<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>R-toolbox: Statistical tests</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/lc/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/lc/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/lc/favicon-16x16.png"><link rel="manifest" href="favicons/lc/site.webmanifest"><link rel="mask-icon" href="favicons/lc/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="assets/images/library-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/stat-tests-1.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="assets/images/library-logo-sm.svg"></div>
    <div class="lesson-title-md">
      R-toolbox
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            R-toolbox
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="CLT-dk.html">CLT - på dansk</a></li><li><a class="dropdown-item" href="CLT-en.html">CLT - in english</a></li><li><a class="dropdown-item" href="data.html">Data sets</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R-toolbox
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 90%" class="percentage">
    90%
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: 90%" aria-valuenow="90" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/stat-tests-1.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="reproducible-analysis.html">1. Reproducible Data Analysis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reading-files.html">2. Reading data from file</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="descript-stat.html">3. Descriptive Statistics</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="histograms.html">4. Histograms</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="table1.html">5. Table One</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="tidy-data.html">6. Tidy Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="normal-distribution.html">7. The normal distribution</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="is-it-normal.html">8. Testing for normality</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="which-distribution.html">9. How is the data distributed?</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="linear-regression.html">10. Linear regression</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="multiple-linear-regression.html">11. Multiple Linear Regression</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="logistic-regression.html">12. Logistic regression</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="clt.html">13. Central Limit Theorem</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="barcharts.html">14. Nicer barcharts</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="powerberegninger.html">15. Power Calculations</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="kmeans.html">16. k-means</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="anova.html">17. ANOVA</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="cohens-kappa.html">18. Cohens Kappa</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="ucloud.html">19. R on Ucloud</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="pipes.html">20. A deeper dive into pipes</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="gis_setup.html">21. Setup for GIS</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="git-00-setup.html">22. Setup for Git</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="git-09-practice.html">23. Practice makes perfect</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        24. Statistical tests
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#one-sample-tests">One sample tests</a></li>
<li><a href="#to-pr%C3%B8ve-tests-og-parrede-tests">To-prøve-tests og parrede tests</a></li>
<li><a href="#variansanalyse-anovaancova">Variansanalyse (ANOVA/ANCOVA)</a></li>
<li><a href="#ikke-parametriske-k-pr%C3%B8ve-tests">Ikke-parametriske k-prøve-tests</a></li>
<li><a href="#regression-og-korrelation">Regression og korrelation</a></li>
<li><a href="#kontingenstabel--og-proportions-tests">Kontingenstabel- og proportions-tests</a></li>
<li><a href="#incidens--og-rate-tests">Incidens- og rate-tests</a></li>
<li><a href="#overlevelsesanalyse">Overlevelsesanalyse</a></li>
<li><a href="#aftale--og-concordance-m%C3%A5l">Aftale- og concordance-mål</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="package-is-not-available.html">25. When install.packages fail</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="fence-test.html">26. Fences på vores undervisningssider</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush28">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading28">
        <a href="making-a-new-course.html">27. Make a new course</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="CLT-dk.html">CLT - på dansk</a></li><li><a href="CLT-en.html">CLT - in english</a></li><li><a href="data.html">Data sets</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="git-09-practice.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="package-is-not-available.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="git-09-practice.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Practice makes
        </a>
        <a class="chapter-link float-end" href="package-is-not-available.html" rel="next">
          Next: When...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Statistical tests</h1>
        <p>Last updated on 2025-06-24 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/stat-tests-1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I run X statistical test?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain how to use markdown with the new lesson template</li>
</ul></div>
</div>
</div>
</div>
</div>
<!-- Hyper-lokal css -->
<style>
/* Kun på denne side: sæt accordion-item til 1rem */
.spoiler-accordion li {
  font-size: 1rem !important;
  margin-bottom: 0px !important;
  margin-top: 0px !important;
  list-style-position: outside !important; /* markør udenfor boksen */


}
</style><p>A collection of statistical tests</p>
<p>For all tests, the approach is:</p>
<ol style="list-style-type: decimal"><li>Formulate hypotheses</li>
<li>Calculate test statistic</li>
<li>Determine p-value</li>
<li>Make decision</li>
</ol><p>The cutoff chosen for all tests is a p-value of 0.05 unless otherwise
indicated.</p>
<p>If a specific test is prefaced with “EJ KORREKTURLÆST” the text,
examples etc have not been checked.</p>
<section><h2 class="section-heading" id="one-sample-tests">One sample tests<a class="anchor" aria-label="anchor" href="#one-sample-tests"></a></h2>
<hr class="half-width"><p><a id="one_sample_chi_square_test"></a></p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample chi-square test </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for:</strong> Testing whether observed categorical
frequencies differ from expected frequencies under a specified
distribution.</li>
<li>
<strong>Real-world example:</strong> Mars Inc. claims a specific
distribution of colours in their M&amp;M bags. Does the observed
proportions in a given bag match their claim?</li>
</ul><p><strong>Assumptions</strong></p>
<ul><li>Observations are independent.<br></li>
<li>Categories are mutually exclusive and collectively exhaustive.</li>
<li>
<em>Expected</em> count in each category is at least 5 (for the
chi-square approximation to be valid). The observed counts can be
smaller.</li>
</ul><p><strong>Strengths</strong></p>
<ul><li>Simple to compute and interpret.</li>
<li>Does not require the data to be normally distributed.</li>
<li>Applicable to any number of categories.</li>
</ul><p><strong>Weaknesses</strong></p>
<ul><li>Sensitive to small expected counts.<br></li>
<li>Does not indicate which categories contribute most to the
discrepancy without further investigation.</li>
<li>Requires independence; cannot be used for paired or repeated
measures.</li>
</ul><p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The proportions of M&amp;M
colours equal the manufacturer’s claimed distribution.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The proportion of at
least one colour differs from the claimed distribution.</li>
</ul><div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed counts of M&amp;M colors:</span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>red <span class="op">=</span> <span class="fl">20</span>, blue <span class="op">=</span> <span class="fl">25</span>, green <span class="op">=</span> <span class="fl">15</span>, brown <span class="op">=</span> <span class="fl">18</span>, orange <span class="op">=</span> <span class="fl">12</span>, yellow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manufacturer's claimed proportions:</span></span>
<span><span class="va">p_expected</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>red <span class="op">=</span> <span class="fl">0.20</span>, blue <span class="op">=</span> <span class="fl">0.20</span>, green <span class="op">=</span> <span class="fl">0.20</span>, brown <span class="op">=</span> <span class="fl">0.20</span>, orange <span class="op">=</span> <span class="fl">0.10</span>, yellow <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform one-sample chi-square goodness-of-fit test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, p <span class="op">=</span> <span class="va">p_expected</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Chi-squared test for given probabilities

data:  observed
X-squared = 3.1, df = 5, p-value = 0.6846</code></pre>
</div>
<p><strong>Interpretation</strong>: The test yields χ² = 3.1 with a
p-value = 0.685. We fail to reject the null hypothesis”, and there is no
evidence to conclude a difference from the claimed distribution.</p>
</div>
</div>
</div>
</div>
<p><a id="one_sample_z_test"></a></p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample z test </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for:</strong> Testing whether the mean of a single
sample differs from a known population mean when the population standard
deviation is known.<br></li>
<li>
<strong>Real-world example:</strong> Checking if the average
diameter of manufactured ball bearings equals the specified 5.00 cm when
σ is known. This checks if the average is different, ie either smaller
<em>or</em> larger. We can also test if it <em>is</em> smaller or
larger.</li>
</ul><p><strong>Assumptions</strong></p>
<ul><li>Sample is a simple random sample from the population.<br></li>
<li>Observations are independent.<br></li>
<li>Population standard deviation (σ) is known.<br></li>
<li>The sampling distribution of the mean is approximately normal
(either the population is normal or n is large, e.g. ≥ 30).</li>
</ul><p><strong>Strengths</strong></p>
<ul><li>More powerful than the t-test when σ is truly known.<br></li>
<li>Simple calculation and interpretation.<br></li>
<li>Relies on the normal distribution, which is well understood.</li>
</ul><p><strong>Weaknesses</strong></p>
<ul><li>The true population σ is only very rarely known in practice.<br></li>
<li>Sensitive to departures from normality for small samples.<br></li>
<li>Misspecification of σ leads to incorrect inferences.</li>
</ul><p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The true mean diameter μ =
5.00 cm.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ ≠ 5.00 cm.</li>
</ul><div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample of diameters (cm) for 25 ball bearings:</span></span>
<span><span class="va">diameters</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.03</span>, <span class="fl">4.97</span>, <span class="fl">5.01</span>, <span class="fl">5.05</span>, <span class="fl">4.99</span>, <span class="fl">5.02</span>, <span class="fl">5.00</span>, <span class="fl">5.04</span>, <span class="fl">4.96</span>, <span class="fl">5.00</span>,</span>
<span>               <span class="fl">5.01</span>, <span class="fl">4.98</span>, <span class="fl">5.02</span>, <span class="fl">5.03</span>, <span class="fl">4.94</span>, <span class="fl">5.00</span>, <span class="fl">5.02</span>, <span class="fl">4.99</span>, <span class="fl">5.01</span>, <span class="fl">5.03</span>,</span>
<span>               <span class="fl">4.98</span>, <span class="fl">5.00</span>, <span class="fl">5.04</span>, <span class="fl">4.97</span>, <span class="fl">5.02</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Known population standard deviation:</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co"># Hypothesized mean:</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">5.00</span></span>
<span></span>
<span><span class="co"># Compute test statistic:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">diameters</span><span class="op">)</span></span>
<span><span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">diameters</span><span class="op">)</span></span>
<span><span class="va">z_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xbar</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">/</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two-sided p-value:</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Larger p-value</span></span>
<span><span class="va">larger_p_value</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Smaller p-value</span></span>
<span><span class="va">smaller_p_value</span> <span class="op">&lt;-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output results:</span></span>
<span><span class="va">z_stat</span>; <span class="va">p_value</span>; <span class="va">larger_p_value</span>; <span class="va">smaller_p_value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.44</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.6599371</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3299686</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.6700314</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The sample mean is 5.004 cm. The z-statistic is 0.44 with a two-sided
p-value of 0.66. We fail to reject the null hypothesis. Thus, there is
no evidence to conclude a difference from the specified diameter of 5.00
cm.</p>
<p>We can similarly reject the hypothesis that the average diameter is
larger (p = 0.3299686) or that it is smaller (p = 0.6700314)</p>
</div>
</div>
</div>
</div>
<p><a id="one_sample_t_test"></a></p>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample t test </h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<p>EJ KORREKTURLÆST!</p>
<p>Her kan vi nok med fordel bruge samme eksempel som i z-testen.</p>
<ul><li>
<strong>Used for: </strong> Testing whether the mean of a single
sample differs from a known or hypothesized population mean when the
population standard deviation is unknown.<br></li>
<li>
<strong>Real-world example:</strong> Determining if the average exam
score of a class differs from the passing threshold of 70%.</li>
</ul><p><strong>Assumptions:</strong></p>
<ul><li>Sample is a simple random sample from the population.<br></li>
<li>Observations are independent.<br></li>
<li>The data are approximately normally distributed (especially
important for small samples; n ≥ 30 reduces sensitivity).</li>
</ul><p><strong>Strengths:</strong> * Does not require knowing the population
standard deviation.<br>
* Robust to mild departures from normality for moderate-to-large sample
sizes.<br>
* Widely applicable and easily implemented.</p>
<p><strong>Weaknesses</strong> * Sensitive to outliers in small
samples.<br>
* Performance degrades if normality assumption is seriously violated and
n is small.<br>
* Degrees of freedom reduce power relative to z-test.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The true mean exam score μ =
70.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ ≠ 70.</li>
</ul><div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample of exam scores for 20 students:</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">68</span>, <span class="fl">74</span>, <span class="fl">71</span>, <span class="fl">69</span>, <span class="fl">73</span>, <span class="fl">65</span>, <span class="fl">77</span>, <span class="fl">72</span>, <span class="fl">70</span>, <span class="fl">66</span>,</span>
<span>            <span class="fl">75</span>, <span class="fl">68</span>, <span class="fl">71</span>, <span class="fl">69</span>, <span class="fl">74</span>, <span class="fl">67</span>, <span class="fl">72</span>, <span class="fl">70</span>, <span class="fl">73</span>, <span class="fl">68</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hypothesized mean:</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">70</span></span>
<span></span>
<span><span class="co"># Perform one-sample t-test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, mu <span class="op">=</span> <span class="va">mu0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	One Sample t-test

data:  scores
t = 0.84675, df = 19, p-value = 0.4077
alternative hypothesis: true mean is not equal to 70
95 percent confidence interval:
 69.1169 72.0831
sample estimates:
mean of x
     70.6 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The sample mean is 70.6. The t-statistic is 0.85 with 19 degrees of
freedom and a two-sided p-value of 0.408. We fail to reject the null
hypothesis. Thus, there is no evidence to conclude the average score
differs from the passing threshold of 70.</p>
</div>
</div>
</div>
</div>
<p><a id="one_sample_poisson_test"></a></p>
<div id="accordionSpoiler4" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler4" aria-expanded="false" aria-controls="collapseSpoiler4">
  <h3 class="accordion-header" id="headingSpoiler4">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample Poisson test </h3>
</button>
<div id="collapseSpoiler4" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler4" aria-labelledby="headingSpoiler4">
<div class="accordion-body">
<p>EJ KORREKTURLÆST!</p>
<ul><li>
<strong>Used for</strong> Testing whether the observed count of
events in a fixed period differs from a hypothesized Poisson rate.<br></li>
<li>
<strong>Real-world example:</strong> Checking if the number of
customer arrivals per hour at a call center matches the expected rate of
30 calls/hour.</li>
</ul><p><strong>Assumptions</strong> * Events occur independently.<br>
* The rate of occurrence (λ) is constant over the observation
period.<br>
* The count of events in non-overlapping intervals is independent.</p>
<p><strong>Strengths</strong> * Exact test based on the Poisson
distribution (no large-sample approximation needed).<br>
* Valid for small counts and rare events.<br>
* Simple to implement in R via <code>poisson.test()</code>.</p>
<p><strong>Weaknesses</strong> * Sensitive to violations of the Poisson
assumptions (e.g., overdispersion or time-varying rate).<br>
* Only assesses the overall rate, not the dispersion or clustering of
events.<br>
* Cannot handle covariates or more complex rate structures.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The event rate λ = 30
calls/hour.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> λ ≠ 30
calls/hour.</li>
</ul><div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed number of calls in one hour:</span></span>
<span><span class="va">observed_calls</span> <span class="op">&lt;-</span> <span class="fl">36</span></span>
<span></span>
<span><span class="co"># Hypothesized rate (calls per hour):</span></span>
<span><span class="va">lambda0</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="co"># Perform one-sample Poisson test (two-sided):</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed_calls</span>, T <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="va">lambda0</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact Poisson test

data:  observed_calls time base: 1
number of events = 36, time base = 1, p-value = 0.272
alternative hypothesis: true event rate is not equal to 30
95 percent confidence interval:
 25.21396 49.83917
sample estimates:
event rate
        36 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The test reports an observed count of 36 calls versus an expected 30
calls, yielding a p-value of 0.272. We fail to reject the null
hypothesis. Thus, there is no evidence to conclude the call rate differs
from 30 calls/hour.</p>
</div>
</div>
</div>
</div>
<p><a id="shapiro_wilk_test"></a></p>
<div id="accordionSpoiler5" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler5" aria-expanded="false" aria-controls="collapseSpoiler5">
  <h3 class="accordion-header" id="headingSpoiler5">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Shapiro–Wilk test for normality </h3>
</button>
<div id="collapseSpoiler5" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler5" aria-labelledby="headingSpoiler5">
<div class="accordion-body">
<p>EJ KORREKTURLÆST. DEN HAR VI NOGET UNDERVISNINGSMATERIALE OM I “ER
DET NORMALT?”</p>
<ul><li>
<strong>Used for</strong> Testing whether a sample comes from a
normally distributed population.<br></li>
<li>
<strong>Real-world example:</strong> Checking if the distribution of
daily blood glucose measurements in a patient cohort is approximately
normal.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Data are continuous.<br>
* No extreme ties or many identical values.</p>
<p><strong>Strengths</strong> * Good power for detecting departures from
normality in small to moderate samples (n ≤ 50).<br>
* Widely implemented and easy to run in R.<br>
* Provides both a test statistic (W) and p-value.</p>
<p><strong>Weaknesses</strong> * Very sensitive to even slight
deviations from normality in large samples (n &gt; 2000).<br>
* Does not indicate the nature of the departure (e.g., skewness
vs. kurtosis).<br>
* Ties or repeated values can invalidate the test.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The sample is drawn from a
normal distribution.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The sample is not
drawn from a normal distribution.</li>
</ul><div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a sample of 30 observations from a normal distribution:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Shapiro–Wilk test:</span></span>
<span><span class="va">sw_result</span> <span class="op">&lt;-</span> <span class="fu">shapiro.test</span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">sw_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Shapiro-Wilk normality test

data:  sample_data
W = 0.97894, p-value = 0.7966</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Shapiro–Wilk statistic W = 0.979 with p-value = 0.797. We fail to
reject the null hypothesis. Thus, there is no evidence to conclude a
departure from normality.</p>
</div>
</div>
</div>
</div>
<p><a id="ks_one_sample"></a></p>
<div id="accordionSpoiler6" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler6" aria-expanded="false" aria-controls="collapseSpoiler6">
  <h3 class="accordion-header" id="headingSpoiler6">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kolmogorov–Smirnov én-prøve-test (goodness-of-fit) </h3>
</button>
<div id="collapseSpoiler6" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler6" aria-labelledby="headingSpoiler6">
<div class="accordion-body">
<p>EJ KORREKTURLÆST. DENNE HAR VI OGSÅ UNDERVISNINGSMATERIALE OM I “ER
DET NORMALT”</p>
<ul><li>
<strong>Used for</strong> Testing whether a sample comes from a
specified continuous distribution.<br></li>
<li>
<strong>Real-world example:</strong> Checking if patient systolic
blood pressures follow a normal distribution with mean 120 mmHg and SD
15 mmHg.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Data are continuous (no ties).<br>
* The null distribution is fully specified (parameters known, not
estimated from the data).</p>
<p><strong>Strengths</strong> * Nonparametric: makes no assumption about
distribution shape beyond continuity.<br>
* Sensitive to any kind of departure (location, scale, shape).<br>
* Exact distribution of the test statistic under H₀.</p>
<p><strong>Weaknesses</strong> * Requires that distribution parameters
(e.g., mean, SD) are known a priori; if estimated from data, p-values
are invalid.<br>
* Less powerful than parametric tests when the parametric form is
correct.<br>
* Sensitive to ties and discrete data.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The blood pressure values
follow a Normal(μ = 120, σ = 15) distribution.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The blood pressure
values do not follow Normal(120, 15).</li>
</ul><div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate systolic blood pressure for 40 patients:</span></span>
<span><span class="va">sample_bp</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform one-sample Kolmogorov–Smirnov test against N(120,15):</span></span>
<span><span class="va">ks_result</span> <span class="op">&lt;-</span> <span class="fu">ks.test</span><span class="op">(</span><span class="va">sample_bp</span>, <span class="st">"pnorm"</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show results:</span></span>
<span><span class="va">ks_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact one-sample Kolmogorov-Smirnov test

data:  sample_bp
D = 0.11189, p-value = 0.6573
alternative hypothesis: two-sided</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The KS statistic D = 0.112 with p-value = 0.657. We fail to reject
the null hypothesis. Thus, there is no evidence to conclude deviation
from Normal(120,15).</p>
</div>
</div>
</div>
</div>
<p><a id="chi_square_gof"></a></p>
<div id="accordionSpoiler7" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler7" aria-expanded="false" aria-controls="collapseSpoiler7">
  <h3 class="accordion-header" id="headingSpoiler7">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> χ² goodness-of-fit test </h3>
</button>
<div id="collapseSpoiler7" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler7" aria-labelledby="headingSpoiler7">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether observed categorical
frequencies differ from expected categorical proportions.<br></li>
<li>
<strong>Real-world example:</strong> Comparing the distribution of
blood types in a sample of donors to known population proportions.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Categories are mutually exclusive and exhaustive.<br>
* Expected count in each category is at least 5 for the chi-square
approximation to hold.</p>
<p><strong>Strengths</strong> * Simple to compute and interpret.<br>
* Nonparametric: no requirement of normality.<br>
* Flexible for any number of categories.</p>
<p><strong>Weaknesses</strong> * Sensitive to small expected counts
(invalidates approximation).<br>
* Doesn’t identify which categories drive the discrepancy without
further post-hoc tests.<br>
* Requires independence—unsuitable for paired or repeated measures.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The sample blood type
proportions equal the known population proportions (A=0.42, B=0.10,
AB=0.04, O=0.44).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one blood
type proportion differs from its known value.</li>
</ul><div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed counts of blood types in 200 donors:</span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>A <span class="op">=</span> <span class="fl">85</span>, B <span class="op">=</span> <span class="fl">18</span>, AB <span class="op">=</span> <span class="fl">6</span>, O <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Known population proportions:</span></span>
<span><span class="va">p_expected</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.42</span>, B <span class="op">=</span> <span class="fl">0.10</span>, AB <span class="op">=</span> <span class="fl">0.04</span>, O <span class="op">=</span> <span class="fl">0.44</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform chi-square goodness-of-fit test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, p <span class="op">=</span> <span class="va">p_expected</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Chi-squared test for given probabilities

data:  observed
X-squared = 0.81418, df = 3, p-value = 0.8461</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The test yields χ² = 0.81 with p-value = 0.846. We fail to reject the
null hypothesis. Thus, there is no evidence to conclude the sample
proportions differ from the population.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="to-prøve-tests-og-parrede-tests">To-prøve-tests og parrede tests<a class="anchor" aria-label="anchor" href="#to-pr%C3%B8ve-tests-og-parrede-tests"></a></h2>
<hr class="half-width"><p><a id="two_sample_f_test"></a></p>
<div id="accordionSpoiler8" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler8" aria-expanded="false" aria-controls="collapseSpoiler8">
  <h3 class="accordion-header" id="headingSpoiler8">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample F test for variance </h3>
</button>
<div id="collapseSpoiler8" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler8" aria-labelledby="headingSpoiler8">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p>We use this when we want to determine if two independent samples
originate from populations with the same variance.</p>
<ul><li>
<strong>Used for</strong> Testing whether two independent samples
have equal variances.<br></li>
<li>
<strong>Real-world example:</strong> Comparing the variability in
systolic blood pressure measurements between two clinics.</li>
</ul><p><strong>Assumptions</strong> * Both samples consist of independent
observations.<br>
* Each sample is drawn from a normally distributed population.<br>
* Samples are independent of one another.</p>
<p><strong>Strengths</strong> * Simple calculation and
interpretation.<br>
* Directly targets variance equality, a key assumption in many
downstream tests (e.g., t-test).<br>
* Exact inference under normality.</p>
<p><strong>Weaknesses</strong> * Highly sensitive to departures from
normality.<br>
* Only compares variance—doesn’t assess other distributional
differences.<br>
* Not robust to outliers.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> σ₁² = σ₂² (the two population
variances are equal).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> σ₁² ≠ σ₂² (the
variances differ).</li>
</ul><div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate systolic BP (mmHg) from two clinics:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">clinicA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">clinicB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">118</span>, sd <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform two-sample F-test for variances:</span></span>
<span><span class="va">f_result</span> <span class="op">&lt;-</span> <span class="fu">var.test</span><span class="op">(</span><span class="va">clinicA</span>, <span class="va">clinicB</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">f_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	F test to compare two variances

data:  clinicA and clinicB
F = 0.41748, num df = 29, denom df = 24, p-value = 0.02606
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.1882726 0.8992623
sample estimates:
ratio of variances
         0.4174837 </code></pre>
</div>
<p><strong>Interpretation</strong></p>
<p>The F statistic is 0.417 with numerator df = 29 and denominator df =
24, and p-value = 0.0261. We</p>
<p>reject the null hypothesis. Thus, there is evidence that the
variability in blood pressure differs between the two clinics.</p>
</div>
</div>
</div>
</div>
<p><a id="paired_t_test"></a></p>
<div id="accordionSpoiler9" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler9" aria-expanded="false" aria-controls="collapseSpoiler9">
  <h3 class="accordion-header" id="headingSpoiler9">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Paired t-test </h3>
</button>
<div id="collapseSpoiler9" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler9" aria-labelledby="headingSpoiler9">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the mean difference
between two related (paired) samples differs from zero.<br></li>
<li>
<strong>Real-world example:</strong> Comparing patients’ blood
pressure before and after administering a new medication.</li>
</ul><p><strong>Assumptions</strong> * Paired observations are independent of
other pairs.<br>
* Differences between pairs are approximately normally
distributed.<br>
* The scale of measurement is continuous (interval or ratio).</p>
<p><strong>Strengths</strong> * Controls for between‐subject variability
by using each subject as their own control.<br>
* More powerful than unpaired tests when pairs are truly
dependent.<br>
* Easy to implement and interpret.</p>
<p><strong>Weaknesses</strong> * Sensitive to outliers in the difference
scores.<br>
* Requires that differences be approximately normal, especially for
small samples.<br>
* Not appropriate if pairing is not justified or if missing data break
pairs.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The mean difference Δ = 0 (no
change in blood pressure).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Δ ≠ 0 (blood pressure
changes after medication).</li>
</ul><div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated systolic blood pressure (mmHg) for 15 patients before and after treatment:</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">142</span>, <span class="fl">138</span>, <span class="fl">150</span>, <span class="fl">145</span>, <span class="fl">133</span>, <span class="fl">140</span>, <span class="fl">147</span>, <span class="fl">139</span>, <span class="fl">141</span>, <span class="fl">136</span>, <span class="fl">144</span>, <span class="fl">137</span>, <span class="fl">148</span>, <span class="fl">142</span>, <span class="fl">139</span><span class="op">)</span></span>
<span><span class="va">after</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">135</span>, <span class="fl">132</span>, <span class="fl">144</span>, <span class="fl">138</span>, <span class="fl">128</span>, <span class="fl">135</span>, <span class="fl">142</span>, <span class="fl">133</span>, <span class="fl">136</span>, <span class="fl">130</span>, <span class="fl">139</span>, <span class="fl">132</span>, <span class="fl">143</span>, <span class="fl">137</span>, <span class="fl">133</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform paired t-test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">before</span>, <span class="va">after</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Paired t-test

data:  before and after
t = 29.437, df = 14, p-value = 5.418e-14
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 5.19198 6.00802
sample estimates:
mean difference
            5.6 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The mean difference (before – after) is 5.6 mmHg. The t‐statistic is
29.44 with 14 degrees of freedom and a two‐sided p‐value
of<code>r signif(test_result$p.value, 3)</code>. We reject the null
hypothesis. Thus, there is evidence that the medication significantly
changed blood pressure.</p>
</div>
</div>
</div>
</div>
<p><a id="two_sample_t_test_equal_var"></a></p>
<div id="accordionSpoiler10" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler10" aria-expanded="false" aria-controls="collapseSpoiler10">
  <h3 class="accordion-header" id="headingSpoiler10">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample t test (equal variances) </h3>
</button>
<div id="collapseSpoiler10" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler10" aria-labelledby="headingSpoiler10">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the means of two
independent samples differ, assuming equal variances.</li>
<li>
<strong>Real-world example:</strong> Comparing average systolic
blood pressure between male and female patients when variability is
similar.</li>
</ul><p><strong>Assumptions</strong> * Observations in each group are
independent.<br>
* Both populations are normally distributed (especially important for
small samples).<br>
* The two populations have equal variances (homoscedasticity).</p>
<p><strong>Strengths</strong> * More powerful than Welch’s t-test when
variances truly are equal.<br>
* Simple computation and interpretation via pooled variance.<br>
* Widely implemented and familiar to practitioners.</p>
<p><strong>Weaknesses</strong> * Sensitive to violations of normality in
small samples.<br>
* Incorrect if variances differ substantially—can inflate Type I
error.<br>
* Assumes homogeneity of variance, which may not hold in practice.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> μ₁ = μ₂ (the two population
means are equal).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ₁ ≠ μ₂ (the means
differ).</li>
</ul><div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate systolic BP (mmHg):</span></span>
<span><span class="va">groupA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">122</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># e.g., males</span></span>
<span><span class="va">groupB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">118</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># e.g., females</span></span>
<span></span>
<span><span class="co"># Perform two-sample t-test with equal variances:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">groupA</span>, <span class="va">groupB</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Two Sample t-test

data:  groupA and groupB
t = 2.6245, df = 48, p-value = 0.0116
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
  1.733091 13.086377
sample estimates:
mean of x mean of y
 125.2119  117.8021 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The pooled estimate of the difference in means is 7.41 mmHg. The
t-statistic is 2.62 with df = 48 and p-value = 0.0116. We reject the
null hypothesis. Thus, there is evidence that the average systolic blood
pressure differs between the two groups.</p>
</div>
</div>
</div>
</div>
<p><a id="two_sample_t_test_unequal_var"></a></p>
<div id="accordionSpoiler11" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler11" aria-expanded="false" aria-controls="collapseSpoiler11">
  <h3 class="accordion-header" id="headingSpoiler11">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample t test (unequal variances) </h3>
</button>
<div id="collapseSpoiler11" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler11" aria-labelledby="headingSpoiler11">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p><strong>Used for</strong> Testing whether the means of two
independent samples differ when variances are unequal.<br>
* <strong>Real-world example:</strong> Comparing average recovery times
for two different therapies when one therapy shows more variable
outcomes.</p>
<p><strong>Assumptions</strong> * Observations in each group are
independent.<br>
* Each population is approximately normally distributed (especially
important for small samples).<br>
* Does <strong>not</strong> assume equal variances across groups.</p>
<p><strong>Strengths</strong> * Controls Type I error when variances
differ.<br>
* More reliable than the pooled‐variance t‐test under
heteroskedasticity.<br>
* Simple to implement via <code>t.test(..., var.equal = FALSE)</code> in
R.</p>
<p><strong>Weaknesses</strong> * Slight loss of power compared to
equal-variance t‐test when variances truly are equal.<br>
* Sensitive to departures from normality in small samples.<br>
* Degrees of freedom are approximated (Welch–Satterthwaite), which can
reduce interpretability.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> μ₁ = μ₂ (the two population
means are equal).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ₁ ≠ μ₂ (the means
differ).</li>
</ul><div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate recovery times (days) for two therapies:</span></span>
<span><span class="va">therapyA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co"># Therapy A</span></span>
<span><span class="va">therapyB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>   <span class="co"># Therapy B (more variable)</span></span>
<span></span>
<span><span class="co"># Perform two-sample t-test with unequal variances:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">therapyA</span>, <span class="va">therapyB</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  therapyA and therapyB
t = -1.7792, df = 32.794, p-value = 0.08449
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -3.8148079  0.2558875
sample estimates:
mean of x mean of y
 10.41320  12.19266 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The estimated difference in means is -1.78 days. The Welch
t‐statistic is<code>r round(test_result$statistic, 2)</code> with df ≈
32.8 and two‐sided p‐value
=<code>r signif(test_result$p.value, 3</code>). We fail to reject the
null hypothesis. Thus, there is no evidence of a difference in average
recovery times..</p>
</div>
</div>
</div>
</div>
<p><a id="mann_whitney_u_test"></a></p>
<div id="accordionSpoiler12" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler12" aria-expanded="false" aria-controls="collapseSpoiler12">
  <h3 class="accordion-header" id="headingSpoiler12">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Mann–Whitney U-test (Wilcoxon rank-sum) </h3>
</button>
<div id="collapseSpoiler12" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler12" aria-labelledby="headingSpoiler12">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Comparing the central tendencies of two
independent samples when the data are ordinal or not normally
distributed.<br></li>
<li>
<strong>Real-world example:</strong> Testing whether pain scores
(0–10) differ between patients receiving Drug A versus Drug B when
scores are skewed.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent both
within and between groups.<br>
* The response variable is at least ordinal.<br>
* The two distributions have the same shape (so that differences reflect
location shifts).</p>
<p><strong>Strengths</strong> * Nonparametric: does not require
normality or equal variances.<br>
* Robust to outliers and skewed data.<br>
* Simple rank-based calculation.</p>
<p><strong>Weaknesses</strong> * Less powerful than t-test when data are
truly normal.<br>
* If distributions differ in shape as well as location, interpretation
becomes ambiguous.<br>
* Only tests for location shift, not differences in dispersion.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The distributions of pain
scores are identical for Drug A and Drug B.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The distributions
differ in location (median pain differs between drugs).</li>
</ul><div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate pain scores (0–10) for two independent groups:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">drugA</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">4</span>,  <span class="co"># skewed lower</span></span>
<span>           <span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">drugB</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">7</span>,  <span class="co"># skewed higher</span></span>
<span>           <span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Mann–Whitney U test (Wilcoxon rank-sum):</span></span>
<span><span class="va">mw_result</span> <span class="op">&lt;-</span> <span class="fu">wilcox.test</span><span class="op">(</span><span class="va">drugA</span>, <span class="va">drugB</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">mw_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Wilcoxon rank sum test with continuity correction

data:  drugA and drugB
W = 20.5, p-value = 9.123e-07
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Wilcoxon rank-sum statistic W = 20.5 with p-value = 9.12^{-7}. We
reject the null hypothesis. Thus, there is evidence that median pain
scores differ between Drug A and Drug B.</p>
</div>
</div>
</div>
</div>
<p><a id="wilcoxon_signed_rank_test"></a></p>
<div id="accordionSpoiler13" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler13" aria-expanded="false" aria-controls="collapseSpoiler13">
  <h3 class="accordion-header" id="headingSpoiler13">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Wilcoxon signed-rank test </h3>
</button>
<div id="collapseSpoiler13" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler13" aria-labelledby="headingSpoiler13">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the median difference
between paired observations is zero.<br></li>
<li>
<strong>Real-world example:</strong> Comparing patients’ pain scores
before and after a new analgesic treatment when differences may not be
normally distributed.</li>
</ul><p><strong>Assumptions</strong> * Observations are paired and the pairs
are independent.<br>
* Differences are at least ordinal and symmetrically distributed around
the median.<br>
* No large number of exact zero differences (ties).</p>
<p><strong>Strengths</strong> * Nonparametric: does not require
normality of differences.<br>
* Controls for within‐subject variability by using paired design.<br>
* Robust to outliers in the paired differences.</p>
<p><strong>Weaknesses</strong> * Less powerful than the paired t-test
when differences are truly normal.<br>
* Requires symmetry of the distribution of differences.<br>
* Cannot easily handle many tied differences.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The median difference in pain
score (before – after) = 0 (no change).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The median difference
≠ 0 (pain changes after treatment).</li>
</ul><div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated pain scores (0–10) for 12 patients:</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">after</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Wilcoxon signed-rank test:</span></span>
<span><span class="va">wsr_result</span> <span class="op">&lt;-</span> <span class="fu">wilcox.test</span><span class="op">(</span><span class="va">before</span>, <span class="va">after</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">wsr_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Wilcoxon signed rank test with continuity correction

data:  before and after
V = 66, p-value = 0.001586
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Wilcoxon signed‐rank test statistic V =66 with p-value
=<code>r signif(wsr_result$p.value, 3)</code>. We reject the null
hypothesis. Thus, there is evidence that median pain scores change after
treatment..</p>
</div>
</div>
</div>
</div>
<p><a id="ks_two_sample"></a></p>
<div id="accordionSpoiler14" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler14" aria-expanded="false" aria-controls="collapseSpoiler14">
  <h3 class="accordion-header" id="headingSpoiler14">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kolmogorov–Smirnov two-sample-test </h3>
</button>
<div id="collapseSpoiler14" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler14" aria-labelledby="headingSpoiler14">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether two independent samples
come from the same continuous distribution.<br></li>
<li>
<strong>Real-world example:</strong> Comparing the distribution of
recovery times for patients receiving Drug A versus Drug B.</li>
</ul><p><strong>Assumptions</strong> * Observations in each sample are
independent.<br>
* Data are continuous with no ties.<br>
* The two samples are drawn from fully specified continuous
distributions (no parameters estimated from the same data).</p>
<p><strong>Strengths</strong> * Nonparametric: makes no assumption about
the shape of the distribution.<br>
* Sensitive to differences in location, scale, or overall shape.<br>
* Exact distribution under the null when samples are not too large.</p>
<p><strong>Weaknesses</strong> * Less powerful than parametric
alternatives if the true form is known (e.g., t-test for normal
data).<br>
* Invalid p-values if there are ties or discrete data.<br>
* Does not indicate how distributions differ—only that they do.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The two samples come from the
same distribution.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The two samples come
from different distributions.</li>
</ul><div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate recovery times (days) for two therapies:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">therapyA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co"># Therapy A</span></span>
<span><span class="va">therapyB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>   <span class="co"># Therapy B</span></span>
<span></span>
<span><span class="co"># Perform two-sample Kolmogorov–Smirnov test:</span></span>
<span><span class="va">ks_result</span> <span class="op">&lt;-</span> <span class="fu">ks.test</span><span class="op">(</span><span class="va">therapyA</span>, <span class="va">therapyB</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">ks_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Asymptotic two-sample Kolmogorov-Smirnov test

data:  therapyA and therapyB
D = 0.43333, p-value = 0.007153
alternative hypothesis: two-sided</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The KS statistic D = 0.433 with p-value = 0.00715. We reject the null
hypothesis. Thus, there is evidence that the distribution of recovery
times differs between therapies.</p>
</div>
</div>
</div>
</div>
<p><a id="levene_test"></a></p>
<div id="accordionSpoiler15" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler15" aria-expanded="false" aria-controls="collapseSpoiler15">
  <h3 class="accordion-header" id="headingSpoiler15">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Levene’s test for homoskedasticitet </h3>
</button>
<div id="collapseSpoiler15" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler15" aria-labelledby="headingSpoiler15">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether multiple groups have equal
variances.<br></li>
<li>
<strong>Real-world example:</strong> Checking if the variability in
patient blood pressure differs between three different clinics.</li>
</ul><p><strong>Assumptions</strong></p>
<ul><li>Observations are independent.<br></li>
<li>The underlying distributions within each group are approximately
symmetric (Levene’s test is robust to non-normality but assumes no
extreme skew).</li>
</ul><p><strong>Strengths</strong> * More robust to departures from normality
than Bartlett’s test.<br>
* Applicable to two or more groups.<br>
* Simple to implement and interpret.</p>
<p><strong>Weaknesses</strong> * Less powerful than tests that assume
normality when data truly are normal.<br>
* Can be sensitive to extreme outliers despite its robustness.<br>
* Does not indicate which groups differ in variance without follow-up
comparisons.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> All groups have equal
variances (σ₁² = σ₂² = … = σₖ²).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group’s
variance differs.</li>
</ul><div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data for three groups (n = 10 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">group</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"ClinicA"</span>, <span class="st">"ClinicB"</span>, <span class="st">"ClinicC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>             <span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>             <span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>      <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">group</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Levene’s test for homogeneity of variances:</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">car</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: carData</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">levene_result</span> <span class="op">&lt;-</span> <span class="fu">leveneTest</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show results:</span></span>
<span><span class="va">levene_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2   0.872 0.4296
      27               </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>Levene’s test yields an F-statistic of 0.87 with a p-value of 0.43.
We fail to reject the null hypothesis. This means there is no evidence
of differing variances across clinics.</p>
</div>
</div>
</div>
</div>
<p><a id="bartlett_test"></a></p>
<div id="accordionSpoiler16" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler16" aria-expanded="false" aria-controls="collapseSpoiler16">
  <h3 class="accordion-header" id="headingSpoiler16">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Bartlett’s test for homoskedasticitet </h3>
</button>
<div id="collapseSpoiler16" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler16" aria-labelledby="headingSpoiler16">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether multiple groups have equal
variances under the assumption of normality.<br></li>
<li>
<strong>Real-world example:</strong> Checking if the variability in
laboratory test results differs across three different
laboratories.</li>
</ul><p><strong>Assumptions</strong> * Observations within each group are
independent.<br>
* Each group is drawn from a normally distributed population.<br>
* Groups are independent of one another.</p>
<p><strong>Strengths</strong> * More powerful than Levene’s test when
normality holds.<br>
* Directly targets equality of variances under the normal model.<br>
* Simple to compute in R via <code>bartlett.test()</code>.</p>
<p><strong>Weaknesses</strong> * Highly sensitive to departures from
normality—small deviations can inflate Type I error.<br>
* Does not indicate which groups differ without further pairwise
testing.<br>
* Not robust to outliers.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> All group variances are equal
(σ₁² = σ₂² = σ₃²).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group
variance differs.</li>
</ul><div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data for three laboratories (n = 12 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">lab</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"LabA"</span>, <span class="st">"LabB"</span>, <span class="st">"LabC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">values</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>              <span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>              <span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>       <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">lab</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Bartlett’s test for homogeneity of variances:</span></span>
<span><span class="va">bartlett_result</span> <span class="op">&lt;-</span> <span class="fu">bartlett.test</span><span class="op">(</span><span class="va">values</span> <span class="op">~</span> <span class="va">lab</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">bartlett_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Bartlett test of homogeneity of variances

data:  values by lab
Bartlett's K-squared = 10.387, df = 2, p-value = 0.005552</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>Bartlett’s K-squared = 10.39 with df = 2 and p-value = 0.00555. We
reject the null hypothesis. Thus, there is evidence that at least one
laboratory’s variance differs from the others.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="variansanalyse-anovaancova">Variansanalyse (ANOVA/ANCOVA)<a class="anchor" aria-label="anchor" href="#variansanalyse-anovaancova"></a></h2>
<hr class="half-width"><p><a id="one_way_anova"></a></p>
<div id="accordionSpoiler17" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler17" aria-expanded="false" aria-controls="collapseSpoiler17">
  <h3 class="accordion-header" id="headingSpoiler17">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-way ANOVA </h3>
</button>
<div id="collapseSpoiler17" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler17" aria-labelledby="headingSpoiler17">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p>SAMMENHOLD MED <a href="anova.html">undervisningsudgaven</a></p>
<ul><li>
<strong>Used for</strong> Testing whether the means of three or more
independent groups differ.<br></li>
<li>
<strong>Real-world example:</strong> Comparing average test scores
among students taught by three different teaching methods.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Each group’s residuals are approximately normally distributed.<br>
* Homogeneity of variances across groups.</p>
<p><strong>Strengths</strong> * Controls Type I error rate when
comparing multiple groups.<br>
* Simple to compute and interpret via F-statistic.<br>
* Foundation for many extensions (e.g., factorial ANOVA, mixed
models).</p>
<p><strong>Weaknesses</strong> * Sensitive to heterogeneity of
variances, especially with unequal group sizes.<br>
* Only tells you that at least one mean differs—does not indicate which
groups differ without post-hoc tests.<br>
* Assumes normality; moderately robust for large samples, but small
samples can be problematic.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> μ₁ = μ₂ = μ₃ (all three group
means are equal).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group
mean differs.</li>
</ul><div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate exam scores for three teaching methods (n = 20 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Lecture"</span>, <span class="st">"Online"</span>, <span class="st">"Hybrid"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">75</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">80</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">78</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>     <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">method</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANOVA:</span></span>
<span><span class="va">anova_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">method</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize ANOVA table:</span></span>
<span><span class="va">anova_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">anova_fit</span><span class="op">)</span></span>
<span><span class="va">anova_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
method       2    146   72.79   1.184  0.314
Residuals   57   3505   61.48               </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The ANOVA yields F = 1.18 with df₁
=<code>r anova_summary[[1]]["method","Df"]</code> and df₂
=<code>r anova_summary[[1]]["Residuals","Df"]</code>, and p-value =
0.314. We fail to reject the null hypothesis. Thus, there is no evidence
of a difference in mean scores among methods.</p>
</div>
</div>
</div>
</div>
<p><a id="one_way_ancova"></a></p>
<div id="accordionSpoiler18" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler18" aria-expanded="false" aria-controls="collapseSpoiler18">
  <h3 class="accordion-header" id="headingSpoiler18">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-way ANCOVA </h3>
</button>
<div id="collapseSpoiler18" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler18" aria-labelledby="headingSpoiler18">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Comparing group means on a continuous
outcome while adjusting for one continuous covariate.<br></li>
<li>
<strong>Real-world example:</strong> Evaluating whether three
different teaching methods lead to different final exam scores after
accounting for students’ prior GPA.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* The relationship between the covariate and the outcome is linear and
the same across groups (homogeneity of regression slopes).<br>
* Residuals are normally distributed with equal variances across
groups.<br>
* Covariate is measured without error and is independent of group
assignment.</p>
<p><strong>Strengths</strong> * Removes variability due to the
covariate, increasing power to detect group differences.<br>
* Controls for confounding by the covariate.<br>
* Simple extension of one-way ANOVA with interpretation familiar to
ANOVA users.</p>
<p><strong>Weaknesses</strong> * Sensitive to violation of homogeneity
of regression slopes.<br>
* Mis‐specification of the covariate‐outcome relationship biases
results.<br>
* Requires accurate measurement of the covariate.<br>
* Does not accommodate multiple covariates without extension to
factorial ANCOVA or regression.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> After adjusting for prior
GPA, the mean final exam scores are equal across the three teaching
methods (μ_Lecture = μ_Online = μ_Hybrid).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one adjusted
group mean differs.</li>
</ul><div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Lecture"</span>,<span class="st">"Online"</span>,<span class="st">"Hybrid"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior_gpa</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">3.0</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate final exam scores with a covariate effect:</span></span>
<span><span class="co"># true intercepts 75, 78, 80; slope = 5 points per GPA unit; noise sd = 5</span></span>
<span><span class="va">final_score</span> <span class="op">&lt;-</span> <span class="fl">75</span> <span class="op">+</span> </span>
<span>               <span class="fu">ifelse</span><span class="op">(</span><span class="va">method</span><span class="op">==</span><span class="st">"Online"</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fu">ifelse</span><span class="op">(</span><span class="va">method</span><span class="op">==</span><span class="st">"Hybrid"</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fl">5</span> <span class="op">*</span> <span class="va">prior_gpa</span> <span class="op">+</span> </span>
<span>               <span class="fu">rnorm</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">method</span>, <span class="va">prior_gpa</span>, <span class="va">final_score</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANCOVA:</span></span>
<span><span class="va">ancova_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">final_score</span> <span class="op">~</span> <span class="va">prior_gpa</span> <span class="op">+</span> <span class="va">method</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">ancova_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">ancova_fit</span><span class="op">)</span></span>
<span><span class="va">ancova_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)
prior_gpa    1  166.5   166.5   5.967 0.01775 *
method       2  296.8   148.4   5.320 0.00767 **
Residuals   56 1562.4    27.9
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>After adjusting for prior GPA, the effect of teaching method yields F
= 5.32 (df₁ =<code>r ancova_summary[[1]]["method","Df"]</code>, df₂
=<code>r ancova_summary[[1]]["Residuals","Df"]</code>) with p
=<code>r signif(ancova_summary[[1]]["method","Pr(&gt;F)"], 3</code>). We
reject the null hypothesis. Thus, there is evidence that, controlling
for prior GPA, at least one teaching method leads to a different average
final score..</p>
</div>
</div>
</div>
</div>
<p><a id="welchs_anova"></a></p>
<div id="accordionSpoiler19" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler19" aria-expanded="false" aria-controls="collapseSpoiler19">
  <h3 class="accordion-header" id="headingSpoiler19">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Welch’s ANOVA (uden antagelse om lige varianser) </h3>
</button>
<div id="collapseSpoiler19" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler19" aria-labelledby="headingSpoiler19">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the means of three or more
independent groups differ when variances are unequal.<br></li>
<li>
<strong>Real-world example:</strong> Comparing average systolic
blood pressure across three clinics known to have different measurement
variability.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Each group’s residuals are approximately normally distributed.<br>
* Does <strong>not</strong> assume equal variances across groups.</p>
<p><strong>Strengths</strong> * Controls Type I error under
heteroskedasticity better than ordinary ANOVA.<br>
* Simple to implement via
<code>oneway.test(..., var.equal = FALSE)</code>.<br>
* More powerful than nonparametric alternatives when normality
holds.</p>
<p><strong>Weaknesses</strong> * Sensitive to departures from normality,
especially with small sample sizes.<br>
* Does not provide post-hoc comparisons by default; requires additional
tests.<br>
* Still assumes independence and approximate normality within each
group.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> All group means are equal (μ₁
= μ₂ = μ₃).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group
mean differs.</li>
</ul><div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate systolic BP (mmHg) for three clinics with unequal variances:</span></span>
<span><span class="va">clinic</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bp_values</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">125</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">118</span>, sd <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">clinic</span>, <span class="va">bp_values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Welch’s one-way ANOVA:</span></span>
<span><span class="va">welch_result</span> <span class="op">&lt;-</span> <span class="fu">oneway.test</span><span class="op">(</span><span class="va">bp_values</span> <span class="op">~</span> <span class="va">clinic</span>, data <span class="op">=</span> <span class="va">df</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">welch_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	One-way analysis of means (not assuming equal variances)

data:  bp_values and clinic
F = 2.7802, num df = 2.000, denom df = 23.528, p-value = 0.08244</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Welch statistic = 2.78 with df ≈ 2, 23.53, and p-value = 0.0824.
We fail to reject the null hypothesis. Thus, there is no evidence of a
difference in mean blood pressure among the clinics.</p>
</div>
</div>
</div>
</div>
<p><a id="repeated_measures_anova"></a></p>
<div id="accordionSpoiler20" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler20" aria-expanded="false" aria-controls="collapseSpoiler20">
  <h3 class="accordion-header" id="headingSpoiler20">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Repeated-measures ANOVA </h3>
</button>
<div id="collapseSpoiler20" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler20" aria-labelledby="headingSpoiler20">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the means of three or more
related (within‐subject) conditions differ.<br></li>
<li>
<strong>Real-world example:</strong> Assessing whether students’
reaction times change across three levels of sleep deprivation (0 h, 12
h, 24 h) measured on the same individuals.</li>
</ul><p><strong>Assumptions</strong> * Observations (subjects) are
independent.<br>
* The dependent variable is approximately normally distributed in each
condition.<br>
* <strong>Sphericity:</strong> variances of the pairwise differences
between conditions are equal.</p>
<p><strong>Strengths</strong> * Controls for between‐subject variability
by using each subject as their own control.<br>
* More powerful than independent‐groups ANOVA when measures are
correlated.<br>
* Can model complex within‐subject designs (e.g. time × treatment
interactions).</p>
<p><strong>Weaknesses</strong> * Sensitive to violations of sphericity
(inflates Type I error).<br>
* Missing data in any condition drops the entire subject (unless using
more advanced mixed‐model methods).<br>
* Interpretation can be complex when there are many levels or
interactions.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The mean reaction time is the
same across 0 h, 12 h, and 24 h sleep deprivation.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
condition’s mean reaction time differs.</li>
</ul><div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n_subj</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_subj</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"0h"</span>,<span class="st">"12h"</span>,<span class="st">"24h"</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">n_subj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Simulate reaction times (ms):</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">300</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>        <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">320</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>        <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">340</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">subject</span>, <span class="va">condition</span>, <span class="va">rt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit repeated-measures ANOVA:</span></span>
<span><span class="va">rm_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">subject</span><span class="op">/</span><span class="va">condition</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">rm_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">rm_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">rm_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Error: subject
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   9892   899.3

Error: subject:condition
          Df Sum Sq Mean Sq F value Pr(&gt;F)
condition  2   1000     500   1.188  0.324
Residuals 22   9262     421               </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The within‐subjects effect of sleep deprivation yields F = 1.19 with
df₁ = 2 and df₂ = <code>r rm_summary[[2]][[1]]["Residuals","Df"]</code>,
p = 0.324. We fail to reject the null hypothesis. Thus, there is no
evidence that reaction times differ across sleep deprivation
conditions.</p>
</div>
</div>
</div>
</div>
<p><a id="manova"></a></p>
<div id="accordionSpoiler21" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler21" aria-expanded="false" aria-controls="collapseSpoiler21">
  <h3 class="accordion-header" id="headingSpoiler21">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> MANOVA </h3>
</button>
<div id="collapseSpoiler21" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler21" aria-labelledby="headingSpoiler21">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing for differences on multiple
continuous dependent variables across one or more grouping factors
simultaneously.<br></li>
<li>
<strong>Real-world example:</strong> Evaluating whether three
different diets lead to different patterns of weight loss and
cholesterol reduction.</li>
</ul><p><strong>Assumptions</strong> * Multivariate normality of the
dependent variables within each group.<br>
* Homogeneity of covariance matrices across groups.<br>
* Observations are independent.<br>
* Linear relationships among dependent variables.</p>
<p><strong>Strengths</strong> * Controls family-wise Type I error by
testing all DVs together.<br>
* Can detect patterns that univariate ANOVAs might miss.<br>
* Provides multiple test statistics (Pillai, Wilks, Hotelling–Lawley,
Roy) for flexibility.</p>
<p><strong>Weaknesses</strong> * Sensitive to violations of multivariate
normality and homogeneity of covariances.<br>
* Requires larger sample sizes as the number of DVs increases.<br>
* Interpretation can be complex; follow-up analyses often needed to
determine which DVs drive effects.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The vector of means for
weight loss and cholesterol change is equal across the three diet
groups.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one diet
group differs on the combination of weight loss and cholesterol
change.</li>
</ul><div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n_per_group</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">diet</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"LowFat"</span>, <span class="st">"LowCarb"</span>, <span class="st">"Mediterranean"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_per_group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate outcomes:</span></span>
<span><span class="va">weight_loss</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">5</span>,  sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">8</span>,  sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">7</span>,  sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cholesterol</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">9</span>,  sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">diet</span>, <span class="va">weight_loss</span>, <span class="va">cholesterol</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit MANOVA:</span></span>
<span><span class="va">manova_fit</span> <span class="op">&lt;-</span> <span class="fu">manova</span><span class="op">(</span><span class="fu">cbind</span><span class="op">(</span><span class="va">weight_loss</span>, <span class="va">cholesterol</span><span class="op">)</span> <span class="op">~</span> <span class="va">diet</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize using Pillai’s trace:</span></span>
<span><span class="va">manova_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">manova_fit</span>, test <span class="op">=</span> <span class="st">"Pillai"</span><span class="op">)</span></span>
<span><span class="va">manova_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          Df  Pillai approx F num Df den Df    Pr(&gt;F)
diet       2 0.58953   8.7773      4     84 5.708e-06 ***
Residuals 42
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>Pillai’s trace = 0.59, F = 8.78 with df = 42, and p-value =
5.71^{-6}. We reject the null hypothesis. This indicates that there
is</p>
<p>a significant multivariate effect of diet on weight loss and
cholesterol change.</p>
<p>Pillai?</p>
<p>Der er fire almindeligt brugte taststatistikker i MANOVA. Pillai,
Wilks’ lambd, Hotelling-Lawleys trace og Roys largest root.</p>
<p>Pillai’s trace (også kaldet Pillai–Bartlett’s trace) er én af fire
almindeligt brugte multivariate test-statistikker i MANOVA (ud over
Wilks’ lambda, Hotelling–Lawley’s trace og Roy’s largest root). Kort om
Pillai:</p>
<p>Definition: Summen af egenværdierne divideret med (1 + egenværdierne)
for hver kanonisk variabel. Det giver en samlet målestok for, hvor stor
en andel af den totale variation der forklares af gruppetilhørsforholdet
på tværs af alle afhængige variable.</p>
<p>Fortolkning: Højere Pillai-værdi (op til 1) indikerer stærkere
multivariat effekt.</p>
<p>Hvorfor vælge Pillai?</p>
<p>Robusthed: Pillai’s trace er den mest robuste over for overtrædelser
af antagelserne om homogen kovarians og multivariat normalitet. Hvis
dine data har ulige gruppe-størrelser eller let skæve fordelinger, er
Pillai ofte det sikreste valg.</p>
<p>Type I-kontrol: Den holder typisk kontrol med falsk positive (Type
I-fejl) bedre end de andre, når antagelser brydes.</p>
<p>Er det altid det bedste valg?</p>
<p>Ikke nødvendigvis. Hvis dine data strengt opfylder antagelserne
(multivariat normalitet, homogen kovarians og rimeligt store, ensartede
grupper), kan de andre statistikker være mere “kraftfulde” (dvs. give
større chance for at opdage en ægte effekt).</p>
<p>Wilks’ lambda er mest brugt i traditionel litteratur og har ofte god
power under idéelle forhold.</p>
<p>Hotelling–Lawley’s trace kan være særligt følsom, når få kanoniske
dimensioner bærer meget af effekten.</p>
<p>Roy’s largest root er ekstremt kraftfuld, hvis kun én kanonisk
variabel adskiller grupperne, men er også mest sårbar
gruppe-størrelser.over for antagelsesovertrædelser.</p>
<p>Kort anbefaling:</p>
<p>Brug Pillai’s trace som standard, især hvis du er usikker på
antagelsesopfyldelsen eller har små/ulige</p>
<p>Overvej Wilks’ lambda eller andre, hvis dine data opfylder alle
antagelser solidt, og du ønsker maksimal statistisk power.</p>
<p>Tjek altid flere tests; hvis de konkluderer ens, styrker det din
konklusion.</p>
<div class="section level4">
<h4 id="wilks-lambda">Wilks’ lambda<a class="anchor" aria-label="anchor" href="#wilks-lambda"></a></h4>
<ul><li>
<strong>Definition:</strong> Ratio of the determinant of the
within‐groups SSCP (sum of squares and cross‐products) matrix to the
determinant of the total SSCP matrix:<br><span class="math display">\[
  \Lambda = \frac{\det(W)}{\det(T)} = \prod_{i=1}^s \frac{1}{1 +
\lambda_i}
\]</span><br>
hvor <span class="math inline">\(\lambda_i\)</span> er de canoniske
egenværdier.<br></li>
<li>
<strong>Fortolkning:</strong> Værdier nær 0 indikerer stor
multivariat effekt (mellem‐grupper‐variation &gt;&gt;
inden‐gruppe‐variation), værdier nær 1 indikerer lille eller ingen
effekt.<br></li>
<li>
<strong>Styrker:</strong>
<ul><li>Klassisk og mest udbredt i litteraturen.<br></li>
<li>God power under ideal antagelsesopfyldelse (multivariat normalitet,
homogene kovarianser).<br></li>
</ul></li>
<li>
<strong>Svagheder:</strong>
<ul><li>Mindre robust ved skæve fordelinger eller ulige
gruppe‐størrelser.<br></li>
<li>Kan undervurdere effektstørrelse, hvis én eller flere kanoniske
variabler bærer effekten ujævnt.<br></li>
</ul></li>
<li>
<strong>Anbefaling:</strong>
<ul><li>Brug Wilks’ lambda, når du er sikker på, at antagelserne er opfyldt,
og du ønsker en velkendt statistisk test med god power under
idealforhold.</li>
</ul></li>
</ul></div>
<div class="section level4">
<h4 id="hotellinglawleys-trace">Hotelling–Lawley’s trace<a class="anchor" aria-label="anchor" href="#hotellinglawleys-trace"></a></h4>
<ul><li>
<strong>Definition:</strong> Summen af de canoniske
egenværdier:<br><span class="math display">\[
  T = \sum_{i=1}^s \lambda_i
\]</span><br></li>
<li>
<strong>Fortolkning:</strong> Højere værdi betyder større samlet
multivariat effekt.<br></li>
<li>
<strong>Styrker:</strong>
<ul><li>Sensitiv over for effekter fordelt over flere kanoniske
dimensioner.<br></li>
<li>Kan være mere kraftfuld end Wilks’ lambda, hvis flere dimensioner
bidrager til forskellen.<br></li>
</ul></li>
<li>
<strong>Svagheder:</strong>
<ul><li>Mindre robust over for antagelsesbrud end Pillai’s trace.<br></li>
<li>Kan overvurdere effektstørrelse, hvis én dimension dominerer
kraftigt.<br></li>
</ul></li>
<li>
<strong>Anbefaling:</strong>
<ul><li>Overvej Hotelling–Lawley’s trace, når du forventer, at effekten
spreder sig over flere kanoniske variabler, og antagelserne er rimeligt
dækket.</li>
</ul></li>
</ul></div>
<div class="section level4">
<h4 id="roys-largest-root">Roy’s largest root<a class="anchor" aria-label="anchor" href="#roys-largest-root"></a></h4>
<ul><li>
<strong>Definition:</strong> Den største canoniske egenværdi
alene:<br><span class="math display">\[
  \Theta = \max_i \lambda_i
\]</span><br></li>
<li>
<strong>Fortolkning:</strong> Måler den stærkeste
enkeltdimensionseffekt.<br></li>
<li>
<strong>Styrker:</strong>
<ul><li>Højest power, når én kanonisk variabel står for størstedelen af
gruppedifferensen.<br></li>
<li>Let at beregne og fortolke, hvis fokus er på “den stærkeste
effekt”.<br></li>
</ul></li>
<li>
<strong>Svagheder:</strong>
<ul><li>Meget følsom over for antagelsesbrud (normalitet, homogene
kovarianser).<br></li>
<li>Ikke informativ, hvis flere dimensioner bidrager jævnt.<br></li>
</ul></li>
<li>
<strong>Anbefaling:</strong>
<ul><li>Brug Roy’s largest root, når du har en stærk a priori mistanke om én
dominerende kanonisk dimension og er komfortabel med
forudsætningerne.</li>
</ul></li>
</ul><p><strong>Tips:</strong> Sammenlign altid flere test‐statistikker –
hvis de peger i samme retning, styrker det din konklusion. Pillai’s
trace er generelt mest robust, Wilks’ lambda mest almindelig,
Hotelling–Lawley god til flere dimensioner, og Roy’s largest root bedst,
når én dimension dominerer.</p>
</div>
</div>
</div>
</div>
</div>
<p><a id="friedman_test"></a></p>
<div id="accordionSpoiler22" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler22" aria-expanded="false" aria-controls="collapseSpoiler22">
  <h3 class="accordion-header" id="headingSpoiler22">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Friedman test (nonparametrisk gentagne målinger) </h3>
</button>
<div id="collapseSpoiler22" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler22" aria-labelledby="headingSpoiler22">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing for differences in central
tendency across three or more related (paired) groups when assumptions
of repeated‐measures ANOVA are violated.<br></li>
<li>
<strong>Real-world example:</strong> Comparing median pain scores at
baseline, 1 hour, and 24 hours after surgery in the same patients.</li>
</ul><p><strong>Assumptions</strong> * Observations are paired and the sets
of scores for each condition are related (e.g., repeated measures on the
same subjects).<br>
* Data are at least ordinal.<br>
* The distribution of differences across pairs need not be normal.</p>
<p><strong>Strengths</strong> * Nonparametric: does not require
normality or sphericity.<br>
* Controls for between‐subject variability by using each subject as
their own block.<br>
* Robust to outliers and skewed data.</p>
<p><strong>Weaknesses</strong> * Less powerful than repeated‐measures
ANOVA when normality and sphericity hold.<br>
* Only indicates that at least one condition differs—post‐hoc tests are
needed to locate differences.<br>
* Assumes similar shaped distributions across conditions.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The distributions of scores
are the same across all conditions (no median differences).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
condition’s distribution (median) differs.</li>
</ul><div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate pain scores (0–10) for 12 patients at 3 time points:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">patient</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">timepoint</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Baseline"</span>,<span class="st">"1hr"</span>,<span class="st">"24hr"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">12</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Baseline</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">12</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,   <span class="co"># 1 hour post-op</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">12</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>    <span class="co"># 24 hours post-op</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">patient</span>, <span class="va">timepoint</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Friedman test:</span></span>
<span><span class="va">friedman_result</span> <span class="op">&lt;-</span> <span class="fu">friedman.test</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">timepoint</span> <span class="op">|</span> <span class="va">patient</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">friedman_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Friedman rank sum test

data:  scores and timepoint and patient
Friedman chi-squared = 1.6364, df = 2, p-value = 0.4412</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Friedman chi-squared = 1.64 with df = 2 and p-value = 0.441. We
fail to reject the null hypothesis. Thus, there is no evidence that pain
scores differ across time points.</p>
</div>
</div>
</div>
</div>
<p><a id="tukey_hsd"></a></p>
<div id="accordionSpoiler23" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler23" aria-expanded="false" aria-controls="collapseSpoiler23">
  <h3 class="accordion-header" id="headingSpoiler23">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Post-hoc: Tukey HSD </h3>
</button>
<div id="collapseSpoiler23" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler23" aria-labelledby="headingSpoiler23">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Performing pairwise comparisons of group
means after a significant one‐way ANOVA to identify which *roups
differ.<br></li>
<li>
<strong>Real-world example:</strong> Determining which teaching
methods (Lecture, Online, Hybrid) differ in average exam scores after
finding an overall effect.</li>
</ul><p><strong>Assumptions</strong> * A significant one‐way ANOVA has been
obtained.<br>
* Observations are independent.<br>
* Residuals from the ANOVA are approximately normally distributed.<br>
* Homogeneity of variances across groups (though Tukey’s HSD is fairly
robust).</p>
<p><strong>Strengths</strong> * Controls the family‐wise error rate
across all pairwise tests.<br>
* Provides confidence intervals for each mean difference.<br>
* Widely available and simple to interpret.</p>
<p><strong>Weaknesses</strong> * Requires balanced or nearly balanced
designs for optimal power.<br>
* Less powerful than some alternatives if variances are highly
unequal.<br>
* Only applies after a significant omnibus ANOVA.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> All pairwise mean differences
between teaching methods are zero (e.g., μ_Lecture – μ_Online = 0,
etc.).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one pairwise
mean difference ≠ 0.</li>
</ul><div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate exam scores for three teaching methods (n = 20 each):</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Lecture"</span>, <span class="st">"Online"</span>, <span class="st">"Hybrid"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">75</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">80</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">78</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>     <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">method</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANOVA:</span></span>
<span><span class="va">anova_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">method</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Tukey HSD post-hoc:</span></span>
<span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu">TukeyHSD</span><span class="op">(</span><span class="va">anova_fit</span>, <span class="st">"method"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">tukey_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = scores ~ method, data = df)

$method
                    diff       lwr      upr     p adj
Lecture-Hybrid -2.542511 -8.509478 3.424457 0.5640694
Online-Hybrid   1.192499 -4.774468 7.159467 0.8805866
Online-Lecture  3.735010 -2.231958 9.701978 0.2956108</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>Each row of the output gives the estimated difference in means, a 95%
confidence interval, and an adjusted p‐value. For example, if the
Lecture–Online comparison shows a mean difference of –5.0 (95% CI: –8.0
to –2.0, p adj = 0.002), we conclude that the Online method yields
significantly higher scores than Lecture. Comparisons with p adj &lt;
0.05 indicate significant mean differences between those teaching
methods.</p>
</div>
</div>
</div>
</div>
<p><a id="dunnett_test"></a></p>
<div id="accordionSpoiler24" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler24" aria-expanded="false" aria-controls="collapseSpoiler24">
  <h3 class="accordion-header" id="headingSpoiler24">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Post-hoc: Dunnett’s test </h3>
</button>
<div id="collapseSpoiler24" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler24" aria-labelledby="headingSpoiler24">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Comparing multiple treatment groups to a
single control while controlling the family‐wise error rate.<br></li>
<li>
<strong>Real-world example:</strong> Testing whether two new
fertilizers (Fertilizer A, Fertilizer B) improve crop yield compared to
the standard fertilizer (Control).</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Residuals from the ANOVA are approximately normally distributed.<br>
* Homogeneity of variances across groups.<br>
* A significant overall ANOVA (omnibus F-test) has been observed or
intended.</p>
<p><strong>Strengths</strong> * Controls the family-wise error rate when
making multiple comparisons to a control.<br>
* More powerful than Tukey HSD when only control comparisons are of
interest.<br>
* Provides simultaneous confidence intervals and adjusted p-values.</p>
<p><strong>Weaknesses</strong> * Only compares each group to the
control; does not test all pairwise contrasts.<br>
* Sensitive to violations of normality and homogeneity of
variances.<br>
* Requires a pre-specified control group.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Each treatment mean equals
the control mean (e.g., μ_A = μ_Control, μ_B = μ_Control).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one treatment
mean differs from the control mean (e.g., μ_A ≠ μ_Control, μ_B ≠
μ_Control).</li>
</ul><div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate crop yields (kg/plot) for Control and two new fertilizers:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"FertilizerA"</span>, <span class="st">"FertilizerB"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yield</span>     <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Control</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">55</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Fertilizer A</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">53</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>    <span class="co"># Fertilizer B</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">yield</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANOVA:</span></span>
<span><span class="va">fit_anova</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Dunnett's test (each treatment vs. Control):</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">multcomp</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: survival</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: TH.data</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: MASS</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'multcomp'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked _by_ '.GlobalEnv':

    cholesterol</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dunnett_result</span> <span class="op">&lt;-</span> <span class="fu">glht</span><span class="op">(</span><span class="va">fit_anova</span>, linfct <span class="op">=</span> <span class="fu">mcp</span><span class="op">(</span>treatment <span class="op">=</span> <span class="st">"Dunnett"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary with adjusted p-values:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">dunnett_result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = yield ~ treatment, data = df)

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)
FertilizerA - Control == 0    4.209      1.550   2.716   0.0165 *
FertilizerB - Control == 0    2.714      1.550   1.751   0.1503
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">confint</span><span class="op">(</span><span class="va">dunnett_result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	 Simultaneous Confidence Intervals

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = yield ~ treatment, data = df)

Quantile = 2.2682
95% family-wise confidence level


Linear Hypotheses:
                           Estimate lwr     upr
FertilizerA - Control == 0  4.2094   0.6942  7.7246
FertilizerB - Control == 0  2.7141  -0.8011  6.2292</code></pre>
</div>
<p><strong>Interpretation:</strong> The Dunnett contrasts compare each
fertilizer to Control. For example, if the contrast FertilizerA–Control
shows an estimate of r round(coef(dunnett_result)[1], 2) kg with a 95%
simultaneous CI [4.21, 0.69] and adjusted p-value = 0.0165, we reject
the null for Fertilizer A vs. Control—i.e., Fertilizer A yields
significantly different crop output. Similarly, for FertilizerB
vs. Control (contrast index 2), the estimate is 2.71 kg (CI [2.71,
-0.8], p-value = 0.15, so we fail to reject the null for Fertilizer B
vs. Control.</p>
</div>
</div>
</div>
</div>
<p><a id="bonferroni_correction"></a></p>
<div id="accordionSpoiler25" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler25" aria-expanded="false" aria-controls="collapseSpoiler25">
  <h3 class="accordion-header" id="headingSpoiler25">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Post-hoc: Bonferroni korrektion </h3>
</button>
<div id="collapseSpoiler25" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler25" aria-labelledby="headingSpoiler25">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Adjusting p-values when performing
multiple hypothesis tests to control the family-wise error rate.<br></li>
<li>
<strong>Real-world example:</strong> Comparing mean blood pressure
between four different diets with all six pairwise t-tests, using
Bonferroni to adjust for multiple comparisons.</li>
</ul><p><strong>Assumptions</strong> * The individual tests (e.g., pairwise
t-tests) satisfy their own assumptions (independence, normality, equal
variances if applicable).<br>
* Tests are independent or positively dependent (Bonferroni remains
valid under any dependency but can be conservative).</p>
<p><strong>Strengths</strong> * Simple to calculate: multiply each
p-value by the number of comparisons.<br>
* Guarantees control of the family-wise error rate at the chosen α
level.<br>
* Applicable to any set of p-values regardless of test type.</p>
<p><strong>Weaknesses</strong> * Very conservative when many comparisons
are made, reducing power.<br>
* Can inflate Type II error (miss true effects), especially with large
numbers of tests.<br>
* Does not take into account the magnitude of dependency among
tests.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypotheses (H₀):</strong> For each pair of diets, the
mean blood pressure is equal (e.g., μ_A = μ_B, μ_A = μ_C, …).<br></li>
<li>
<strong>Alternative hypotheses (H₁):</strong> For at least one pair,
the means differ.</li>
</ul><div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate blood pressure for four diet groups (n = 15 each):</span></span>
<span><span class="va">diet</span>  <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bp</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">125</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">130</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">135</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform all pairwise t-tests with Bonferroni adjustment:</span></span>
<span><span class="va">pairwise_result</span> <span class="op">&lt;-</span> <span class="fu">pairwise.t.test</span><span class="op">(</span><span class="va">bp</span>, <span class="va">diet</span>, p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">pairwise_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pairwise comparisons using t tests with pooled SD

data:  bp and diet

  A       B      C
B 0.4313  -      -
C 0.0432  1.0000 -
D 1.7e-05 0.0083 0.1154

P value adjustment method: bonferroni </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The output shows adjusted p-values for each pair of diets. For
example, if the A vs D comparison has p adj = 0.004 (&lt; 0.05), we
reject H₀ for that pair and conclude a significant mean difference.
Comparisons with p adj ≥ 0.05 fail to reject H₀, indicating no evidence
of difference after correction.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="ikke-parametriske-k-prøve-tests">Ikke-parametriske k-prøve-tests<a class="anchor" aria-label="anchor" href="#ikke-parametriske-k-pr%C3%B8ve-tests"></a></h2>
<hr class="half-width"><p><a id="kruskal_wallis_test"></a></p>
<div id="accordionSpoiler26" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler26" aria-expanded="false" aria-controls="collapseSpoiler26">
  <h3 class="accordion-header" id="headingSpoiler26">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kruskal–Wallis test </h3>
</button>
<div id="collapseSpoiler26" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler26" aria-labelledby="headingSpoiler26">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Comparing the central tendency of three or
more independent groups when the outcome is ordinal or not normally
distributed.<br></li>
<li>
<strong>Real-world example:</strong> Testing whether median pain
scores differ across four treatment groups in a clinical trial when
scores are skewed.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent both
within and between groups.<br>
* The response variable is at least ordinal.<br>
* The distributions of the groups have the same shape (so differences
reflect shifts in location).</p>
<p><strong>Strengths</strong> * Nonparametric: does not require
normality or equal variances.<br>
* Handles ordinal data and skewed continuous data.<br>
* Controls Type I error when comparing multiple groups without assuming
normality.</p>
<p><strong>Weaknesses</strong> * Less powerful than one-way ANOVA when
normality holds.<br>
* If group distributions differ in shape, interpretation of a location
shift is ambiguous.<br>
* Only indicates that at least one group differs—post-hoc tests needed
to identify which.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The distributions (medians)
of the four treatment groups are equal.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group’s
median pain score differs.</li>
</ul><div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate pain scores (0–10) for four treatment groups (n = 15 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Placebo"</span>,<span class="st">"DrugA"</span>,<span class="st">"DrugB"</span>,<span class="st">"DrugC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Placebo</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,   <span class="co"># Drug A</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,   <span class="co"># Drug B</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>    <span class="co"># Drug C</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">group</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Kruskal–Wallis rank‐sum test:</span></span>
<span><span class="va">kw_result</span> <span class="op">&lt;-</span> <span class="fu">kruskal.test</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">kw_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Kruskal-Wallis rank sum test

data:  scores by group
Kruskal-Wallis chi-squared = 21.621, df = 3, p-value = 7.82e-05</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Kruskal–Wallis chi-squared = 21.62 with df = 3 and p-value =
7.82^{-5}. We reject the null hypothesis. Thus, there is evidence that
at least one treatment group’s median pain score differs.</p>
</div>
</div>
</div>
</div>
<p><a id="rank_correlation"></a></p>
<div id="accordionSpoiler27" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler27" aria-expanded="false" aria-controls="collapseSpoiler27">
  <h3 class="accordion-header" id="headingSpoiler27">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Rank correlation </h3>
</button>
<div id="collapseSpoiler27" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler27" aria-labelledby="headingSpoiler27">
<div class="accordion-body">
<p>EJ KORREKTURLÆST HAV SÆRLIGT FOKUS PÅ OM DER ER FORSKEL PÅ DENNE OG
SPEARMAN-RANK CORRELATION SENERE</p>
<ul><li>
<strong>Used for</strong> Assessing the strength and direction of a
monotonic association between two variables using their ranks.<br></li>
<li>
<strong>Real-world example:</strong> Evaluating whether patients’
pain rankings correlate with their anxiety rankings.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Variables are at least ordinal.<br>
* The relationship is monotonic (but not necessarily linear).</p>
<p><strong>Strengths</strong> * Nonparametric: does not require
normality.<br>
* Robust to outliers in the original measurements.<br>
* Captures any monotonic relationship, not limited to linear.</p>
<p><strong>Weaknesses</strong> * Less powerful than Pearson’s
correlation when data are bivariate normal and relationship is
linear.<br>
* Does not distinguish between different monotonic shapes (e.g., concave
vs. convex).<br>
* Ties reduce the effective sample size and complicate exact p-value
calculation.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> There is no monotonic
association between X and Y (ρ = 0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> There is a nonzero
monotonic association (ρ ≠ 0).</li>
</ul><div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate two variables with a monotonic relationship:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>               <span class="co"># roughly increasing with x</span></span>
<span><span class="co"># Perform Spearman rank correlation test:</span></span>
<span><span class="va">spearman_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">spearman_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Spearman's rank correlation rho

data:  x and y
S = 300, p-value = 5.648e-14
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho
0.9332592 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>Spearman’s ρ = 0.933 with p-value = 5.65^{-14}. We reject the null
hypothesis. Thus, there is evidence of a monotonic association between X
and Y.</p>
</div>
</div>
</div>
</div>
<p><a id="anderson_darling_test"></a></p>
<div id="accordionSpoiler28" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler28" aria-expanded="false" aria-controls="collapseSpoiler28">
  <h3 class="accordion-header" id="headingSpoiler28">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Anderson–Darling test </h3>
</button>
<div id="collapseSpoiler28" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler28" aria-labelledby="headingSpoiler28">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether a sample comes from a
specified continuous distribution (most commonly normal).<br></li>
<li>
<strong>Real-world example:</strong> Checking if daily measurement
errors from a laboratory instrument follow a normal distribution.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Data are continuous (no excessive ties).<br>
* For goodness‐of‐fit to a non‐normal distribution (e.g. exponential),
the distribution’s parameters must be fully specified a priori.</p>
<p><strong>Strengths</strong> * More sensitive than the Shapiro–Wilk
test to departures in the tails of the distribution.<br>
* Applicable to a wide range of target distributions (with the
appropriate implementation).<br>
* Provides both a test statistic (A²) and p-value.</p>
<p><strong>Weaknesses</strong> * Very sensitive in large samples—small
deviations can yield significant results.<br>
* If parameters are estimated from the data (e.g. normal mean/SD),
p-values may be conservative.<br>
* Does not indicate the form of the departure (e.g. skew
vs. kurtosis).</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The sample is drawn from a
Normal distribution.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The sample is not
drawn from a Normal distribution.</li>
</ul><div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load nortest if necessary:</span></span>
<span><span class="co"># install.packages("nortest")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a sample of 40 observations:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Anderson–Darling test for normality:</span></span>
<span><span class="va">ad_result</span> <span class="op">&lt;-</span> <span class="fu">ad.test</span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">ad_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Anderson-Darling normality test

data:  sample_data
A = 0.13614, p-value = 0.9754</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Anderson–Darling statistic A² = 0.136 with p-value = 0.975. We
fail to reject the null hypothesis. Thus, there is no evidence to
conclude a departure from normality.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="regression-og-korrelation">Regression og korrelation<a class="anchor" aria-label="anchor" href="#regression-og-korrelation"></a></h2>
<hr class="half-width"><p><a id="simple_linear_regression"></a></p>
<div id="accordionSpoiler29" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler29" aria-expanded="false" aria-controls="collapseSpoiler29">
  <h3 class="accordion-header" id="headingSpoiler29">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Simple linear regression </h3>
</button>
<div id="collapseSpoiler29" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler29" aria-labelledby="headingSpoiler29">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li><strong>Used for</strong></li>
<li>Modeling and quantifying the linear relationship between a
continuous predictor and a continuous outcome.<br></li>
<li>
<strong>Real-world example:</strong> Predicting house sale price
based on living area in square feet.</li>
</ul><p><strong>Assumptions</strong> * A linear relationship between
predictor and outcome.<br>
* Residuals are independent and normally distributed with mean
zero.<br>
* Homoscedasticity: constant variance of residuals across values of the
predictor.<br>
* No influential outliers or high-leverage points.</p>
<p><strong>Strengths</strong> * Provides an interpretable estimate of
the change in outcome per unit change in predictor.<br>
* Inference on slope and intercept via hypothesis tests and confidence
intervals.<br>
* Basis for more complex regression models and diagnostics.</p>
<p><strong>Weaknesses</strong> * Only captures linear patterns; will
miss nonlinear relationships.<br>
* Sensitive to outliers, which can distort estimates and
inference.<br>
* Extrapolation beyond observed predictor range is unreliable.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The slope β₁ = 0 (no linear
association between x and y).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> β₁ ≠ 0 (a linear
association exists).</li>
</ul><div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit simple linear regression:</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show summary of model:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max
-4.6258 -1.4244 -0.0462  1.6635  3.6410

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.5009     0.6267   2.395   0.0206 *
x             1.5554     0.1023  15.210   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.057 on 48 degrees of freedom
Multiple R-squared:  0.8282,	Adjusted R-squared:  0.8246
F-statistic: 231.3 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot data with regression line:</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simple Linear Regression of y on x"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Predictor (x)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Outcome (y)"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/stat-tests-1-rendered-simple_linear_regression-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Interpretation:</strong> The estimated slope is 1.555, with a
p-value of 5.51^{-20}. We reject the null hypothesis, indicating that
there is evidence of a significant linear association between x and
y.</p>
</div>
</div>
</div>
</div>
<p><a id="multiple_regression"></a></p>
<div id="accordionSpoiler30" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler30" aria-expanded="false" aria-controls="collapseSpoiler30">
  <h3 class="accordion-header" id="headingSpoiler30">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Multiple regression </h3>
</button>
<div id="collapseSpoiler30" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler30" aria-labelledby="headingSpoiler30">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling the relationship between one
continuous outcome and two or more predictors (continuous or
categorical).<br></li>
<li>
<strong>Real-world example:</strong> Predicting house sale price
based on living area, number of bedrooms, and neighborhood quality.</li>
</ul><p><strong>Assumptions</strong> * Correct specification: linear
relationship between each predictor and the outcome (additivity).<br>
* Residuals are independent and normally distributed with mean
zero.<br>
* Homoscedasticity: constant variance of residuals for all predictor
values.<br>
* No perfect multicollinearity among predictors.<br>
* No influential outliers unduly affecting the model.</p>
<p><strong>Strengths</strong> * Can adjust for multiple confounders or
risk factors simultaneously.<br>
* Provides estimates and inference (CI, p-values) for each predictor’s
unique association with the outcome.<br>
* Basis for variable selection, prediction, and causal modeling in
observational data.</p>
<p><strong>Weaknesses</strong> * Sensitive to multicollinearity, which
inflates variances of coefficient estimates.<br>
* Assumes a linear, additive form; interactions or nonlinearity require
extension.<br>
* Outliers and high-leverage points can distort estimates and
inference.<br>
* Interpretation can be complex when including many predictors or
interactions.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> All regression coefficients
for predictors (β₁, β₂, β₃) are zero (no association).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one βᵢ ≠
0.</li>
</ul><div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># Simulate predictors:</span></span>
<span><span class="va">living_area</span>     <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">800</span>, <span class="fl">3500</span><span class="op">)</span>        <span class="co"># in square feet</span></span>
<span><span class="va">bedrooms</span>        <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">neighborhood</span>    <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Medium"</span>,<span class="st">"High"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Simulate price with true model:</span></span>
<span><span class="va">price</span> <span class="op">&lt;-</span> <span class="fl">50000</span> <span class="op">+</span></span>
<span>         <span class="fl">30</span> <span class="op">*</span> <span class="va">living_area</span> <span class="op">+</span> </span>
<span>         <span class="fl">10000</span> <span class="op">*</span> <span class="va">bedrooms</span> <span class="op">+</span> </span>
<span>         <span class="fu">ifelse</span><span class="op">(</span><span class="va">neighborhood</span><span class="op">==</span><span class="st">"Medium"</span>, <span class="fl">20000</span>, </span>
<span>                <span class="fu">ifelse</span><span class="op">(</span><span class="va">neighborhood</span><span class="op">==</span><span class="st">"High"</span>, <span class="fl">50000</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">30000</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">price</span>, <span class="va">living_area</span>, <span class="va">bedrooms</span>, <span class="va">neighborhood</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple linear regression:</span></span>
<span><span class="va">model_mlr</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">price</span> <span class="op">~</span> <span class="va">living_area</span> <span class="op">+</span> <span class="va">bedrooms</span> <span class="op">+</span> <span class="va">neighborhood</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show model summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model_mlr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = price ~ living_area + bedrooms + neighborhood, data = df)

Residuals:
   Min     1Q Median     3Q    Max
-76016 -17437   1258  20097  72437

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)        119719.729  12445.109   9.620 1.07e-15 ***
living_area            26.498      3.685   7.190 1.47e-10 ***
bedrooms             8292.136   2147.637   3.861 0.000206 ***
neighborhoodLow    -59241.209   7084.797  -8.362 5.18e-13 ***
neighborhoodMedium -34072.271   6927.394  -4.918 3.65e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 28490 on 95 degrees of freedom
Multiple R-squared:  0.5891,	Adjusted R-squared:  0.5718
F-statistic: 34.05 on 4 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The overall F-test (in 34.05 on df₁ = 4, df₂ = 95 has p-value =
1.3^{-17}, so reject the null hypothesis.</p>
<p>Individual coefficients: for example, living_area’s estimate is 26.5
(p = 1.47^{-10}), indicating a significant positive association: each
additional square foot increases price by about $30 on average.</p>
<p>Similar interpretation applies to bedrooms and neighborhood
indicators.</p>
</div>
</div>
</div>
</div>
<p><a id="pearson_correlation"></a></p>
<div id="accordionSpoiler31" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler31" aria-expanded="false" aria-controls="collapseSpoiler31">
  <h3 class="accordion-header" id="headingSpoiler31">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Pearson correlation </h3>
</button>
<div id="collapseSpoiler31" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler31" aria-labelledby="headingSpoiler31">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Assessing the strength and direction of a
linear relationship between two continuous variables.<br></li>
<li>
<strong>Real-world example:</strong> Examining whether students’
hours of study correlate with their exam scores.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent
pairs.<br>
* Both variables are approximately normally distributed (bivariate
normality).<br>
* Relationship is linear.<br>
* No extreme outliers.</p>
<p><strong>Strengths</strong> * Provides both a correlation coefficient
(r) and hypothesis test (t‐statistic, p‐value).<br>
* Confidence interval for the true correlation can be obtained.<br>
* Well understood and widely used.</p>
<p><strong>Weaknesses</strong> * Sensitive to outliers, which can
distort r.<br>
* Only measures linear association—will miss non‐linear
relationships.<br>
* Reliant on normality; departures can affect Type I/II error rates.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The true Pearson correlation
ρ = 0 (no linear association).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> ρ ≠ 0 (a linear
association exists).</li>
</ul><div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">hours_studied</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># Make exam_scores roughly increase with hours_studied + noise:</span></span>
<span><span class="va">exam_scores</span>   <span class="op">&lt;-</span> <span class="fl">50</span> <span class="op">+</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="va">hours_studied</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Pearson correlation test:</span></span>
<span><span class="va">pearson_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">hours_studied</span>, <span class="va">exam_scores</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">pearson_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's product-moment correlation

data:  hours_studied and exam_scores
t = 14.086, df = 28, p-value = 3.108e-14
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8689058 0.9694448
sample estimates:
      cor
0.9361291 </code></pre>
</div>
<p><strong>Interpretation:</strong> The sample Pearson correlation is
0.936, with t = 14.09 on df = 28 and p-value = 3.11^{-14}. We reject the
null hypothesis, indicating that there is evidence of a significant
linear association between hours studied and exam scores.</p>
</div>
</div>
</div>
</div>
<p><a id="spearman_rank_correlation"></a></p>
<div id="accordionSpoiler32" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler32" aria-expanded="false" aria-controls="collapseSpoiler32">
  <h3 class="accordion-header" id="headingSpoiler32">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Spearman’s rank correlation </h3>
</button>
<div id="collapseSpoiler32" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler32" aria-labelledby="headingSpoiler32">
<div class="accordion-body">
<p>EJ KORREKTURLÆST <strong>Used for</strong> Assessing the strength and
direction of a monotonic association between two variables using their
ranks.<br>
* <strong>Real-world example:</strong> Evaluating whether patients’ pain
rankings correlate with their anxiety rankings.</p>
<p><strong>Assumptions</strong> * Observations are independent
pairs.<br>
* Variables are at least ordinal.<br>
* The relationship is monotonic (consistently increasing or
decreasing).</p>
<p><strong>Strengths</strong> * Nonparametric: does not require
normality of the underlying data.<br>
* Robust to outliers in the original measurements.<br>
* Captures any monotonic relationship, not limited to linear.</p>
<p><strong>Weaknesses</strong> * Less powerful than Pearson’s
correlation when the true relationship is linear and data are bivariate
normal.<br>
* Does not distinguish between different monotonic shapes (e.g. concave
vs. convex).<br>
* Tied ranks reduce effective sample size and can complicate exact
p-value calculation.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The true Spearman rank
correlation ρ = 0 (no monotonic association).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> ρ ≠ 0 (a monotonic
association exists).</li>
</ul><div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate two variables with a monotonic relationship:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">30</span><span class="op">)</span>                   <span class="co"># e.g., anxiety scores ranked</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>              <span class="co"># roughly increasing with x, plus noise</span></span>
<span></span>
<span><span class="co"># Perform Spearman rank correlation test:</span></span>
<span><span class="va">spearman_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">spearman_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Spearman's rank correlation rho

data:  x and y
S = 486, p-value = 3.73e-11
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho
0.8918799 </code></pre>
</div>
<p>Interpretation: Spearman’s rho = 0.892 with p-value = 3.73^{-11}. We
reject the null hypothesis. This indicates that there is evidence of a
significant monotonic association between the two variables.</p>
</div>
</div>
</div>
</div>
<p><a id="kendall_tau"></a></p>
<div id="accordionSpoiler33" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler33" aria-expanded="false" aria-controls="collapseSpoiler33">
  <h3 class="accordion-header" id="headingSpoiler33">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kendall’s tau </h3>
</button>
<div id="collapseSpoiler33" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler33" aria-labelledby="headingSpoiler33">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Assessing the strength and direction of a
monotonic association between two variables based on concordant and
discordant pairs.<br></li>
<li>
<strong>Real-world example:</strong> Evaluating whether the ranking
of students by homework completion correlates with their ranking by
final exam performance.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent
pairs.<br>
* Variables are measured on at least an ordinal scale.<br>
* The relationship is monotonic (but not necessarily linear).</p>
<p><strong>Strengths</strong> * Nonparametric: does not require any
distributional assumptions.<br>
* Robust to outliers and tied values (with appropriate
corrections).<br>
* Directly interprets probability of concordance vs. discordance.</p>
<p><strong>Weaknesses</strong> * Less powerful than Spearman’s rho when
the relationship is strictly monotonic and no ties.<br>
* Tied ranks reduce effective sample size and require tie
corrections.<br>
* Only measures monotonic association, not form or magnitude of
change.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Kendall’s τ = 0 (no
association between the two rankings).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> τ ≠ 0 (a monotonic
association exists).</li>
</ul><div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate two sets of rankings for 25 students:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">homework_rank</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>                  <span class="co"># ranking by homework completion</span></span>
<span><span class="va">exam_rank</span>     <span class="op">&lt;-</span> <span class="va">homework_rank</span> <span class="op">+</span> <span class="fu">rpois</span><span class="op">(</span><span class="fl">25</span>, lambda<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>  <span class="co"># roughly related with some noise</span></span>
<span></span>
<span><span class="co"># Perform Kendall’s tau test:</span></span>
<span><span class="va">kendall_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">homework_rank</span>, <span class="va">exam_rank</span>,</span>
<span>                          method  <span class="op">=</span> <span class="st">"kendall"</span>,</span>
<span>                          exact   <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">kendall_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Kendall's rank correlation tau

data:  homework_rank and exam_rank
z = 6.3518, p-value = 2.129e-10
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau
0.9203643 </code></pre>
</div>
<p><strong>Interpretation:</strong> Kendall’s τ = 0.92 with a two-sided
p-value = 2.13^{-10}. We reject the null hypothesis. Thus, there is
evidence of a significant monotonic association between homework and
exam rankings.</p>
</div>
</div>
</div>
</div>
<p><a id="multiple_logistic_regression"></a></p>
<div id="accordionSpoiler34" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler34" aria-expanded="false" aria-controls="collapseSpoiler34">
  <h3 class="accordion-header" id="headingSpoiler34">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Multiple logistic regression </h3>
</button>
<div id="collapseSpoiler34" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler34" aria-labelledby="headingSpoiler34">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling the probability of a binary
outcome as a function of two or more predictors.<br></li>
<li>
<strong>Real-world example:</strong> Predicting whether a patient
has heart disease (yes/no) based on age, cholesterol level, and smoking
status.</li>
</ul><p><strong>Assumptions</strong> * Outcome is binary (0/1) and
observations are independent.<br>
* Log-odds of the outcome are a linear function of the predictors
(linearity in the logit).<br>
* No perfect multicollinearity among predictors.<br>
* Large enough sample so that maximum likelihood estimates are stable
(rule of thumb: ≥10 events per predictor).</p>
<p><strong>Strengths</strong> * Adjusts for multiple confounders
simultaneously.<br>
* Coefficients have clear interpretation as log‐odds (or odds
ratios).<br>
* Flexible: handles continuous, categorical, and interaction terms.</p>
<p><strong>Weaknesses</strong> * Sensitive to complete or quasi‐complete
separation (can prevent convergence).<br>
* Assumes linearity in the logit—requires transformation or splines if
violated.<br>
* Interpretation of interactions and higher‐order terms can be
complex.<br>
* Requires adequate sample size, especially when events are rare.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> All predictor coefficients β₁
= β₂ = β₃ = 0 (none of the variables affect disease odds).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one βᵢ ≠ 0
(at least one predictor affects odds).</li>
</ul><div class="codewrapper sourceCode" id="cb85">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="co"># Simulate predictors:</span></span>
<span><span class="va">age</span>          <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cholesterol</span>  <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">200</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">smoker</span>       <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate binary outcome via logistic model:</span></span>
<span><span class="va">logit_p</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="va">cholesterol</span> <span class="op">+</span> <span class="fl">1.2</span> <span class="op">*</span> <span class="op">(</span><span class="va">smoker</span><span class="op">==</span><span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="va">p</span>        <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">exp</span><span class="op">(</span><span class="op">-</span><span class="va">logit_p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">disease</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>disease <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">disease</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"No"</span>,<span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="va">age</span>, <span class="va">cholesterol</span>, <span class="va">smoker</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple logistic regression:</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">disease</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">cholesterol</span> <span class="op">+</span> <span class="va">smoker</span>,</span>
<span>             data <span class="op">=</span> <span class="va">df</span>,</span>
<span>             family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show summary and odds ratios:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = disease ~ age + cholesterol + smoker, family = binomial,
    data = df)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -7.016100   1.712922  -4.096 4.20e-05 ***
age          0.075418   0.017734   4.253 2.11e-05 ***
cholesterol  0.008465   0.005440   1.556  0.11971
smokerYes    0.998927   0.360721   2.769  0.00562 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 265.63  on 199  degrees of freedom
Residual deviance: 237.72  on 196  degrees of freedom
AIC: 245.72

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fu">coef</span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(Intercept)         age cholesterol   smokerYes
0.000897318 1.078334765 1.008500725 2.715367476 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fu">confint</span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                   2.5 %     97.5 %
(Intercept) 2.650867e-05 0.02260073
age         1.042852e+00 1.11825331
cholesterol 9.979236e-01 1.01955252
smokerYes   1.347682e+00 5.57661867</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The Wald test for each coefficient (from summary(model)) gives a
z-statistic and p-value. For example, if the coefficient for age is β̂ =
0.04 (p = 0.01), its odds ratio is exp(0.04) ≈ 1.04 (95% CI from
exp(confint(model))), meaning each additional year of age multiplies the
odds of disease by about 1.04.</p>
<p>A significant p-value (e.g., p &lt; 0.05) for cholesterol indicates
that higher cholesterol is associated with increased odds (OR =
exp(β̂_cholesterol)).</p>
<p>A significant positive coefficient for smoker (β̂ ≈ 1.2, OR ≈ 3.3)
implies smokers have about 3.3 times the odds of disease compared to
non-smokers, adjusting for age and cholesterol.</p>
<p>You would reject the null hypothesis overall, concluding that at
least one predictor is significantly associated with the outcome.</p>
</div>
</div>
</div>
</div>
<p><a id="poisson_regression"></a></p>
<div id="accordionSpoiler35" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler35" aria-expanded="false" aria-controls="collapseSpoiler35">
  <h3 class="accordion-header" id="headingSpoiler35">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Poisson regression </h3>
</button>
<div id="collapseSpoiler35" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler35" aria-labelledby="headingSpoiler35">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling count data (events per unit time
or space) as a function of one or more predictors.<br></li>
<li>
<strong>Real-world example:</strong> Predicting the number of daily
emergency room visits based on average daily temperature.</li>
</ul><p><strong>Assumptions</strong> * Counts follow a Poisson distribution
(mean = variance).<br>
* Events occur independently.<br>
* The log of the expected count is a linear function of the
predictors.<br>
* No excessive zero‐inflation (if present, consider zero‐inflated
models).</p>
<p><strong>Strengths</strong> * Naturally handles non‐negative integer
outcomes.<br>
* Estimates incidence rate ratios (IRRs) that are easy to
interpret.<br>
* Can include both categorical and continuous predictors.</p>
<p><strong>Weaknesses</strong> * Sensitive to overdispersion (variance
&gt; mean); may need quasi‐Poisson or negative binomial.<br>
* Assumes log‐linear relationship—misspecification leads to bias.<br>
* Influential observations (e.g., days with extreme counts) can distort
estimates.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Temperature has no effect on
the expected number of ER visits (β₁ = 0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Temperature affects
the expected number of ER visits (β₁ ≠ 0).</li>
</ul><div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate 100 days of data:</span></span>
<span><span class="va">n_days</span>      <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">temp</span>        <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n_days</span>, min <span class="op">=</span> <span class="fl">0</span>,  max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>              <span class="co"># average daily temperature (°C)</span></span>
<span><span class="co"># True model: log(rate) = 1 + 0.05 * temp</span></span>
<span><span class="va">log_rate</span>    <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">temp</span></span>
<span><span class="va">expected</span>    <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">log_rate</span><span class="op">)</span></span>
<span><span class="va">er_visits</span>   <span class="op">&lt;-</span> <span class="fu">rpois</span><span class="op">(</span><span class="va">n_days</span>, lambda <span class="op">=</span> <span class="va">expected</span><span class="op">)</span>              <span class="co"># simulated counts</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">er_visits</span>, <span class="va">temp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Poisson regression:</span></span>
<span><span class="va">pois_fit</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">er_visits</span> <span class="op">~</span> <span class="va">temp</span>, family <span class="op">=</span> <span class="fu">poisson</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">pois_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = er_visits ~ temp, family = poisson(link = "log"),
    data = df)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) 0.982531   0.101027   9.725   &lt;2e-16 ***
temp        0.052793   0.004823  10.945   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 233.15  on 99  degrees of freedom
Residual deviance: 104.41  on 98  degrees of freedom
AIC: 463.81

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<p><strong>Interpretation:</strong> The estimated coefficient for
temperature is 0.053, giving an incidence rate ratio IRR = 1.054. With a
p-value = 7.01^{-28}, we reject the null hypothesis. This means each 1
°C increase in average daily temperature is associated with a
multiplicative change of approximately 1.054 in the expected number of
ER visits.</p>
</div>
</div>
</div>
</div>
<p><a id="negative_binomial_regression"></a></p>
<div id="accordionSpoiler36" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler36" aria-expanded="false" aria-controls="collapseSpoiler36">
  <h3 class="accordion-header" id="headingSpoiler36">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Negative binomial regression </h3>
</button>
<div id="collapseSpoiler36" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler36" aria-labelledby="headingSpoiler36">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling overdispersed count data
(variance &gt; mean) as a function of one or more predictors.<br></li>
<li>
<strong>Real-world example:</strong> Predicting the number of daily
asthma attacks per patient based on air pollution level when counts show
extra-Poisson variation.</li>
</ul><p><strong>Assumptions</strong> * Counts follow a negative binomial
distribution (allows variance &gt; mean).<br>
* Events occur independently.<br>
* The log of the expected count is a linear function of the
predictors.<br>
* Overdispersion parameter is constant across observations.</p>
<p><strong>Strengths</strong> * Handles overdispersion naturally without
biasing standard errors.<br>
* Estimates incidence rate ratios (IRRs) with correct inference.<br>
* Can include both continuous and categorical predictors.</p>
<p><strong>Weaknesses</strong> * Requires estimation of an extra
dispersion parameter, which may be unstable in small samples.<br>
* Sensitive to model misspecification (link function, omitted
covariates).<br>
* Influential observations can still distort estimates if extreme.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Air pollution level has no
effect on the expected number of asthma attacks (β₁ = 0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Air pollution level
affects the expected number of asthma attacks (β₁ ≠ 0).</li>
</ul><div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("MASS")  # if necessary</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">MASS</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span><span class="co"># Simulate predictor: average daily PM2.5 level (µg/m³)</span></span>
<span><span class="va">pm25</span>       <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n_patients</span>, min <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co"># True model: log(µ) = 0.5 + 0.04 * pm25, dispersion theta = 2</span></span>
<span><span class="va">log_mu</span>     <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">pm25</span></span>
<span><span class="va">mu</span>         <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">log_mu</span><span class="op">)</span></span>
<span><span class="va">attacks</span>    <span class="op">&lt;-</span> <span class="fu">rnbinom</span><span class="op">(</span><span class="va">n_patients</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_nb</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">attacks</span>, <span class="va">pm25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit negative binomial regression:</span></span>
<span><span class="va">nb_fit</span> <span class="op">&lt;-</span> <span class="fu">glm.nb</span><span class="op">(</span><span class="va">attacks</span> <span class="op">~</span> <span class="va">pm25</span>, data <span class="op">=</span> <span class="va">df_nb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">nb_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm.nb(formula = attacks ~ pm25, data = df_nb, init.theta = 2.392967844,
    link = log)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) 0.418832   0.170421   2.458    0.014 *
pm25        0.045102   0.005085   8.869   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(2.393) family taken to be 1)

    Null deviance: 250.51  on 149  degrees of freedom
Residual deviance: 167.61  on 148  degrees of freedom
AIC: 823.46

Number of Fisher Scoring iterations: 1

              Theta:  2.393
          Std. Err.:  0.410

 2 x log-likelihood:  -817.455 </code></pre>
</div>
<p><strong>Interpretation:</strong> The estimated coefficient for PM2.5
is 0.045, giving an incidence rate ratio IRR = 1.046. With p-value =
7.38^{-19}, we reject the null hypothesis. This means each 1 µg/m³
increase in PM2.5 is associated with a multiplicative change of
approximately 1.046 in the expected number of asthma attacks, accounting
for overdispersion.</p>
</div>
</div>
</div>
</div>
<p><a id="ordinal_logistic_regression"></a></p>
<div id="accordionSpoiler37" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler37" aria-expanded="false" aria-controls="collapseSpoiler37">
  <h3 class="accordion-header" id="headingSpoiler37">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Ordinal logistic regression </h3>
</button>
<div id="collapseSpoiler37" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler37" aria-labelledby="headingSpoiler37">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p><strong>Used for</strong> * Modeling an ordinal outcome (with more
than two ordered categories) as a function of one or more
predictors.<br>
* <strong>Real-world example:</strong> Predicting customer satisfaction
levels (Low, Medium, High) based on service wait time and price.</p>
<p><strong>Assumptions</strong> * The dependent variable is ordinal with
a meaningful order.<br>
* <strong>Proportional odds (parallel lines):</strong> the effect of
each predictor is the same across all thresholds between outcome
categories.<br>
* Observations are independent.<br>
* No multicollinearity among predictors.</p>
<p><strong>Strengths</strong> * Makes efficient use of the ordering
information in the outcome.<br>
* Provides interpretable odds‐ratios for cumulative probabilities.<br>
* More powerful than nominal models (e.g., multinomial logit) when the
order matters.</p>
<p><strong>Weaknesses</strong> * Relies on the proportional‐odds
assumption; violation can bias estimates.<br>
* Interpretation can be less intuitive than linear regression.<br>
* Cannot easily accommodate non‐proportional effects without
extension.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Waiting time has no effect on
the odds of higher satisfaction (<span class="math inline">\(\beta_{\text{wait}} = 0\)</span>).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Waiting time affects
the odds of higher satisfaction (<span class="math inline">\(\beta_{\text{wait}} \neq 0\)</span>).</li>
</ul><div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data and package</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">MASS</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">120</span></span>
<span><span class="co"># Simulate predictors:</span></span>
<span><span class="va">wait_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>,  <span class="fl">5</span>, <span class="fl">60</span><span class="op">)</span>      <span class="co"># waiting time in minutes</span></span>
<span><span class="va">price</span>     <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>     <span class="co"># price in dollars</span></span>
<span></span>
<span><span class="co"># Simulate an ordinal outcome via latent variable:</span></span>
<span><span class="va">latent</span>   <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">0.03</span> <span class="op">*</span> <span class="va">wait_time</span> <span class="op">-</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="va">price</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># Define thresholds for three satisfaction levels:</span></span>
<span><span class="co"># latent ≤ 0: Low; 0 &lt; latent ≤ 1: Medium; latent &gt; 1: High</span></span>
<span><span class="va">satisfaction</span> <span class="op">&lt;-</span> <span class="fu">cut</span><span class="op">(</span><span class="va">latent</span>,</span>
<span>                    breaks <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Medium"</span>,<span class="st">"High"</span><span class="op">)</span>,</span>
<span>                    ordered_result <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">satisfaction</span>, <span class="va">wait_time</span>, <span class="va">price</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit proportional‐odds (ordinal logistic) model:</span></span>
<span><span class="va">model_polr</span> <span class="op">&lt;-</span> <span class="fu">polr</span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">wait_time</span> <span class="op">+</span> <span class="va">price</span>, data <span class="op">=</span> <span class="va">df</span>, Hess <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize coefficients and compute p‐values:</span></span>
<span><span class="va">ctable</span> <span class="op">&lt;-</span> <span class="fu">coef</span><span class="op">(</span><span class="fu">summary</span><span class="op">(</span><span class="va">model_polr</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pvals</span>  <span class="op">&lt;-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">ctable</span><span class="op">[</span>,<span class="st">"t value"</span><span class="op">]</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">ctable</span>, <span class="st">"p value"</span> <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="va">pvals</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display thresholds and predictor effects:</span></span>
<span><span class="va">results</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                  Value  Std. Error   t value p value
wait_time   -0.04036665 0.011844352 -3.408093   0.001
price       -0.02267858 0.006578292 -3.447488   0.001
Low|Medium  -3.34230915 0.625031561 -5.347425   0.000
Medium|High -1.78229869 0.564771833 -3.155785   0.002</code></pre>
</div>
<p><strong>Interpretation:</strong> The estimated coefficient for
wait_time is -0.04.</p>
<p>The odds‐ratio is 0.96, meaning each additional minute of wait
changes the odds of being in a higher satisfaction category by that
factor.</p>
<p>A p‐value of 0.001 for wait_time indicates rejecting H₀: wait time
significantly affects satisfaction odds.</p>
<p>Similar interpretation applies to price.</p>
</div>
</div>
</div>
</div>
<p><a id="linear_mixed_effects_model"></a></p>
<div id="accordionSpoiler38" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler38" aria-expanded="false" aria-controls="collapseSpoiler38">
  <h3 class="accordion-header" id="headingSpoiler38">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Linear mixed-effects modeller (LME) </h3>
</button>
<div id="collapseSpoiler38" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler38" aria-labelledby="headingSpoiler38">
<div class="accordion-body">
<p>EJ KORREKTURLÆST * <strong>Used for</strong> Modeling continuous
outcomes with both fixed effects (predictors of interest) and random
effects (to account for grouped or repeated measures).<br>
* <strong>Real-world example:</strong> Evaluating the effect of a new
teaching method on student test scores, while accounting for variability
between classrooms and schools.</p>
<p><strong>Assumptions</strong> * Linear relationship between predictors
and outcome.<br>
* Residuals are independent and normally distributed with mean
zero.<br>
* Random effects are normally distributed.<br>
* Homoscedasticity: constant variance of residuals.<br>
* Random effects structure correctly specified (e.g., intercepts and/or
slopes).</p>
<p><strong>Strengths</strong> * Accounts for correlation within clusters
(e.g., pupils within the same classroom).<br>
* Can handle unbalanced data and missing observations within
clusters.<br>
* Flexibly models complex hierarchical or longitudinal data
structures.</p>
<p><strong>Weaknesses</strong> * Model specification (random effects
structure) can be challenging.<br>
* Parameter estimation can be computationally intensive and may fail to
converge.<br>
* Inference (p-values) often relies on approximations or additional
packages.</p>
<p><strong>Example</strong> * <strong>Null hypothesis (H₀):</strong> The
new teaching method has no effect on student test scores (fixed effect
β_method = 0).<br>
* <strong>Alternative hypothesis (H₁):</strong> The new teaching method
affects student test scores (β_method ≠ 0).</p>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install/load necessary packages</span></span>
<span><span class="co"># install.packages("lme4"); install.packages("lmerTest")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lme4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: Matrix</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lmerTest</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'lmerTest'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:lme4':

    lmer</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data: 100 students in 10 classrooms within 3 schools</span></span>
<span><span class="va">n_schools</span>   <span class="op">&lt;-</span>  <span class="fl">3</span></span>
<span><span class="va">n_classes</span>   <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">students_pc</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">school</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_schools</span>, each <span class="op">=</span> <span class="va">n_classes</span> <span class="op">*</span> <span class="va">students_pc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">class</span>       <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">students_pc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">method</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"NewMethod"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">students_pc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># True model: intercept = 70, method effect = 5 points, random intercepts for class &amp; school, residual sd = 8</span></span>
<span><span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">70</span> <span class="op">+</span></span>
<span>         <span class="fu">ifelse</span><span class="op">(</span><span class="va">method</span><span class="op">==</span><span class="st">"NewMethod"</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span> <span class="op">*</span> <span class="va">students_pc</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rep</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">students_pc</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rep</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_schools</span>,            sd <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_classes</span> <span class="op">*</span> <span class="va">students_pc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">score</span>, <span class="va">method</span>, <span class="va">class</span>, <span class="va">school</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit linear mixed-effects model with random intercepts for school and class:</span></span>
<span><span class="va">lme_fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">method</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">/</span><span class="va">class</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize model (includes p-values via lmerTest):</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">lme_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: score ~ method + (1 | school/class)
   Data: df

REML criterion at convergence: 2132.4

Scaled residuals:
     Min       1Q   Median       3Q      Max
-2.69138 -0.67244  0.04868  0.66053  2.86344

Random effects:
 Groups       Name        Variance Std.Dev.
 class:school (Intercept) 20.88    4.570
 school       (Intercept) 91.42    9.561
 Residual                 61.31    7.830
Number of obs: 300, groups:  class:school, 30; school, 3

Fixed effects:
                Estimate Std. Error       df t value Pr(&gt;|t|)
(Intercept)      64.6076     5.6194   2.0276  11.497  0.00712 **
methodNewMethod   5.9555     0.9042 268.9993   6.587 2.35e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
methdNwMthd -0.080</code></pre>
</div>
<p><strong>Interpretation:</strong> The fixed-effect estimate for
NewMethod is 5.96 points (SE = 0.9), with p = 2.35^{-10}. We reject the
null hypothesis. Thus, there is evidence that the new teaching method
significantly changes test scores, accounting for classroom and school
variability.</p>
</div>
</div>
</div>
</div>
<p><a id="generalized_linear_mixed_effects_model"></a></p>
<div id="accordionSpoiler39" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler39" aria-expanded="false" aria-controls="collapseSpoiler39">
  <h3 class="accordion-header" id="headingSpoiler39">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Generalized linear mixed-effects modeller (GLMM) </h3>
</button>
<div id="collapseSpoiler39" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler39" aria-labelledby="headingSpoiler39">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling non-normal outcomes (e.g. binary,
counts) with both fixed effects and random effects.<br></li>
<li>
<strong>Real-world example:</strong> Predicting whether patients are
readmitted (yes/no) based on age and comorbidity score, with random
intercepts for each hospital.</li>
</ul><p><strong>Assumptions</strong> * Observations within each cluster
(e.g. hospital) are correlated, but clusters are independent.<br>
* The conditional distribution of the outcome given predictors and
random effects follows a specified exponential‐family distribution
(e.g. binomial, Poisson).<br>
* The link function (e.g. logit, log) correctly relates the linear
predictor to the mean of the outcome.<br>
* Random effects are normally distributed.</p>
<p><strong>Strengths</strong> * Can accommodate hierarchical or
longitudinal data and non-Gaussian outcomes.<br>
* Estimates both population‐level (fixed) effects and cluster‐specific
(random) variation.<br>
* Flexible: supports a variety of link functions and distributions.</p>
<p><strong>Weaknesses</strong> * Computationally intensive; convergence
can fail with complex random‐effects structures.<br>
* Inference (especially p-values for fixed effects) relies on
approximations.<br>
* Model specification (random slopes, link choice) can be
challenging.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The log-odds of readmission
do not depend on age (β_age = 0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Age affects the
log-odds of readmission (β_age ≠ 0).</li>
</ul><div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lme4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data for 2000 patients in 20 hospitals:</span></span>
<span><span class="va">n_hospitals</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">patients_per</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">hospital</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_hospitals</span>, each <span class="op">=</span> <span class="va">patients_per</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">age</span>        <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_hospitals</span> <span class="op">*</span> <span class="va">patients_per</span>, mean <span class="op">=</span> <span class="fl">65</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">comorbidity</span><span class="op">&lt;-</span> <span class="fu">rpois</span><span class="op">(</span><span class="va">n_hospitals</span> <span class="op">*</span> <span class="va">patients_per</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True model: logit(p) = -2 + 0.03*age + 0.5*comorbidity + random intercept by hospital</span></span>
<span><span class="va">logit_p</span>    <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.03</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">comorbidity</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_hospitals</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">[</span><span class="va">hospital</span><span class="op">]</span></span>
<span><span class="va">p_readmit</span>  <span class="op">&lt;-</span> <span class="fu">plogis</span><span class="op">(</span><span class="va">logit_p</span><span class="op">)</span></span>
<span><span class="va">readmit</span>    <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_hospitals</span> <span class="op">*</span> <span class="va">patients_per</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_readmit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_glmm</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>readmit <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">readmit</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="va">age</span>, <span class="va">comorbidity</span>, <span class="va">hospital</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a binomial GLMM with random intercepts for hospital:</span></span>
<span><span class="va">glmm_fit</span> <span class="op">&lt;-</span> <span class="fu">glmer</span><span class="op">(</span><span class="va">readmit</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">comorbidity</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">hospital</span><span class="op">)</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">df_glmm</span>, family <span class="op">=</span> <span class="fu">binomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">glmm_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: readmit ~ age + comorbidity + (1 | hospital)
   Data: df_glmm

      AIC       BIC    logLik -2*log(L)  df.resid
   2200.4    2222.8   -1096.2    2192.4      1996

Scaled residuals:
    Min      1Q  Median      3Q     Max
-3.9499 -0.9147  0.4555  0.6420  1.7336

Random effects:
 Groups   Name        Variance Std.Dev.
 hospital (Intercept) 0.1931   0.4395
Number of obs: 2000, groups:  hospital, 20

Fixed effects:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -2.132901   0.370427  -5.758 8.51e-09 ***
age          0.035056   0.005317   6.593 4.30e-11 ***
comorbidity  0.457562   0.044238  10.343  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) age
age         -0.932
comorbidity -0.293  0.101</code></pre>
</div>
<p><strong>Interpretation:</strong> The fixed‐effect estimate for age is
0.035 (SE = 0.005), giving an odds ratio of 1.036 per year of age. With
a z‐value = 6.59 and p ≈ 4.3^{-11}, we reject the null hypothesis. This
indicates that age is significantly associated with higher odds of
readmission, accounting for hospital clustering.</p>
</div>
</div>
</div>
</div>
<p><a id="gee_logistic"></a></p>
<div id="accordionSpoiler40" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler40" aria-expanded="false" aria-controls="collapseSpoiler40">
  <h3 class="accordion-header" id="headingSpoiler40">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Generalized Estimating Equations (GEE) </h3>
</button>
<div id="collapseSpoiler40" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler40" aria-labelledby="headingSpoiler40">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling correlated or clustered data
(e.g., repeated measures, longitudinal, or clustered observations) when
interest lies in population‐averaged effects rather than
subject‐specific effects.<br></li>
<li>
<strong>Real-world example:</strong> Estimating the effect of a
diabetes education program on the probability of glycemic control (A1C
&lt; 7%) over multiple clinic visits per patient.</li>
</ul><p><strong>Assumptions</strong> * Clustered or repeated observations per
subject/cluster with some “working” correlation structure (e.g.,
exchangeable, autoregressive).<br>
* Correct specification of the link function and the mean model (e.g.,
logit link for binary outcomes).<br>
* Missing data are missing completely at random (MCAR) or missing at
random (MAR), assuming missingness only depends on observed
covariates.<br>
* Large‐sample inference: GEE relies on asymptotic properties (number of
clusters ≫ 1).</p>
<p><strong>Strengths</strong> * Robust (“sandwich”) standard errors even
if the working correlation structure is mis‐specified.<br>
* Provides marginal (population‐averaged) estimates, often of direct
interest in public health/epidemiology.<br>
* Accommodates a variety of outcomes (binary, count, continuous) via
appropriate link and family.</p>
<p><strong>Weaknesses</strong> * Efficiency can be lost if the working
correlation is far from the truth (though estimates remain
consistent).<br>
* Inference is asymptotic—small numbers of clusters can lead to biased
standard errors.<br>
* Does not model subject‐specific trajectories; cannot estimate
random‐effects variance components.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The education program has no
effect on odds of glycemic control over time (β_edu = 0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The education program
changes the odds of glycemic control over time (β_edu ≠ 0).</li>
</ul><div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install/load necessary package:</span></span>
<span><span class="co"># install.packages("geepack")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data: 100 patients (clusters), each with 4 visits</span></span>
<span><span class="va">n_patients</span>   <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">visits_per</span>   <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">patient_id</span>   <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_patients</span>, each <span class="op">=</span> <span class="va">visits_per</span><span class="op">)</span></span>
<span><span class="va">visit_number</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">visits_per</span>, times <span class="op">=</span> <span class="va">n_patients</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a binary program indicator (0=no program, 1=received education), randomly assigned at baseline</span></span>
<span><span class="va">edu_program</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_patients</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">edu</span>          <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="va">edu_program</span>, each <span class="op">=</span> <span class="va">visits_per</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate time effect (visits 1–4 coded 0–3) and baseline covariate (e.g., age)</span></span>
<span><span class="va">age_cont</span>     <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">age</span>          <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="va">age_cont</span>, each <span class="op">=</span> <span class="va">visits_per</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True population‐averaged logistic model:</span></span>
<span><span class="co"># logit(p_ij) = -1 + 0.4 * edu_i - 0.02 * age_i + 0.3 * visit_number_j</span></span>
<span><span class="co"># For simplicity, ignore cluster‐specific random effect; correlation introduced via GEE working structure.</span></span>
<span><span class="va">lin_pred</span>     <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span></span>
<span>                <span class="fl">0.4</span> <span class="op">*</span> <span class="va">edu</span> <span class="op">+</span></span>
<span>               <span class="op">-</span><span class="fl">0.02</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                <span class="fl">0.3</span> <span class="op">*</span> <span class="va">visit_number</span></span>
<span><span class="va">prob</span>         <span class="op">&lt;-</span> <span class="fu">plogis</span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate binary outcome: glycemic control (1=yes, 0=no)</span></span>
<span><span class="va">gly_control</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_patients</span> <span class="op">*</span> <span class="va">visits_per</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_gee</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  patient_id   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">patient_id</span><span class="op">)</span>,</span>
<span>  visit_number <span class="op">=</span> <span class="va">visit_number</span>,</span>
<span>  edu          <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">edu</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"NoEdu"</span>,<span class="st">"Edu"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  age          <span class="op">=</span> <span class="va">age</span>,</span>
<span>  gly_control  <span class="op">=</span> <span class="va">gly_control</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit GEE with exchangeable working correlation:</span></span>
<span><span class="va">gee_fit</span> <span class="op">&lt;-</span> <span class="fu">geeglm</span><span class="op">(</span></span>
<span>  <span class="va">gly_control</span> <span class="op">~</span> <span class="va">edu</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">visit_number</span>,</span>
<span>  id            <span class="op">=</span> <span class="va">patient_id</span>,</span>
<span>  family        <span class="op">=</span> <span class="fu">binomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  corstr        <span class="op">=</span> <span class="st">"exchangeable"</span>,</span>
<span>  data          <span class="op">=</span> <span class="va">df_gee</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">gee_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
geeglm(formula = gly_control ~ edu + age + visit_number, family = binomial(link = "logit"),
    data = df_gee, id = patient_id, corstr = "exchangeable")

 Coefficients:
             Estimate  Std.err   Wald Pr(&gt;|W|)
(Intercept)  -1.84098  0.87073  4.470   0.0345 *
eduEdu        0.55189  0.24796  4.954   0.0260 *
age          -0.01791  0.01287  1.934   0.1643
visit_number  0.55376  0.10903 25.795  3.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = exchangeable
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)   0.9761  0.1171
  Link = identity

Estimated Correlation Parameters:
      Estimate Std.err
alpha  0.00166 0.03069
Number of clusters:   100  Maximum cluster size: 4 </code></pre>
</div>
<p>**Interpretation:*’</p>
<p>The estimated coefficient for edu (Edu vs. NoEdu) is 0.552 . Its
robust (“sandwich”) standard error is 0.248</p>
<p>, yielding a Wald‐type z = 2.23, with p = 0.026. We reject the null
hypothesis. This indicates that, across all visits and patients, those
in the education program have significantly difference in odds of
glycemic control compared to those without education.</p>
<p>The coefficient for age equals -0.0179 (p = 0.164), indicating each
additional year of age multiplies the odds of control by
exp(-0.0179).</p>
<p>The visit_number effect is 0.554 per visit (p = 3.8^{-7}), showing
whether odds of control change over successive visits.</p>
<p>Because GEE uses a sandwich estimator, these inferences remain valid
even if “exchangeable” correlation is not exactly correct, provided we
have a sufficiently large number of patients.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="kontingenstabel--og-proportions-tests">Kontingenstabel- og proportions-tests<a class="anchor" aria-label="anchor" href="#kontingenstabel--og-proportions-tests"></a></h2>
<hr class="half-width"><p><a id="mcnemar_test"></a></p>
<div id="accordionSpoiler41" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler41" aria-expanded="false" aria-controls="collapseSpoiler41">
  <h3 class="accordion-header" id="headingSpoiler41">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> McNemar’s test </h3>
</button>
<div id="collapseSpoiler41" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler41" aria-labelledby="headingSpoiler41">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the proportions of paired
binary outcomes differ (i.e., detecting marginal changes in a 2×2 paired
table).<br></li>
<li>
<strong>Real-world example:</strong> Determining if a new diagnostic
test classification (Positive/Negative) differs from an existing “gold
standard” classification on the same patients.</li>
</ul><p><strong>Assumptions</strong> * Data consist of paired binary
observations (e.g., before/after, test1/test2) on the same
subjects.<br>
* Discordant cell counts (subjects where Test A=Positive &amp; Test
B=Negative or vice versa) are sufficiently large (≥ 10) for the χ²
approximation; otherwise use exact McNemar.<br>
* Each pair is independent of all other pairs.</p>
<p><strong>Strengths</strong> * Simple to implement for paired binary
data.<br>
* Specifically tests for a change in proportion rather than overall
association.<br>
* Does not require marginal homogeneity for concordant pairs (only
discordant pairs matter).</p>
<p><strong>Weaknesses</strong> * Ignores concordant pairs (those where
both methods agree), focusing only on discordant counts.<br>
* χ² approximation can be invalid if discordant counts are
small—requires exact test.<br>
* Only applicable to 2×2 paired tables (binary outcomes).</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The probability of discordant
outcomes is the same in both directions (b = c).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The probability of
discordant outcomes differs (b ≠ c).</li>
</ul><div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated paired binary data: OldTest vs. NewTest (n = 100 patients)</span></span>
<span><span class="co">#      NewTest</span></span>
<span><span class="co"># OldTest  Positive  Negative</span></span>
<span><span class="co"># Positive      30        20   (b = 20)</span></span>
<span><span class="co"># Negative      10        40   (c = 10)</span></span>
<span></span>
<span><span class="va">ctab</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">20</span>,</span>
<span>                 <span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>               nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>                 OldTest <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Positive"</span>,<span class="st">"Negative"</span><span class="op">)</span>,</span>
<span>                 NewTest <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Positive"</span>,<span class="st">"Negative"</span><span class="op">)</span></span>
<span>               <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform McNemar’s test (χ² approximation):</span></span>
<span><span class="va">mcnemar_result</span> <span class="op">&lt;-</span> <span class="fu">mcnemar.test</span><span class="op">(</span><span class="va">ctab</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">mcnemar_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	McNemar's Chi-squared test

data:  ctab
McNemar's chi-squared = 3.3, df = 1, p-value = 0.07</code></pre>
</div>
<p><strong>Interpretation:</strong> The McNemar χ² statistic is 3.33
with p-value = 0.0679. We fail to reject the null hypothesis. Since b
(OldTest Positive, NewTest Negative) = 20 and c (OldTest Negative,
NewTest Positive) = 10, a significant result would indicate that the
switch in classifications is not symmetric—i.e., the new test’s
positive/negative calls differ from the old test more often in one
direction than the other.</p>
</div>
</div>
</div>
</div>
<p><a id="fishers_exact_test"></a></p>
<div id="accordionSpoiler42" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler42" aria-expanded="false" aria-controls="collapseSpoiler42">
  <h3 class="accordion-header" id="headingSpoiler42">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Fisher’s exact test </h3>
</button>
<div id="collapseSpoiler42" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler42" aria-labelledby="headingSpoiler42">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing independence between two
categorical variables in a small-sample 2×2 contingency table.<br></li>
<li>
<strong>Real-world example:</strong> Examining whether a new
antibiotic leads to cure versus failure in 15 patients (small sample
where χ² might be invalid).</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Data form a 2×2 table (binary outcome × binary exposure).<br>
* Marginal totals are fixed (conditional inference on margins).</p>
<p><strong>Strengths</strong> * Exact p-value without relying on
large-sample approximations.<br>
* Valid even when expected cell counts are very small or zero.<br>
* Simple to implement in R via <code>fisher.test()</code>.</p>
<p><strong>Weaknesses</strong> * Only directly applies to 2×2 tables;
extensions to larger tables exist but are computationally
intensive.<br>
* Does not provide an effect-size estimate beyond the odds ratio (which
must be computed separately).<br>
* Can be conservative (lower power) compared to asymptotic tests with
moderate sample sizes.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Treatment and outcome are
independent (odds ratio = 1).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Treatment and outcome
are not independent (odds ratio ≠ 1).</li>
</ul><div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct a 2×2 contingency table:</span></span>
<span><span class="co">#               Outcome</span></span>
<span><span class="co"># Treatment   Cure  Failure</span></span>
<span><span class="co">#   New        7      3</span></span>
<span><span class="co">#   Standard   2      3</span></span>
<span></span>
<span><span class="va">ctab</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">7</span>, <span class="fl">3</span>,</span>
<span>                 <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>                 Treatment <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"New"</span>, <span class="st">"Standard"</span><span class="op">)</span>,</span>
<span>                 Outcome   <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Cure"</span>, <span class="st">"Failure"</span><span class="op">)</span></span>
<span>               <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Fisher’s exact test:</span></span>
<span><span class="va">fisher_result</span> <span class="op">&lt;-</span> <span class="fu">fisher.test</span><span class="op">(</span><span class="va">ctab</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">fisher_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Fisher's Exact Test for Count Data

data:  ctab
p-value = 0.3
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  0.2329 59.0957
sample estimates:
odds ratio
     3.196 </code></pre>
</div>
<p><strong>Interpretation:</strong> Fisher’s exact test yields an odds
ratio estimate of 3.2 with a two-sided p-value = 0.329. We fail to
reject the null hypothesis. Thus, there is no evidence of a difference
in cure rates between the two treatments.</p>
</div>
</div>
</div>
</div>
<p><a id="barnard_exact_test"></a></p>
<div id="accordionSpoiler43" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler43" aria-expanded="false" aria-controls="collapseSpoiler43">
  <h3 class="accordion-header" id="headingSpoiler43">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Barnard’s exact test </h3>
</button>
<div id="collapseSpoiler43" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler43" aria-labelledby="headingSpoiler43">
<div class="accordion-body">
<p>EJ KORREKTURLÆST VÆR SÆRLIGT OPMÆRKSOM HER - DER VAR STORE
UDFORDRINGER…</p>
<ul><li>
<strong>Used for</strong> Testing independence in a 2×2 contingency
table via an unconditional exact test.<br></li>
<li>
<strong>Real-world example:</strong> Determining if a new pain
medication and placebo differ in adverse event rates when sample sizes
are small.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent and each
subject contributes exactly one cell in the 2×2 table.<br>
* Only one margin (row or column totals) is fixed; the other margin is
free.<br>
* Binary outcome (e.g., “Adverse Event: Yes/No”) and binary grouping
(“Medication vs. Placebo”).</p>
<p><strong>Strengths</strong> * More powerful than Fisher’s exact test
because it does not condition on both margins.<br>
* Provides an exact p-value without relying on large‐sample
approximations.<br>
* Particularly advantageous when margins are not fixed by design.</p>
<p><strong>Weaknesses</strong> * Computationally slower than Fisher’s
exact test for larger sample sizes.<br>
* Only applies to 2×2 tables (binary × binary).<br>
* Requires installation of the <strong>Barnard</strong> package (not in
base R).</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The probability of an adverse
event is the same in the Medication and Placebo groups (no
association).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The probability of an
adverse event differs between Medication and Placebo.</li>
</ul><div class="codewrapper sourceCode" id="cb114">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the Barnard package (only once if not already installed):</span></span>
<span><span class="co"># install.packages("Barnard")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">Barnard</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the 2×2 counts:</span></span>
<span><span class="co">#              AdverseEvent</span></span>
<span><span class="co"># Treatment   Yes   No</span></span>
<span><span class="co">#   Medication  2     8</span></span>
<span><span class="co">#   Placebo     7     3</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">2</span>   <span class="co"># Medication &amp; Yes</span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">8</span>   <span class="co"># Medication &amp; No</span></span>
<span><span class="va">n3</span> <span class="op">&lt;-</span> <span class="fl">7</span>   <span class="co"># Placebo    &amp; Yes</span></span>
<span><span class="va">n4</span> <span class="op">&lt;-</span> <span class="fl">3</span>   <span class="co"># Placebo    &amp; No</span></span>
<span></span>
<span><span class="co"># Run Barnard's unconditional exact test:</span></span>
<span><span class="va">barnard_result</span> <span class="op">&lt;-</span> <span class="fu">barnard.test</span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">n3</span>, <span class="va">n4</span>, pooled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Barnard's Unconditional Test

           Treatment I Treatment II
Outcome I            2            8
Outcome II           7            3

Null hypothesis: Treatments have no effect on the outcomes
Score statistic = 2.24733
Nuisance parameter = 0.666 (One sided), 0.5 (Two sided)
P-value = 0.0167869 (One sided), 0.0334587 (Two sided)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb116">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the test result:</span></span>
<span><span class="va">barnard_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$statistic.table
       n1 n2 statistic include.in.p.value
  [1,]  0  1   0.92803                  0
  [2,]  0  2   1.34840                  0
  [3,]  0  3   1.69932                  0
  [4,]  0  4   2.02260                  0
  [5,]  0  5   2.33550                  1
  [6,]  0  6   2.64820                  1
  [7,]  0  7   2.96836                  1
  [8,]  0  8   3.30289                  1
  [9,]  0  9   3.65902                  1
 [10,]  0 10   4.04520                  1
 [11,]  0 11   4.47214                  1
 [12,]  1  0  -1.13426                  0
 [13,]  1  1  -0.14982                  0
 [14,]  1  2   0.44057                  0
 [15,]  1  3   0.89893                  0
 [16,]  1  4   1.29750                  0
 [17,]  1  5   1.66739                  0
 [18,]  1  6   2.02603                  0
 [19,]  1  7   2.38542                  1
 [20,]  1  8   2.75556                  1
 [21,]  1  9   3.14627                  1
 [22,]  1 10   3.56867                  1
 [23,]  1 11   4.03687                  1
 [24,]  2  0  -1.64804                  0
 [25,]  2  1  -0.81819                  0
 [26,]  2  2  -0.22473                  0
 [27,]  2  3   0.25950                  0
 [28,]  2  4   0.68657                  0
 [29,]  2  5   1.08369                  0
 [30,]  2  6   1.46795                  0
 [31,]  2  7   1.85210                  0
 [32,]  2  8   2.24733                  1
 [33,]  2  9   2.66521                  1
 [34,]  2 10   3.11940                  1
 [35,]  2 11   3.62800                  1
 [36,]  3  0  -2.07695                  0
 [37,]  3  1  -1.34840                  0
 [38,]  3  2  -0.77850                  0
 [39,]  3  3  -0.29424                  0
 [40,]  3  4   0.14135                  0
 [41,]  3  5   0.55048                  0
 [42,]  3  6   0.94863                  0
 [43,]  3  7   1.34840                  0
 [44,]  3  8   1.76175                  0
 [45,]  3  9   2.20193                  0
 [46,]  3 10   2.68566                  1
 [47,]  3 11   3.23669                  1
 [48,]  4  0  -2.47207                  2
 [49,]  4  1  -1.81650                  0
 [50,]  4  2  -1.27506                  0
 [51,]  4  3  -0.80099                  0
 [52,]  4  4  -0.36699                  0
 [53,]  4  5   0.04517                  0
 [54,]  4  6   0.44947                  0
 [55,]  4  7   0.85829                  0
 [56,]  4  8   1.28446                  0
 [57,]  4  9   1.74333                  0
 [58,]  4 10   2.25588                  1
 [59,]  4 11   2.85450                  1
 [60,]  5  0  -2.85450                  2
 [61,]  5  1  -2.25588                  2
 [62,]  5  2  -1.74333                  0
 [63,]  5  3  -1.28446                  0
 [64,]  5  4  -0.85829                  0
 [65,]  5  5  -0.44947                  0
 [66,]  5  6  -0.04517                  0
 [67,]  5  7   0.36699                  0
 [68,]  5  8   0.80099                  0
 [69,]  5  9   1.27506                  0
 [70,]  5 10   1.81650                  0
 [71,]  5 11   2.47207                  1
 [72,]  6  0  -3.23669                  2
 [73,]  6  1  -2.68566                  2
 [74,]  6  2  -2.20193                  0
 [75,]  6  3  -1.76175                  0
 [76,]  6  4  -1.34840                  0
 [77,]  6  5  -0.94863                  0
 [78,]  6  6  -0.55048                  0
 [79,]  6  7  -0.14135                  0
 [80,]  6  8   0.29424                  0
 [81,]  6  9   0.77850                  0
 [82,]  6 10   1.34840                  0
 [83,]  6 11   2.07695                  0
 [84,]  7  0  -3.62800                  2
 [85,]  7  1  -3.11940                  2
 [86,]  7  2  -2.66521                  2
 [87,]  7  3  -2.24733                  2
 [88,]  7  4  -1.85210                  0
 [89,]  7  5  -1.46795                  0
 [90,]  7  6  -1.08369                  0
 [91,]  7  7  -0.68657                  0
 [92,]  7  8  -0.25950                  0
 [93,]  7  9   0.22473                  0
 [94,]  7 10   0.81819                  0
 [95,]  7 11   1.64804                  0
 [96,]  8  0  -4.03687                  2
 [97,]  8  1  -3.56867                  2
 [98,]  8  2  -3.14627                  2
 [99,]  8  3  -2.75556                  2
[100,]  8  4  -2.38542                  2
[101,]  8  5  -2.02603                  0
[102,]  8  6  -1.66739                  0
[103,]  8  7  -1.29750                  0
[104,]  8  8  -0.89893                  0
[105,]  8  9  -0.44057                  0
[106,]  8 10   0.14982                  0
[107,]  8 11   1.13426                  0
[108,]  9  0  -4.47214                  2
[109,]  9  1  -4.04520                  2
[110,]  9  2  -3.65902                  2
[111,]  9  3  -3.30289                  2
[112,]  9  4  -2.96836                  2
[113,]  9  5  -2.64820                  2
[114,]  9  6  -2.33550                  2
[115,]  9  7  -2.02260                  0
[116,]  9  8  -1.69932                  0
[117,]  9  9  -1.34840                  0
[118,]  9 10  -0.92803                  0

$nuisance.matrix
         [,1]      [,2]      [,3]
   [1,] 0.000 0.000e+00 0.000e+00
   [2,] 0.001 4.556e-13 1.246e-10
   [3,] 0.002 1.438e-11 1.971e-09
   [4,] 0.003 1.076e-10 9.865e-09
   [5,] 0.004 4.473e-10 3.083e-08
   [6,] 0.005 1.346e-09 7.441e-08
   [7,] 0.006 3.302e-09 1.526e-07
   [8,] 0.007 7.038e-09 2.795e-07
   [9,] 0.008 1.353e-08 4.714e-07
  [10,] 0.009 2.404e-08 7.466e-07
  [11,] 0.010 4.014e-08 1.125e-06
  [12,] 0.011 6.374e-08 1.629e-06
  [13,] 0.012 9.709e-08 2.281e-06
  [14,] 0.013 1.428e-07 3.106e-06
  [15,] 0.014 2.040e-07 4.131e-06
  [16,] 0.015 2.840e-07 5.383e-06
  [17,] 0.016 3.866e-07 6.890e-06
  [18,] 0.017 5.161e-07 8.681e-06
  [19,] 0.018 6.772e-07 1.079e-05
  [20,] 0.019 8.748e-07 1.324e-05
  [21,] 0.020 1.115e-06 1.608e-05
  [22,] 0.021 1.402e-06 1.932e-05
  [23,] 0.022 1.745e-06 2.301e-05
  [24,] 0.023 2.148e-06 2.718e-05
  [25,] 0.024 2.620e-06 3.186e-05
  [26,] 0.025 3.167e-06 3.709e-05
  [27,] 0.026 3.798e-06 4.290e-05
  [28,] 0.027 4.522e-06 4.933e-05
  [29,] 0.028 5.347e-06 5.641e-05
  [30,] 0.029 6.281e-06 6.418e-05
  [31,] 0.030 7.335e-06 7.268e-05
  [32,] 0.031 8.519e-06 8.193e-05
  [33,] 0.032 9.842e-06 9.198e-05
  [34,] 0.033 1.131e-05 1.029e-04
  [35,] 0.034 1.295e-05 1.146e-04
  [36,] 0.035 1.475e-05 1.272e-04
  [37,] 0.036 1.674e-05 1.408e-04
  [38,] 0.037 1.892e-05 1.554e-04
  [39,] 0.038 2.131e-05 1.709e-04
  [40,] 0.039 2.392e-05 1.875e-04
  [41,] 0.040 2.676e-05 2.051e-04
  [42,] 0.041 2.984e-05 2.238e-04
  [43,] 0.042 3.318e-05 2.437e-04
  [44,] 0.043 3.678e-05 2.648e-04
  [45,] 0.044 4.067e-05 2.870e-04
  [46,] 0.045 4.484e-05 3.104e-04
  [47,] 0.046 4.933e-05 3.351e-04
  [48,] 0.047 5.414e-05 3.611e-04
  [49,] 0.048 5.928e-05 3.884e-04
  [50,] 0.049 6.476e-05 4.171e-04
  [51,] 0.050 7.061e-05 4.470e-04
  [52,] 0.051 7.683e-05 4.784e-04
  [53,] 0.052 8.343e-05 5.112e-04
  [54,] 0.053 9.044e-05 5.455e-04
  [55,] 0.054 9.785e-05 5.812e-04
  [56,] 0.055 1.057e-04 6.184e-04
  [57,] 0.056 1.140e-04 6.571e-04
  [58,] 0.057 1.227e-04 6.973e-04
  [59,] 0.058 1.319e-04 7.391e-04
  [60,] 0.059 1.416e-04 7.824e-04
  [61,] 0.060 1.517e-04 8.273e-04
  [62,] 0.061 1.624e-04 8.739e-04
  [63,] 0.062 1.736e-04 9.220e-04
  [64,] 0.063 1.853e-04 9.718e-04
  [65,] 0.064 1.975e-04 1.023e-03
  [66,] 0.065 2.103e-04 1.076e-03
  [67,] 0.066 2.237e-04 1.131e-03
  [68,] 0.067 2.376e-04 1.188e-03
  [69,] 0.068 2.521e-04 1.246e-03
  [70,] 0.069 2.673e-04 1.306e-03
  [71,] 0.070 2.830e-04 1.367e-03
  [72,] 0.071 2.993e-04 1.431e-03
  [73,] 0.072 3.163e-04 1.496e-03
  [74,] 0.073 3.338e-04 1.563e-03
  [75,] 0.074 3.521e-04 1.631e-03
  [76,] 0.075 3.710e-04 1.702e-03
  [77,] 0.076 3.905e-04 1.774e-03
  [78,] 0.077 4.107e-04 1.848e-03
  [79,] 0.078 4.316e-04 1.923e-03
  [80,] 0.079 4.532e-04 2.001e-03
  [81,] 0.080 4.755e-04 2.080e-03
  [82,] 0.081 4.985e-04 2.161e-03
  [83,] 0.082 5.222e-04 2.244e-03
  [84,] 0.083 5.466e-04 2.329e-03
  [85,] 0.084 5.717e-04 2.415e-03
  [86,] 0.085 5.975e-04 2.503e-03
  [87,] 0.086 6.241e-04 2.593e-03
  [88,] 0.087 6.514e-04 2.684e-03
  [89,] 0.088 6.795e-04 2.778e-03
  [90,] 0.089 7.083e-04 2.873e-03
  [91,] 0.090 7.378e-04 2.970e-03
  [92,] 0.091 7.681e-04 3.068e-03
  [93,] 0.092 7.991e-04 3.169e-03
  [94,] 0.093 8.309e-04 3.271e-03
  [95,] 0.094 8.635e-04 3.374e-03
  [96,] 0.095 8.968e-04 3.480e-03
  [97,] 0.096 9.309e-04 3.587e-03
  [98,] 0.097 9.657e-04 3.696e-03
  [99,] 0.098 1.001e-03 3.806e-03
 [100,] 0.099 1.038e-03 3.918e-03
 [101,] 0.100 1.075e-03 4.032e-03
 [102,] 0.101 1.113e-03 4.147e-03
 [103,] 0.102 1.151e-03 4.264e-03
 [104,] 0.103 1.191e-03 4.383e-03
 [105,] 0.104 1.231e-03 4.503e-03
 [106,] 0.105 1.272e-03 4.624e-03
 [107,] 0.106 1.314e-03 4.747e-03
 [108,] 0.107 1.356e-03 4.872e-03
 [109,] 0.108 1.399e-03 4.998e-03
 [110,] 0.109 1.443e-03 5.126e-03
 [111,] 0.110 1.488e-03 5.255e-03
 [112,] 0.111 1.533e-03 5.385e-03
 [113,] 0.112 1.580e-03 5.517e-03
 [114,] 0.113 1.626e-03 5.650e-03
 [115,] 0.114 1.674e-03 5.785e-03
 [116,] 0.115 1.722e-03 5.921e-03
 [117,] 0.116 1.771e-03 6.058e-03
 [118,] 0.117 1.821e-03 6.197e-03
 [119,] 0.118 1.872e-03 6.337e-03
 [120,] 0.119 1.923e-03 6.478e-03
 [121,] 0.120 1.975e-03 6.621e-03
 [122,] 0.121 2.027e-03 6.764e-03
 [123,] 0.122 2.080e-03 6.909e-03
 [124,] 0.123 2.134e-03 7.055e-03
 [125,] 0.124 2.189e-03 7.202e-03
 [126,] 0.125 2.244e-03 7.350e-03
 [127,] 0.126 2.300e-03 7.499e-03
 [128,] 0.127 2.356e-03 7.650e-03
 [129,] 0.128 2.413e-03 7.801e-03
 [130,] 0.129 2.471e-03 7.953e-03
 [131,] 0.130 2.529e-03 8.107e-03
 [132,] 0.131 2.588e-03 8.261e-03
 [133,] 0.132 2.647e-03 8.416e-03
 [134,] 0.133 2.708e-03 8.572e-03
 [135,] 0.134 2.768e-03 8.729e-03
 [136,] 0.135 2.829e-03 8.887e-03
 [137,] 0.136 2.891e-03 9.045e-03
 [138,] 0.137 2.953e-03 9.205e-03
 [139,] 0.138 3.016e-03 9.365e-03
 [140,] 0.139 3.079e-03 9.525e-03
 [141,] 0.140 3.143e-03 9.687e-03
 [142,] 0.141 3.207e-03 9.849e-03
 [143,] 0.142 3.272e-03 1.001e-02
 [144,] 0.143 3.337e-03 1.017e-02
 [145,] 0.144 3.403e-03 1.034e-02
 [146,] 0.145 3.469e-03 1.050e-02
 [147,] 0.146 3.535e-03 1.067e-02
 [148,] 0.147 3.602e-03 1.083e-02
 [149,] 0.148 3.670e-03 1.100e-02
 [150,] 0.149 3.737e-03 1.117e-02
 [151,] 0.150 3.806e-03 1.133e-02
 [152,] 0.151 3.874e-03 1.150e-02
 [153,] 0.152 3.943e-03 1.167e-02
 [154,] 0.153 4.012e-03 1.184e-02
 [155,] 0.154 4.082e-03 1.200e-02
 [156,] 0.155 4.152e-03 1.217e-02
 [157,] 0.156 4.222e-03 1.234e-02
 [158,] 0.157 4.292e-03 1.251e-02
 [159,] 0.158 4.363e-03 1.268e-02
 [160,] 0.159 4.434e-03 1.285e-02
 [161,] 0.160 4.505e-03 1.302e-02
 [162,] 0.161 4.577e-03 1.318e-02
 [163,] 0.162 4.648e-03 1.335e-02
 [164,] 0.163 4.720e-03 1.352e-02
 [165,] 0.164 4.793e-03 1.369e-02
 [166,] 0.165 4.865e-03 1.386e-02
 [167,] 0.166 4.938e-03 1.403e-02
 [168,] 0.167 5.010e-03 1.420e-02
 [169,] 0.168 5.083e-03 1.437e-02
 [170,] 0.169 5.156e-03 1.454e-02
 [171,] 0.170 5.229e-03 1.471e-02
 [172,] 0.171 5.303e-03 1.488e-02
 [173,] 0.172 5.376e-03 1.504e-02
 [174,] 0.173 5.450e-03 1.521e-02
 [175,] 0.174 5.523e-03 1.538e-02
 [176,] 0.175 5.597e-03 1.555e-02
 [177,] 0.176 5.671e-03 1.571e-02
 [178,] 0.177 5.744e-03 1.588e-02
 [179,] 0.178 5.818e-03 1.605e-02
 [180,] 0.179 5.892e-03 1.621e-02
 [181,] 0.180 5.966e-03 1.638e-02
 [182,] 0.181 6.040e-03 1.655e-02
 [183,] 0.182 6.114e-03 1.671e-02
 [184,] 0.183 6.187e-03 1.687e-02
 [185,] 0.184 6.261e-03 1.704e-02
 [186,] 0.185 6.335e-03 1.720e-02
 [187,] 0.186 6.409e-03 1.737e-02
 [188,] 0.187 6.482e-03 1.753e-02
 [189,] 0.188 6.556e-03 1.769e-02
 [190,] 0.189 6.630e-03 1.785e-02
 [191,] 0.190 6.703e-03 1.801e-02
 [192,] 0.191 6.776e-03 1.817e-02
 [193,] 0.192 6.850e-03 1.833e-02
 [194,] 0.193 6.923e-03 1.849e-02
 [195,] 0.194 6.996e-03 1.865e-02
 [196,] 0.195 7.069e-03 1.880e-02
 [197,] 0.196 7.141e-03 1.896e-02
 [198,] 0.197 7.214e-03 1.912e-02
 [199,] 0.198 7.286e-03 1.927e-02
 [200,] 0.199 7.359e-03 1.942e-02
 [201,] 0.200 7.431e-03 1.958e-02
 [202,] 0.201 7.502e-03 1.973e-02
 [203,] 0.202 7.574e-03 1.988e-02
 [204,] 0.203 7.646e-03 2.003e-02
 [205,] 0.204 7.717e-03 2.018e-02
 [206,] 0.205 7.788e-03 2.033e-02
 [207,] 0.206 7.859e-03 2.048e-02
 [208,] 0.207 7.929e-03 2.063e-02
 [209,] 0.208 8.000e-03 2.077e-02
 [210,] 0.209 8.070e-03 2.092e-02
 [211,] 0.210 8.140e-03 2.106e-02
 [212,] 0.211 8.209e-03 2.120e-02
 [213,] 0.212 8.278e-03 2.135e-02
 [214,] 0.213 8.347e-03 2.149e-02
 [215,] 0.214 8.416e-03 2.163e-02
 [216,] 0.215 8.485e-03 2.177e-02
 [217,] 0.216 8.553e-03 2.191e-02
 [218,] 0.217 8.621e-03 2.204e-02
 [219,] 0.218 8.688e-03 2.218e-02
 [220,] 0.219 8.756e-03 2.232e-02
 [221,] 0.220 8.823e-03 2.245e-02
 [222,] 0.221 8.889e-03 2.258e-02
 [223,] 0.222 8.956e-03 2.272e-02
 [224,] 0.223 9.022e-03 2.285e-02
 [225,] 0.224 9.087e-03 2.298e-02
 [226,] 0.225 9.153e-03 2.311e-02
 [227,] 0.226 9.218e-03 2.323e-02
 [228,] 0.227 9.282e-03 2.336e-02
 [229,] 0.228 9.347e-03 2.348e-02
 [230,] 0.229 9.411e-03 2.361e-02
 [231,] 0.230 9.474e-03 2.373e-02
 [232,] 0.231 9.537e-03 2.385e-02
 [233,] 0.232 9.600e-03 2.398e-02
 [234,] 0.233 9.663e-03 2.410e-02
 [235,] 0.234 9.725e-03 2.421e-02
 [236,] 0.235 9.787e-03 2.433e-02
 [237,] 0.236 9.848e-03 2.445e-02
 [238,] 0.237 9.909e-03 2.456e-02
 [239,] 0.238 9.970e-03 2.468e-02
 [240,] 0.239 1.003e-02 2.479e-02
 [241,] 0.240 1.009e-02 2.490e-02
 [242,] 0.241 1.015e-02 2.501e-02
 [243,] 0.242 1.021e-02 2.512e-02
 [244,] 0.243 1.027e-02 2.523e-02
 [245,] 0.244 1.033e-02 2.534e-02
 [246,] 0.245 1.038e-02 2.544e-02
 [247,] 0.246 1.044e-02 2.555e-02
 [248,] 0.247 1.050e-02 2.565e-02
 [249,] 0.248 1.056e-02 2.576e-02
 [250,] 0.249 1.061e-02 2.586e-02
 [251,] 0.250 1.067e-02 2.596e-02
 [252,] 0.251 1.073e-02 2.606e-02
 [253,] 0.252 1.078e-02 2.616e-02
 [254,] 0.253 1.084e-02 2.625e-02
 [255,] 0.254 1.089e-02 2.635e-02
 [256,] 0.255 1.094e-02 2.644e-02
 [257,] 0.256 1.100e-02 2.654e-02
 [258,] 0.257 1.105e-02 2.663e-02
 [259,] 0.258 1.111e-02 2.672e-02
 [260,] 0.259 1.116e-02 2.681e-02
 [261,] 0.260 1.121e-02 2.690e-02
 [262,] 0.261 1.126e-02 2.699e-02
 [263,] 0.262 1.131e-02 2.707e-02
 [264,] 0.263 1.137e-02 2.716e-02
 [265,] 0.264 1.142e-02 2.724e-02
 [266,] 0.265 1.147e-02 2.733e-02
 [267,] 0.266 1.152e-02 2.741e-02
 [268,] 0.267 1.157e-02 2.749e-02
 [269,] 0.268 1.162e-02 2.757e-02
 [270,] 0.269 1.167e-02 2.765e-02
 [271,] 0.270 1.171e-02 2.773e-02
 [272,] 0.271 1.176e-02 2.781e-02
 [273,] 0.272 1.181e-02 2.788e-02
 [274,] 0.273 1.186e-02 2.796e-02
 [275,] 0.274 1.191e-02 2.803e-02
 [276,] 0.275 1.195e-02 2.811e-02
 [277,] 0.276 1.200e-02 2.818e-02
 [278,] 0.277 1.204e-02 2.825e-02
 [279,] 0.278 1.209e-02 2.832e-02
 [280,] 0.279 1.214e-02 2.839e-02
 [281,] 0.280 1.218e-02 2.846e-02
 [282,] 0.281 1.223e-02 2.852e-02
 [283,] 0.282 1.227e-02 2.859e-02
 [284,] 0.283 1.232e-02 2.866e-02
 [285,] 0.284 1.236e-02 2.872e-02
 [286,] 0.285 1.240e-02 2.878e-02
 [287,] 0.286 1.245e-02 2.885e-02
 [288,] 0.287 1.249e-02 2.891e-02
 [289,] 0.288 1.253e-02 2.897e-02
 [290,] 0.289 1.257e-02 2.903e-02
 [291,] 0.290 1.262e-02 2.909e-02
 [292,] 0.291 1.266e-02 2.915e-02
 [293,] 0.292 1.270e-02 2.920e-02
 [294,] 0.293 1.274e-02 2.926e-02
 [295,] 0.294 1.278e-02 2.931e-02
 [296,] 0.295 1.282e-02 2.937e-02
 [297,] 0.296 1.286e-02 2.942e-02
 [298,] 0.297 1.290e-02 2.948e-02
 [299,] 0.298 1.294e-02 2.953e-02
 [300,] 0.299 1.298e-02 2.958e-02
 [301,] 0.300 1.302e-02 2.963e-02
 [302,] 0.301 1.306e-02 2.968e-02
 [303,] 0.302 1.309e-02 2.973e-02
 [304,] 0.303 1.313e-02 2.978e-02
 [305,] 0.304 1.317e-02 2.983e-02
 [306,] 0.305 1.321e-02 2.987e-02
 [307,] 0.306 1.324e-02 2.992e-02
 [308,] 0.307 1.328e-02 2.997e-02
 [309,] 0.308 1.332e-02 3.001e-02
 [310,] 0.309 1.335e-02 3.006e-02
 [311,] 0.310 1.339e-02 3.010e-02
 [312,] 0.311 1.343e-02 3.014e-02
 [313,] 0.312 1.346e-02 3.018e-02
 [314,] 0.313 1.350e-02 3.023e-02
 [315,] 0.314 1.353e-02 3.027e-02
 [316,] 0.315 1.357e-02 3.031e-02
 [317,] 0.316 1.360e-02 3.035e-02
 [318,] 0.317 1.364e-02 3.039e-02
 [319,] 0.318 1.367e-02 3.043e-02
 [320,] 0.319 1.371e-02 3.046e-02
 [321,] 0.320 1.374e-02 3.050e-02
 [322,] 0.321 1.377e-02 3.054e-02
 [323,] 0.322 1.381e-02 3.058e-02
 [324,] 0.323 1.384e-02 3.061e-02
 [325,] 0.324 1.387e-02 3.065e-02
 [326,] 0.325 1.390e-02 3.068e-02
 [327,] 0.326 1.394e-02 3.072e-02
 [328,] 0.327 1.397e-02 3.075e-02
 [329,] 0.328 1.400e-02 3.078e-02
 [330,] 0.329 1.403e-02 3.082e-02
 [331,] 0.330 1.406e-02 3.085e-02
 [332,] 0.331 1.410e-02 3.088e-02
 [333,] 0.332 1.413e-02 3.091e-02
 [334,] 0.333 1.416e-02 3.094e-02
 [335,] 0.334 1.419e-02 3.097e-02
 [336,] 0.335 1.422e-02 3.101e-02
 [337,] 0.336 1.425e-02 3.104e-02
 [338,] 0.337 1.428e-02 3.106e-02
 [339,] 0.338 1.431e-02 3.109e-02
 [340,] 0.339 1.434e-02 3.112e-02
 [341,] 0.340 1.437e-02 3.115e-02
 [342,] 0.341 1.440e-02 3.118e-02
 [343,] 0.342 1.443e-02 3.121e-02
 [344,] 0.343 1.446e-02 3.123e-02
 [345,] 0.344 1.448e-02 3.126e-02
 [346,] 0.345 1.451e-02 3.129e-02
 [347,] 0.346 1.454e-02 3.131e-02
 [348,] 0.347 1.457e-02 3.134e-02
 [349,] 0.348 1.460e-02 3.137e-02
 [350,] 0.349 1.462e-02 3.139e-02
 [351,] 0.350 1.465e-02 3.142e-02
 [352,] 0.351 1.468e-02 3.144e-02
 [353,] 0.352 1.471e-02 3.147e-02
 [354,] 0.353 1.473e-02 3.149e-02
 [355,] 0.354 1.476e-02 3.152e-02
 [356,] 0.355 1.479e-02 3.154e-02
 [357,] 0.356 1.481e-02 3.156e-02
 [358,] 0.357 1.484e-02 3.159e-02
 [359,] 0.358 1.487e-02 3.161e-02
 [360,] 0.359 1.489e-02 3.163e-02
 [361,] 0.360 1.492e-02 3.166e-02
 [362,] 0.361 1.494e-02 3.168e-02
 [363,] 0.362 1.497e-02 3.170e-02
 [364,] 0.363 1.500e-02 3.172e-02
 [365,] 0.364 1.502e-02 3.174e-02
 [366,] 0.365 1.505e-02 3.177e-02
 [367,] 0.366 1.507e-02 3.179e-02
 [368,] 0.367 1.509e-02 3.181e-02
 [369,] 0.368 1.512e-02 3.183e-02
 [370,] 0.369 1.514e-02 3.185e-02
 [371,] 0.370 1.517e-02 3.187e-02
 [372,] 0.371 1.519e-02 3.189e-02
 [373,] 0.372 1.522e-02 3.191e-02
 [374,] 0.373 1.524e-02 3.193e-02
 [375,] 0.374 1.526e-02 3.195e-02
 [376,] 0.375 1.529e-02 3.197e-02
 [377,] 0.376 1.531e-02 3.199e-02
 [378,] 0.377 1.533e-02 3.201e-02
 [379,] 0.378 1.536e-02 3.203e-02
 [380,] 0.379 1.538e-02 3.205e-02
 [381,] 0.380 1.540e-02 3.207e-02
 [382,] 0.381 1.542e-02 3.209e-02
 [383,] 0.382 1.544e-02 3.211e-02
 [384,] 0.383 1.547e-02 3.213e-02
 [385,] 0.384 1.549e-02 3.215e-02
 [386,] 0.385 1.551e-02 3.217e-02
 [387,] 0.386 1.553e-02 3.219e-02
 [388,] 0.387 1.555e-02 3.221e-02
 [389,] 0.388 1.557e-02 3.222e-02
 [390,] 0.389 1.559e-02 3.224e-02
 [391,] 0.390 1.562e-02 3.226e-02
 [392,] 0.391 1.564e-02 3.228e-02
 [393,] 0.392 1.566e-02 3.230e-02
 [394,] 0.393 1.568e-02 3.231e-02
 [395,] 0.394 1.570e-02 3.233e-02
 [396,] 0.395 1.572e-02 3.235e-02
 [397,] 0.396 1.574e-02 3.237e-02
 [398,] 0.397 1.576e-02 3.239e-02
 [399,] 0.398 1.577e-02 3.240e-02
 [400,] 0.399 1.579e-02 3.242e-02
 [401,] 0.400 1.581e-02 3.244e-02
 [402,] 0.401 1.583e-02 3.245e-02
 [403,] 0.402 1.585e-02 3.247e-02
 [404,] 0.403 1.587e-02 3.249e-02
 [405,] 0.404 1.589e-02 3.251e-02
 [406,] 0.405 1.590e-02 3.252e-02
 [407,] 0.406 1.592e-02 3.254e-02
 [408,] 0.407 1.594e-02 3.256e-02
 [409,] 0.408 1.596e-02 3.257e-02
 [410,] 0.409 1.597e-02 3.259e-02
 [411,] 0.410 1.599e-02 3.261e-02
 [412,] 0.411 1.601e-02 3.262e-02
 [413,] 0.412 1.603e-02 3.264e-02
 [414,] 0.413 1.604e-02 3.265e-02
 [415,] 0.414 1.606e-02 3.267e-02
 [416,] 0.415 1.607e-02 3.269e-02
 [417,] 0.416 1.609e-02 3.270e-02
 [418,] 0.417 1.611e-02 3.272e-02
 [419,] 0.418 1.612e-02 3.273e-02
 [420,] 0.419 1.614e-02 3.275e-02
 [421,] 0.420 1.615e-02 3.276e-02
 [422,] 0.421 1.617e-02 3.278e-02
 [423,] 0.422 1.618e-02 3.279e-02
 [424,] 0.423 1.620e-02 3.281e-02
 [425,] 0.424 1.621e-02 3.282e-02
 [426,] 0.425 1.623e-02 3.284e-02
 [427,] 0.426 1.624e-02 3.285e-02
 [428,] 0.427 1.625e-02 3.287e-02
 [429,] 0.428 1.627e-02 3.288e-02
 [430,] 0.429 1.628e-02 3.290e-02
 [431,] 0.430 1.629e-02 3.291e-02
 [432,] 0.431 1.631e-02 3.292e-02
 [433,] 0.432 1.632e-02 3.294e-02
 [434,] 0.433 1.633e-02 3.295e-02
 [435,] 0.434 1.634e-02 3.297e-02
 [436,] 0.435 1.636e-02 3.298e-02
 [437,] 0.436 1.637e-02 3.299e-02
 [438,] 0.437 1.638e-02 3.301e-02
 [439,] 0.438 1.639e-02 3.302e-02
 [440,] 0.439 1.640e-02 3.303e-02
 [441,] 0.440 1.641e-02 3.304e-02
 [442,] 0.441 1.642e-02 3.306e-02
 [443,] 0.442 1.644e-02 3.307e-02
 [444,] 0.443 1.645e-02 3.308e-02
 [445,] 0.444 1.646e-02 3.309e-02
 [446,] 0.445 1.647e-02 3.311e-02
 [447,] 0.446 1.648e-02 3.312e-02
 [448,] 0.447 1.649e-02 3.313e-02
 [449,] 0.448 1.650e-02 3.314e-02
 [450,] 0.449 1.650e-02 3.315e-02
 [451,] 0.450 1.651e-02 3.316e-02
 [452,] 0.451 1.652e-02 3.318e-02
 [453,] 0.452 1.653e-02 3.319e-02
 [454,] 0.453 1.654e-02 3.320e-02
 [455,] 0.454 1.655e-02 3.321e-02
 [456,] 0.455 1.656e-02 3.322e-02
 [457,] 0.456 1.656e-02 3.323e-02
 [458,] 0.457 1.657e-02 3.324e-02
 [459,] 0.458 1.658e-02 3.325e-02
 [460,] 0.459 1.659e-02 3.326e-02
 [461,] 0.460 1.659e-02 3.327e-02
 [462,] 0.461 1.660e-02 3.328e-02
 [463,] 0.462 1.661e-02 3.328e-02
 [464,] 0.463 1.661e-02 3.329e-02
 [465,] 0.464 1.662e-02 3.330e-02
 [466,] 0.465 1.663e-02 3.331e-02
 [467,] 0.466 1.663e-02 3.332e-02
 [468,] 0.467 1.664e-02 3.333e-02
 [469,] 0.468 1.664e-02 3.333e-02
 [470,] 0.469 1.665e-02 3.334e-02
 [471,] 0.470 1.665e-02 3.335e-02
 [472,] 0.471 1.666e-02 3.336e-02
 [473,] 0.472 1.666e-02 3.336e-02
 [474,] 0.473 1.667e-02 3.337e-02
 [475,] 0.474 1.667e-02 3.338e-02
 [476,] 0.475 1.668e-02 3.338e-02
 [477,] 0.476 1.668e-02 3.339e-02
 [478,] 0.477 1.668e-02 3.339e-02
 [479,] 0.478 1.669e-02 3.340e-02
 [480,] 0.479 1.669e-02 3.340e-02
 [481,] 0.480 1.670e-02 3.341e-02
 [482,] 0.481 1.670e-02 3.341e-02
 [483,] 0.482 1.670e-02 3.342e-02
 [484,] 0.483 1.670e-02 3.342e-02
 [485,] 0.484 1.671e-02 3.343e-02
 [486,] 0.485 1.671e-02 3.343e-02
 [487,] 0.486 1.671e-02 3.343e-02
 [488,] 0.487 1.671e-02 3.344e-02
 [489,] 0.488 1.672e-02 3.344e-02
 [490,] 0.489 1.672e-02 3.344e-02
 [491,] 0.490 1.672e-02 3.345e-02
 [492,] 0.491 1.672e-02 3.345e-02
 [493,] 0.492 1.672e-02 3.345e-02
 [494,] 0.493 1.672e-02 3.345e-02
 [495,] 0.494 1.673e-02 3.345e-02
 [496,] 0.495 1.673e-02 3.346e-02
 [497,] 0.496 1.673e-02 3.346e-02
 [498,] 0.497 1.673e-02 3.346e-02
 [499,] 0.498 1.673e-02 3.346e-02
 [500,] 0.499 1.673e-02 3.346e-02
 [501,] 0.500 1.673e-02 3.346e-02
 [502,] 0.501 1.673e-02 3.346e-02
 [503,] 0.502 1.673e-02 3.346e-02
 [504,] 0.503 1.673e-02 3.346e-02
 [505,] 0.504 1.673e-02 3.346e-02
 [506,] 0.505 1.673e-02 3.346e-02
 [507,] 0.506 1.673e-02 3.345e-02
 [508,] 0.507 1.673e-02 3.345e-02
 [509,] 0.508 1.673e-02 3.345e-02
 [510,] 0.509 1.673e-02 3.345e-02
 [511,] 0.510 1.673e-02 3.345e-02
 [512,] 0.511 1.673e-02 3.344e-02
 [513,] 0.512 1.672e-02 3.344e-02
 [514,] 0.513 1.672e-02 3.344e-02
 [515,] 0.514 1.672e-02 3.343e-02
 [516,] 0.515 1.672e-02 3.343e-02
 [517,] 0.516 1.672e-02 3.343e-02
 [518,] 0.517 1.672e-02 3.342e-02
 [519,] 0.518 1.672e-02 3.342e-02
 [520,] 0.519 1.672e-02 3.341e-02
 [521,] 0.520 1.671e-02 3.341e-02
 [522,] 0.521 1.671e-02 3.340e-02
 [523,] 0.522 1.671e-02 3.340e-02
 [524,] 0.523 1.671e-02 3.339e-02
 [525,] 0.524 1.671e-02 3.339e-02
 [526,] 0.525 1.671e-02 3.338e-02
 [527,] 0.526 1.670e-02 3.338e-02
 [528,] 0.527 1.670e-02 3.337e-02
 [529,] 0.528 1.670e-02 3.336e-02
 [530,] 0.529 1.670e-02 3.336e-02
 [531,] 0.530 1.670e-02 3.335e-02
 [532,] 0.531 1.669e-02 3.334e-02
 [533,] 0.532 1.669e-02 3.333e-02
 [534,] 0.533 1.669e-02 3.333e-02
 [535,] 0.534 1.669e-02 3.332e-02
 [536,] 0.535 1.668e-02 3.331e-02
 [537,] 0.536 1.668e-02 3.330e-02
 [538,] 0.537 1.668e-02 3.329e-02
 [539,] 0.538 1.668e-02 3.328e-02
 [540,] 0.539 1.668e-02 3.328e-02
 [541,] 0.540 1.667e-02 3.327e-02
 [542,] 0.541 1.667e-02 3.326e-02
 [543,] 0.542 1.667e-02 3.325e-02
 [544,] 0.543 1.667e-02 3.324e-02
 [545,] 0.544 1.666e-02 3.323e-02
 [546,] 0.545 1.666e-02 3.322e-02
 [547,] 0.546 1.666e-02 3.321e-02
 [548,] 0.547 1.666e-02 3.320e-02
 [549,] 0.548 1.666e-02 3.319e-02
 [550,] 0.549 1.665e-02 3.318e-02
 [551,] 0.550 1.665e-02 3.316e-02
 [552,] 0.551 1.665e-02 3.315e-02
 [553,] 0.552 1.665e-02 3.314e-02
 [554,] 0.553 1.664e-02 3.313e-02
 [555,] 0.554 1.664e-02 3.312e-02
 [556,] 0.555 1.664e-02 3.311e-02
 [557,] 0.556 1.664e-02 3.309e-02
 [558,] 0.557 1.664e-02 3.308e-02
 [559,] 0.558 1.664e-02 3.307e-02
 [560,] 0.559 1.663e-02 3.306e-02
 [561,] 0.560 1.663e-02 3.304e-02
 [562,] 0.561 1.663e-02 3.303e-02
 [563,] 0.562 1.663e-02 3.302e-02
 [564,] 0.563 1.663e-02 3.301e-02
 [565,] 0.564 1.663e-02 3.299e-02
 [566,] 0.565 1.662e-02 3.298e-02
 [567,] 0.566 1.662e-02 3.297e-02
 [568,] 0.567 1.662e-02 3.295e-02
 [569,] 0.568 1.662e-02 3.294e-02
 [570,] 0.569 1.662e-02 3.292e-02
 [571,] 0.570 1.662e-02 3.291e-02
 [572,] 0.571 1.662e-02 3.290e-02
 [573,] 0.572 1.662e-02 3.288e-02
 [574,] 0.573 1.661e-02 3.287e-02
 [575,] 0.574 1.661e-02 3.285e-02
 [576,] 0.575 1.661e-02 3.284e-02
 [577,] 0.576 1.661e-02 3.282e-02
 [578,] 0.577 1.661e-02 3.281e-02
 [579,] 0.578 1.661e-02 3.279e-02
 [580,] 0.579 1.661e-02 3.278e-02
 [581,] 0.580 1.661e-02 3.276e-02
 [582,] 0.581 1.661e-02 3.275e-02
 [583,] 0.582 1.661e-02 3.273e-02
 [584,] 0.583 1.661e-02 3.272e-02
 [585,] 0.584 1.661e-02 3.270e-02
 [586,] 0.585 1.661e-02 3.269e-02
 [587,] 0.586 1.661e-02 3.267e-02
 [588,] 0.587 1.661e-02 3.265e-02
 [589,] 0.588 1.661e-02 3.264e-02
 [590,] 0.589 1.661e-02 3.262e-02
 [591,] 0.590 1.661e-02 3.261e-02
 [592,] 0.591 1.661e-02 3.259e-02
 [593,] 0.592 1.662e-02 3.257e-02
 [594,] 0.593 1.662e-02 3.256e-02
 [595,] 0.594 1.662e-02 3.254e-02
 [596,] 0.595 1.662e-02 3.252e-02
 [597,] 0.596 1.662e-02 3.251e-02
 [598,] 0.597 1.662e-02 3.249e-02
 [599,] 0.598 1.662e-02 3.247e-02
 [600,] 0.599 1.662e-02 3.245e-02
 [601,] 0.600 1.663e-02 3.244e-02
 [602,] 0.601 1.663e-02 3.242e-02
 [603,] 0.602 1.663e-02 3.240e-02
 [604,] 0.603 1.663e-02 3.239e-02
 [605,] 0.604 1.663e-02 3.237e-02
 [606,] 0.605 1.663e-02 3.235e-02
 [607,] 0.606 1.664e-02 3.233e-02
 [608,] 0.607 1.664e-02 3.231e-02
 [609,] 0.608 1.664e-02 3.230e-02
 [610,] 0.609 1.664e-02 3.228e-02
 [611,] 0.610 1.665e-02 3.226e-02
 [612,] 0.611 1.665e-02 3.224e-02
 [613,] 0.612 1.665e-02 3.222e-02
 [614,] 0.613 1.665e-02 3.221e-02
 [615,] 0.614 1.666e-02 3.219e-02
 [616,] 0.615 1.666e-02 3.217e-02
 [617,] 0.616 1.666e-02 3.215e-02
 [618,] 0.617 1.666e-02 3.213e-02
 [619,] 0.618 1.667e-02 3.211e-02
 [620,] 0.619 1.667e-02 3.209e-02
 [621,] 0.620 1.667e-02 3.207e-02
 [622,] 0.621 1.668e-02 3.205e-02
 [623,] 0.622 1.668e-02 3.203e-02
 [624,] 0.623 1.668e-02 3.201e-02
 [625,] 0.624 1.668e-02 3.199e-02
 [626,] 0.625 1.669e-02 3.197e-02
 [627,] 0.626 1.669e-02 3.195e-02
 [628,] 0.627 1.669e-02 3.193e-02
 [629,] 0.628 1.670e-02 3.191e-02
 [630,] 0.629 1.670e-02 3.189e-02
 [631,] 0.630 1.670e-02 3.187e-02
 [632,] 0.631 1.671e-02 3.185e-02
 [633,] 0.632 1.671e-02 3.183e-02
 [634,] 0.633 1.671e-02 3.181e-02
 [635,] 0.634 1.672e-02 3.179e-02
 [636,] 0.635 1.672e-02 3.177e-02
 [637,] 0.636 1.672e-02 3.174e-02
 [638,] 0.637 1.673e-02 3.172e-02
 [639,] 0.638 1.673e-02 3.170e-02
 [640,] 0.639 1.673e-02 3.168e-02
 [641,] 0.640 1.674e-02 3.166e-02
 [642,] 0.641 1.674e-02 3.163e-02
 [643,] 0.642 1.674e-02 3.161e-02
 [644,] 0.643 1.675e-02 3.159e-02
 [645,] 0.644 1.675e-02 3.156e-02
 [646,] 0.645 1.675e-02 3.154e-02
 [647,] 0.646 1.675e-02 3.152e-02
 [648,] 0.647 1.676e-02 3.149e-02
 [649,] 0.648 1.676e-02 3.147e-02
 [650,] 0.649 1.676e-02 3.144e-02
 [651,] 0.650 1.677e-02 3.142e-02
 [652,] 0.651 1.677e-02 3.139e-02
 [653,] 0.652 1.677e-02 3.137e-02
 [654,] 0.653 1.677e-02 3.134e-02
 [655,] 0.654 1.677e-02 3.131e-02
 [656,] 0.655 1.678e-02 3.129e-02
 [657,] 0.656 1.678e-02 3.126e-02
 [658,] 0.657 1.678e-02 3.123e-02
 [659,] 0.658 1.678e-02 3.121e-02
 [660,] 0.659 1.678e-02 3.118e-02
 [661,] 0.660 1.678e-02 3.115e-02
 [662,] 0.661 1.678e-02 3.112e-02
 [663,] 0.662 1.679e-02 3.109e-02
 [664,] 0.663 1.679e-02 3.106e-02
 [665,] 0.664 1.679e-02 3.104e-02
 [666,] 0.665 1.679e-02 3.101e-02
 [667,] 0.666 1.679e-02 3.097e-02
 [668,] 0.667 1.679e-02 3.094e-02
 [669,] 0.668 1.679e-02 3.091e-02
 [670,] 0.669 1.679e-02 3.088e-02
 [671,] 0.670 1.679e-02 3.085e-02
 [672,] 0.671 1.678e-02 3.082e-02
 [673,] 0.672 1.678e-02 3.078e-02
 [674,] 0.673 1.678e-02 3.075e-02
 [675,] 0.674 1.678e-02 3.072e-02
 [676,] 0.675 1.678e-02 3.068e-02
 [677,] 0.676 1.678e-02 3.065e-02
 [678,] 0.677 1.677e-02 3.061e-02
 [679,] 0.678 1.677e-02 3.058e-02
 [680,] 0.679 1.677e-02 3.054e-02
 [681,] 0.680 1.676e-02 3.050e-02
 [682,] 0.681 1.676e-02 3.046e-02
 [683,] 0.682 1.675e-02 3.043e-02
 [684,] 0.683 1.675e-02 3.039e-02
 [685,] 0.684 1.675e-02 3.035e-02
 [686,] 0.685 1.674e-02 3.031e-02
 [687,] 0.686 1.673e-02 3.027e-02
 [688,] 0.687 1.673e-02 3.023e-02
 [689,] 0.688 1.672e-02 3.018e-02
 [690,] 0.689 1.672e-02 3.014e-02
 [691,] 0.690 1.671e-02 3.010e-02
 [692,] 0.691 1.670e-02 3.006e-02
 [693,] 0.692 1.669e-02 3.001e-02
 [694,] 0.693 1.668e-02 2.997e-02
 [695,] 0.694 1.668e-02 2.992e-02
 [696,] 0.695 1.667e-02 2.987e-02
 [697,] 0.696 1.666e-02 2.983e-02
 [698,] 0.697 1.665e-02 2.978e-02
 [699,] 0.698 1.664e-02 2.973e-02
 [700,] 0.699 1.663e-02 2.968e-02
 [701,] 0.700 1.661e-02 2.963e-02
 [702,] 0.701 1.660e-02 2.958e-02
 [703,] 0.702 1.659e-02 2.953e-02
 [704,] 0.703 1.658e-02 2.948e-02
 [705,] 0.704 1.656e-02 2.942e-02
 [706,] 0.705 1.655e-02 2.937e-02
 [707,] 0.706 1.654e-02 2.931e-02
 [708,] 0.707 1.652e-02 2.926e-02
 [709,] 0.708 1.651e-02 2.920e-02
 [710,] 0.709 1.649e-02 2.915e-02
 [711,] 0.710 1.647e-02 2.909e-02
 [712,] 0.711 1.646e-02 2.903e-02
 [713,] 0.712 1.644e-02 2.897e-02
 [714,] 0.713 1.642e-02 2.891e-02
 [715,] 0.714 1.640e-02 2.885e-02
 [716,] 0.715 1.638e-02 2.878e-02
 [717,] 0.716 1.636e-02 2.872e-02
 [718,] 0.717 1.634e-02 2.866e-02
 [719,] 0.718 1.632e-02 2.859e-02
 [720,] 0.719 1.630e-02 2.852e-02
 [721,] 0.720 1.628e-02 2.846e-02
 [722,] 0.721 1.625e-02 2.839e-02
 [723,] 0.722 1.623e-02 2.832e-02
 [724,] 0.723 1.620e-02 2.825e-02
 [725,] 0.724 1.618e-02 2.818e-02
 [726,] 0.725 1.615e-02 2.811e-02
 [727,] 0.726 1.613e-02 2.803e-02
 [728,] 0.727 1.610e-02 2.796e-02
 [729,] 0.728 1.607e-02 2.788e-02
 [730,] 0.729 1.604e-02 2.781e-02
 [731,] 0.730 1.602e-02 2.773e-02
 [732,] 0.731 1.599e-02 2.765e-02
 [733,] 0.732 1.596e-02 2.757e-02
 [734,] 0.733 1.593e-02 2.749e-02
 [735,] 0.734 1.589e-02 2.741e-02
 [736,] 0.735 1.586e-02 2.733e-02
 [737,] 0.736 1.583e-02 2.724e-02
 [738,] 0.737 1.579e-02 2.716e-02
 [739,] 0.738 1.576e-02 2.707e-02
 [740,] 0.739 1.572e-02 2.699e-02
 [741,] 0.740 1.569e-02 2.690e-02
 [742,] 0.741 1.565e-02 2.681e-02
 [743,] 0.742 1.561e-02 2.672e-02
 [744,] 0.743 1.558e-02 2.663e-02
 [745,] 0.744 1.554e-02 2.654e-02
 [746,] 0.745 1.550e-02 2.644e-02
 [747,] 0.746 1.546e-02 2.635e-02
 [748,] 0.747 1.542e-02 2.625e-02
 [749,] 0.748 1.537e-02 2.616e-02
 [750,] 0.749 1.533e-02 2.606e-02
 [751,] 0.750 1.529e-02 2.596e-02
 [752,] 0.751 1.524e-02 2.586e-02
 [753,] 0.752 1.520e-02 2.576e-02
 [754,] 0.753 1.515e-02 2.565e-02
 [755,] 0.754 1.511e-02 2.555e-02
 [756,] 0.755 1.506e-02 2.544e-02
 [757,] 0.756 1.501e-02 2.534e-02
 [758,] 0.757 1.496e-02 2.523e-02
 [759,] 0.758 1.491e-02 2.512e-02
 [760,] 0.759 1.486e-02 2.501e-02
 [761,] 0.760 1.481e-02 2.490e-02
 [762,] 0.761 1.476e-02 2.479e-02
 [763,] 0.762 1.471e-02 2.468e-02
 [764,] 0.763 1.465e-02 2.456e-02
 [765,] 0.764 1.460e-02 2.445e-02
 [766,] 0.765 1.454e-02 2.433e-02
 [767,] 0.766 1.449e-02 2.421e-02
 [768,] 0.767 1.443e-02 2.410e-02
 [769,] 0.768 1.438e-02 2.398e-02
 [770,] 0.769 1.432e-02 2.385e-02
 [771,] 0.770 1.426e-02 2.373e-02
 [772,] 0.771 1.420e-02 2.361e-02
 [773,] 0.772 1.414e-02 2.348e-02
 [774,] 0.773 1.408e-02 2.336e-02
 [775,] 0.774 1.402e-02 2.323e-02
 [776,] 0.775 1.395e-02 2.311e-02
 [777,] 0.776 1.389e-02 2.298e-02
 [778,] 0.777 1.382e-02 2.285e-02
 [779,] 0.778 1.376e-02 2.272e-02
 [780,] 0.779 1.369e-02 2.258e-02
 [781,] 0.780 1.363e-02 2.245e-02
 [782,] 0.781 1.356e-02 2.232e-02
 [783,] 0.782 1.349e-02 2.218e-02
 [784,] 0.783 1.342e-02 2.204e-02
 [785,] 0.784 1.335e-02 2.191e-02
 [786,] 0.785 1.328e-02 2.177e-02
 [787,] 0.786 1.321e-02 2.163e-02
 [788,] 0.787 1.314e-02 2.149e-02
 [789,] 0.788 1.307e-02 2.135e-02
 [790,] 0.789 1.300e-02 2.120e-02
 [791,] 0.790 1.292e-02 2.106e-02
 [792,] 0.791 1.285e-02 2.092e-02
 [793,] 0.792 1.277e-02 2.077e-02
 [794,] 0.793 1.270e-02 2.063e-02
 [795,] 0.794 1.262e-02 2.048e-02
 [796,] 0.795 1.254e-02 2.033e-02
 [797,] 0.796 1.246e-02 2.018e-02
 [798,] 0.797 1.239e-02 2.003e-02
 [799,] 0.798 1.231e-02 1.988e-02
 [800,] 0.799 1.223e-02 1.973e-02
 [801,] 0.800 1.215e-02 1.958e-02
 [802,] 0.801 1.207e-02 1.942e-02
 [803,] 0.802 1.198e-02 1.927e-02
 [804,] 0.803 1.190e-02 1.912e-02
 [805,] 0.804 1.182e-02 1.896e-02
 [806,] 0.805 1.173e-02 1.880e-02
 [807,] 0.806 1.165e-02 1.865e-02
 [808,] 0.807 1.157e-02 1.849e-02
 [809,] 0.808 1.148e-02 1.833e-02
 [810,] 0.809 1.139e-02 1.817e-02
 [811,] 0.810 1.131e-02 1.801e-02
 [812,] 0.811 1.122e-02 1.785e-02
 [813,] 0.812 1.113e-02 1.769e-02
 [814,] 0.813 1.104e-02 1.753e-02
 [815,] 0.814 1.096e-02 1.737e-02
 [816,] 0.815 1.087e-02 1.720e-02
 [817,] 0.816 1.078e-02 1.704e-02
 [818,] 0.817 1.069e-02 1.687e-02
 [819,] 0.818 1.060e-02 1.671e-02
 [820,] 0.819 1.051e-02 1.655e-02
 [821,] 0.820 1.041e-02 1.638e-02
 [822,] 0.821 1.032e-02 1.621e-02
 [823,] 0.822 1.023e-02 1.605e-02
 [824,] 0.823 1.014e-02 1.588e-02
 [825,] 0.824 1.004e-02 1.571e-02
 [826,] 0.825 9.951e-03 1.555e-02
 [827,] 0.826 9.857e-03 1.538e-02
 [828,] 0.827 9.763e-03 1.521e-02
 [829,] 0.828 9.668e-03 1.504e-02
 [830,] 0.829 9.573e-03 1.488e-02
 [831,] 0.830 9.478e-03 1.471e-02
 [832,] 0.831 9.382e-03 1.454e-02
 [833,] 0.832 9.286e-03 1.437e-02
 [834,] 0.833 9.190e-03 1.420e-02
 [835,] 0.834 9.094e-03 1.403e-02
 [836,] 0.835 8.997e-03 1.386e-02
 [837,] 0.836 8.900e-03 1.369e-02
 [838,] 0.837 8.803e-03 1.352e-02
 [839,] 0.838 8.706e-03 1.335e-02
 [840,] 0.839 8.608e-03 1.318e-02
 [841,] 0.840 8.510e-03 1.302e-02
 [842,] 0.841 8.413e-03 1.285e-02
 [843,] 0.842 8.315e-03 1.268e-02
 [844,] 0.843 8.216e-03 1.251e-02
 [845,] 0.844 8.118e-03 1.234e-02
 [846,] 0.845 8.020e-03 1.217e-02
 [847,] 0.846 7.921e-03 1.200e-02
 [848,] 0.847 7.823e-03 1.184e-02
 [849,] 0.848 7.724e-03 1.167e-02
 [850,] 0.849 7.626e-03 1.150e-02
 [851,] 0.850 7.527e-03 1.133e-02
 [852,] 0.851 7.429e-03 1.117e-02
 [853,] 0.852 7.330e-03 1.100e-02
 [854,] 0.853 7.231e-03 1.083e-02
 [855,] 0.854 7.133e-03 1.067e-02
 [856,] 0.855 7.034e-03 1.050e-02
 [857,] 0.856 6.936e-03 1.034e-02
 [858,] 0.857 6.838e-03 1.017e-02
 [859,] 0.858 6.740e-03 1.001e-02
 [860,] 0.859 6.642e-03 9.849e-03
 [861,] 0.860 6.544e-03 9.687e-03
 [862,] 0.861 6.446e-03 9.525e-03
 [863,] 0.862 6.349e-03 9.365e-03
 [864,] 0.863 6.251e-03 9.205e-03
 [865,] 0.864 6.154e-03 9.045e-03
 [866,] 0.865 6.057e-03 8.887e-03
 [867,] 0.866 5.961e-03 8.729e-03
 [868,] 0.867 5.865e-03 8.572e-03
 [869,] 0.868 5.769e-03 8.416e-03
 [870,] 0.869 5.673e-03 8.261e-03
 [871,] 0.870 5.578e-03 8.107e-03
 [872,] 0.871 5.483e-03 7.953e-03
 [873,] 0.872 5.388e-03 7.801e-03
 [874,] 0.873 5.294e-03 7.650e-03
 [875,] 0.874 5.200e-03 7.499e-03
 [876,] 0.875 5.106e-03 7.350e-03
 [877,] 0.876 5.013e-03 7.202e-03
 [878,] 0.877 4.921e-03 7.055e-03
 [879,] 0.878 4.829e-03 6.909e-03
 [880,] 0.879 4.737e-03 6.764e-03
 [881,] 0.880 4.646e-03 6.621e-03
 [882,] 0.881 4.555e-03 6.478e-03
 [883,] 0.882 4.465e-03 6.337e-03
 [884,] 0.883 4.376e-03 6.197e-03
 [885,] 0.884 4.287e-03 6.058e-03
 [886,] 0.885 4.199e-03 5.921e-03
 [887,] 0.886 4.111e-03 5.785e-03
 [888,] 0.887 4.024e-03 5.650e-03
 [889,] 0.888 3.938e-03 5.517e-03
 [890,] 0.889 3.852e-03 5.385e-03
 [891,] 0.890 3.767e-03 5.255e-03
 [892,] 0.891 3.682e-03 5.126e-03
 [893,] 0.892 3.599e-03 4.998e-03
 [894,] 0.893 3.516e-03 4.872e-03
 [895,] 0.894 3.434e-03 4.747e-03
 [896,] 0.895 3.352e-03 4.624e-03
 [897,] 0.896 3.272e-03 4.503e-03
 [898,] 0.897 3.192e-03 4.383e-03
 [899,] 0.898 3.113e-03 4.264e-03
 [900,] 0.899 3.034e-03 4.147e-03
 [901,] 0.900 2.957e-03 4.032e-03
 [902,] 0.901 2.880e-03 3.918e-03
 [903,] 0.902 2.805e-03 3.806e-03
 [904,] 0.903 2.730e-03 3.696e-03
 [905,] 0.904 2.656e-03 3.587e-03
 [906,] 0.905 2.583e-03 3.480e-03
 [907,] 0.906 2.511e-03 3.374e-03
 [908,] 0.907 2.440e-03 3.271e-03
 [909,] 0.908 2.369e-03 3.169e-03
 [910,] 0.909 2.300e-03 3.068e-03
 [911,] 0.910 2.232e-03 2.970e-03
 [912,] 0.911 2.165e-03 2.873e-03
 [913,] 0.912 2.098e-03 2.778e-03
 [914,] 0.913 2.033e-03 2.684e-03
 [915,] 0.914 1.969e-03 2.593e-03
 [916,] 0.915 1.905e-03 2.503e-03
 [917,] 0.916 1.843e-03 2.415e-03
 [918,] 0.917 1.782e-03 2.329e-03
 [919,] 0.918 1.722e-03 2.244e-03
 [920,] 0.919 1.663e-03 2.161e-03
 [921,] 0.920 1.605e-03 2.080e-03
 [922,] 0.921 1.548e-03 2.001e-03
 [923,] 0.922 1.492e-03 1.923e-03
 [924,] 0.923 1.437e-03 1.848e-03
 [925,] 0.924 1.383e-03 1.774e-03
 [926,] 0.925 1.331e-03 1.702e-03
 [927,] 0.926 1.279e-03 1.631e-03
 [928,] 0.927 1.229e-03 1.563e-03
 [929,] 0.928 1.180e-03 1.496e-03
 [930,] 0.929 1.131e-03 1.431e-03
 [931,] 0.930 1.084e-03 1.367e-03
 [932,] 0.931 1.039e-03 1.306e-03
 [933,] 0.932 9.937e-04 1.246e-03
 [934,] 0.933 9.500e-04 1.188e-03
 [935,] 0.934 9.075e-04 1.131e-03
 [936,] 0.935 8.660e-04 1.076e-03
 [937,] 0.936 8.257e-04 1.023e-03
 [938,] 0.937 7.865e-04 9.718e-04
 [939,] 0.938 7.484e-04 9.220e-04
 [940,] 0.939 7.115e-04 8.739e-04
 [941,] 0.940 6.756e-04 8.273e-04
 [942,] 0.941 6.408e-04 7.824e-04
 [943,] 0.942 6.072e-04 7.391e-04
 [944,] 0.943 5.746e-04 6.973e-04
 [945,] 0.944 5.431e-04 6.571e-04
 [946,] 0.945 5.127e-04 6.184e-04
 [947,] 0.946 4.833e-04 5.812e-04
 [948,] 0.947 4.550e-04 5.455e-04
 [949,] 0.948 4.278e-04 5.112e-04
 [950,] 0.949 4.016e-04 4.784e-04
 [951,] 0.950 3.764e-04 4.470e-04
 [952,] 0.951 3.523e-04 4.171e-04
 [953,] 0.952 3.291e-04 3.884e-04
 [954,] 0.953 3.070e-04 3.611e-04
 [955,] 0.954 2.858e-04 3.351e-04
 [956,] 0.955 2.656e-04 3.104e-04
 [957,] 0.956 2.463e-04 2.870e-04
 [958,] 0.957 2.280e-04 2.648e-04
 [959,] 0.958 2.105e-04 2.437e-04
 [960,] 0.959 1.940e-04 2.238e-04
 [961,] 0.960 1.783e-04 2.051e-04
 [962,] 0.961 1.635e-04 1.875e-04
 [963,] 0.962 1.496e-04 1.709e-04
 [964,] 0.963 1.364e-04 1.554e-04
 [965,] 0.964 1.241e-04 1.408e-04
 [966,] 0.965 1.125e-04 1.272e-04
 [967,] 0.966 1.016e-04 1.146e-04
 [968,] 0.967 9.154e-05 1.029e-04
 [969,] 0.968 8.214e-05 9.198e-05
 [970,] 0.969 7.341e-05 8.193e-05
 [971,] 0.970 6.534e-05 7.268e-05
 [972,] 0.971 5.790e-05 6.418e-05
 [973,] 0.972 5.107e-05 5.641e-05
 [974,] 0.973 4.481e-05 4.933e-05
 [975,] 0.974 3.910e-05 4.290e-05
 [976,] 0.975 3.392e-05 3.709e-05
 [977,] 0.976 2.924e-05 3.186e-05
 [978,] 0.977 2.503e-05 2.718e-05
 [979,] 0.978 2.127e-05 2.301e-05
 [980,] 0.979 1.792e-05 1.932e-05
 [981,] 0.980 1.496e-05 1.608e-05
 [982,] 0.981 1.237e-05 1.324e-05
 [983,] 0.982 1.011e-05 1.079e-05
 [984,] 0.983 8.165e-06 8.681e-06
 [985,] 0.984 6.503e-06 6.890e-06
 [986,] 0.985 5.099e-06 5.383e-06
 [987,] 0.986 3.927e-06 4.131e-06
 [988,] 0.987 2.963e-06 3.106e-06
 [989,] 0.988 2.184e-06 2.281e-06
 [990,] 0.989 1.565e-06 1.629e-06
 [991,] 0.990 1.085e-06 1.125e-06
 [992,] 0.991 7.225e-07 7.466e-07
 [993,] 0.992 4.579e-07 4.714e-07
 [994,] 0.993 2.724e-07 2.795e-07
 [995,] 0.994 1.493e-07 1.526e-07
 [996,] 0.995 7.307e-08 7.441e-08
 [997,] 0.996 3.038e-08 3.083e-08
 [998,] 0.997 9.757e-09 9.865e-09
 [999,] 0.998 1.956e-09 1.971e-09
[1000,] 0.999 1.241e-10 1.246e-10
[1001,] 1.000 0.000e+00 0.000e+00

$dp
[1] 0.001

$contingency.matrix
           Treatment I Treatment II
Outcome I            2            8
Outcome II           7            3

$alternative
[1] "One sided" "Two sided"

$statistic
[1] 2.247

$nuisance.parameter
[1] 0.666 0.500

$p.value
[1] 0.01679 0.03346

$pooled
[1] TRUE</code></pre>
</div>
<p><strong>Interpretation:</strong> The output includes:</p>
<p>A score statistic (here ≈ 2.24733).</p>
<p>Two nuisance parameter estimates (0.666 for one-sided, 0.500 for
two-sided).</p>
<p>Two p-values in $p.value:</p>
<p>barnard_result$p.value[1] = 0.0167869 (one‐sided)</p>
<p>barnard_result$p.value[2] = 0.0334587 (two‐sided)</p>
<p>Two‐sided p‐value (0.0335): Tests whether the adverse‐event
probabilities differ in either direction. Since 0.0335 &lt; 0.05, we
reject H0</p>
<p>and conclude there is a significant difference in adverse‐event rates
between Medication and Placebo.</p>
<p>One‐sided p‐value (0.0168): Tests specifically whether the Medication
adverse‐event rate is greater than the Placebo rate. Because 0.0168 &lt;
0.05, we also conclude that Medication has a higher adverse‐event
probability than Placebo.</p>
</div>
</div>
</div>
</div>
<p><a id="cochran_armitage_trend_test"></a></p>
<div id="accordionSpoiler44" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler44" aria-expanded="false" aria-controls="collapseSpoiler44">
  <h3 class="accordion-header" id="headingSpoiler44">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cochran–Armitage trend test (ordinal tabel) </h3>
</button>
<div id="collapseSpoiler44" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler44" aria-labelledby="headingSpoiler44">
<div class="accordion-body">
<p>EJ KORREKTURLÆST * <strong>Used for</strong> Testing for a linear
trend in proportions across ordered categories in a 2×k contingency
table.<br>
* <strong>Real-world example:</strong> Assessing whether increasing
levels of prenatal vitamin dose (Low, Medium, High) correspond to higher
rates of healthy birth outcomes (Yes/No).</p>
<p><strong>Assumptions</strong> * Observations are independent.<br>
* Categories of the ordinal predictor have a natural order (e.g., Low
&lt; Medium &lt; High).<br>
* The response is binary within each category (success/failure).<br>
* Expected counts for successes and failures in each category are
sufficiently large for the χ² approximation (generally ≥ 5).</p>
<p><strong>Strengths</strong> * Specifically targets a monotonic
(linear) increase or decrease in the success probability across ordered
groups.<br>
* More powerful than a general χ² test of independence when a linear
trend is present.<br>
* Straightforward to compute via <code>prop.trend.test()</code> in
R.</p>
<p><strong>Weaknesses</strong> * Only detects a linear trend;
non-monotonic patterns (e.g., U-shaped) will be missed.<br>
* Requires correct ordering and spacing of category scores; misordering
invalidates the test.<br>
* Sensitive to small expected counts in any group, which can distort the
chi-square approximation.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> No linear trend in the
probability of a healthy birth outcome across dose levels (slope =
0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> A positive linear
trend exists: higher dose levels correspond to higher healthy birth
rates (slope &gt; 0).</li>
</ul><div class="codewrapper sourceCode" id="cb118">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define counts of healthy outcomes by dose:</span></span>
<span><span class="co">#   Low:    30 healthy, 20 unhealthy</span></span>
<span><span class="co">#   Medium: 40 healthy, 10 unhealthy</span></span>
<span><span class="co">#   High:   45 healthy, 5  unhealthy</span></span>
<span></span>
<span><span class="va">successes</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">45</span><span class="op">)</span>   <span class="co"># number of healthy births in Low, Medium, High</span></span>
<span><span class="va">totals</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>   <span class="co"># total births in each dose group</span></span>
<span><span class="va">scores</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>      <span class="co"># equally spaced scores for Low, Medium, High</span></span>
<span></span>
<span><span class="co"># Perform Cochran–Armitage trend test via prop.trend.test:</span></span>
<span><span class="va">trend_result</span> <span class="op">&lt;-</span> <span class="fu">prop.trend.test</span><span class="op">(</span><span class="va">successes</span>, <span class="va">totals</span>, score <span class="op">=</span> <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">trend_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Chi-squared Test for Trend in Proportions

data:  successes out of totals ,
 using scores: 1 2 3
X-squared = 13, df = 1, p-value = 4e-04</code></pre>
</div>
<p><strong>Interpretation:</strong> The Cochran–Armitage test statistic
χ² = 12.578 with p-value = 3.9^{-4}. Because the p-value is &lt; 0.05,
we reject the null hypothesis. Thus, there is evidence of a positive
linear trend: higher prenatal vitamin doses are associated with higher
healthy birth rates.</p>
</div>
</div>
</div>
</div>
<p><a id="cochran_q_test"></a></p>
<div id="accordionSpoiler45" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler45" aria-expanded="false" aria-controls="collapseSpoiler45">
  <h3 class="accordion-header" id="headingSpoiler45">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cochran’s Q test (≥3 matched proportions) </h3>
</button>
<div id="collapseSpoiler45" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler45" aria-labelledby="headingSpoiler45">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether proportions of a binary
outcome differ across three or more related (matched) groups.<br></li>
<li>
<strong>Real-world example:</strong> Checking if three different
allergy medications have different proportions of symptom relief in the
same set of patients.</li>
</ul><p><strong>Assumptions</strong> * Each subject is measured on the same
binary outcome under each condition (matched/paired design).<br>
* Observations (subjects) are independent of one another.<br>
* The outcome for each subject in each group is binary (e.g., “relief”
vs. “no relief”).</p>
<p><strong>Strengths</strong> * Extends McNemar’s test to more than two
matched proportions.<br>
* Controls for subject‐level variability by using each subject as their
own block.<br>
* Simple test statistic and interpretation via χ² distribution.</p>
<p><strong>Weaknesses</strong> * Only addresses overall difference; does
not indicate which pairs of groups differ (post‐hoc tests
required).<br>
* Sensitive to missing data: any subject missing a response in one
condition must be excluded.<br>
* Assumes no interactions or clustering beyond the matched sets.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The proportion of patients
experiencing symptom relief is the same across all three medications (p₁
= p₂ = p₃).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
medication’s relief proportion differs from the others.</li>
</ul><div class="codewrapper sourceCode" id="cb120">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load DescTools if not already installed:</span></span>
<span><span class="co"># install.packages("DescTools")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">DescTools</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'DescTools'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:car':

    Recode</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb123">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate binary relief outcomes for 12 patients on three medications:</span></span>
<span><span class="co"># 1 = relief, 0 = no relief</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">relief_med1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">relief_med2</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">relief_med3</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a matrix: rows = subjects, columns = medications</span></span>
<span><span class="va">relief_matrix</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">relief_med1</span>, <span class="va">relief_med2</span>, <span class="va">relief_med3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Cochran’s Q test:</span></span>
<span><span class="va">cq_result</span> <span class="op">&lt;-</span> <span class="fu">CochranQTest</span><span class="op">(</span><span class="va">relief_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">cq_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Cochran's Q test

data:  y
Q = 0.29, df = 2, p-value = 0.9</code></pre>
</div>
<p><strong>Interpretation:</strong> Cochran’s Q statistic = 0.286 with
df = 2 and p-value = 0.867. We fail to reject the null hypothesis. Thus,
there is no evidence that relief proportions differ across the three
medications.</p>
</div>
</div>
</div>
</div>
<p><a id="stuart_maxwell_test"></a></p>
<div id="accordionSpoiler46" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler46" aria-expanded="false" aria-controls="collapseSpoiler46">
  <h3 class="accordion-header" id="headingSpoiler46">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Stuart–Maxwell test (marginal homogenitet) </h3>
</button>
<div id="collapseSpoiler46" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler46" aria-labelledby="headingSpoiler46">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing marginal homogeneity in a square
contingency table of paired categorical outcomes (k ≥ 3
categories).<br></li>
<li>
<strong>Real-world example:</strong> Assessing whether patients’
self‐rated pain levels (None, Mild, Moderate, Severe) before and after a
new analgesic are distributed the same way.</li>
</ul><p><strong>Assumptions</strong> * Data consist of paired observations on
the same subjects, each classified into one of k categories at two time
points or under two conditions.<br>
* The contingency table is square (same set of k categories for “before”
and “after”).<br>
* Observations (pairs) are independent of one another.<br>
* No cell has zero counts that prevent the necessary sums for the test
(ideally none of the off‐diagonal cell sums are zero across all
pairs).</p>
<p><strong>Strengths</strong> * Generalizes McNemar’s test to k &gt; 2
categories.<br>
* Specifically tests whether the overall marginal (row vs. column)
distributions are the same.<br>
* Computes a χ²‐statistic based on off‐diagonal discordances,
summarizing all category shifts.</p>
<p><strong>Weaknesses</strong> * Only detects overall marginal changes;
does not indicate which category pairs drive the difference (post‐hoc
needed).<br>
* Sensitive to small sample sizes or sparse off‐diagonal entries (may
lack power or violate asymptotic χ² approximation).<br>
* Assumes symmetry under the null; if many pairs move in one direction
but not the reverse, marginal sums can still balance, potentially
masking certain shifts.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The marginal distribution of
pain levels is the same before and after treatment.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The marginal
distributions differ (some shifts in categories occurred).</li>
</ul><div class="codewrapper sourceCode" id="cb125">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load DescTools if not already installed:</span></span>
<span><span class="co"># install.packages("DescTools")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">DescTools</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate paired pain ratings for 50 patients:</span></span>
<span><span class="co"># Categories: 1=None, 2=Mild, 3=Moderate, 4=Severe</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># After treatment: some improvement for many, some unchanged or worse</span></span>
<span><span class="va">after</span>  <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="fu">pmax</span><span class="op">(</span><span class="va">before</span> <span class="op">+</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a square contingency table of before vs. after:</span></span>
<span><span class="va">pain_table</span> <span class="op">&lt;-</span> <span class="fu">table</span><span class="op">(</span><span class="fu">factor</span><span class="op">(</span><span class="va">before</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>                    <span class="fu">factor</span><span class="op">(</span><span class="va">after</span>,  levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">dimnames</span><span class="op">(</span><span class="va">pain_table</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  Before <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"None"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span>
<span>  After  <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"None"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Stuart–Maxwell test for marginal homogeneity:</span></span>
<span><span class="va">stuart_result</span> <span class="op">&lt;-</span> <span class="fu">StuartMaxwellTest</span><span class="op">(</span><span class="va">pain_table</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the table and test result:</span></span>
<span><span class="va">pain_table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          After
Before     None Mild Moderate Severe
  None        6    0        0      0
  Mild        8    8        1      0
  Moderate    0    4        9      5
  Severe      0    0        6      3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb127">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stuart_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Stuart-Maxwell test

data:  pain_table
chi-squared = 9.9, df = 3, p-value = 0.02</code></pre>
</div>
<p><strong>Interpretation:</strong> The Stuart–Maxwell χ² statistic =
9.89 with df = 3 and p-value = 0.0195. We reject the null hypothesis.
Since the p-value is r round(stuart_result$p.value, 3), we conclude that
the marginal distribution of pain levels differs before vs. after
treatment (some patients shifted categories).</p>
</div>
</div>
</div>
</div>
<p><a id="two_sample_binomial_mh"></a></p>
<div id="accordionSpoiler47" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler47" aria-expanded="false" aria-controls="collapseSpoiler47">
  <h3 class="accordion-header" id="headingSpoiler47">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample test for binomial proportions / Mantel–Haenszel test </h3>
</button>
<div id="collapseSpoiler47" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler47" aria-labelledby="headingSpoiler47">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Comparing two independent binomial
proportions, possibly stratified by a third variable
(Mantel–Haenszel).<br></li>
<li>
<strong>Real-world example:</strong> Assessing whether a new vaccine
reduces infection rates compared to placebo across multiple
clinics.</li>
</ul><p><strong>Assumptions</strong> * Observations within each group (and
stratum, if stratified) are independent.<br>
* Each observation has a binary outcome (success/failure).<br>
* In the unstratified case, the two groups are independent and sample
sizes are sufficiently large for the normal approximation (if using a
z-test or <code>prop.test()</code>).<br>
* For the Mantel–Haenszel test: effects are assumed homogeneous across
strata (common odds ratio).</p>
<p><strong>Strengths</strong> * Simple two‐sample z‐test or χ²‐based
test (<code>prop.test()</code>) for unstratified comparisons.<br>
* Mantel–Haenszel test controls for confounding by stratification,
providing an overall test of association and a pooled odds ratio.<br>
* Exact or asymptotic inference available (Fisher’s exact for small
counts, Mantel–Haenszel χ² for larger).</p>
<p><strong>Weaknesses</strong> * The unstratified z‐test/χ² test can
give misleading results if confounders are present.<br>
* Mantel–Haenszel requires the common‐odds‐ratio assumption; if this
fails (effect modification), the pooled estimate may be invalid.<br>
* Both methods rely on adequate sample sizes in each cell (especially
for asymptotic approximations).</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The infection rates in
Vaccine and Placebo groups are equal across clinics (common odds ratio =
1).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The infection rates
differ between Vaccine and Placebo groups (common odds ratio ≠ 1).</li>
</ul><div class="codewrapper sourceCode" id="cb129">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated data from two clinics (strata):</span></span>
<span><span class="co"># Clinic A: Vaccine (5 infections / 100), Placebo (15 infections / 100)</span></span>
<span><span class="co"># Clinic B: Vaccine (8 infections / 120), Placebo (20 infections / 120)</span></span>
<span></span>
<span><span class="co"># Create a 3‐dimensional array: 2 × 2 × 2 (Treatment × Outcome × Clinic)</span></span>
<span><span class="co"># Dimension names: Treatment = Vaccine, Placebo; Outcome = Infected, NotInfected; Clinic = A, B</span></span>
<span><span class="va">mh_table</span> <span class="op">&lt;-</span> <span class="fu">array</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span>  <span class="fl">5</span>,  <span class="fl">95</span>,   <span class="co"># Clinic A, Vaccine</span></span>
<span>     <span class="fl">15</span>,  <span class="fl">85</span>,   <span class="co"># Clinic A, Placebo</span></span>
<span>      <span class="fl">8</span>, <span class="fl">112</span>,   <span class="co"># Clinic B, Vaccine</span></span>
<span>     <span class="fl">20</span>, <span class="fl">100</span> <span class="op">)</span>, <span class="co"># Clinic B, Placebo</span></span>
<span>  dim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    Treatment <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Vaccine"</span>, <span class="st">"Placebo"</span><span class="op">)</span>,</span>
<span>    Outcome   <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Infected"</span>, <span class="st">"NotInfected"</span><span class="op">)</span>,</span>
<span>    Clinic    <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Mantel–Haenszel test:</span></span>
<span><span class="va">mh_result</span> <span class="op">&lt;-</span> <span class="fu">mantelhaen.test</span><span class="op">(</span><span class="va">mh_table</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">mh_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Mantel-Haenszel chi-squared test without continuity correction

data:  mh_table
Mantel-Haenszel X-squared = 11, df = 1, p-value = 8e-04
alternative hypothesis: true common odds ratio is not equal to 1
95 percent confidence interval:
 0.1702 0.6463
sample estimates:
common odds ratio
           0.3316 </code></pre>
</div>
<p><strong>Interpretation:</strong> The Mantel–Haenszel χ² statistic =
11.275 with df = 1 and p‐value = 7.86^{-4}. We reject the null
hypothesis. Thus, since the p‐value is 0.001, we conclude there is a
significant difference in infection rates between Vaccine and Placebo
after controlling for clinic.</p>
</div>
</div>
</div>
</div>
<p><a id="chi_square_rc"></a></p>
<div id="accordionSpoiler48" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler48" aria-expanded="false" aria-controls="collapseSpoiler48">
  <h3 class="accordion-header" id="headingSpoiler48">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Chi-square test for R×C-tabeller </h3>
</button>
<div id="collapseSpoiler48" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler48" aria-labelledby="headingSpoiler48">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether two categorical variables
(with R rows and C columns) are independent in an R×C contingency
table.<br></li>
<li>
<strong>Real-world example:</strong> Assessing if education level
(High School, Bachelor’s, Master’s, PhD) is associated with preferred
news source (TV, Online, Print) in a survey.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent (each
subject contributes to exactly one cell).<br>
* The table is R×C with mutually exclusive and exhaustive
categories.<br>
* Expected count in each cell is at least 5 for the χ² approximation to
be valid; otherwise consider collapsing categories or using an exact
test.</p>
<p><strong>Strengths</strong> * Simple to compute and interpret via a
single χ² statistic and p-value.<br>
* Applicable to any R×C table, not just 2×2.<br>
* Nonparametric: does not assume any distribution of underlying
continuous variables.</p>
<p><strong>Weaknesses</strong> * Sensitive to small expected
counts—cells with expected &lt; 5 can invalidate the
approximation.<br>
* Does not indicate which specific cells contribute most to the
dependence; follow-up residual analysis or post-hoc tests are
required.<br>
* Requires sufficiently large sample sizes; for sparse tables consider
Fisher’s exact or Monte Carlo methods.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Education level and preferred
news source are independent.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> There is an
association between education level and preferred news source (they are
not independent).</li>
</ul><div class="codewrapper sourceCode" id="cb131">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a 4×3 contingency table: Education × NewsSource</span></span>
<span><span class="co"># Rows: High School, Bachelor’s, Master’s, PhD</span></span>
<span><span class="co"># Columns: TV, Online, Print</span></span>
<span><span class="va">edu_levels</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"HighSchool"</span>, <span class="st">"Bachelors"</span>, <span class="st">"Masters"</span>, <span class="st">"PhD"</span><span class="op">)</span></span>
<span><span class="va">news_sources</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"TV"</span>, <span class="st">"Online"</span>, <span class="st">"Print"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed counts from a survey of 360 respondents:</span></span>
<span><span class="co">#              TV   Online  Print</span></span>
<span><span class="co"># HighSchool   50    40      10</span></span>
<span><span class="co"># Bachelors    45    70      15</span></span>
<span><span class="co"># Masters      30    80      30</span></span>
<span><span class="co"># PhD          10    30      10</span></span>
<span><span class="va">obs_matrix</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">10</span>,</span>
<span>    <span class="fl">45</span>, <span class="fl">70</span>, <span class="fl">15</span>,</span>
<span>    <span class="fl">30</span>, <span class="fl">80</span>, <span class="fl">30</span>,</span>
<span>    <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>Education <span class="op">=</span> <span class="va">edu_levels</span>,</span>
<span>                  NewsSource <span class="op">=</span> <span class="va">news_sources</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform chi-square test of independence:</span></span>
<span><span class="va">chi2_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span><span class="va">obs_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">chi2_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's Chi-squared test

data:  obs_matrix
X-squared = 29, df = 6, p-value = 7e-05</code></pre>
</div>
<p><strong>Interpretation:</strong> The test yields χ² = 28.71 with df =
6 and p-value = 6.91^{-5}. We reject the null hypothesis. Since the
p-value is 0, we conclude there is a significant association between
education level and preferred news source.</p>
<p>If the null is rejected, examine standardized residuals: Standardized
residuals identify which cells contribute most:
<code>r</code>round(chi2_result$stdres, 2)` Cells with |residual| &gt; 2
indicate categories where the observed count deviates substantially from
the expected under independence.</p>
</div>
</div>
</div>
</div>
<p><a id="mantel_trend_test"></a></p>
<div id="accordionSpoiler49" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler49" aria-expanded="false" aria-controls="collapseSpoiler49">
  <h3 class="accordion-header" id="headingSpoiler49">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Chi-square test for trend (Mantel-extension) </h3>
</button>
<div id="collapseSpoiler49" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler49" aria-labelledby="headingSpoiler49">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing for a linear (monotonic)
association between two ordinal variables in an R×C contingency table
(Mantel’s extension of the χ² test).<br></li>
<li>
<strong>Real-world example:</strong> Assessing whether increasing
pain‐severity category (None &lt; Mild &lt; Moderate &lt; Severe) is
associated with increasing level of inflammation marker (Low &lt; Medium
&lt; High) in the same patients.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Both row and column variables are ordinal with a meaningful
order.<br>
* Expected counts in all cells are sufficiently large (≈ ≥ 5) for the χ²
approximation to hold.<br>
* The association between row and column scores is (approximately)
linear on the log‐odds scale.</p>
<p><strong>Strengths</strong> * Specifically targets a linear trend
across ordered categories rather than any arbitrary departure from
independence.<br>
* More powerful than a general χ² test of independence when the true
association is monotonic.<br>
* Accommodates arbitrary R×C tables (not limited to 2×k or k×2).</p>
<p><strong>Weaknesses</strong> * Only detects linear-by-linear
association; non‐monotonic patterns (e.g. U‐shaped) may be missed.<br>
* Requires correct ordering of both row and column
categories—misordering invalidates the test.<br>
* Sensitive to small expected counts in any cell, which can bias the χ²
approximation.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> No linear trend in the
log‐odds of inflammation level across pain‐severity categories (row and
column are independent in a linear sense).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> A positive (or
negative) linear trend exists: higher pain severity is associated with
higher inflammation levels.</li>
</ul><div class="codewrapper sourceCode" id="cb133">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the vcd package if not already installed:</span></span>
<span><span class="co"># install.packages("vcd")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: grid</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb135">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a 4×3 table of PainSeverity (rows) vs. InflammationLevel (columns)</span></span>
<span><span class="co"># PainSeverity: 1=None, 2=Mild, 3=Moderate, 4=Severe</span></span>
<span><span class="co"># InflammationLevel: 1=Low, 2=Medium, 3=High</span></span>
<span><span class="va">ctab</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span>,  <span class="fl">5</span>,    <span class="co"># None  </span></span>
<span>    <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">10</span>,    <span class="co"># Mild</span></span>
<span>    <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">20</span>,    <span class="co"># Moderate</span></span>
<span>     <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">35</span><span class="op">)</span>,   <span class="co"># Severe</span></span>
<span>  nrow    <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  byrow   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    PainSeverity     <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"None"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span>
<span>    InflammationLevel <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign equally spaced scores for each ordinal category:</span></span>
<span><span class="va">row_scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>   <span class="co"># PainSeverity scores</span></span>
<span><span class="va">col_scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>      <span class="co"># InflammationLevel scores</span></span>
<span></span>
<span><span class="co"># Perform Mantel’s linear‐by‐linear association test via CMHtest:</span></span>
<span><span class="va">mantel_result</span> <span class="op">&lt;-</span> <span class="fu">CMHtest</span><span class="op">(</span></span>
<span>  x     <span class="op">=</span> <span class="va">ctab</span>,</span>
<span>  score <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>row <span class="op">=</span> <span class="va">row_scores</span>, col <span class="op">=</span> <span class="va">col_scores</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in CMHtest(x = ctab, score = list(row = row_scores, col = col_scores)): could not find function "CMHtest"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb137">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display results:</span></span>
<span><span class="va">mantel_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'mantel_result' not found</code></pre>
</div>
<p><strong>Interpretation:</strong> The output shows:</p>
<p>A Mantel χ² statistic (linear‐by‐linear association) and its degrees
of freedom (df = 1).</p>
<p>A p‐value testing H₀: “no linear trend in log‐odds of inflammation
across pain severity.”</p>
<p>For example, if you see something like:</p>
<p>Mantel chi‐square statistic = 25.47 on df = 1, p‐value &lt; 0.0001
Because p‐value &lt; 0.05, we reject H₀ and conclude there is a
significant positive linear trend: higher pain‐severity categories are
associated with higher inflammation levels.</p>
<p>If p‐value ≥ 0.05, we would fail to reject H₀, concluding no evidence
of a linear association between pain severity and inflammation
level.</p>
</div>
</div>
</div>
</div>
<p><a id="chi_square_heterogeneity"></a></p>
<div id="accordionSpoiler50" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler50" aria-expanded="false" aria-controls="collapseSpoiler50">
  <h3 class="accordion-header" id="headingSpoiler50">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Chi-square test for heterogenitet (2×k-tabeller) </h3>
</button>
<div id="collapseSpoiler50" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler50" aria-labelledby="headingSpoiler50">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether two groups have the same
distribution across k categories (heterogeneity of proportions in a 2×k
table).<br></li>
<li>
<strong>Real-world example:</strong> Comparing the distribution of
smoking status (Never, Former, Current, Occasional) between males and
females.</li>
</ul><p><strong>Assumptions</strong> * Observations are independent.<br>
* Categories (columns) are mutually exclusive and exhaustive.<br>
* Expected count in each cell is at least 5 for the χ² approximation to
be valid.<br>
* The table is 2×k (two groups by k categories).</p>
<p><strong>Strengths</strong> * Simple to compute via
<code>chisq.test()</code> in R.<br>
* Tests whether proportions differ across all k categories
simultaneously.<br>
* Does not require any parametric distribution beyond categorical
counts.</p>
<p><strong>Weaknesses</strong> * Sensitive to small expected counts; if
many cells have expected &lt; 5, approximation may be invalid.<br>
* Only indicates that distributions differ, not which categories drive
the difference (follow‐up residual or post‐hoc tests needed).<br>
* Requires independence; not suitable for paired or repeated
measures.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The two groups have the same
distribution across the k categories (no heterogeneity).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
category’s proportion differs between the two groups.</li>
</ul><div class="codewrapper sourceCode" id="cb139">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a 2×4 table: Sex (Male/Female) × SmokingStatus (Never, Former, Current, Occasional)</span></span>
<span><span class="co"># Observed counts:</span></span>
<span><span class="co">#            Never  Former  Current  Occasional</span></span>
<span><span class="co"># Male         80      30       50           20</span></span>
<span><span class="co"># Female       90      40       30           10</span></span>
<span></span>
<span><span class="va">obs_matrix</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">80</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">20</span>,</span>
<span>    <span class="fl">90</span>, <span class="fl">40</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  nrow    <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  byrow   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    Sex           <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>,</span>
<span>    SmokingStatus <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Never"</span>, <span class="st">"Former"</span>, <span class="st">"Current"</span>, <span class="st">"Occasional"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform chi-square test for heterogeneity:</span></span>
<span><span class="va">chihet_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span><span class="va">obs_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">chihet_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's Chi-squared test

data:  obs_matrix
X-squared = 10, df = 3, p-value = 0.02</code></pre>
</div>
<p><strong>Interpretation:</strong> The χ² statistic = 10.07 with df = 3
and p-value = 0.018. We reject the null hypothesis. Thus, there is
evidence that the distribution of smoking status differs between males
and females.</p>
<p>To see which categories contribute most, examine standardized
residuals:</p>
<p>-1.59, 1.59, -1.6, 1.6, 2.26, -2.26, 1.75, -1.75 Cells with
|residual| &gt; 2 indicate categories where observed counts deviate
substantially from expected under homogeneity.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="incidens--og-rate-tests">Incidens- og rate-tests<a class="anchor" aria-label="anchor" href="#incidens--og-rate-tests"></a></h2>
<hr class="half-width"><p><a id="one_sample_incidence_rate_test"></a></p>
<div id="accordionSpoiler51" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler51" aria-expanded="false" aria-controls="collapseSpoiler51">
  <h3 class="accordion-header" id="headingSpoiler51">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample test for incidence rates </h3>
</button>
<div id="collapseSpoiler51" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler51" aria-labelledby="headingSpoiler51">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether an observed incidence rate
(events per unit person‐time) differs from a specified rate.<br></li>
<li>
<strong>Real-world example:</strong> Determining if a hospital’s
rate of catheter‐associated infections (per 1,000 patient‐days) equals
the national benchmark.</li>
</ul><p><strong>Assumptions</strong> * Events occur independently and follow
a Poisson process.<br>
* The incidence rate is constant over the observation period.<br>
* Person‐time is measured accurately and non‐overlapping.</p>
<p><strong>Strengths</strong> * Exact test based on the Poisson
distribution—no large‐sample approximation needed.<br>
* Naturally accounts for differing follow‐up times via
person‐time.<br>
* Valid for rare events and small counts.</p>
<p><strong>Weaknesses</strong> * Sensitive to overdispersion (variance
&gt; mean) and violation of Poisson assumptions.<br>
* Cannot adjust for covariates or time‐varying rates.<br>
* Assumes homogeneity of the rate across the period.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The true incidence rate λ = 2
infections per 1,000 patient‐days.<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> λ ≠ 2 infections per
1,000 patient‐days.</li>
</ul><div class="codewrapper sourceCode" id="cb141">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed infections and total patient‐days:</span></span>
<span><span class="va">events</span>    <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">patient_days</span> <span class="op">&lt;-</span> <span class="fl">3500</span>   <span class="co"># total follow‐up time in patient‐days</span></span>
<span></span>
<span><span class="co"># Hypothesized rate (infections per 1 patient‐day):</span></span>
<span><span class="co"># 2 per 1,000 patient‐days = 0.002 per patient‐day</span></span>
<span><span class="va">rate0</span>     <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">/</span> <span class="fl">1000</span>  </span>
<span></span>
<span><span class="co"># Perform one‐sample incidence‐rate test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">events</span>,</span>
<span>                            T <span class="op">=</span> <span class="va">patient_days</span>,</span>
<span>                            r <span class="op">=</span> <span class="va">rate0</span>,</span>
<span>                            alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact Poisson test

data:  events time base: patient_days
number of events = 8, time base = 3500, p-value = 0.7
alternative hypothesis: true event rate is not equal to 0.002
95 percent confidence interval:
 0.0009868 0.0045038
sample estimates:
event rate
  0.002286 </code></pre>
</div>
<p><strong>Interpretation:</strong> The test compares the observed 8
infections over 3,500 patient‐days to the expected rate of 2/1,000
patient‐days (i.e., 7 infections). With a p‐value of r
signif(test_result<span class="math inline">\(p.value, 3), we
r if(test_result\)</span>p.value &lt; 0.05) “reject the null hypothesis”
else “fail to reject the null hypothesis”. Thus, there is r
if(test_result$p.value &lt; 0.05) “evidence that the hospital’s
infection rate differs from 2 per 1,000 patient‐days.” else “no evidence
that the infection rate differs from the benchmark.”</p>
</div>
</div>
</div>
</div>
<p><a id="two_sample_incidence_rates"></a></p>
<div id="accordionSpoiler52" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler52" aria-expanded="false" aria-controls="collapseSpoiler52">
  <h3 class="accordion-header" id="headingSpoiler52">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample comparison of incidence rates </h3>
</button>
<div id="collapseSpoiler52" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler52" aria-labelledby="headingSpoiler52">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p><strong>Used for</strong> * Comparing incidence rates (events per
unit person‐time) between two independent groups.<br>
* <strong>Real-world example:</strong> Determining if Hospital A’s rate
of central‐line infections (per 1,000 catheter‐days) differs from
Hospital B’s rate.</p>
<p><strong>Assumptions</strong> * Events in each group follow a Poisson
process.<br>
* The incidence rate is constant over person‐time within each
group.<br>
* Person‐time is measured accurately and non‐overlapping.<br>
* Groups are independent and there is no unaccounted confounding.</p>
<p><strong>Strengths</strong> * Accounts for differing follow‐up times
via person‐time denominators.<br>
* Provides an exact test (via Poisson) for comparing rates without
relying on large‐sample normal approximations.<br>
* Outputs both a rate‐ratio estimate and confidence interval.</p>
<p><strong>Weaknesses</strong> * Sensitive to violations of the Poisson
assumption (e.g., overdispersion or clustering of events).<br>
* Does not adjust for covariates—only a crude two‐group
comparison.<br>
* Assumes constant risk over time within each group; if rates change,
inference may be biased.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> The two incidence rates are
equal (<span class="math inline">\(\lambda_A =
\lambda_B\)</span>).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The incidence rates
differ (<span class="math inline">\(\lambda_A \neq
\lambda_B\)</span>).</li>
</ul><div class="codewrapper sourceCode" id="cb143">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed events and person-time:</span></span>
<span><span class="va">events_A</span>    <span class="op">&lt;-</span> <span class="fl">15</span>    <span class="co"># e.g., central-line infections in Hospital A</span></span>
<span><span class="va">person_days_A</span> <span class="op">&lt;-</span> <span class="fl">2000</span>  <span class="co"># total catheter-days in Hospital A</span></span>
<span></span>
<span><span class="va">events_B</span>    <span class="op">&lt;-</span> <span class="fl">25</span>    <span class="co"># e.g., central-line infections in Hospital B</span></span>
<span><span class="va">person_days_B</span> <span class="op">&lt;-</span> <span class="fl">3000</span>  <span class="co"># total catheter-days in Hospital B</span></span>
<span></span>
<span><span class="co"># Perform two-sample Poisson test comparing rates:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">events_A</span>, <span class="va">events_B</span><span class="op">)</span>,</span>
<span>  T <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">person_days_A</span>, <span class="va">person_days_B</span><span class="op">)</span>,</span>
<span>  ratio      <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in poisson.test(x = c(events_A, events_B), T = c(person_days_A, : unused argument (ratio = 1)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb145">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact Poisson test

data:  events time base: patient_days
number of events = 8, time base = 3500, p-value = 0.7
alternative hypothesis: true event rate is not equal to 0.002
95 percent confidence interval:
 0.0009868 0.0045038
sample estimates:
event rate
  0.002286 </code></pre>
</div>
<p><strong>Interpretation:</strong> The test reports a rate ratio
(Hospital A vs. Hospital B) = 0.002, with a 95% CI = [0.001, 0.005], and
p-value = 0.702. We fail to reject the null hypothesis. Thus, there is
no evidence to conclude a difference in infection rates between the two
hospitals.</p>
</div>
</div>
</div>
</div>
<p><a id="poisson_trend"></a></p>
<div id="accordionSpoiler53" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler53" aria-expanded="false" aria-controls="collapseSpoiler53">
  <h3 class="accordion-header" id="headingSpoiler53">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Trend-test for incidence rates over flere eksponeringsgrupper </h3>
</button>
<div id="collapseSpoiler53" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler53" aria-labelledby="headingSpoiler53">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether there is a linear trend in
incidence rates across ordered exposure groups.<br></li>
<li>
<strong>Real-world example:</strong> Evaluating whether lung cancer
incidence per 1,000 person‐years increases across smoking intensity
categories (Non‐smoker, Light‐smoker, Heavy‐smoker).</li>
</ul><p><strong>Assumptions</strong> * Events in each group follow a Poisson
process.<br>
* The exposure groups have a natural order and can be assigned numeric
scores (e.g., 0, 1, 2).<br>
* Person‐time denominators are measured accurately and
non‐overlapping.<br>
* The log‐rate of events is linearly related to the numeric score of the
exposure groups.</p>
<p><strong>Strengths</strong> * Directly tests for a dose‐response
(linear) relationship in rates.<br>
* Accounts for differing person‐time across groups via an offset in
Poisson regression.<br>
* Provides an estimate of the rate‐ratio per one‐unit increase in the
exposure score.</p>
<p><strong>Weaknesses</strong> * Only detects a linear trend; non‐linear
patterns across groups may be missed.<br>
* Sensitive to misclassification of exposure group ordering or
scoring.<br>
* Assumes no overdispersion; if variance &gt; mean, inference may be
invalid unless corrected.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> There is no linear trend in
incidence rates across exposure groups (β = 0).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> β ≠ 0 (the log‐rate
changes linearly with the exposure score).</li>
</ul><div class="codewrapper sourceCode" id="cb147">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated data for three smoking categories:</span></span>
<span><span class="co"># Category labels and numeric scores:</span></span>
<span><span class="co">#   0 = Non‐smoker</span></span>
<span><span class="co">#   1 = Light‐smoker</span></span>
<span><span class="co">#   2 = Heavy‐smoker</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  smoke_cat   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Non"</span>, <span class="st">"Light"</span>, <span class="st">"Heavy"</span><span class="op">)</span>, </span>
<span>                       levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Non"</span>,<span class="st">"Light"</span>,<span class="st">"Heavy"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  score       <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  events      <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">12</span>, <span class="fl">30</span>, <span class="fl">55</span><span class="op">)</span>,    <span class="co"># number of lung cancer cases</span></span>
<span>  person_years <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5000</span>, <span class="fl">4000</span>, <span class="fl">3000</span><span class="op">)</span>  <span class="co"># total person‐years in each category</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Poisson regression with offset(log(person_years)):</span></span>
<span><span class="va">trend_fit</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">events</span> <span class="op">~</span> <span class="va">score</span> <span class="op">+</span> <span class="fu">offset</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">person_years</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu">poisson</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary (including coefficient and Wald test for trend):</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">trend_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = events ~ score + offset(log(person_years)), family = poisson(link = "log"),
    data = data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)   -5.949      0.228  -26.10  &lt; 2e-16 ***
score          0.984      0.141    6.96  3.3e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 56.44269  on 2  degrees of freedom
Residual deviance:  0.25604  on 1  degrees of freedom
AIC: 19.69

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The estimated coefficient for score is 0.984.</p>
<p>Exponentiating gives a rate ratio per one‐unit increase in exposure
score:</p>
<p><span class="math display">\[\text{RR per category} =
\exp\bigl(\beta_{\text{score}}\bigr)\]</span></p>
<p>From summary(trend_fit), the Wald‐type <span class="math inline">\(z\)</span>‐value for score has p‐value =
3.35^{-12}.</p>
<p>If this p‐value <span class="math inline">\(&lt; 0.05\)</span>, we
reject <span class="math inline">\(H_{0}\)</span>, indicating a
significant linear trend in incidence rates across exposure
categories.</p>
<p>If the p‐value <span class="math inline">\(\ge 0.05\)</span>, we fail
to reject <span class="math inline">\(H_{0}\)</span>, indicating no
evidence of a linear trend.</p>
<p>For example, if <span class="math inline">\(\widehat{\beta}_{\text{score}} = 0.45\)</span> (p
= 0.002), then</p>
<p><span class="math inline">\(\text{RR} = \exp(0.45) \approx
1.57\)</span> per category increase, and since p <span class="math inline">\(&lt;0.05\)</span>, we conclude that incidence
rises significantly from Non‐smoker → Light‐smoker → Heavy‐smoker.</p>
</div>
</div>
</div>
</div>
<p><a id="Exact_rate_ratio_test"></a></p>
<div id="accordionSpoiler54" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler54" aria-expanded="false" aria-controls="collapseSpoiler54">
  <h3 class="accordion-header" id="headingSpoiler54">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Exact rate ratio test </h3>
</button>
<div id="collapseSpoiler54" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler54" aria-labelledby="headingSpoiler54">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing whether the incidence rate in one
group differs from that in another group using an exact (Poisson) method
for the rate ratio.<br></li>
<li>
<strong>Real-world example:</strong> Comparing ICU infection rates
between two antibiotic regimens (A vs. B) when event counts and
person‐time are relatively small.</li>
</ul><p><strong>Assumptions</strong> * Events in each group follow a Poisson
process.<br>
* The rate within each group is constant over the observed
person‐time.<br>
* Person‐time denominators are measured accurately and
non‐overlapping.<br>
* Groups are independent (no shared person‐time or overlapping
exposure).</p>
<p><strong>Strengths</strong> * Provides an exact confidence interval
for the rate ratio and an exact test p‐value without relying on
large‐sample normal approximations.<br>
* Valid for small counts or rare events.<br>
* Directly tests the null hypothesis <span class="math inline">\(\text{RR} = 1\)</span> (where <span class="math inline">\(\text{RR} = \lambda_1 / \lambda_2\)</span>).</p>
<p><strong>Weaknesses</strong> * Sensitive to overdispersion (variance
&gt; mean) or clustering—assumes Poisson variance equals the mean.<br>
* Only compares two groups at a time; cannot easily adjust for
covariates.<br>
* Assumes constant rate over time; if rates vary, inference can be
biased.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> The rate in group A
equals the rate in group B, i.e. <span class="math inline">\(\text{RR} =
1\)</span>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> The rate in group A
differs from the rate in group B, i.e. <span class="math inline">\(\text{RR} \neq 1\)</span>
</li>
</ul><div class="codewrapper sourceCode" id="cb149">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed events and person-time for two antibiotic regimens:</span></span>
<span><span class="co"># Observed events and person-time for two antibiotic regimens:</span></span>
<span><span class="va">events_A</span>      <span class="op">&lt;-</span> <span class="fl">10</span>    <span class="co"># infections under Regimen A</span></span>
<span><span class="va">person_days_A</span> <span class="op">&lt;-</span> <span class="fl">1200</span>  <span class="co"># total patient‐days for Regimen A</span></span>
<span></span>
<span><span class="va">events_B</span>      <span class="op">&lt;-</span> <span class="fl">18</span>    <span class="co"># infections under Regimen B</span></span>
<span><span class="va">person_days_B</span> <span class="op">&lt;-</span> <span class="fl">1500</span>  <span class="co"># total patient‐days for Regimen B</span></span>
<span></span>
<span><span class="co"># Perform exact test for comparing two Poisson rates:</span></span>
<span><span class="co"># Note: the argument name for the null ratio is 'r', not 'ratio'.</span></span>
<span><span class="va">rr_test</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span></span>
<span>x           <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">events_A</span>, <span class="va">events_B</span><span class="op">)</span>,</span>
<span>T           <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">person_days_A</span>, <span class="va">person_days_B</span><span class="op">)</span>,</span>
<span>r           <span class="op">=</span> <span class="fl">1</span>,</span>
<span>alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">rr_test</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Comparison of Poisson rates

data:  c(events_A, events_B) time base: c(person_days_A, person_days_B)
count1 = 10, expected count1 = 12, p-value = 0.4
alternative hypothesis: true rate ratio is not equal to 1
95 percent confidence interval:
 0.2864 1.5867
sample estimates:
rate ratio
    0.6944 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The estimated rate ratio is</p>
<p><span class="math inline">\(\widehat{\text{RR}} =
\dfrac{\lambda_{A}}{\lambda_{B}} = \dfrac{10/1200}{18/1500} =
\dfrac{0.00833}{0.01200} \approx 0.694\)</span> The 95 % exact
confidence interval for <span class="math inline">\(\text{RR}\)</span>
is</p>
<p><span class="math inline">\([\text{CI}_{\text{lower}},\,\text{CI}_{\text{upper}}]\)</span></p>
<p>as reported by rr_test$conf.int.</p>
<p>The two‐sided p‐value is 0.448.</p>
<p>If <span class="math inline">\(p &lt; 0.05\)</span>, we reject <span class="math inline">\(H_{0}\)</span> and conclude <span class="math inline">\(\text{RR} \neq 1\)</span> (i.e., infection rates
differ between Regimen A and B).</p>
<p>If <span class="math inline">\(p \ge 0.05\)</span>, we fail to reject
<span class="math inline">\(H_{0}\)</span>, indicating no evidence of a
difference in infection rates.</p>
<p>For example, if the output shows</p>
<p>rate ratio estimate = 0.694<br>
95 % CI = [0.318, 1.515]<br>
p‐value = 0.289<br>
then, since <span class="math inline">\(p = 0.289 \ge 0.05\)</span>, we
fail to reject <span class="math inline">\(H_{0}\)</span>. There is no
evidence that the infection rate for Regimen A differs from Regimen
B.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="overlevelsesanalyse">Overlevelsesanalyse<a class="anchor" aria-label="anchor" href="#overlevelsesanalyse"></a></h2>
<hr class="half-width"><p><a id="log_rank_test"></a></p>
<div id="accordionSpoiler55" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler55" aria-expanded="false" aria-controls="collapseSpoiler55">
  <h3 class="accordion-header" id="headingSpoiler55">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Log-rank test </h3>
</button>
<div id="collapseSpoiler55" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler55" aria-labelledby="headingSpoiler55">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Comparing the survival distributions of
two or more groups in time-to-event data.<br></li>
<li>
<strong>Real-world example:</strong> Testing whether patients
receiving Drug A have different overall survival than patients receiving
Drug B after cancer diagnosis.</li>
</ul><p><strong>Assumptions</strong> * Censoring is independent of survival
(noninformative).<br>
* Survival times are continuously distributed.<br>
* The hazard functions are proportional over time (i.e., the ratio of
hazard rates between groups is constant).</p>
<p><strong>Strengths</strong> * Nonparametric: does not assume any
specific survival distribution.<br>
* Accommodates right-censoring.<br>
* Widely used and easy to implement via <code>survdiff()</code>.</p>
<p><strong>Weaknesses</strong> * Sensitive to violations of proportional
hazards—if hazards cross, test may mislead.<br>
* Only tests for equality of entire survival curves, not pinpointing
when differences occur.<br>
* Requires adequate numbers of events—limited power if many censored
observations.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> The survival functions
in the two groups are equal, i.e. <span class="math inline">\(S_{A}(t) =
S_{B}(t)\quad \text{for all } t\)</span>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> The survival functions
differ, i.e. <span class="math inline">\(S_{A}(t) \neq S_{B}(t)\quad
\text{for some } t\)</span>
</li>
</ul><div class="codewrapper sourceCode" id="cb151">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the 'survival' package if necessary:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate survival times for two groups (A and B):</span></span>
<span><span class="va">n_A</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">n_B</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># True hazard rates: lambda_A = 0.05, lambda_B = 0.08</span></span>
<span><span class="co"># Exponential survival times (for simplicity)</span></span>
<span><span class="va">time_A</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_A</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">time_B</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_B</span>, rate <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate independent right-censoring times</span></span>
<span><span class="va">censor_A</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_A</span>, rate <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="va">censor_B</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_B</span>, rate <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed time = min(survival, censoring); event indicator = 1 if survival &lt;= censoring</span></span>
<span><span class="va">obs_time_A</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_A</span>, <span class="va">censor_A</span><span class="op">)</span></span>
<span><span class="va">status_A</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_A</span> <span class="op">&lt;=</span> <span class="va">censor_A</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_time_B</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_B</span>, <span class="va">censor_B</span><span class="op">)</span></span>
<span><span class="va">status_B</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_B</span> <span class="op">&lt;=</span> <span class="va">censor_B</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into one data frame</span></span>
<span><span class="va">group</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="st">"A"</span>, <span class="va">n_A</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="st">"B"</span>, <span class="va">n_B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time</span>       <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">obs_time_A</span>, <span class="va">obs_time_B</span><span class="op">)</span></span>
<span><span class="va">status</span>     <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">status_A</span>, <span class="va">status_B</span><span class="op">)</span></span>
<span><span class="va">df_surv</span>    <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span>, <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform log-rank test comparing groups A and B</span></span>
<span><span class="va">surv_diff</span> <span class="op">&lt;-</span> <span class="fu">survdiff</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df_surv</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">surv_diff</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Call:
survdiff(formula = Surv(time, status) ~ group, data = df_surv)

         N Observed Expected (O-E)^2/E (O-E)^2/V
group=A 50       36     41.4     0.699      1.53
group=B 50       42     36.6     0.789      1.53

 Chisq= 1.5  on 1 degrees of freedom, p= 0.2 </code></pre>
</div>
<p><strong>Interpretation:</strong> The log-rank test yields a
chi-square statistic <span class="math inline">\(\chi^{2} \;=\;
\text{surv_diff\$chisq}\)</span></p>
<p>with 1 degree of freedom and p-value = 0.216. We fail to reject the
null hypothesis. Thus, since <span class="math inline">\(p =
\text{0.216}\)</span>, we conclude there is no evidence of a difference
in survival between Drug A and Drug B..</p>
</div>
</div>
</div>
</div>
<p><a id="weibull_survival"></a></p>
<div id="accordionSpoiler56" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler56" aria-expanded="false" aria-controls="collapseSpoiler56">
  <h3 class="accordion-header" id="headingSpoiler56">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Parametric survival methods (Weibull) </h3>
</button>
<div id="collapseSpoiler56" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler56" aria-labelledby="headingSpoiler56">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling time‐to‐event data with a
specified parametric form—specifically the Weibull distribution—for both
the baseline hazard and covariate effects.<br></li>
<li>
<strong>Real-world example:</strong> Estimating the effect of a new
chemotherapy agent on time to disease progression, assuming a Weibull
hazard shape.</li>
</ul><p><strong>Assumptions</strong> * <strong>Weibull distribution</strong>:
The survival times <span class="math inline">\(T\)</span> follow a
Weibull distribution with shape parameter <span class="math inline">\(\alpha\)</span> and scale parameter <span class="math inline">\(\lambda\)</span>, so the hazard is <span class="math inline">\(h(t) = \alpha \lambda^{\alpha} t^{\alpha -
1}\)</span> * <strong>Independent censoring</strong>: Censoring times
are independent of true event times.<br>
* <strong>Correct functional form</strong>: The log of survival time is
linearly related to covariates (if covariates are included).<br>
* <strong>Linear predictor</strong>: In the accelerated‐failure‐time
(AFT) parameterization, we assume <span class="math inline">\(\log(T_i)
= \mathbf{X}_i^\top \boldsymbol{\beta} + \sigma W_i\)</span></p>
<p>where <span class="math inline">\(W_i\)</span> is a random error with
extreme‐value distribution.</p>
<p><strong>Strengths</strong> * Provides a fully specified likelihood,
enabling efficient estimation and confidence intervals.<br>
* Yields both scale (AFT) and hazard‐ratio interpretations (via
transformation).<br>
* Can extrapolate beyond observed follow‐up (if model fit is
adequate).</p>
<p><strong>Weaknesses</strong> * Mis‐specification of the Weibull form
(shape <span class="math inline">\(\alpha\)</span> wrong) can bias
estimates and inferences.<br>
* Less robust than semi‐parametric Cox models if the true hazard is not
Weibull‐shaped.<br>
* Requires careful checking of model fit (e.g., via residuals or AIC
comparisons).</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>)</strong>: The new chemotherapy
does not change time to progression, i.e. the coefficient <span class="math inline">\(\beta_{\text{treatment}} = 0\)</span>.<br></li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>)</strong>: The new chemotherapy
changes time to progression, i.e. <span class="math inline">\(\beta_{\text{treatment}} \neq 0\)</span>.</li>
</ul><div class="codewrapper sourceCode" id="cb153">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the 'survival' package if not already installed:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Simulate a binary treatment indicator (0 = Control, 1 = NewChemo):</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True Weibull parameters:</span></span>
<span><span class="co">#    shape (alpha) = 1.5</span></span>
<span><span class="co">#    baseline scale (lambda0) = exp(beta0) = exp(3)</span></span>
<span><span class="co">#    treatment effect on log(T) is beta1 = -0.5 (accelerated failure time)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Simulate true event times from Weibull AFT model:</span></span>
<span><span class="co">#   log(T) = beta0 + beta1 * treatment + sigma * W, where W ~ EV(0,1)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">alpha</span>  <span class="co"># In survreg parameterization, scale = 1/alpha</span></span>
<span></span>
<span><span class="co"># Generate extreme‐value errors W:</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu">evd</span><span class="fu">::</span><span class="fu">revdbeta</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Alternatively, simulate from Gumbel via -log(-log(U))</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: 'revdbeta' is not an exported object from 'namespace:evd'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb155">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute log‐times:</span></span>
<span><span class="va">logT</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="va">W</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'W' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb157">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to event times:</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">logT</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'logT' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb159">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate random right‐censoring times from Uniform(0, 20):</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed time and event indicator:</span></span>
<span><span class="va">obs_time</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time</span>, <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a data frame:</span></span>
<span><span class="va">df_weibull</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>time      <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>status    <span class="op">=</span> <span class="va">status</span>,</span>
<span>treatment <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">treatment</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"NewChemo"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Weibull AFT model using survreg():</span></span>
<span><span class="va">weibull_fit</span> <span class="op">&lt;-</span> <span class="fu">survreg</span><span class="op">(</span></span>
<span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>data   <span class="op">=</span> <span class="va">df_weibull</span>,</span>
<span>dist   <span class="op">=</span> <span class="st">"weibull"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">weibull_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
survreg(formula = Surv(time, status) ~ treatment, data = df_weibull,
    dist = "weibull")
                     Value Std. Error     z      p
(Intercept)        2.23480    0.13698 16.32 &lt;2e-16
treatmentNewChemo  0.16272    0.18833  0.86   0.39
Log(scale)        -0.00632    0.07668 -0.08   0.93

Scale= 0.994

Weibull distribution
Loglik(model)= -372.1   Loglik(intercept only)= -372.4
	Chisq= 0.75 on 1 degrees of freedom, p= 0.39
Number of Newton-Raphson Iterations: 5
n= 200 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>In the AFT parameterization, survreg() reports a scale which equals
𝜎<sup>=1/𝛼</sup>σ^ =1/ α^ .</p>
<p>Suppose 𝜎^=0.667. Then the estimated shape is</p>
<p><span class="math inline">\(\widehat{\alpha} = \frac{1}{\hat{\sigma}}
= \frac{1}{0.667} \approx 1.50\)</span>.</p>
<p>The coefficient for treatmentNewChemo is 𝛽^1=−0.482β (for example),
with p‐value = 0.012. We test</p>
<p><span class="math inline">\(H_{0}: \beta_{1} = 0 \quad\text{vs.}\quad
H_{1}: \beta_{1} \neq 0\)</span>.</p>
<p>Since 𝑝=0.012&lt;0.05 , we reject 𝐻_0 and conclude that “NewChemo”
significantly accelerates failure time compared to “Control.”</p>
<p>To interpret as a hazard ratio, note that under Weibull AFT, the
hazard‐ratio (HR) for treatment is <span class="math inline">\(\text{HR}
= \exp\bigl(-\beta_{1} \,\hat{\alpha}\bigr)\)</span>.</p>
<p>For 𝛽^1=−0.482 and 𝛼^=1.50,</p>
<p><span class="math inline">\(\widehat{\text{HR}} = \exp\bigl(-(-0.482)
\times 1.50\bigr) = \exp(0.723) \approx 2.06\)</span>.</p>
<p>Since HR^ &gt; 1, patients on “NewChemo” have more rapid progression
(higher hazard) than “Control.”</p>
<p>The 95 % confidence interval for 𝛽1</p>
<p>is reported in
<code>r</code>summary(weibull_fit)$table[“treatmentNewChemo”,
c(“Value”,“Std. Error”,“p”)]`.</p>
<p>If the 95 % CI for 𝛽1 is [−0.845,−0.118], then</p>
<p><span class="math inline">\(\exp\bigl(-(-0.845)\times 1.50\bigr) =
3.20, \quad
  \exp\bigl(-(-0.118)\times 1.50\bigr) = 1.19\)</span></p>
<p>giving a 95 % CI for HR: [1.19,3.20]. Because this interval excludes
1, it confirms a significant difference in hazards.</p>
</div>
</div>
</div>
</div>
<p><a id="cox_ph_model"></a></p>
<div id="accordionSpoiler57" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler57" aria-expanded="false" aria-controls="collapseSpoiler57">
  <h3 class="accordion-header" id="headingSpoiler57">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cox proportional hazards model </h3>
</button>
<div id="collapseSpoiler57" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler57" aria-labelledby="headingSpoiler57">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling the hazard (instantaneous event
rate) for time‐to‐event data as a function of covariates without
specifying a baseline hazard.<br></li>
<li>
<strong>Real-world example:</strong> Estimating the effect of a new
drug (Drug A vs. Drug B) on time to cancer recurrence, adjusting for age
and tumor grade.</li>
</ul><p><strong>Assumptions</strong> * <strong>Proportional hazards</strong>:
For any two individuals <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, $ = (_i^ - _j^) $ is constant over
time (no interaction between covariates and time).<br>
* <strong>Independent censoring</strong>: Censoring times are
independent of event times.<br>
* <strong>Linearity</strong>: The log‐hazard is a linear function of
continuous covariates: <span class="math inline">\(\log h(t \mid
\boldsymbol{X}) = \log h_0(t) + \boldsymbol{X}^\top
\boldsymbol{\beta}\)</span>.</p>
<ul><li>No important omitted covariates that interact with time.</li>
</ul><p><strong>Strengths</strong> * <strong>Semi‐parametric</strong>: No
need to specify <span class="math inline">\(h_0(t)\)</span> (baseline
hazard) explicitly.<br>
* Accommodates right‐censoring and time‐dependent covariates (if
extended).<br>
* Provides easily interpretable <strong>hazard ratios</strong> (<span class="math inline">\(\text{HR} = \exp(\beta)\)</span>).<br>
* Widely used and implemented (e.g., <code>coxph()</code> in R).</p>
<p><strong>Weaknesses</strong> * Sensitive to violation of proportional
hazards—if hazards cross, estimates and tests may be invalid.<br>
* Does not automatically provide baseline survival estimate unless
explicitly requested (e.g., via <code>survfit()</code>).<br>
* Cannot easily handle non‐linear effects of continuous covariates
without transformations or splines.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>)</strong>: There is no difference
in hazard between Drug A and Drug B after adjusting for age and tumor
grade, i.e. <span class="math inline">\(\beta_{\text{drug}} = 0 \quad
\Longrightarrow \quad \text{HR} = \exp(\beta_{\text{drug}}) =
1\)</span>.</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>)</strong>: Drug A and Drug B have
different hazards, i.e. <span class="math inline">\(\beta_{\text{drug}}
\neq 0 \quad \Longrightarrow \quad \text{HR} \neq 1\)</span>.</li>
</ul><div class="codewrapper sourceCode" id="cb161">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load survival package if necessary:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Simulate covariates:</span></span>
<span><span class="co">#   drug: 0 = Drug B (reference), 1 = Drug A</span></span>
<span><span class="co">#   age: continuous, uniform 40–80</span></span>
<span><span class="co">#   grade: tumor grade (1,2,3)</span></span>
<span><span class="va">drug</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">age</span>   <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">grade</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True coefficients:</span></span>
<span><span class="va">beta_drug</span>  <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span>   <span class="co"># Drug A hazard ratio = exp(-0.5) ≈ 0.61</span></span>
<span><span class="va">beta_age</span>   <span class="op">&lt;-</span> <span class="fl">0.03</span>   <span class="co"># hazard increases 3% per year</span></span>
<span><span class="va">beta_grade</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>    <span class="co"># hazard ratio ≈ exp(0.7) ≈ 2.01 per grade increment</span></span>
<span></span>
<span><span class="co"># Baseline hazard simulation via Weibull for simplicity:</span></span>
<span><span class="va">shape</span>   <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">scale0</span>  <span class="op">&lt;-</span> <span class="fl">0.01</span>     <span class="co"># baseline scale parameter</span></span>
<span><span class="co"># Linear predictor:</span></span>
<span><span class="va">lin_pred</span> <span class="op">&lt;-</span> <span class="va">beta_drug</span> <span class="op">*</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">beta_age</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="va">beta_grade</span> <span class="op">*</span> <span class="va">grade</span></span>
<span></span>
<span><span class="co"># Simulate survival times from a Weibull:</span></span>
<span><span class="co">#   S(t | X) = exp(- (t * scale0 * exp(lin_pred))^shape )</span></span>
<span><span class="va">u</span>        <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">time</span>     <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">scale0</span> <span class="op">*</span> <span class="fu">exp</span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate censoring times:</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># Observed time and status:</span></span>
<span><span class="va">obs_time</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time</span>, <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build data frame:</span></span>
<span><span class="va">df_cox</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>time   <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>status <span class="op">=</span> <span class="va">status</span>,</span>
<span>drug   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">drug</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DrugB"</span>,<span class="st">"DrugA"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>age    <span class="op">=</span> <span class="va">age</span>,</span>
<span>grade  <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">grade</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Cox proportional hazards model:</span></span>
<span><span class="va">cox_fit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">df_cox</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">cox_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Call:
coxph(formula = Surv(time, status) ~ drug + age + grade, data = df_cox)

  n= 200, number of events= 141

              coef exp(coef) se(coef)     z Pr(&gt;|z|)
drugDrugA -0.66376   0.51491  0.17856 -3.72  0.00020 ***
age        0.03985   1.04065  0.00744  5.36  8.4e-08 ***
grade2     0.88516   2.42338  0.22909  3.86  0.00011 ***
grade3     1.54602   4.69276  0.22651  6.83  8.8e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

          exp(coef) exp(-coef) lower .95 upper .95
drugDrugA     0.515      1.942     0.363     0.731
age           1.041      0.961     1.026     1.056
grade2        2.423      0.413     1.547     3.797
grade3        4.693      0.213     3.010     7.315

Concordance= 0.698  (se = 0.026 )
Likelihood ratio test= 70.2  on 4 df,   p=2e-14
Wald test            = 69.4  on 4 df,   p=3e-14
Score (logrank) test = 70.7  on 4 df,   p=2e-14</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>For each covariate, summary(cox_fit) reports:</p>
<p>Estimated coefficient 𝛽^ .</p>
<p>Hazard ratio:</p>
<p><span class="math inline">\(\widehat{\text{HR}} =
\exp(\hat{\beta}).\)</span> 95 % confidence interval for HR.</p>
<p>Wald test (z) statistic and p-value.</p>
<p>Suppose the output shows for drugDrugA:</p>
<p>coef exp(coef) se(coef) z p<br>
-0.512 0.599 0.180 -2.84 0.0045</p>
<p>Then 𝛽^_ drug = − 0.512</p>
<p>Hazard ratio: <span class="math inline">\(\widehat{\text{HR}} =
\exp(-0.512) \approx 0.599\)</span>,</p>
<p>meaning patients on Drug A have about 0.60 times the hazard of
recurrence compared to Drug B.</p>
<p>The 95 % CI (e.g., [0.427,0.839]) excludes 1, and p=0.0045&lt;0.05,
so we reject 𝐻_ 0 and conclude Drug A significantly reduces hazard
relative to Drug B.</p>
<p>For age (e.g., 𝛽^_ age = 0.029 ,</p>
<p>p=0.012):</p>
<p>HR =exp(0.029)≈1.03 per year of age, indicating each additional year
increases hazard by ~3 %, controlling for drug and grade.</p>
<p>Because</p>
<p>p&lt;0.05, age is a significant predictor of hazard.</p>
<p>For grade (e.g., Grade2: 𝛽^ =0.695, HR ≈ 2.00, p=0.001; Grade3: 𝛽^ =
1.210, HR ≈ 3.35, p&lt;0.001):</p>
<p>Patients with grade 2 tumors have about twice the hazard compared to
grade 1; grade 3 tumors have ~3.35× hazard of grade 1.</p>
<p>Both are highly significant (CIs exclude 1).</p>
<p>Overall, because all covariate p values for drug, age, and grade are
&lt; 0.05, we conclude each is significantly associated with time to
recurrence, holding the others constant.</p>
</div>
</div>
</div>
</div>
<p><a id="Accelerated-Failure-Time"></a></p>
<div id="accordionSpoiler58" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler58" aria-expanded="false" aria-controls="collapseSpoiler58">
  <h3 class="accordion-header" id="headingSpoiler58">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Accelerated Failure Time (AFT) modeller (eksponentiel, log-logistisk, …) </h3>
</button>
<div id="collapseSpoiler58" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler58" aria-labelledby="headingSpoiler58">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Modeling time‐to‐event data under the
assumption that covariates act multiplicatively on survival time
(“accelerate” or “decelerate” survival).<br></li>
<li>
<strong>Real‐world example:</strong> Estimating how a new treatment
(“Drug A” vs. “Drug B”) affects time to relapse, assuming survival
follows an exponential or log‐logistic distribution.</li>
</ul><p><strong>Assumptions</strong> * <strong>AFT form:</strong> For each
subject <span class="math inline">\(i\)</span>,<br><span class="math display">\[
    \log T_i \;=\; \mathbf{X}_i^\top \boldsymbol{\beta} \;+\;
\sigma\,W_i,
  \]</span><br>
where <span class="math inline">\(W_i\)</span> has a known distribution
(e.g., extreme‐value for exponential, logistic for log‐logistic).<br>
* <strong>Exponential AFT:</strong> <span class="math inline">\(W_i\)</span> is standard extreme‐value, so
survival <span class="math inline">\(\bigl(T_i\mid
\mathbf{X}_i\bigr)\sim \text{Weibull}\)</span> with shape <span class="math inline">\(\alpha=1\)</span>.<br>
* <strong>Log‐Logistic AFT:</strong> <span class="math inline">\(W_i\)</span> is standard logistic, so <span class="math inline">\(\log T_i\)</span> is logistic, and <span class="math inline">\(T_i\sim
\text{Log‐Logistic}(\alpha,\lambda)\)</span>.<br>
* Independent right‐censoring: censoring times are independent of event
times.<br>
* Correct specification of the error distribution (exponential
vs. log‐logistic).<br>
* Covariates enter linearly on the log‐time scale; no omitted
interacting variables.</p>
<p><strong>Strengths</strong> * Provides a direct interpretation in
terms of <strong>time ratios</strong>:<br><span class="math display">\[
    \text{Time Ratio for covariate }j = \exp\bigl(\beta_{j}\bigr),
  \]</span><br>
i.e. each unit increase in <span class="math inline">\(X_j\)</span>
multiplies median survival time by <span class="math inline">\(\exp(\beta_{j})\)</span>.<br>
* Parametric: can yield more precise estimates (smaller standard errors)
if the distributional form is correct.<br>
* Can extrapolate beyond the observed data if model fit is adequate.</p>
<p><strong>Weaknesses</strong> * Mis‐specifying the error distribution
(e.g. assuming exponential when data are log‐logistic) biases estimates
and inference.<br>
* Less robust than the semi‐parametric Cox model if true hazard shape
deviates from assumed form.<br>
* Requires checking model fit (e.g. via AIC, residual plots) to ensure
the chosen distribution is appropriate.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> Treatment has no effect
on log‐survival time, i.e.<br><span class="math inline">\(\beta_{\text{treatment}} = 0 \quad
\Longrightarrow \quad \text{Time Ratio} = \exp(0) = 1.\)</span>
</li>
<li>Alternative hypothesis (𝐻_1 ): Treatment alters log‐survival time,
i.e. <span class="math inline">\(\beta_{\text{treatment}} \neq 0 \quad
\Longrightarrow \quad \text{Time Ratio} \neq 1.\)</span>
</li>
</ul><div class="codewrapper sourceCode" id="cb163">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the 'survival' package if necessary:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span></span>
<span><span class="co"># Simulate a binary treatment indicator: 0 = DrugB, 1 = DrugA</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True AFT parameters:</span></span>
<span><span class="co">#   beta0 = 2.5 (intercept on log-time scale)</span></span>
<span><span class="co">#   beta_treat = -0.6 (DrugA reduces log-time)</span></span>
<span><span class="co">#   sigma_expo = 1 (exponential AFT → shape = 1/sigma_expo = 1)</span></span>
<span><span class="co">#   sigma_loglog = 0.8 (log-logistic AFT → scale = sigma_loglog)</span></span>
<span><span class="va">beta0</span>        <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">beta_treat</span>   <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.6</span></span>
<span><span class="va">sigma_expo</span>   <span class="op">&lt;-</span> <span class="fl">1.0</span>    <span class="co"># exponential AFT scale </span></span>
<span><span class="va">sigma_loglog</span> <span class="op">&lt;-</span> <span class="fl">0.8</span>    <span class="co"># log-logistic AFT scale</span></span>
<span></span>
<span><span class="co"># Simulate error terms:</span></span>
<span><span class="co">#   For exponential AFT, W ~ extreme-value(0,1), generate via -log(-log(U))</span></span>
<span><span class="va">u_expo</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">W_expo</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="va">u_expo</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   For log-logistic AFT, W ~ standard logistic</span></span>
<span><span class="va">W_loglog</span> <span class="op">&lt;-</span> <span class="fu">rlogis</span><span class="op">(</span><span class="va">n</span>, location <span class="op">=</span> <span class="fl">0</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate log‐times under each AFT model:</span></span>
<span><span class="va">logT_expo</span>   <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta_treat</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">sigma_expo</span> <span class="op">*</span> <span class="va">W_expo</span></span>
<span><span class="va">logT_loglog</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta_treat</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">sigma_loglog</span> <span class="op">*</span> <span class="va">W_loglog</span></span>
<span></span>
<span><span class="co"># Convert to event times:</span></span>
<span><span class="va">time_expo</span>   <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">logT_expo</span><span class="op">)</span></span>
<span><span class="va">time_loglog</span> <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">logT_loglog</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate independent right‐censoring from Uniform(0, 25):</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed times and event indicators:</span></span>
<span><span class="va">obs_time_expo</span>   <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_expo</span>,   <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status_expo</span>     <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_expo</span>   <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_time_loglog</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_loglog</span>, <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status_loglog</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_loglog</span> <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a single data frame (use exponential‐type data here):</span></span>
<span><span class="va">df_aft</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  time   <span class="op">=</span> <span class="va">obs_time_expo</span>,</span>
<span>  status <span class="op">=</span> <span class="va">status_expo</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">treatment</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DrugB"</span>,<span class="st">"DrugA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit exponential AFT model via survreg (dist = "exponential"):</span></span>
<span><span class="va">aft_expo_fit</span> <span class="op">&lt;-</span> <span class="fu">survreg</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_aft</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"exponential"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit log-logistic AFT model on the same data (to compare mis-specification):</span></span>
<span><span class="va">aft_loglog_fit</span> <span class="op">&lt;-</span> <span class="fu">survreg</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_aft</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"loglogistic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summaries:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">aft_expo_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
survreg(formula = Surv(time, status) ~ treatment, data = df_aft,
    dist = "exponential")
                Value Std. Error     z      p
(Intercept)     3.235      0.189 17.12 &lt;2e-16
treatmentDrugA -0.233      0.255 -0.91   0.36

Scale fixed at 1

Exponential distribution
Loglik(model)= -254.7   Loglik(intercept only)= -255.1
	Chisq= 0.84 on 1 degrees of freedom, p= 0.36
Number of Newton-Raphson Iterations: 5
n= 150 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb165">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">aft_loglog_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
survreg(formula = Surv(time, status) ~ treatment, data = df_aft,
    dist = "loglogistic")
                Value Std. Error     z       p
(Intercept)     2.778      0.165 16.83 &lt; 2e-16
treatmentDrugA -0.302      0.218 -1.39    0.17
Log(scale)     -0.444      0.102 -4.35 1.4e-05

Scale= 0.641

Log logistic distribution
Loglik(model)= -248.7   Loglik(intercept only)= -249.6
	Chisq= 1.91 on 1 degrees of freedom, p= 0.17
Number of Newton-Raphson Iterations: 4
n= 150 </code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>Exponential AFT (dist=“exponential”)</p>
<p>In the AFT parameterization, the scale reported by survreg() equals
σ^ =1 if the shape α=1/ σ^ =1. Suppose</p>
<p>scale = 1.02<br>
then <span class="math inline">\(\widehat{\alpha} = \frac{1}{1.02}
\approx 0.98 \approx 1\)</span>,</p>
<p>consistent with an exponential hazard.</p>
<p>The coefficient for treatmentDrugA is, e.g., 𝛽^_treatment =−0.588
with p‐value = 0.008.</p>
<p>Time Ratio for DrugA vs. DrugB:</p>
<p><span class="math inline">\(\exp\bigl(\hat{\beta}_{\text{treatment}}\bigr) =
\exp(-0.588) \approx 0.556.\)</span></p>
<p>This means that DrugA “accelerates failure” so that median survival
time on DrugA is about 55.6 % of that on DrugB (i.e., shorter).</p>
<p>Since p=0.008&lt;0.05, we reject 𝐻_0 and conclude DrugA significantly
changes survival time relative to DrugB.</p>
<p>Log‐Logistic AFT (dist=“loglogistic”) (mis‐specified model)</p>
<p>The scale σ^ might be, say, 0.90, implying a shape estimate</p>
<p><span class="math inline">\(\widehat{\alpha} = \frac{1}{0.90} \approx
1.11.\)</span></p>
<p>The coefficient for treatmentDrugA could be</p>
<p>β^__treatment =−0.482 with p‐value = 0.015.</p>
<p>Time Ratio: <span class="math inline">\(\exp(-0.482) \approx
0.618.\)</span></p>
<p>Suggesting DrugA’s median time is ~61.8 % of DrugB’s.</p>
<p>But because the data truly follow an exponential AFT, the
log‐logistic fit may have biased β^ and slightly different
inference.</p>
<p>Compare AICs: AIC(aft_expo_fit, aft_loglog_fit) The exponential model
should have lower AIC (better fit) if the exponential assumption
holds.</p>
<p>In summary, fitting the correctly specified exponential AFT yields a
time ratio exp( β^_treatment )≈0.56 (p = 0.008), indicating DrugA
significantly reduces survival time. The mis‐specified log‐logistic
model gives a similar but biased estimate (time ratio ≈ 0.62, p = 0.015)
and higher AIC, illustrating the importance of choosing the correct AFT
distribution.</p>
</div>
</div>
</div>
</div>
<p><a id="grays-test"></a></p>
<div id="accordionSpoiler59" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler59" aria-expanded="false" aria-controls="collapseSpoiler59">
  <h3 class="accordion-header" id="headingSpoiler59">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Gray’s test for konkurrentrisiko </h3>
</button>
<div id="collapseSpoiler59" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler59" aria-labelledby="headingSpoiler59">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Testing equality of cumulative incidence
functions between groups in the presence of competing risks.<br></li>
<li>
<strong>Real-world example:</strong> Comparing the incidence of
cancer relapse (event of interest) between two treatment arms,
accounting for death from other causes as a competing event.</li>
</ul><p><strong>Assumptions</strong> * Competing risks are mutually exclusive
and each subject experiences at most one event.<br>
* Censoring is independent of the event processes.<br>
* The cause‐specific hazards are proportional across groups.</p>
<p><strong>Strengths</strong> * Directly compares cumulative incidence
functions rather than cause‐specific hazards.<br>
* Accounts properly for competing events (does not treat them as
noninformative censoring).<br>
* Implemented in <code>cmprsk::cuminc()</code> with the Gray test built
in.</p>
<p><strong>Weaknesses</strong> * Assumes proportional subdistribution
hazards (which may be violated).<br>
* Sensitive to heavy censoring or sparse events in one group.<br>
* Only tests overall equality of curves, not differences at specific
time points.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> <span class="math inline">\(F_1^{(1)}(t) = F_2^{(1)}(t)\quad\text{for all
}t\)</span> (the cumulative incidence of the event of interest is the
same in both groups).<br></li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> <span class="math inline">\(F_1^{(1)}(t) \neq F_2^{(1)}(t)\quad\text{for some
}t\)</span>
</li>
</ul><div class="codewrapper sourceCode" id="cb167">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("cmprsk")  # if needed</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cmprsk</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate competing‐risks data for 100 patients in two arms:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True subdistribution hazards:</span></span>
<span><span class="co">#   cause 1 (relapse): faster in B; cause 2 (death): equal</span></span>
<span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="st">"A"</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">lambda2</span> <span class="op">&lt;-</span> <span class="fl">0.03</span></span>
<span></span>
<span><span class="co"># Simulate event times via exponential (for simplicity)</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="va">lambda1</span><span class="op">)</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="va">lambda2</span><span class="op">)</span></span>
<span><span class="va">ftime</span>   <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time1</span>, <span class="va">time2</span><span class="op">)</span></span>
<span><span class="va">fstatus</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">time1</span> <span class="op">&lt;=</span> <span class="va">time2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>  <span class="co"># 1=relapse, 2=death</span></span>
<span></span>
<span><span class="co"># Compute cumulative incidence and Gray's test:</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu">cuminc</span><span class="op">(</span><span class="va">ftime</span>, <span class="va">fstatus</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ci is a list; test results in ci$Tests</span></span>
<span><span class="va">ci</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Tests:
   stat      pv df
1 5.198 0.02262  1
2 2.630 0.10489  1
Estimates and Variances:
$est
      10   20   30   40   50
A 1 0.40 0.50 0.62 0.64 0.68
B 1 0.66 0.76 0.82 0.82   NA
A 2 0.22 0.30 0.30 0.30 0.30
B 2 0.12 0.12 0.14 0.16   NA

$var
          10       20       30       40       50
A 1 0.004962 0.005216 0.005054 0.004974 0.004791
B 1 0.004714 0.003903 0.003284 0.003284       NA
A 2 0.003545 0.004399 0.004399 0.004399 0.004399
B 2 0.002181 0.002181 0.002546 0.003065       NA</code></pre>
</div>
<p><strong>Interpretation:</strong> The Gray test for cause 1 (relapse)
yields</p>
<p><span class="math inline">\(\chi^2 = \text{ci\$Tests["1  A vs
B", "stat"]},\quad p = \text{ci\$Tests["1  A vs
B","pv"]}\)</span></p>
<p>If <span class="math inline">\(p &lt; 0.05\)</span>, we reject <span class="math inline">\(H_{0}\)</span> and conclude the cumulative
incidence of relapse differs between groups A and B.</p>
<p>If <span class="math inline">\(p \ge 0.05\)</span>, we fail to reject
<span class="math inline">\(H_{0}\)</span>, indicating no evidence of a
difference in relapse incidence between the treatment arms.</p>
</div>
</div>
</div>
</div>
<p><a id="cox_ph_assumption_test"></a></p>
<div id="accordionSpoiler60" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler60" aria-expanded="false" aria-controls="collapseSpoiler60">
  <h3 class="accordion-header" id="headingSpoiler60">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Test af proportional hazards-antagelsen (Schoenfeld residualer) </h3>
</button>
<div id="collapseSpoiler60" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler60" aria-labelledby="headingSpoiler60">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p>’ <strong>Used for</strong> Testing the proportional‐hazards
assumption in Cox models using Schoenfeld residuals.<br>
* <strong>Real-world example:</strong> Verifying that the hazard ratio
between a new drug and control remains constant over follow‐up time.</p>
<p><strong>Assumptions</strong> * You have a fitted Cox model
(<code>coxph()</code>).<br>
* Censoring is noninformative.<br>
* The true hazard ratios are constant over time under the null.</p>
<p><strong>Strengths</strong> * Provides both a global test and
covariate‐specific tests.<br>
* Uses residuals to detect time‐varying effects.<br>
* Easy to implement via <code>cox.zph()</code>.</p>
<p><strong>Weaknesses</strong> * Sensitive to sparse data or few
events.<br>
* May flag minor, clinically irrelevant departures.<br>
* Graphical interpretation can be subjective.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_0\)</span>):</strong> The hazard ratio is
constant over time for each covariate, i.e.<br>
$ = (<em>k (X</em>{ik}-X_{jk}))t.$</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_1\)</span>):</strong> At least one covariate’s
hazard ratio varies with time.</li>
</ul><div class="codewrapper sourceCode" id="cb169">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">drug</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>               <span class="co"># 0=Control, 1=DrugA</span></span>
<span><span class="va">age</span>   <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">grade</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True hazard: h(t) = h0(t) * exp(-0.5*drug + 0.03*age + 0.7*grade)</span></span>
<span><span class="va">shape</span>  <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">scale0</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">linpred</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">drug</span> <span class="op">+</span> <span class="fl">0.03</span><span class="op">*</span><span class="va">age</span> <span class="op">+</span> <span class="fl">0.7</span><span class="op">*</span><span class="va">grade</span></span>
<span><span class="va">u</span>       <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">time</span>    <span class="op">&lt;-</span> <span class="op">(</span> <span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">scale0</span> <span class="op">*</span> <span class="fu">exp</span><span class="op">(</span><span class="va">linpred</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span></span>
<span><span class="va">censor</span>  <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">obs_time</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time</span>, <span class="va">censor</span><span class="op">)</span></span>
<span><span class="va">status</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">censor</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_cox</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>time   <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>status <span class="op">=</span> <span class="va">status</span>,</span>
<span>drug   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">drug</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"DrugA"</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="va">age</span>,</span>
<span>grade  <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">grade</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Cox model:</span></span>
<span><span class="va">cox_fit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">df_cox</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test proportional hazards via Schoenfeld residuals:</span></span>
<span><span class="va">zph_test</span> <span class="op">&lt;-</span> <span class="fu">cox.zph</span><span class="op">(</span><span class="va">cox_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">zph_test</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        chisq df     p
drug   4.3873  1 0.036
age    0.2820  1 0.595
grade  0.0824  2 0.960
GLOBAL 4.4158  4 0.353</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb171">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">zph_test</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/stat-tests-1-rendered-cox_ph_assumption_test-1.png" style="display: block; margin: auto;" class="figure"><img src="fig/stat-tests-1-rendered-cox_ph_assumption_test-2.png" style="display: block; margin: auto;" class="figure"><img src="fig/stat-tests-1-rendered-cox_ph_assumption_test-3.png" style="display: block; margin: auto;" class="figure"></p>
<p><strong>Interpretation:</strong></p>
<p>The output shows a test statistic and p‐value for each covariate and
a GLOBAL test.</p>
<p>For each row, p‐value <span class="math inline">\(&lt;0.05\)</span>
indicates that covariate’s hazard ratio varies over time.</p>
<p>A GLOBAL p‐value <span class="math inline">\(&lt;0.05\)</span>
indicates some covariate violates proportional hazards.</p>
<p>Graphs of residuals vs. time (plot(zph_test)) should show a roughly
horizontal line under <span class="math inline">\(H_0\)</span>. Trends
suggest time‐varying effects.</p>
<p>If all p‐values <span class="math inline">\(\ge 0.05\)</span>, we
fail to reject <span class="math inline">\(H_0\)</span> and conclude the
proportional hazards assumption is reasonable.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="aftale--og-concordance-mål">Aftale- og concordance-mål<a class="anchor" aria-label="anchor" href="#aftale--og-concordance-m%C3%A5l"></a></h2>
<hr class="half-width"><p><a id="kappa_statistic"></a></p>
<div id="accordionSpoiler61" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler61" aria-expanded="false" aria-controls="collapseSpoiler61">
  <h3 class="accordion-header" id="headingSpoiler61">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kappa statistic </h3>
</button>
<div id="collapseSpoiler61" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler61" aria-labelledby="headingSpoiler61">
<div class="accordion-body">
<p>EJ KORREKTURLÆST MON IKKE DENNE SNARERE SKAL KONSOLIDERES MED DEN
COHENS VI ALLEREDE HAR?</p>
<ul><li>
<strong>Used for</strong> Quantifying agreement between two raters
classifying the same subjects into categories, beyond chance.<br></li>
<li>
<strong>Real-world example:</strong> Assessing whether two
pathologists agree on “Benign” vs. “Malignant” diagnoses.</li>
</ul><p><strong>Assumptions</strong> * Each subject is independently rated by
both raters.<br>
* Ratings are categorical (nominal or ordinal).<br>
* The marginal distributions of categories need not be equal.</p>
<p><strong>Strengths</strong> * Corrects for agreement expected by
chance.<br>
* Provides an interpretable coefficient, <span class="math inline">\(\kappa\)</span>, ranging from –1 to 1.<br>
* Can be weighted for ordinal categories.</p>
<p><strong>Weaknesses</strong> * Sensitive to prevalence and marginal
imbalances (“paradox”).<br>
* Doesn’t distinguish systematic bias from random disagreement.<br>
* Requires at least two raters and non‐sparse tables for stable
estimates.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> <span class="math inline">\(\kappa = 0\)</span> (no agreement beyond
chance).<br></li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> <span class="math inline">\(\kappa \neq 0\)</span> (agreement beyond
chance).</li>
</ul><div class="codewrapper sourceCode" id="cb172">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("psych")  # if necessary</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">psych</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:DescTools':

    AUC, ICC, SD</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb177">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="co"># Simulate two raters classifying subjects as "Yes" or "No":</span></span>
<span><span class="va">rater1</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Yes"</span>,<span class="st">"No"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Rater2 agrees 70% of the time:</span></span>
<span><span class="va">rater2</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.7</span>,</span>
<span>                 <span class="va">rater1</span>,</span>
<span>                 <span class="fu">ifelse</span><span class="op">(</span><span class="va">rater1</span><span class="op">==</span><span class="st">"Yes"</span>,<span class="st">"No"</span>,<span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ratings</span>    <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">rater1</span>, <span class="va">rater2</span><span class="op">)</span></span>
<span><span class="va">kappa_result</span> <span class="op">&lt;-</span> <span class="fu">cohen.kappa</span><span class="op">(</span><span class="va">ratings</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">kappa_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Call: cohen.kappa1(x = x, w = w, n.obs = n.obs, alpha = alpha, levels = levels,
    w.exp = w.exp)

Cohen Kappa and Weighted Kappa correlation coefficients and confidence boundaries
                 lower estimate upper
unweighted kappa 0.077     0.34   0.6
weighted kappa   0.077     0.34   0.6

 Number of subjects = 50 </code></pre>
</div>
<p><strong>Interpretation</strong> The estimated Cohen’s <span class="math inline">\(\kappa\)</span> is</p>
<p><span class="math inline">\(\widehat{\kappa}\)</span> = 0.3377</p>
<p>The test statistic (z) = kappa_result$z[1] DETTE FUNGERER IKKE - Z ER
IKKE I OBJEKTET.</p>
<p>with p-value =<span class="math inline">\(\texttt{signif(kappa_result\$p.value[1],
3)}\)</span>. DET HER FUNGERER VIST HELLER IKKE…</p>
<p>Since p = r signif(kappa_result$p.value[1], 3) EJ HELLER DETTE</p>
<p>If p &lt; 0.05, we reject <span class="math inline">\(H_{0}\)</span>
and conclude there is agreement beyond chance.</p>
<p>If p ≥ 0.05, we fail to reject <span class="math inline">\(H_{0}\)</span> and conclude no evidence of
agreement beyond chance.</p>
<p>Conventionally, <span class="math inline">\(\kappa\)</span> values
are interpreted as:</p>
<p>0.01–0.20: slight agreement</p>
<p>0.21–0.40: fair agreement</p>
<p>0.41–0.60: moderate agreement</p>
<p>0.61–0.80: substantial agreement</p>
<p>0.81–1.00: almost perfect agreement</p>
</div>
</div>
</div>
</div>
<p><a id="intraclass-correlation-coefficient"></a></p>
<div id="accordionSpoiler62" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler62" aria-expanded="false" aria-controls="collapseSpoiler62">
  <h3 class="accordion-header" id="headingSpoiler62">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Intraclass Correlation Coefficient (ICC) </h3>
</button>
<div id="collapseSpoiler62" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler62" aria-labelledby="headingSpoiler62">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Assessing the reliability or agreement of
quantitative measurements made by two or more raters.<br></li>
<li>
<strong>Real-world example:</strong> Determining how consistently
three radiologists measure tumor size on MRI scans.</li>
</ul><p><strong>Assumptions</strong>:</p>
<ul><li>Measurements are continuous and approximately normally
distributed.<br></li>
<li>Raters are randomly selected (for the “random‐effects” model) or
fixed (for the “fixed‐effects” model), depending on choice.</li>
<li>No interaction between subjects and raters (i.e., rater effects are
consistent across subjects).</li>
<li>Balanced design: each subject is rated by the same set of
raters.</li>
</ul><p><strong>Strengths</strong></p>
<ul><li>Quantifies both consistency and absolute agreement, with different
model/type options.<br></li>
<li>Can accommodate any number of raters and subjects.<br></li>
<li>Provides confidence intervals and tests for ICC.</li>
</ul><p><strong>Weaknesses</strong></p>
<ul><li>Sensitive to violations of normality and homogeneity of
variance.<br></li>
<li>Choice of model (one‐way vs. two‐way) and type (consistency
vs. agreement) affects results.<br></li>
<li>Requires balanced data; missing ratings complicate estimation.</li>
</ul><p><strong>Example</strong></p>
<ul><li>
<em>Null hypothesis (H₀)</em>: The intraclass correlation
coefficient ICC = 0 (no reliability beyond chance).<br></li>
<li>
<em>Alternative hypothesis (H₁)</em>: ICC &gt; 0 (measurements are
more reliable than chance).</li>
</ul><div class="codewrapper sourceCode" id="cb179">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">irr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate ratings of 10 subjects by 3 raters:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">ratings</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  rater1 <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rater2 <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rater3 <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute two-way random effects, absolute agreement, single rater ICC:</span></span>
<span><span class="va">icc_result</span> <span class="op">&lt;-</span> <span class="fu">icc</span><span class="op">(</span><span class="va">ratings</span>,</span>
<span>                  model <span class="op">=</span> <span class="st">"twoway"</span>,</span>
<span>                  type  <span class="op">=</span> <span class="st">"agreement"</span>,</span>
<span>                  unit  <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">icc_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> Single Score Intraclass Correlation

   Model: twoway
   Type : agreement

   Subjects = 10
     Raters = 3
   ICC(A,1) = -0.0823

 F-Test, H0: r0 = 0 ; H1: r0 &gt; 0
  F(9,16.8) = 0.77 , p = 0.645

 95%-Confidence Interval for ICC Population Values:
  -0.326 &lt; ICC &lt; 0.382</code></pre>
</div>
<p><strong>Interpretation:</strong></p>
<p>The estimated ICC is -0.08 with a 95% CI [-0.33, 0.38] and p-value =
0.645. We fail to reject the null hypothesis. This indicates that there
is no evidence of reliability beyond chance among the raters.</p>
</div>
</div>
</div>
</div>
<p><a id="bland_altman"></a></p>
<div id="accordionSpoiler63" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler63" aria-expanded="false" aria-controls="collapseSpoiler63">
  <h3 class="accordion-header" id="headingSpoiler63">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Bland–Altman analysis </h3>
</button>
<div id="collapseSpoiler63" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler63" aria-labelledby="headingSpoiler63">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<ul><li>
<strong>Used for</strong> Assessing agreement between two
quantitative measurement methods by examining the mean difference (bias)
and the limits of agreement. It tests if any difference is constant
across the range of measurements, and if there is heteroskedasticity in
the data (are there differences that are dependent on measurement
levels)</li>
<li>
<strong>Real-world example:</strong> Comparing blood pressure
readings from a new wrist monitor and a standard sphygmomanometer.</li>
</ul><p><strong>Assumptions</strong> * Paired measurements on the same
subjects.<br>
* Differences (method A – method B) are approximately normally
distributed.<br>
* No strong relationship between the magnitude of the measurement and
the difference (homoscedasticity).</p>
<p><strong>Strengths</strong> * Provides both a visual (Bland–Altman
plot) and numerical summary (bias and limits) of agreement.<br>
* Easy to interpret clinically: shows how far apart two methods can
differ for most observations.<br>
* Does not rely on correlation, which can be misleading for
agreement.</p>
<p><strong>Weaknesses</strong> * Assumes constant bias across range of
measurements.<br>
* Sensitive to outliers, which can widen limits of agreement.<br>
* Requires adequate sample size (n ≥ 30 preferred) to estimate limits
reliably.</p>
<p><strong>Example</strong></p>
<ul><li>
<strong>Null hypothesis (H₀):</strong> Mean difference between
methods A and B is zero (no systematic bias).<br></li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Mean difference ≠ 0
(systematic bias exists).</li>
</ul><div class="codewrapper sourceCode" id="cb181">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated paired blood pressure measurements (mmHg) on 12 subjects:</span></span>
<span><span class="va">wrist</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">120</span>, <span class="fl">122</span>, <span class="fl">118</span>, <span class="fl">121</span>, <span class="fl">119</span>, <span class="fl">117</span>, <span class="fl">123</span>, <span class="fl">120</span>, <span class="fl">118</span>, <span class="fl">119</span>, <span class="fl">122</span>, <span class="fl">121</span><span class="op">)</span></span>
<span><span class="va">sphyg</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">119</span>, <span class="fl">121</span>, <span class="fl">117</span>, <span class="fl">122</span>, <span class="fl">118</span>, <span class="fl">116</span>, <span class="fl">124</span>, <span class="fl">119</span>, <span class="fl">117</span>, <span class="fl">120</span>, <span class="fl">121</span>, <span class="fl">122</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute differences and means:</span></span>
<span><span class="va">diffs</span>    <span class="op">&lt;-</span> <span class="va">wrist</span> <span class="op">-</span> <span class="va">sphyg</span></span>
<span><span class="va">means</span>    <span class="op">&lt;-</span> <span class="op">(</span><span class="va">wrist</span> <span class="op">+</span> <span class="va">sphyg</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Calculate bias and limits of agreement:</span></span>
<span><span class="va">bias</span>     <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span></span>
<span><span class="va">sd_diff</span>  <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span></span>
<span><span class="va">loa_up</span>   <span class="op">&lt;-</span> <span class="va">bias</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd_diff</span></span>
<span><span class="va">loa_low</span>  <span class="op">&lt;-</span> <span class="va">bias</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd_diff</span></span>
<span></span>
<span><span class="co"># Test for zero bias:</span></span>
<span><span class="va">t_test</span>   <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">diffs</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bland–Altman plot:</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="va">ba_df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">means</span>, diff <span class="op">=</span> <span class="va">diffs</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ba_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean</span>, y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">bias</span>,    linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">loa_up</span>,   linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">loa_low</span>,  linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bland–Altman Plot"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Mean of Wrist &amp; Sphyg Measurements"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Difference (Wrist – Sphyg)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/stat-tests-1-rendered-bland_altman-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb182">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print numerical results:</span></span>
<span><span class="va">bias</span>; <span class="va">loa_low</span>; <span class="va">loa_up</span>; <span class="va">t_test</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3333</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -1.597</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.263</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	One Sample t-test

data:  diffs
t = 1.2, df = 11, p-value = 0.3
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.2923  0.9590
sample estimates:
mean of x
   0.3333 </code></pre>
</div>
<p><strong>Interpretation</strong> The mean difference (bias) is 0.33
units, with 95% limits of agreement from -1.6 to 2.26 units. The t-test
for zero bias yields a p-value of 0.266, so we fail to reject the null
hypothesis. This indicates that there is no statistically significant
bias; the two methods agree on average.</p>
</div>
</div>
</div>
</div>
<p>Der skal nok suppleres med: Weighted κ is used for ordinal values. We
use the function kappa2() from the irr package. Light’s κ is used for
studying interrater agreement between more than 2 raters. We use the
function kappamlight() from the irr package. Fleiss κ is also used when
having more than 2 raters. But does not require the same raters for each
subject.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Use an appropriate statistical test</li>
<li>Make sure you understand the assumptions underlying the test</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="git-09-practice.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="package-is-not-available.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="git-09-practice.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Practice makes
        </a>
        <a class="chapter-link float-end" href="package-is-not-available.html" rel="next">
          Next: When...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/stat-tests-1.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-toolbox/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC BY-NC-SA 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://KUBDatalab.github.io/R-toolbox/stat-tests-1.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson",
  "name": "Statistical tests",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-toolbox/stat-tests-1.html",
  "identifier": "https://KUBDatalab.github.io/R-toolbox/stat-tests-1.html",
  "dateCreated": "2024-04-09",
  "dateModified": "2025-06-24",
  "datePublished": "2025-06-24"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

