<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R-toolbox: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/lc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/lc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/lc/favicon-16x16.png">
<link rel="manifest" href="favicons/lc/site.webmanifest">
<link rel="mask-icon" href="favicons/lc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="assets/images/library-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="assets/images/library-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R-toolbox
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R-toolbox
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="CLT-dk.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="CLT-en.html">CLT - in english</a></li>
<li><a class="dropdown-item" href="data.html">Data sets</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R-toolbox
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="reproducible-analysis.html">1. Reproducible Data Analysis</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reading-files.html">2. Reading data from file</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="descript-stat.html">3. Descriptive Statistics</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="histograms.html">4. Histograms</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="table1.html">5. Table One</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="tidy-data.html">6. Tidy Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="normal-distribution.html">7. The normal distribution</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="is-it-normal.html">8. Testing for normality</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="which-distribution.html">9. How is the data distributed?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="linear-regression.html">10. Linear regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="multiple-linear-regression.html">11. Multiple Linear Regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="logistic-regression.html">12. Logistic regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="clt.html">13. Central Limit Theorem</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="barcharts.html">14. Nicer barcharts</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="powerberegninger.html">15. Power Calculations</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="kmeans.html">16. k-means</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="anova.html">17. ANOVA</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="cohens-kappa.html">18. Cohens Kappa</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="ucloud.html">19. R on Ucloud</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="pipes.html">20. A deeper dive into pipes</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="gis_setup.html">21. Setup for GIS</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="fence-test.html">22. Fences på vores undervisningssider</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="making-a-new-course.html">23. Make a new course</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="stat-tests-1.html">24. Statistical tests</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="CLT-dk.html">CLT - på dansk</a></li>
<li><a href="CLT-en.html">CLT - in english</a></li>
<li><a href="data.html">Data sets</a></li>
<li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-reproducible-analysis"><p>Content from <a href="reproducible-analysis.html">Reproducible Data Analysis</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/reproducible-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I ensure that my results can be reproduced?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown</li>
<li>Demonstrate how to include pieces of code</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A key concept in the scientific process is reproducibility. We should
be able to run the same experiment again, and get, more or less, the
same result.</p>

<p>This also applies to the analysis of data. If we have a collection of
measurements of blood pressure from patients before and after they have
taken an antihypertensive drug, we might arrive at the result that this
specific drug is not working. Doing the same analysis tomorrow, we
should reach the same result.</p>
<p>And that can be surprisingly difficult!</p>
<p>There are a lot of pitfalls, ranging from accessibility to incentive
structures in academia. But the three areas where R can help us are:</p>
<ul>
<li>Software Environment</li>
<li>Documentation and Metadata</li>
<li>Complex Workflows</li>
</ul></section><section><h2 class="section-heading" id="software-environment">Software Environment<a class="anchor" aria-label="anchor" href="#software-environment"></a>
</h2>
<hr class="half-width">
<p>Data analysis is done using specific software, libraries or packages,
in a variety of versions. And it happens in an environment on the
computer that might not be identical from day to day.</p>
<p>One example of these problems is shown every time we load tidyverse:
<img src="fig/tidyverse_conflicts.png" alt="Screenshot of messages from attaching core tidyverse packages including conflicts" class="figure"></p>
<p>This message informs us that there is a <code>filter()</code>
function in the <code>stats</code> packages which is part of the core
R-installation. That function is masked by the <code>filter()</code>
function from the <code>tidyverse´ package</code>dplyr`.</p>
<p>If our analysis relies on the way the <code>filter()</code> function
works in the <code>tidyverse</code>, we will get errors if
<code>tidyverse</code> is not loaded.</p>
<p>We might also have data stored in memory. Every time we close
RStudio, we are asked if we want to save the environment:</p>
<figure><img src="fig/save_environment.png" alt="Screenshot of dialog box from RStudio asking about saving workspace image" class="figure mx-auto d-block"><div class="figcaption">Should we save the environment? No!</div>
</figure><p>This will save all the objects we have in our environment, in order
for RStudio to be able to load them into memory when we open RStudio
again.</p>
<p>That can be nice and useful. On the other hand we run the risk of
having the wrong version of the
<code>my_data_that_is_ready_for_analysis</code> dataframe lying around
in memory.</p>
<p>In addition we can experience performance problems. Storing a lot of
large objects before closing RStudio can take a lot of time. And loading
them into memory when opening RStudio will also take a lot of time.</p>
<p>On modern computers we normally have plenty of storage - but it is
entirely possible to fill your harddrive with R-environments to the
point where your computer crashes.</p>
</section><section><h2 class="section-heading" id="documentation-and-metadata">Documentation and Metadata<a class="anchor" aria-label="anchor" href="#documentation-and-metadata"></a>
</h2>
<hr class="half-width">
<p>What did we actually do in the analysis? Why did we do it? Why are we
reaching the conclusion we’ve arrived at?</p>
<p>Three very good questions. Having good metadata, data that describes
your data, often makes understanding your data easier. Documenting the
individual steps of your analysis, may not seem necessary right now -
you know why you are doing what you are doing. But future you - you in
three months, or some one else, might not remember or be able to guess
(correctly).</p>
</section><section><h2 class="section-heading" id="complex-workflows">Complex Workflows<a class="anchor" aria-label="anchor" href="#complex-workflows"></a>
</h2>
<hr class="half-width">
<p>Doing data analysis in eg Excel, can involve a lot of pointing and
clicking.</p>
<p>And in any piece of software, the analysis will normally always
involve more than one step. Those steps will have to be done in the
correct order. Calculating a mean of some values, depends heavily on
whether it happens before or after deleting irrelevant observations.</p>
</section><section><h2 class="section-heading" id="the-solution-to-all-of-this">The solution to all of this!<a class="anchor" aria-label="anchor" href="#the-solution-to-all-of-this"></a>
</h2>
<hr class="half-width">
<figure><img src="fig/horstmarkdown.png" alt="A glam rock band comprised of 3 fuzzy round monsters labeled as “Text”, “Outputs” and “Code” performing together. Stylized title text reads: “R Markdown - we’re getting the band back together." class="figure mx-auto d-block"><div class="figcaption">The Rmarkdown family. Artwork by <span class="citation">@allison_horst</span>, <a href="https://twitter.com/allison_horst" class="external-link uri">https://twitter.com/allison_horst</a>, CC-BY</div>
</figure><p>Working in RMarkdown allows us to collect the text describing our
data, what and why we are doing what we do, the code actually doing it,
and the results of that code - all in one document.</p>
<p>Open a new file, choose RMarkdown, and give your document a name:</p>
<figure><img src="fig/rmarkdown.png" alt="Screenshot of initial demo Rmarkdown document in RStudio" class="figure mx-auto d-block"><div class="figcaption">An RMarkdown document</div>
</figure><p>The code chunks, marked here with a light grey background, contains
code, in this case not very advanced code. You can run the entire code
chunk by clicking the green arrow on the right. Or by placing your
cursor in the line of code you want to run, and pressing ctrl+enter (or
command+enter on a Mac).</p>
<p>Outside the code chunks we can add our reasons for actually running
<code>summary</code> on the <code>cars</code> dataframe, and describe
what it contains.</p>
<p>You will see a new button in RStudio: <img src="fig/knitr_button.png" alt="Screenshot of the Knit-button in RStudio" class="figure"></p>
<p>Clicking this, will “knit” your document; run each chunck of code,
add the output to your document, and combine your code, the results and
all your explanatory text to one html-document.</p>
<p>If you do not want an HTMl-document, you can knit to a MicroSoft Word
document. Depending on your computer, you can knit directly to a
pdf.</p>
<p>Having the entirety of your analysis in an RMarkdown document, and
then running it, ensures that the individual steps in the analysis are
run in the correct order.</p>
<p>It does not ensure that your documentation of what you do is written
- it makes it easy to add it, but you still have to do it.</p>
<div class="section level3">
<h3 id="but-what-about-the-environment">But what about the environment?<a class="anchor" aria-label="anchor" href="#but-what-about-the-environment"></a>
</h3>
<p>So we force ourself to have the steps in our analysis in the correct
order, and we make it easy to add documentation. What about the
environment?</p>
<p>Working with RMarkdown also adresses this problem. Every time we
<code>knit</code> our document, RStudio opens a new session of R,
without libraries or objects in memory. This ensures that the analysis
is done in the exact same way each and every time.</p>
<p>This, on the other hand, requires us to add code chunks loading
libraries and data to our document.</p>
<div id="try-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>Make a new RMarkdown document, add <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code> to
the first chunk, add your own text, and change the plot to plot the
<code>distance</code> variable from the <code>cars</code> data set.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Make a new RMarkdown document - File -&gt; New File -&gt; R
Markdown.</p>
<p>Change the final code chunk to include <code>plot(cars$dist)</code>
instead of plot(pressure), and add <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use RMarkdown to enforce reproducible analysis</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-reading-files"><p>Content from <a href="reading-files.html">Reading data from file</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/reading-files.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you read in data from files?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to read in data from a selection of different data
files.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The first step of doing dataanalysis, is normally to read in the
data.</p>
<p>Data can come from many different sources, and it is practically
impossible to cover every possible format. Here we cover some of the
more common.</p>

<figure><img src="fig/manyfiles.webp" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="use-code">Use code!<a class="anchor" aria-label="anchor" href="#use-code"></a>
</h2>
<hr class="half-width">
<p>RStudio makes it simple to load most common data formats: Click on
the file in the “Files” tab in RStudio, and choose “Import Dataset”:</p>
<figure><img src="fig/import-file.png" class="figure mx-auto d-block"></figure><p>RStudio will then provide an interface for loading the data:</p>
<figure><img src="fig/data_import.png" class="figure mx-auto d-block"></figure><p>However in general we prefer to have a script or a document, that can
be run without us pointing and clicking. So - instead of importing the
data in this way, copy the code that RStudio uses to import the data,
and paste it into your script or document.</p>
</section><section><h2 class="section-heading" id="csv-files">CSV-files<a class="anchor" aria-label="anchor" href="#csv-files"></a>
</h2>
<hr class="half-width">
<p>The most basic file type for storing and transferring data. A
“simple” textfile, containing tabular data. One line of text for each
row of data, each cell in that row, corresponding to a column, separated
with a separator, typically a comma.</p>
<p>Many languages use commas as decimal separators. That neccesitates an
option for using something else than a comma. Typically a semicolon.</p>
<div class="section level3">
<h3 id="truly-commaseparated-files">Truly commaseparated files<a class="anchor" aria-label="anchor" href="#truly-commaseparated-files"></a>
</h3>
<p>Use <code>read.csv()</code> (from base-R) or <code>read_csv()</code>
(from <code>readr</code>, included in <code>tidyverse</code>)</p>
<p>We recommend using <code>read_csv()</code>.</p>
</div>
<div class="section level3">
<h3 id="semicolon-separated-files">Semicolon separated files<a class="anchor" aria-label="anchor" href="#semicolon-separated-files"></a>
</h3>
<p>Use <code>read.csv2()</code> (from base-R) or
<code>read_csv2()</code> (from <code>readr</code>, included in
<code>tidyverse</code>)</p>
<p>We recommend <code>read_csv2()</code></p>
</div>
<div class="section level3">
<h3 id="what-they-have-in-common">What they have in common<a class="anchor" aria-label="anchor" href="#what-they-have-in-common"></a>
</h3>
<p><code>read_csv</code> and <code>read_csv2</code> take a lot of
arguments that can control datatypes, handling of headers etc. For most
use, the default options are enough, but if you need to adjust
something, there are plenty of options for that.</p>
<div id="guess_max" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="guess_max" class="callout-inner">
<h3 class="callout-title">guess_max</h3>
<div class="callout-content">
<p><code>read_csv</code> and <code>read_csv2</code> tries to guess the
datatypes in the file, and will convert the data accordingly. That will
return a dataframe where date-time data is stored as such. The functions
by default reads the first 1000 rows, and makes a guess on the datatype
based on that.</p>
<p>That can lead to problems if the first 1000 rows of a column contain
numbers, and row 1001 contains text. In that case the entire row will be
coerced to <code>numeric</code>, and the following rows will contain
<code>NA</code> values. Adjust the argument <code>guess_max</code> to
something larger to catch this problem.</p>
<p>To include every row in the guess, add <code>guess_max = Inf</code> -
but be careful if you have a very large dataset.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="excel-files">Excel-files<a class="anchor" aria-label="anchor" href="#excel-files"></a>
</h2>
<hr class="half-width">
<p>Use the <code>readxl</code> package. Excel comes in two variants,
<code>xls</code> and <code>xlsx</code>. <code>read_excel()</code> makes
a qualified quess of the actual type your excel-file is. Should we need
to specify, we can use <code>read_xls()</code> or
<code>read_xlsx()</code>.</p>
<p>Workbooks often contains more than one sheet. We can specify which we
want to read in:</p>
<p><code>read_excel(path = "filename", sheet = 2)</code></p>
<p>Which will read in sheet number 2 from the workbook “filename”.</p>
<p>Read the documentation for details on how to read in specific cells
or ranges.</p>
</section><section><h2 class="section-heading" id="spss">SPSS<a class="anchor" aria-label="anchor" href="#spss"></a>
</h2>
<hr class="half-width">
<p>SPSS, originally “Statistical Package for the Social Sciences”, later
renamed “Statistical Product and Service Solutions” is a proprietary
statistical software suite developed by IBM.</p>
<p>Not surprisingly it is widely used in social science.</p>
<p>The package <code>haven</code> supports reading SPSS (Stata and SAS)
files</p>
<p>Use the package to read in spss files:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_spss</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>Note that SPSS uses a variety of different formats.
<code>read_spss()</code> will make a guess of the correct format, but if
problems arise, try using one of the other functions provided in
<code>haven</code></p>
</section><section><h2 class="section-heading" id="stata">Stata<a class="anchor" aria-label="anchor" href="#stata"></a>
</h2>
<hr class="half-width">
<p>Stata is a proprietary statistical software package, used in a
multitude of different fields, primarily biomedicine, epidemiololy,
sociology and economics.</p>
<p>As mentioned above, the <code>haven</code> package provides functions
for reading Stata files:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_stata</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>As with SPSS Stata uses a couple of different fileformats, and
<code>read_stata</code> makes a guess as to which format is used. If
problems arise, <code>haven</code> has more specific functions for
reading specific file formats.</p>
</section><section><h2 class="section-heading" id="sas">SAS<a class="anchor" aria-label="anchor" href="#sas"></a>
</h2>
<hr class="half-width">
<p>SAS is a proprietary statistical software suite developed by SAS
Institute.</p>
<figure><img src="fig/SasScreenshot.png" class="figure mx-auto d-block"></figure><p>The package <code>haven</code> can read SAS-files:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_sas</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>As with SPSS and Stata, SAS uses a couple of different fileformats,
and <code>read_sas</code> tries to guess the correct format.</p>
<p>If problems arise, <code>haven</code> has more specific functions for
reading specific file formats.</p>
</section><section><h2 class="section-heading" id="json">JSON<a class="anchor" aria-label="anchor" href="#json"></a>
</h2>
<hr class="half-width">
<p>Not all data come in a nice rectangular format, note the multiple
phone numbers for the White House:</p>
<table style="width:97%;" class="table">
<colgroup>
<col width="50%">
<col width="20%">
<col width="22%">
<col width="4%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2">
<h1 id="country">Country</h1>
<p>USA</p>
</td>
<td rowspan="2">
<h1 id="name">Name</h1>
<p>NASA</p>
</td>
<td rowspan="2">
<h1 id="phonenumber">Phonenumber</h1>
<ol start="713" style="list-style-type: decimal">
<li>483-3111</li>
</ol>
</td>
<td></td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>White House</td>
<td>
<ol start="202" style="list-style-type: decimal">
<li>456-1414</li>
</ol>
<p>(202)-456-1111</p>
</td>
<td></td>
</tr>
<tr class="even">
<td>Russia</td>
<td>Kremlin</td>
<td colspan="2">0107-095-295-9051</td>
</tr>
<tr class="odd">
<td>Vatican</td>
<td>The Pope</td>
<td>011-39-6-6982</td>
<td></td>
</tr>
</tbody>
</table>
<p>There are two locations in the US, and one of them have two phone
numbers. These kinds of structures, where one row contains data with
more than one row (etc), are called nested, and are often stored or
distributed in the JSON-format.</p>
<p>JSON can be read using <code>fromJSON()</code> from the
<code>jsonlite</code> library.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="fu">fromJSON</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>Note that you will end up with nested columns - containing lists -
which you probably will have to handle afterwards.</p>
</section><section><h2 class="section-heading" id="other-formats">Other formats<a class="anchor" aria-label="anchor" href="#other-formats"></a>
</h2>
<hr class="half-width">
<p>In general if a piece of software is in widespread enough use that
you encounter the weird file-format it uses, someone will have written a
package for reading it. Google is your friend here!</p>
<p>Also, if you encounter a really weird dataformat, please send us an
example so we can expand our knowledge.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The <code>readr</code> version of <code>read_csv()</code> is
preferred</li>
<li>Remember that csv is not always actually separated with commas.</li>
<li>The <code>haven</code> package contains functions for reading common
proprietary file formats.</li>
<li>In general a package will exist for reading strange datatypes.
Google is your friend!</li>
<li>Use code to read in your data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-descript-stat"><p>Content from <a href="descript-stat.html">Descriptive Statistics</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/descript-stat.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we describe a set of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn about the most common ways of describing a variable</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Descriptive statistic involves summarising or describing a set of
data. It usually presents quantitative descriptions in a short form, and
helps to simplify large datasets.</p>
<p>Most descriptive statistical parameters applies to just one variable
in our data, and includes:</p>
<table class="table">
<thead><tr class="header">
<th>Central tendency</th>
<th>Measure of variation</th>
<th>Measure of shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>Range</td>
<td>Skewness</td>
</tr>
<tr class="even">
<td>Median</td>
<td>Quartiles</td>
<td>Kurtosis</td>
</tr>
<tr class="odd">
<td>Mode</td>
<td>Inter Quartile Range</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Variance</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>Standard deviation</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Percentiles</td>
<td></td>
</tr>
</tbody>
</table></section><section><h2 class="section-heading" id="central-tendency">Central tendency<a class="anchor" aria-label="anchor" href="#central-tendency"></a>
</h2>
<hr class="half-width">
<p>The easiest way to get summary statistics on data is to use the
<code>summarise</code> function from the <code>tidyverse</code>
package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>In the following we are working with the <code>palmerpenguins</code>
dataset. Note that the actual data is called <code>penguins</code> and
is part of the package <code>palmerpenguins</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'palmerpenguins'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:datasets':

    penguins, penguins_raw</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
1 Adelie  Torgersen           39.1          18.7               181        3750
2 Adelie  Torgersen           39.5          17.4               186        3800
3 Adelie  Torgersen           40.3          18                 195        3250
4 Adelie  Torgersen           NA            NA                  NA          NA
5 Adelie  Torgersen           36.7          19.3               193        3450
6 Adelie  Torgersen           39.3          20.6               190        3650
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
<p>344 penguins have been recorded at three different islands over three
years. Three different penguin species are in the dataset, and we have
data on their weight, sex, length of their flippers and two measurements
of their bill (beak).</p>
<p><img src="fig/culmen_depth.png" alt="What is lenght and depth of penguin bills?" class="figure">{Copyright Allison
Horst}</p>
<p>Specifically we are going to work with the weight of the penguins,
stored in the variable <code>body_mass_g</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] 3750 3800 3250   NA 3450 3650 3625 4675 3475 4250 3300 3700 3200 3800 4400
 [16] 3700 3450 4500 3325 4200 3400 3600 3800 3950 3800 3800 3550 3200 3150 3950
 [31] 3250 3900 3300 3900 3325 4150 3950 3550 3300 4650 3150 3900 3100 4400 3000
 [46] 4600 3425 2975 3450 4150 3500 4300 3450 4050 2900 3700 3550 3800 2850 3750
 [61] 3150 4400 3600 4050 2850 3950 3350 4100 3050 4450 3600 3900 3550 4150 3700
 [76] 4250 3700 3900 3550 4000 3200 4700 3800 4200 3350 3550 3800 3500 3950 3600
 [91] 3550 4300 3400 4450 3300 4300 3700 4350 2900 4100 3725 4725 3075 4250 2925
[106] 3550 3750 3900 3175 4775 3825 4600 3200 4275 3900 4075 2900 3775 3350 3325
[121] 3150 3500 3450 3875 3050 4000 3275 4300 3050 4000 3325 3500 3500 4475 3425
[136] 3900 3175 3975 3400 4250 3400 3475 3050 3725 3000 3650 4250 3475 3450 3750
[151] 3700 4000 4500 5700 4450 5700 5400 4550 4800 5200 4400 5150 4650 5550 4650
[166] 5850 4200 5850 4150 6300 4800 5350 5700 5000 4400 5050 5000 5100 4100 5650
[181] 4600 5550 5250 4700 5050 6050 5150 5400 4950 5250 4350 5350 3950 5700 4300
[196] 4750 5550 4900 4200 5400 5100 5300 4850 5300 4400 5000 4900 5050 4300 5000
[211] 4450 5550 4200 5300 4400 5650 4700 5700 4650 5800 4700 5550 4750 5000 5100
[226] 5200 4700 5800 4600 6000 4750 5950 4625 5450 4725 5350 4750 5600 4600 5300
[241] 4875 5550 4950 5400 4750 5650 4850 5200 4925 4875 4625 5250 4850 5600 4975
[256] 5500 4725 5500 4700 5500 4575 5500 5000 5950 4650 5500 4375 5850 4875 6000
[271] 4925   NA 4850 5750 5200 5400 3500 3900 3650 3525 3725 3950 3250 3750 4150
[286] 3700 3800 3775 3700 4050 3575 4050 3300 3700 3450 4400 3600 3400 2900 3800
[301] 3300 4150 3400 3800 3700 4550 3200 4300 3350 4100 3600 3900 3850 4800 2700
[316] 4500 3950 3650 3550 3500 3675 4450 3400 4300 3250 3675 3325 3950 3600 4050
[331] 3350 3450 3250 4050 3800 3525 3950 3650 3650 4000 3400 3775 4100 3775</code></pre>
</div>
<p>How can we describe these values?</p>
<div class="section level3">
<h3 id="mean">Mean<a class="anchor" aria-label="anchor" href="#mean"></a>
</h3>
<p>The mean is the average of all datapoints. We add all values
(excluding the missing values encoded with <code>NA</code>), and divide
with the number of observations:</p>
<p><span class="math display">\[\overline{x} = \frac{1}{N}\sum_1^N
x_i\]</span> Where N is the number of observations, and <span class="math inline">\(x_i\)</span> is the individual observations in the
sample <span class="math inline">\(x\)</span>.</p>
<p>The easiest way of getting the mean is using the <code>mean()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4201.754</code></pre>
</div>
<p>A slightly more cumbersome way is using the <code>summarise()</code>
function from <code>tidyverse</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_mass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  avg_mass
     &lt;dbl&gt;
1    4202.</code></pre>
</div>
<p>As we will see below, this function streamlines the process of
getting multiple descriptive values.</p>
<p>Barring significant outliers, <code>mean</code> is an expression of
position of the data. This is the weight we would expect a random
penguin in our dataset to have.</p>
<p>However, we have three different species of penguins in the dataset,
and they have quite different average weights. There is also a
significant difference in the average weight for the two sexes.</p>
<p>We will get to that at the end of this segment.</p>
</div>
<div class="section level3">
<h3 id="median">Median<a class="anchor" aria-label="anchor" href="#median"></a>
</h3>
<p>Similarly to the average/mean, the <code>median</code> is an
expression of the location of the data. If we order our data by size,
from the smallest to the largest value, and locate the middle
observation, we get the median. This is the value that half of the
observations is smaller than. And half the observations is larger.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">median</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4050</code></pre>
</div>
<p>We can note that the mean is larger than the median. This indicates
that the data is skewed, in this case toward the larger penguins.</p>
<p>We can get both <code>median</code> and <code>mean</code> in one go
using the <code>summarise()</code> function:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            mean   <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  median  mean
   &lt;dbl&gt; &lt;dbl&gt;
1   4050 4202.</code></pre>
</div>

</div>
<div class="section level3">
<h3 id="mode">Mode<a class="anchor" aria-label="anchor" href="#mode"></a>
</h3>
<p>Mode is the most common, or frequently occurring, observation. R does
not have a build-in function for this, but we can easily find the mode
by counting the different observations,and locating the most common
one.</p>
<p>We typically do not use this for continous variables. The mode of the
<code>sex</code> variable in this dataset can be found like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male     168
2 female   165
3 &lt;NA&gt;      11</code></pre>
</div>
<p>We count the different values in the <code>sex</code> variable, and
arrange the counts in descending order (<code>desc</code>). The mode of
the <code>sex</code> variable is male.</p>
<p>In this specific case, we note that the dataset is pretty evenly
balanced regarding the two sexes.</p>
</div>
</section><section><h2 class="section-heading" id="measures-of-variance">Measures of variance<a class="anchor" aria-label="anchor" href="#measures-of-variance"></a>
</h2>
<hr class="half-width">
<p>Knowing where the observations are located is interesting. But how do
they vary? How can we describe the variation in the data?</p>
<div class="section level3">
<h3 id="range">Range<a class="anchor" aria-label="anchor" href="#range"></a>
</h3>
<p>The simplest information about the variation is the range. What is
the smallest and what is the largest value? Or, what is the spread?</p>
<p>We can get that by using the <code>min()</code> and
<code>max()</code> functions in a <code>summarise()</code> function:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
    min   max
  &lt;int&gt; &lt;int&gt;
1  2700  6300</code></pre>
</div>
<p>There is a dedicated function, <code>range()</code>, that does the
same. However it returns two values (for each row), and the summarise
function expects to get <em>one</em> value.</p>
<p>If we would like to use the <code>range()</code> function, we can add
it using the <code>reframe()</code> function instead of
<code>summarise()</code>:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">reframe</span><span class="op">(</span>range <span class="op">=</span> <span class="fu">range</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 1
  range
  &lt;int&gt;
1  2700
2  6300</code></pre>
</div>

</div>
<div class="section level3">
<h3 id="variance">Variance<a class="anchor" aria-label="anchor" href="#variance"></a>
</h3>
<p>The observations varies. They are not all located at the mean (or
median), but are spread out on both sides of the mean. Can we get a
numerical value describing that?</p>
<p>An obvious way would be to calculate the difference between each of
the observations and the mean, and then take the average of those
differences.</p>
<p>That will give us the average deviation. But we have a problem. The
average weight of penguins was 4202 (rounded). Look at two penguins, one
weighing 5000, and another weighing 3425. The differences are:</p>
<ul>
<li>5000 - 4202 = 798</li>
<li>3425 - 4202 = -777</li>
</ul>
<p>The sum of those two differences is: -777 + 798 = 21 g. And the
average is then 10.5 gram. That is <em>not</em> a good estimate of a
variation from the mean of more than 700 gram.</p>
<p>The problem is, that the differences can be both positive and
negative, and might cancel each other out.</p>
<p>We solve that problem by squaring the differences, and calculate the
mean of those.</p>

<p>For the population variance, the mathematical notation would be:</p>
<p><span class="math display">\[
\sigma^2 = \frac{\sum_{i=1}^N(x_i - \mu)^2}{N}
\]</span></p>
<div id="population-or-sample" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="population-or-sample" class="callout-inner">
<h3 class="callout-title">Population or sample?</h3>
<div class="callout-content">
<p>Why are we suddenly using <span class="math inline">\(\mu\)</span>
instead of <span class="math inline">\(\overline{x}\)</span>? Because
this definition uses the population mean. The mean, or average, in the
entire population of all penguins everywhere in the universe. But we
have not weighed all those penguins.</p>
</div>
</div>
</div>
<p>And the sample variance:</p>
<p><span class="math display">\[
s^2 = \frac{\sum_{i=1}^N(x_i - \overline{x})^2}{N-1}
\]</span></p>
<p>Note that we also change the <span class="math inline">\(\sigma\)</span> to an <span class="math inline">\(s\)</span>.</p>
<p>And again we are not going to do that by hand, but will ask R to do
it for us:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            variance <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  variance
     &lt;dbl&gt;
1  643131.</code></pre>
</div>

</div>
<div class="section level3">
<h3 id="standard-deviation">Standard deviation<a class="anchor" aria-label="anchor" href="#standard-deviation"></a>
</h3>
<p>There is a problem with the variance. It is 643131, completely off
scale from the actual values. There is also a problem with the unit
which is in <span class="math inline">\(g^2\)</span>.</p>
<p>A measurement of the variation of the data would be the standard
deviation, simply defined as the square root of the variance:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            s <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
      s
  &lt;dbl&gt;
1  802.</code></pre>
</div>
<p>Since the standard deviation occurs in several statistical tests, it
is more frequently used than the variance. It is also more intuitively
relateable to the mean.</p>
</div>
</section><section><h2 class="section-heading" id="a-histogram">A histogram<a class="anchor" aria-label="anchor" href="#a-histogram"></a>
</h2>
<hr class="half-width">
<p>A visual illustration of the data can be nice. Often one of the first
we make, is a histogram.</p>
<p>A histogram is a plot or graph where we split the range of
observations in a number of “buckets”, and count the number of
observations in each bucket:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>buckets <span class="op">=</span> <span class="fu">cut</span><span class="op">(</span><span class="va">body_mass_g</span>, breaks<span class="op">=</span><span class="fu">seq</span><span class="op">(</span><span class="fl">2500</span>,<span class="fl">6500</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">group_by</span><span class="op">(</span><span class="va">buckets</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>antal <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 2
  buckets         antal
  &lt;fct&gt;           &lt;int&gt;
1 (2.5e+03,3e+03]    11
2 (3e+03,3.5e+03]    67
3 (3.5e+03,4e+03]    92
4 (4e+03,4.5e+03]    57
5 (4.5e+03,5e+03]    54
6 (5e+03,5.5e+03]    33
7 (5.5e+03,6e+03]    26
8 (6e+03,6.5e+03]     2</code></pre>
</div>
<p>Typically, rather than counting ourself, we leave the work to R, and
make a histogram directly:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>By default ggplot chooses 30 bins, typically we should chose a
different number:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-change_bin_n-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Or, ideally, set the widths of them, manually:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">250</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with binwidth = 250 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="fig/descript-stat-rendered-change_bin_width-1.png" style="display: block; margin: auto;" class="figure">
Or even specify the exact intervals we want, here intervals from 0 to
6500 gram in intervals of 250 gram:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6500</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with bins in 250 g steps from 0 to 6500 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="fig/descript-stat-rendered-bin_breaks-1.png" style="display: block; margin: auto;" class="figure">
The histogram provides us with a visual indication of both range, the
variation of the values, and an idea about where the data is
located.</p>
</section><section><h2 class="section-heading" id="quartiles">Quartiles<a class="anchor" aria-label="anchor" href="#quartiles"></a>
</h2>
<hr class="half-width">
<p>The median can be understood as splitting the data in two equally
sized parts, where one is characterized by having values smaller than
the median and the other as having values larger than the median. It is
the value where 50% of the observations are smaller.</p>
<p>Similary we can calculate the value where 25% of the observations are
smaller.</p>
<p>That is often called the first quartile, where the median is the 50%,
or second quartile. Quartile implies four parts, and the existence of a
third or 75% quartile.</p>
<p>We can calcultate those using the quantile function:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 25%
3550 </code></pre>
</div>
<p>and</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 75%
4750 </code></pre>
</div>

<p>We are often interested in knowing the range in which 50% of the
observations fall.</p>
<p>That is used often enough that we have a dedicated function for
it:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
    iqr
  &lt;dbl&gt;
1  1200</code></pre>
</div>
<p>The name of the quantile function implies that we might have other
quantiles than quartiles. Actually we can calculate any quantile, eg the
2.5% quantile:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.025</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    2.5%
2988.125 </code></pre>
</div>
<p>The individual quantiles can be interesting in themselves. If we want
a visual representation of <em>all</em> quantiles, we can calculate all
of them, and plot them.</p>
<p>Instead of doing that by hand, we can use a concept called
<em>CDF</em> or cumulative density function:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CDF</span> <span class="op">&lt;-</span> <span class="fu">ecdf</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span></span>
<span><span class="va">CDF</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Empirical CDF
Call: ecdf(penguins$body_mass_g)
 x[1:94] =   2700,   2850,   2900,  ...,   6050,   6300</code></pre>
</div>
<p>That was not very informative. Lets plot it:</p>
<figure><img src="fig/descript-stat-rendered-cdf-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="measures-of-shape">Measures of shape<a class="anchor" aria-label="anchor" href="#measures-of-shape"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="skewness">Skewness<a class="anchor" aria-label="anchor" href="#skewness"></a>
</h3>
<p>We previously saw a histogram of the data, and noted that the
observations were skewed to the left, and that the “tail” on the right
was longer than on the left. That skewness can be quantised.</p>
<p>There is no function for skewness build into R, but we can get it
from the library <code>e1071</code></p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="fu">skewness</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4662117</code></pre>
</div>
<p>The skewness is positive, indicating that the data are skewed to the
left, just as we saw. A negative skewness would indicate that the data
skew to the right.</p>

</div>
<div class="section level3">
<h3 id="kurtosis">Kurtosis<a class="anchor" aria-label="anchor" href="#kurtosis"></a>
</h3>
<p>Another parameter describing the shape of the data is kurtosis. We
can think of that as either “are there too many observations in the
tails?” leading to a relatively low peak. Or, as “how pointy is the
peak” - because the majority of observations are centered in the peak,
rather than appearing in the tails.</p>
<p>We use the <code>e1071</code> package again:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kurtosis</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.73952</code></pre>
</div>
<p>Kurtosis is defined weirdly, and here we get “excess” kurtosis, the
actual kurtosis minus 3. We have negative kurtosis, indicating that the
peak is flat, and the tails are fat.</p>
</div>
</section><section><h2 class="section-heading" id="everything-everywhere-all-at-once">Everything Everywhere All at Once<a class="anchor" aria-label="anchor" href="#everything-everywhere-all-at-once"></a>
</h2>
<hr class="half-width">
<p>A lot of these descriptive values can be gotten for every variable in
the dataset using the <code>summary</code> function:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      species          island    bill_length_mm  bill_depth_mm
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30
                                 Mean   :43.92   Mean   :17.15
                                 3rd Qu.:48.50   3rd Qu.:18.70
                                 Max.   :59.60   Max.   :21.50
                                 NA's   :2       NA's   :2
 flipper_length_mm  body_mass_g       sex           year
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007
 Median :197.0     Median :4050   NA's  : 11   Median :2008
 Mean   :200.9     Mean   :4202                Mean   :2008
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009
 Max.   :231.0     Max.   :6300                Max.   :2009
 NA's   :2         NA's   :2                                 </code></pre>
</div>
<p>Here we get the range, the 1st and 3rd quantiles (and from those the
IQR), the median and the mean and, rather useful, the number of missing
values in each variable.</p>
<p>We can also get all the descriptive values in one table, by adding
more than one summarizing function to the summarise function:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            var <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q1 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q3 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            skew <span class="op">=</span> <span class="fu">skewness</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            kurtosis <span class="op">=</span> <span class="fu">kurtosis</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 11
    min   max  mean median stddev     var    Q1    Q3   iqr  skew kurtosis
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1  2700  6300 4202.   4050   802. 643131.  3550  4750  1200 0.466   -0.740</code></pre>
</div>
<p>As noted, we have three different species of penguins in the dataset.
Their weight varies a lot. If we want to do the summarising on each for
the species, we can group the data by species, before summarising:</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 6
  species     min   max  mean median stddev
  &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Adelie     2850  4775 3701.   3700   459.
2 Chinstrap  2700  4800 3733.   3700   384.
3 Gentoo     3950  6300 5076.   5000   504.</code></pre>
</div>
<p>We have removed some summary statistics in order to get a smaller
table.</p>
</section><section><h2 class="section-heading" id="boxplots">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h2>
<hr class="half-width">
<p>Finally boxplots offers a way of visualising some of the summary
statistics:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-boxplots-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The boxplot shows us the median (the fat line in the middel of each
box), the 1st and 3rd quartiles (the ends of the boxes), and the range,
with the whiskers at each end of the boxes, illustrating the minimum and
maximum. Any observations, more than 1.5 times the IQR from either the
1st or 3rd quartiles, are deemed as outliers and would be plotted as
individual points in the plot.</p>
</section><section><h2 class="section-heading" id="counting">Counting<a class="anchor" aria-label="anchor" href="#counting"></a>
</h2>
<hr class="half-width">
<p>Most of the descriptive functions above are focused on continuous
variables, maybe grouped by one or more categorical variables.</p>
<p>What about the categorical themselves?</p>
<p>The one thing we can do looking only at categorical variables, is
counting.</p>
<p>Counting the different values in a single categorical variable in
base-R is done using the <code>table(()</code> function</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
female   male
   165    168 </code></pre>
</div>
<p>Often we are interested in cross tables, tables where we count the
different combinations of the values in more than one categorical
variable, eg the distribution of the two different penguin sexes on the
three different islands:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">island</span>, <span class="va">penguins</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
            female male
  Biscoe        80   83
  Dream         61   62
  Torgersen     24   23</code></pre>
</div>
<p>We can event group on three (or more) categorical variables, but the
output becomes increasingly difficult to read the mote variables we
add:</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">island</span>, <span class="va">penguins</span><span class="op">$</span><span class="va">sex</span>, <span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>, ,  = Adelie


            female male
  Biscoe        22   22
  Dream         27   28
  Torgersen     24   23

, ,  = Chinstrap


            female male
  Biscoe         0    0
  Dream         34   34
  Torgersen      0    0

, ,  = Gentoo


            female male
  Biscoe        58   61
  Dream          0    0
  Torgersen      0    0</code></pre>
</div>
</section><section><h2 class="section-heading" id="aggregate">Aggregate<a class="anchor" aria-label="anchor" href="#aggregate"></a>
</h2>
<hr class="half-width">
<p>A different way of doing that in base-R is using the
<code>aggregate()</code> function:</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">aggregate</span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">island</span>, data <span class="op">=</span> <span class="va">penguins</span>, FUN <span class="op">=</span> <span class="va">length</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     island sex
1    Biscoe 163
2     Dream 123
3 Torgersen  47</code></pre>
</div>
<p>Here we construct the crosstable using the formula notation, and
specify which function we want to apply on the results. This can be used
to calculate summary statistics on groups, by adjusting the
<code>FUN</code> argument.</p>
</section><section><h2 class="section-heading" id="counting-in-tidyverse">Counting in tidyverse<a class="anchor" aria-label="anchor" href="#counting-in-tidyverse"></a>
</h2>
<hr class="half-width">
<p>In tidyverse we will typically group the data by the variables we
want to count, and then tallying them:</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  sex        n
  &lt;fct&gt;  &lt;int&gt;
1 female   165
2 male     168
3 &lt;NA&gt;      11</code></pre>
</div>
<p><code>group_by</code> works equally well with more than one
group:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span>, <span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 3
# Groups:   sex [3]
  sex    species       n
  &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;
1 female Adelie       73
2 female Chinstrap    34
3 female Gentoo       58
4 male   Adelie       73
5 male   Chinstrap    34
6 male   Gentoo       61
7 &lt;NA&gt;   Adelie        6
8 &lt;NA&gt;   Gentoo        5</code></pre>
</div>
<p>But the output is in a long format, and often requires some
manipulation to get into a wider tabular format.</p>
<p>A shortcut exists in tidyverse, <code>count</code>, which combines
group_by and tally:</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span>, <span class="va">species</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 3
  sex    species       n
  &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;
1 female Adelie       73
2 female Chinstrap    34
3 female Gentoo       58
4 male   Adelie       73
5 male   Chinstrap    34
6 male   Gentoo       61
7 &lt;NA&gt;   Adelie        6
8 &lt;NA&gt;   Gentoo        5</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We have access to a lot of summarising descriptive indicators the
the location, spread and shape of our data.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-histograms"><p>Content from <a href="histograms.html">Histograms</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/histograms.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a histogram?</li>
<li>What do we use histograms for?</li>
<li>What is the connection between number of bins, binwidths and
breaks?</li>
<li>How do we chose a suitable number of bins?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand what a histogram is, and what it is used for</li>
<li>Introduce a number of heuristics for chosing the “correct” number of
bins</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-even-is-a-histogram">What even is a histogram?<a class="anchor" aria-label="anchor" href="#what-even-is-a-histogram"></a>
</h2>
<hr class="half-width">
<p>We use histograms to visualise the distribution of some continuous
variable. It have values between a minimum and maximum value (range),
but are these values equally probable? Probably not.</p>
<p>In a histogram we divide the range in a number of bins, count the
number of observations in each bin, and make a plot with a bar for each
bin, where the height is equivalent to the number of observations in
each bin.</p>
<p>Normally the bins have equal width - equal to the range of the
variable (max - min), divided by the number of bins.</p>
</section><section><h2 class="section-heading" id="how-do-we-do-that">How do we do that?<a class="anchor" aria-label="anchor" href="#how-do-we-do-that"></a>
</h2>
<hr class="half-width">
<p>Let us look at some data - penguin data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<p>R has a build-in histogram function, <code>hist()</code>, which will
make a basic histogram, of the data we provide it with:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/histograms-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is not a very nice looking histogram, and <code>ggplot2</code>
provides us with a more easily customisable
<code>geom_histogram()</code> function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">penguins</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/histograms-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is the distibution of the length, in millimeter, of the bill (or
beak) of a selection of penguins.</p>
<p>By default the <code>geom_histogram()</code> function divides the
range of the data (min = 32.1, max = 59.6 mm) into 30 bins. Each bin
therefore have a width of 0.9167 mm. The first bin contains a single
penguin, that has a beak that is between 32.1 and 32.1 + 0.9187 mm
long.</p>
<p>From this plot we get information about the distribution of
bill-lengths of penguins.</p>
<p>There appears to be several different “peaks” in the plot. This is to
be expected as we have three different species of penguins in the data,
in addition to having penguins of both sexes.</p>
<p>If we want to split the histogram into these different groups, we can
use the possibilities available in <code>ggplot2</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">penguins</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">sex</span><span class="op">~</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/histograms-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The data now looks a bit more normally distributed. And we can
observe that male penguins tend to have longer beaks than female
penguins. We can also see that the different species of penguins have
different bill lengths.</p>
</section><section><h2 class="section-heading" id="how-many-bins">How many bins?<a class="anchor" aria-label="anchor" href="#how-many-bins"></a>
</h2>
<hr class="half-width">
<p>Note the warning we get.</p>
<p>“using <code>bins = 30</code>. Pick better value with
<code>binwidth</code>”</p>
<p>The choice of number of bins have a big influence on how the data is
visualised. By providing the <code>geom_histogram()</code> function with
an argument, <code>bins = xx</code> where <code>xx</code> is the number
of bins we can adjust the number of bins:</p>
<div id="try-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>Try to plot the bill_length_mm variable in the penguins dataset with
different numbers of bins.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">penguins</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/histograms-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>By default <code>geom_histogram()</code> choses 30 bins. This default
value has been chosen because it is almost never the correct choice.
<code>ggplot2</code> is an opinionated package, that tries to force us
to make better plots. And this is the reason for the warning.</p>
</section><section><h2 class="section-heading" id="how-many-bins-should-we-chose">How many bins should we chose?<a class="anchor" aria-label="anchor" href="#how-many-bins-should-we-chose"></a>
</h2>
<hr class="half-width">
<p>We should chose the number of bins that best tells the story we want
to tell about our data. But also the number of bins that does not hide
information about our data.</p>
<p>The obvious way to do this is to fiddle with the number of bins, and
find the number that best do that.</p>
<p>But that can feel a bit cheaty. How do we rationalise the number of
bins in a way that makes sure that this number is not just the one that
show what we <em>want</em> the data to show, but the number that
actually show the data as it is?</p>
<p>A number of heuristics for chosing the “correct” number of bins
exist.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Why do we call it a heuristic? </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>A heuristic is a fancy way of saying “rule of thumb”. “Heuristic”
sounds like we know what we are talking about.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="different-heuristics-for-chosing-number-of-bins-">Different heuristics for chosing number of bins.<a class="anchor" aria-label="anchor" href="#different-heuristics-for-chosing-number-of-bins-"></a>
</h2>
<hr class="half-width">
<p>To have an approximately consistent way of describing them, we use
these three values:</p>
<ul>
<li>
<em>k</em> for the number of bins</li>
<li>
<em>h</em> for the width of the bins</li>
<li>
<em>n</em> for the number of observations</li>
</ul>
<p>We also use a couple of mathematical signs: <span class="math inline">\(\lceil\)</span> and <span class="math inline">\(\rceil\)</span>. These are “ceiling” functions,
and simply mean that we round a number up. Rather than rounding 4.01 to
4, we round <em>up</em> to 5.</p>
<div class="section level3">
<h3 id="freedman-diaconis">Freedman-Diaconis<a class="anchor" aria-label="anchor" href="#freedman-diaconis"></a>
</h3>
<p>This heuristic determines the bind-width as:</p>
<p><span class="math display">\[h = 2 \cdot IQR \cdot n^{-1/3}\]</span>
where IQR is the interquartile range of our data, which can be found
using the <code>IQR()</code> function.</p>
<p>The number of bins are then found as</p>
<p><span class="math display">\[
k = \lceil \frac{range}{h} \rceil
\]</span> ::::challenge ## Try it yourself</p>
<p>How many bins does Freedman-Diaconis prescribe for making a histogram
of the bill length of the penguins?</p>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Get all the lengths of the penguin bills, excluding missing
values:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lengths</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">na.omit</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(n\)</span>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>And the inter quartile range:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iqr</span> <span class="op">&lt;-</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>Now find the recommended bin-width:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="va">iqr</span><span class="op">*</span><span class="va">n</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>And then the number of bins:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">max</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span> <span class="op">-</span> <span class="fu">min</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">h</span></span></code></pre>
</div>
<p>Remember to take the ceiling:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ceiling</span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 11</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>::::</p>
</div>
<div class="section level3">
<h3 id="square-root-rule">Square root rule<a class="anchor" aria-label="anchor" href="#square-root-rule"></a>
</h3>
<p>The number of bins <span class="math inline">\(k\)</span> are found
directly from the number of observations, n:</p>
<p><span class="math display">\[k = \lceil\sqrt{n}\rceil\]</span></p>
<div id="try-it-yourself-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself-1" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>According to the Square Root rule, how many bins should we use for a
histogram of the length of penguin bills?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Get all the lengths of the penguin bills, excluding missing
values:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lengths</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">na.omit</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(n\)</span>:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>And calculate the square root of <span class="math inline">\(n\)</span>, rounded up using the
<code>ceiling()</code> function:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ceiling</span><span class="op">(</span><span class="fu">sqrt</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 19</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-sturges-rule">The Sturges rule<a class="anchor" aria-label="anchor" href="#the-sturges-rule"></a>
</h3>
<p>Here we also find <span class="math inline">\(k\)</span> directly
from the number of observations:</p>
<p><span class="math display">\[ k = \lceil\log_2(n) + 1\rceil \]</span>
An implicit assumption is that the data is approximately normally
distributed.</p>
<p><span class="math inline">\(\log_2\)</span> is found using the
<code>log2()</code> function.</p>
<div id="try-it-yourself-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself-2" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>According to the Sturgess rule, how many bins should we use for a
histogram of the length of penguin bills?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>Get all the lengths of the penguin bills, excluding missing
values:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lengths</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">na.omit</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(n\)</span>:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>Now find <span class="math inline">\(k\)</span></p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu">log2</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre>
</div>
<p>And remember to round up:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ceiling</span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-rice-rule">The Rice Rule<a class="anchor" aria-label="anchor" href="#the-rice-rule"></a>
</h3>
<p>Again we get <span class="math inline">\(k\)</span> directly from
<span class="math inline">\(n\)</span>:</p>
<p><span class="math display">\[k = \lceil 2n^{1/3}\rceil\]</span>
::::challenge</p>
<p>According to the Rice rule, how many bins should we use for a
histogram of the length of penguin bills? ::::solution</p>
<p>Get all the lengths of the penguin bills, excluding missing
values:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lengths</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">na.omit</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(n\)</span>:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>And then find <span class="math inline">\(k\)</span>:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>Remember to round up:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ceiling</span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 14</code></pre>
</div>
<p>:::: ::::</p>
</div>
<div class="section level3">
<h3 id="doanes-rule">Doanes Rule<a class="anchor" aria-label="anchor" href="#doanes-rule"></a>
</h3>
<p>This rule is a bit more complicated:</p>
<p><span class="math display">\[k= 1 + \log_2(n) + \log_2(1+
|g_1|/\sigma_{g1})\]</span></p>
<p><span class="math inline">\(|g_1|\)</span> is the absolute value of
the estimated 3rd moment skewness of the data, found by using the
<code>skewness()</code> function from the <code>e1071</code> package,
and <span class="math inline">\(\sigma_{g1}\)</span> is found by:</p>
<p><span class="math display">\[\sigma_{g1} =
\sqrt{6(n-2)/((n+1)(n+3))}\]</span></p>
<p>Doanes rule basically adds extra bins based on how skewed the data
is, and works better than Sturges’ rule for non-normal
distributions.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>According to Doanes rule, how many bins should we use for a histogram
of the length of penguin bills? ::::solution</p>
<p>Get all the lengths of the penguin bills, excluding missing
values:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lengths</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">na.omit</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(n\)</span>:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(g_1\)</span>:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu">skewness</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in skewness(bill_lengths): could not find function "skewness"</code></pre>
</div>
<p>Find <span class="math inline">\(\sigma_{g1}\)</span>:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_g1</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="fl">6</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can find <span class="math inline">\(k\)</span>. Remember to
take the absolute value of <span class="math inline">\(g_1\)</span></p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu">log2</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="fu">log2</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu">abs</span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">s_g1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'g1' not found</code></pre>
</div>
<p>And then round up <span class="math inline">\(k\)</span> to get the
number of bins:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ceiling</span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 14</code></pre>
</div>
</div>
</div>
</div>
<p>::::</p>
</div>
<div class="section level3">
<h3 id="scotts-rule">Scott’s rule<a class="anchor" aria-label="anchor" href="#scotts-rule"></a>
</h3>
<p>Here we get the bin-width <span class="math inline">\(h\)</span>
using this expression:</p>
<p><span class="math display">\[h = 3.49 \frac{\sigma}{n^{1/3}}\]</span>
Where <span class="math inline">\(\sigma\)</span> is the standard
deviation of the data. This rule implicitly assumes that the data is
normally distributed.</p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>According to Scott’s rule, how many bins should we use for a
histogram of the length of penguin bills? ::::solution</p>
<p>Get all the lengths of the penguin bills, excluding missing
values:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lengths</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">na.omit</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(n\)</span>:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>Find <span class="math inline">\(\sigma\)</span>:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can find the bin-width <span class="math inline">\(h\)</span>:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">3.49</span><span class="op">*</span><span class="va">sigma</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And from that, the number of bins <span class="math inline">\(k\)</span>:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">max</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span> <span class="op">-</span> <span class="fu">min</span><span class="op">(</span><span class="va">bill_lengths</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">h</span></span></code></pre>
</div>
<p>Remember to round up <span class="math inline">\(k\)</span>:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ceiling</span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 11</code></pre>
</div>
</div>
</div>
</div>
<p>::::</p>
</div>
</section><section><h2 class="section-heading" id="that-is-difficult">That is difficult<a class="anchor" aria-label="anchor" href="#that-is-difficult"></a>
</h2>
<hr class="half-width">
<p>Rather than doing these calculations on our own, we can read the help
file for the <code>hist()</code> function. The argument
<code>breaks</code> allow us to specify where the breaks in the
histogram - the splits in bins - should occur.</p>
<p>We can see that the default value is “Sturges”. And under details we
can see the other options that <code>hist()</code> can work with,
“Scott” and “FD” for Freedman-Diaconis. We also get a hint of the
functions that can return the number of bins:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nclass.Sturges</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10</code></pre>
</div>
<p><code>nclass.FD</code> and <code>nclass.scott</code> works similarly,
but note that it is necessary to remove missing values. If one of the
other heuristics is needed, we either need to do the calculations
ourself - or try to identify a package that contains functions to do
it.</p>
</section><section><h2 class="section-heading" id="another-way">Another way<a class="anchor" aria-label="anchor" href="#another-way"></a>
</h2>
<hr class="half-width">
<p>With these heuristics, we can calculate the recommended number of
bins for making a histogram. And with that number, knowing the range of
the data, we can calculate the binwidth.</p>
<p>Either of those can be used as an argument in
<code>geom_histogram()</code>, <code>bins=</code> and
<code>binwidth=</code> respectively.</p>
<p>However, for effective communication, we might consider a third way.
The bill length of the penguins ranges from 32.1 to 59.6 mm. With 9 bins
we will get a bin width of 3.055556 mm. The first bin will therefore
start at 32.1 and end at 35.15556 mm, and the second will start at
35.15556 mm and end at 38.21112. These are the breaks, and they are not
very intuitive.</p>
<p>Instead we might consider choosing the breaks ourself. Having a first
bin that starts at 32 mm and ends at 35, and the a second bin that
starts at 35 mm and ends at 38 might be beneficial for understanding the
histogram.</p>
<p>Those breaks can also be provide to the <code>geom_histogram()</code>
function - we just need to calculate them our self.</p>
<p>The <code>seq()</code> function is useful for this.</p>
<p>This function returns a sequence of numbers from a start value, to
and end value, in steps that we can chose:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">30</span>, to <span class="op">=</span> <span class="fl">65</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 30 35 40 45 50 55 60 65</code></pre>
</div>
<p>You will have to think about the <code>from</code> and the
<code>to</code> arguments, to not exclude any observations, but this
method give us much more natural breaks in the histogram:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">30</span>, to <span class="op">=</span> <span class="fl">65</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/histograms-rendered-unnamed-chunk-36-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="do-not-abuse-the-option-of-specifying-breaks">Do not abuse the option of specifying breaks!<a class="anchor" aria-label="anchor" href="#do-not-abuse-the-option-of-specifying-breaks"></a>
</h2>
<hr class="half-width">
<p>Instead of using the <code>seq()</code> function we could construct
the breaks by hand:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">50</span>, <span class="fl">55</span>, <span class="fl">60</span>, <span class="fl">65</span><span class="op">)</span></span></code></pre>
</div>
<p>And it might be tempting enter breaks that would lead to uneven
binwidths:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">42</span>, <span class="fl">45</span>, <span class="fl">50</span>, <span class="fl">55</span>, <span class="fl">60</span>, <span class="fl">65</span><span class="op">)</span></span></code></pre>
</div>
<p>Do not do this. This will, except in very rare cases, rightfully be
considered misleading. Always use a consistent binwidth!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Histograms are used for visualising the distribution of data</li>
<li>A lot of different rules for chosing number of bins exists</li>
<li>Binwidth and number of bins are equivalent</li>
<li>Chose the number of bins that best supports your data story. Without
hiding inconvenient truths about your data.</li>
<li>Never use unequal binwidths</li>
<li>Consider using natural breaks as an alternative</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-table1"><p>Content from <a href="table1.html">Table One</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/table1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you make a Table One?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what a Table One is</li>
<li>Know how to make a Tabel One and adjust key parameters</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-a-table-one">What is a “Table One”?<a class="anchor" aria-label="anchor" href="#what-is-a-table-one"></a>
</h2>
<hr class="half-width">
<p>Primarily used in medical and epidemiological research, a Table One
is typically the first table in any publication using data.</p>
<p>It presents the baseline characteristics of the participants in a
study, and provides a concise overview of the relevant demographic and
clinical variables.</p>
<p>It typically compares different groups (male~female,
treatment~control), to highlight similarities and differences.</p>
<p>It can look like this:</p>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
61.3 (4.75)
</td>
<td>
58.9 (5.68)
</td>
<td>
61.5 (4.85)
</td>
<td>
58.1 (5.32)
</td>
<td>
61.4 (4.78)
</td>
<td>
58.6 (5.53)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
62.0 [46.0, 69.0]
</td>
<td class="lastrow">
59.0 [46.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [49.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
25.3 (13.2)
</td>
<td>
22.2 (10.7)
</td>
<td>
27.6 (16.1)
</td>
<td>
28.2 (15.6)
</td>
<td>
26.0 (14.2)
</td>
<td>
24.4 (13.0)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
9.60 (5.10)
</td>
<td>
13.7 (12.3)
</td>
<td>
10.8 (6.79)
</td>
<td>
9.57 (3.29)
</td>
<td>
9.99 (5.70)
</td>
<td>
12.2 (10.1)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>Please note that the automatic styling of this site results in a
table-one that is not very nice looking.</p>
<p>We have 510 participants in a study, split into control and case
groups, and further subdivided into two groups based on PostMenopausal
Hormone use. It describes the distribution of sex and concentration of
testosterone and prolactin in a blood sample.</p>
</section><section><h2 class="section-heading" id="how-do-we-make-that">How do we make that?<a class="anchor" aria-label="anchor" href="#how-do-we-make-that"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="structuring-the-data">Structuring the data<a class="anchor" aria-label="anchor" href="#structuring-the-data"></a>
</h3>
<p>Most things in R are simple to do (but rarely simple to understand)
when the data has the correct structure.</p>
<p>If we follow the general rules of thumb for tidy data, we are off to
a good start. This is the structure of the data set we are working with
here - after we have made some modifications regarding labels, levels
and units.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">blood</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 8
      ID matchid case    curpmh ageblood estradol testost prolactn
   &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;   &lt;fct&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 100013  164594 control yes          46       57      25     11.1
2 100241  107261 control no           65       11      NA      2.8
3 100696  110294 control yes          66        3       8     38
4 101266  101266 case    no           57        4       6      8.9
5 101600  101600 case    no           66        6      25      6.9
6 102228  155717 control yes          57       10      31     13.9</code></pre>
</div>
<p>The important thing to note is that when we stratify the summary
statistics by some variable, this variable have to be a categorical
variable. The variables we want to do summary statistics <em>on</em>
also have to have the correct type. Are the values categorical, the
column in the dataframe have to actually be categorical. Are they
numeric, the data type have to be numeric.</p>
</div>
<div class="section level3">
<h3 id="and-having-the-data---how-do-we-actually-do-it">And having the data - how do we actually do it?<a class="anchor" aria-label="anchor" href="#and-having-the-data---how-do-we-actually-do-it"></a>
</h3>
<p>A number of packages making it easy to make a Table One exists. Here
we look at the package <code>table1</code>.</p>
<p>The specific way of doing it depends on the data available. If we do
not have data on the weight of the participants, we are not able to
describe the distribution of their weight.</p>
<p>Let us begin by looking at the data. We begin by loading the two
packages <code>tidyverse</code> and <code>table1</code>. We then read in
the data from the csv-file “BLOOD.csv”, which we have <a href="https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/BLOOD.csv" class="external-link">downloaded
from this link</a>.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">table1</span><span class="op">)</span></span>
<span><span class="va">blood</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/BLOOD.csv"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">blood</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 9
      ID matchid  case curpmh ageblood estradol estrone testost prolactn
   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 100013  164594     0      1       46       57      65      25     11.1
2 100241  107261     0      0       65       11      26     999      2.8
3 100696  110294     0      1       66        3     999       8     38
4 101266  101266     1      0       57        4      18       6      8.9
5 101600  101600     1      0       66        6      18      25      6.9
6 102228  155717     0      1       57       10     999      31     13.9</code></pre>
</div>
<p>510 rows. Its a case-control study, where the ID represents one
individual, and matchid gives us the link between cases and controls.
Ageblood is the age of the individual at the time when the blood sample
was drawn, and we then have levels of four different hormones.</p>
<p>The data contains missing values, coded as “999.0” for estrone and
testost, and 99.99 for prolactin.</p>
<p>Let us fix that:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blood</span> <span class="op">&lt;-</span> <span class="va">blood</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>estrone <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">estrone</span>, <span class="fl">999.0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>testost <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">testost</span>, <span class="fl">999.0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prolactn <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">prolactn</span>, <span class="fl">99.99</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<p>We then ensure that categorical values are stored as categorical
values, and adjust the labels of those categorical values:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blood</span> <span class="op">&lt;-</span> <span class="va">blood</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>case <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">case</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"case"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>curpmh <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">curpmh</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And now we can make our table one like this. Note that we only
include testosterone and prolactin, in order to get a more manageble
table 1:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span> <span class="op">+</span> <span class="va">testost</span> <span class="op">+</span> <span class="va">prolactn</span><span class="op">|</span><span class="va">case</span> <span class="op">+</span> <span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">blood</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
ageblood
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
61.3 (4.75)
</td>
<td>
58.9 (5.68)
</td>
<td>
61.5 (4.85)
</td>
<td>
58.1 (5.32)
</td>
<td>
61.4 (4.78)
</td>
<td>
58.6 (5.53)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
62.0 [46.0, 69.0]
</td>
<td class="lastrow">
59.0 [46.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [49.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
25.3 (13.2)
</td>
<td>
22.2 (10.7)
</td>
<td>
27.6 (16.1)
</td>
<td>
28.2 (15.6)
</td>
<td>
26.0 (14.2)
</td>
<td>
24.4 (13.0)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
9.60 (5.10)
</td>
<td>
13.7 (12.3)
</td>
<td>
10.8 (6.79)
</td>
<td>
9.57 (3.29)
</td>
<td>
9.99 (5.70)
</td>
<td>
12.2 (10.1)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>It is a good idea, and increases readability, to add labels and units
to the variables. The <code>table1</code> package provides functions for
that:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">label</span><span class="op">(</span><span class="va">blood</span><span class="op">$</span><span class="va">curpmh</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"current_pmh"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">blood</span><span class="op">$</span><span class="va">case</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"case_control"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">blood</span><span class="op">$</span><span class="va">ageblood</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Age"</span></span>
<span><span class="fu">units</span><span class="op">(</span><span class="va">blood</span><span class="op">$</span><span class="va">ageblood</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"years"</span></span></code></pre>
</div>
<p>This will add labels to the plot, and allow us to give the data more
meaningful names and units without changing the date it self. This looks
nicer, and is easier to read:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span> <span class="op">+</span> <span class="va">testost</span> <span class="op">+</span> <span class="va">prolactn</span><span class="op">|</span><span class="va">case</span> <span class="op">+</span> <span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">blood</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
61.3 (4.75)
</td>
<td>
58.9 (5.68)
</td>
<td>
61.5 (4.85)
</td>
<td>
58.1 (5.32)
</td>
<td>
61.4 (4.78)
</td>
<td>
58.6 (5.53)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
62.0 [46.0, 69.0]
</td>
<td class="lastrow">
59.0 [46.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [49.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
25.3 (13.2)
</td>
<td>
22.2 (10.7)
</td>
<td>
27.6 (16.1)
</td>
<td>
28.2 (15.6)
</td>
<td>
26.0 (14.2)
</td>
<td>
24.4 (13.0)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
9.60 (5.10)
</td>
<td>
13.7 (12.3)
</td>
<td>
10.8 (6.79)
</td>
<td>
9.57 (3.29)
</td>
<td>
9.99 (5.70)
</td>
<td>
12.2 (10.1)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
</div>
</section><section><h2 class="section-heading" id="more-advanced-stuff">More advanced stuff<a class="anchor" aria-label="anchor" href="#more-advanced-stuff"></a>
</h2>
<hr class="half-width">
<p>We might want to be able to precisely control the summary statistics
presented in the table.</p>
<p>We can do that by specifying input to the arguments
<code>render.continuous</code> and <code>render.categorical</code> that
control how continuous and categorical data respectively, is shown in
the table.</p>
<p>The simple way of doing that is by using abbrevieated function names.
We only include testosterone and prolactin in the the table to save
space:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span> <span class="op">+</span> <span class="va">testost</span> <span class="op">+</span> <span class="va">prolactn</span><span class="op">|</span><span class="va">case</span> <span class="op">+</span> <span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">blood</span>,</span>
<span>        render.continuous<span class="op">=</span><span class="fu">c</span><span class="op">(</span>.<span class="op">=</span><span class="st">"Mean (SD%)"</span>, .<span class="op">=</span><span class="st">"Median [Min, Max]"</span>,</span>
<span>                           <span class="st">"Geom. mean (Geo. SD%)"</span><span class="op">=</span><span class="st">"GMEAN (GSD%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD%)
</td>
<td>
61.3 (4.75%)
</td>
<td>
58.9 (5.68%)
</td>
<td>
61.5 (4.85%)
</td>
<td>
58.1 (5.32%)
</td>
<td>
61.4 (4.78%)
</td>
<td>
58.6 (5.53%)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
62.0 [46.0, 69.0]
</td>
<td>
59.0 [46.0, 68.0]
</td>
<td>
62.0 [45.0, 69.0]
</td>
<td>
58.0 [49.0, 68.0]
</td>
<td>
62.0 [45.0, 69.0]
</td>
<td>
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Geom. mean (Geo. SD%)
</td>
<td class="lastrow">
61.1 (1.08%)
</td>
<td class="lastrow">
58.7 (1.10%)
</td>
<td class="lastrow">
61.3 (1.08%)
</td>
<td class="lastrow">
57.9 (1.10%)
</td>
<td class="lastrow">
61.2 (1.08%)
</td>
<td class="lastrow">
58.4 (1.10%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD%)
</td>
<td>
25.3 (13.2%)
</td>
<td>
22.2 (10.7%)
</td>
<td>
27.6 (16.1%)
</td>
<td>
28.2 (15.6%)
</td>
<td>
26.0 (14.2%)
</td>
<td>
24.4 (13.0%)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel">
Geom. mean (Geo. SD%)
</td>
<td>
22.4 (1.65%)
</td>
<td>
20.0 (1.58%)
</td>
<td>
24.6 (1.60%)
</td>
<td>
24.6 (1.69%)
</td>
<td>
23.1 (1.64%)
</td>
<td>
21.6 (1.63%)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD%)
</td>
<td>
9.60 (5.10%)
</td>
<td>
13.7 (12.3%)
</td>
<td>
10.8 (6.79%)
</td>
<td>
9.57 (3.29%)
</td>
<td>
9.99 (5.70%)
</td>
<td>
12.2 (10.1%)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel">
Geom. mean (Geo. SD%)
</td>
<td>
8.59 (1.58%)
</td>
<td>
10.7 (1.89%)
</td>
<td>
9.63 (1.58%)
</td>
<td>
9.05 (1.41%)
</td>
<td>
8.90 (1.59%)
</td>
<td>
10.1 (1.73%)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p><code>table1</code> recognizes the following summary statisticis: N,
NMISS, MEAN, SD, CV, GMEAN, GCV, MEDIAN, MIN, MAX, IQR, Q1, Q2, Q3, T1,
T2, FREQ, PCT</p>
<p>Details can be found in the help to the function
<code>stats.default()</code></p>
<p>Note that they are case-insensitive, and we can write Median or
mediAn instead of median.</p>
<p>Also note that we write <code>.="Mean (SD%)"</code> which will be
recognized as the functions <code>mean()</code> and <code>sd()</code>,
but also that the label shown should be “Mean (SD%)”.</p>
<p>If we want to specify the label, we can write
<code>"Geom. mean (Geo. SD%)"="GMEAN (GSD%)"</code></p>
<div id="change-the-labels" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="change-the-labels" class="callout-inner">
<h3 class="callout-title">Change the labels</h3>
<div class="callout-content">
<p>We have two unusual values in this table - geometric mean and
geometric standard deviation. Change the code to write out “Geom.” and
“geo.” as geometric.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span> <span class="op">+</span> <span class="va">testost</span> <span class="op">+</span> <span class="va">prolactn</span> <span class="op">|</span><span class="va">case</span> <span class="op">+</span> <span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">blood</span>,</span>
<span>        render.continuous<span class="op">=</span><span class="fu">c</span><span class="op">(</span>.<span class="op">=</span><span class="st">"Mean (SD%)"</span>, .<span class="op">=</span><span class="st">"Median [Min, Max]"</span>,</span>
<span>                           <span class="st">"Geometric mean (Geometric SD%)"</span><span class="op">=</span><span class="st">"GMEAN (GSD%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>The geometric mean of two numbers is the squareroot of the product of
the two numbers. If we have three numbers, we take the cube root of the
product. In general:</p>
<p><span class="math display">\[\left( \prod_{i=1}^{n} x_i
\right)^{\frac{1}{n}}\]</span></p>
<p>The geometric standard deviation is defined by: <span class="math display">\[ \exp\left(\sqrt{\frac{1}{n} \sum_{i=1}^{n}
\left( \log x_i - \frac{1}{n} \sum_{j=1}^{n} \log x_j
\right)^2}\right)\]</span></p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="very-advanced-stuff">Very advanced stuff<a class="anchor" aria-label="anchor" href="#very-advanced-stuff"></a>
</h2>
<hr class="half-width">
<p>If we want to specify the summary statistics very precisely, we have
to define a function ourself:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,<span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span> <span class="op">+</span> <span class="va">testost</span> <span class="op">+</span> <span class="va">prolactn</span><span class="op">|</span><span class="va">case</span> <span class="op">+</span> <span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">blood</span>,</span>
<span>render.continuous <span class="op">=</span> <span class="va">my_summary</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Median
</td>
<td>
62.000
</td>
<td>
59.000
</td>
<td>
62.000
</td>
<td>
58.000
</td>
<td>
62.000
</td>
<td>
58.000
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Variance
</td>
<td class="lastrow">
22.6
</td>
<td class="lastrow">
32.3
</td>
<td class="lastrow">
23.5
</td>
<td class="lastrow">
28.3
</td>
<td class="lastrow">
22.8
</td>
<td class="lastrow">
30.6
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Median
</td>
<td>
23.000
</td>
<td>
21.500
</td>
<td>
25.000
</td>
<td>
24.000
</td>
<td>
23.000
</td>
<td>
22.000
</td>
</tr>
<tr>
<td class="rowlabel">
Variance
</td>
<td>
173.6
</td>
<td>
115.0
</td>
<td>
257.7
</td>
<td>
241.9
</td>
<td>
200.4
</td>
<td>
169.0
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Median
</td>
<td>
8.155
</td>
<td>
8.805
</td>
<td>
9.300
</td>
<td>
8.880
</td>
<td>
8.640
</td>
<td>
8.835
</td>
</tr>
<tr>
<td class="rowlabel">
Variance
</td>
<td>
26.1
</td>
<td>
151.3
</td>
<td>
46.1
</td>
<td>
10.8
</td>
<td>
32.5
</td>
<td>
102.8
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>We do not <em>need</em> to use the <code>sprintf()</code> function,
but it is a very neat way of combining text with numeric variables
because it allows us to format them directly.</p>
<p>Summary statistics for categorical data can be adjusted similarly, by
specifying <code>render.categorical</code>.</p>
<div id="what-does-.3f-actually-do" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="what-does-.3f-actually-do" class="callout-inner">
<h3 class="callout-title">What does %.3f actually do?</h3>
<div class="callout-content">
<p>Can you guess what the formatting in ´sprintf´ does?</p>
<p>Try to change “%.3f” in the function to “%.2f”.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,<span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p><code>sprintf</code> uses a bit of an arcane way of specifying the
way numbers should be formatted when we combine them with text. The
“%”-sign specifies that “this is where we place the number in the
function”. “.3f” specifies that we are treating the number as a floating
point number (which is just a fancy way of saying that it is a decimal
number), and that we would like three digits after the decimal
point.</p>
</div>
</div>
</div>
</div>
<div id="whats-up-with-that-blank-line" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="whats-up-with-that-blank-line" class="callout-inner">
<h3 class="callout-title">Whats up with that blank line?</h3>
<div class="callout-content">
<p>Note that in the function, we define a vector as output, with three
elements:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,</span>
<span><span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Calculating and formatting the median and the varianse is pretty
straightforward.</p>
<p>But the first element is an empty string. Whats up with that?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Try to remove the empty string from the function, and use it is a
table one as previously shown:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span> <span class="op">+</span> <span class="va">testost</span> <span class="op">+</span> <span class="va">prolactn</span><span class="op">|</span><span class="va">case</span> <span class="op">+</span> <span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">blood</span>,</span>
<span>render.continuous <span class="op">=</span> <span class="va">my_summary</span><span class="op">)</span></span></code></pre>
</div>
<p>The line beginning with “Median” does not show up, but the median
value is shown next to the “Age” and “Weight” lines.</p>
</div>
</div>
</div>
</div>

<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A Table One provides a compact describtion of the data we are
working with</li>
<li>With a little bit of work we can control the content of the
table.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-tidy-data"><p>Content from <a href="tidy-data.html">Tidy Data</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/tidy-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we structure our data best?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what tidy data is</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Most of what we want to do with our data is relatively simple.
<em>If</em> the data is structured in the right way.</p>
<p>Working within the paradigm of <code>tidyverse</code> it is
preferable if the data is <em>tidy</em>.</p>
<figure><img src="fig/tidy_why.jpg" alt="" class="figure mx-auto d-block"></figure><p>Tidy data is not the opposite of messy data. Data can be nice and
well structured, tidy as in non-messy, without being tidy in the way we
understand it in this context.</p>
<figure><img src="fig/tidy_hadley_2.jpg" alt="" class="figure mx-auto d-block"></figure><p>Tidy data in the world of R, especially the dialect of R we call
tidyverse, are characterized by:</p>
<ul>
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ul>
<figure><img src="fig/tidy_hadley.jpg" alt="" class="figure mx-auto d-block"></figure><p>This way of structuring our data is useful not only in R, but also in
other software packages.</p>
</section><section><h2 class="section-heading" id="an-examples">An examples<a class="anchor" aria-label="anchor" href="#an-examples"></a>
</h2>
<hr class="half-width">
<p>This is an example of untidy data, on new cases of tubercolosis in
Afghanistan. It is well structured, however there are information in the
column names.</p>
<p>“new_sp_m014” describes “new” cases. Diagnosed with the “sp” method
(culturing a sample of sputum and identifying the presence of
Mycobacterium Tuberculosis bacteria). In “m” meaning males, between the
ages of 0 and 14.</p>
<p>Picking out information on all new cases eg. distribution between the
two sexes is difficult. Similar problems arise if we want to follow the
total number of new cases.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 6
   country      year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544
   &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1 Afghanistan  2000          52          228          183          149
 2 Afghanistan  2001         129          379          349          274
 3 Afghanistan  2002          90          476          481          368
 4 Afghanistan  2003         127          511          436          284
 5 Afghanistan  2004         139          537          568          360
 6 Afghanistan  2005         151          606          560          472
 7 Afghanistan  2006         193          837          791          574
 8 Afghanistan  2007         186          856          840          597
 9 Afghanistan  2008         187          941          773          545
10 Afghanistan  2009         200          906          705          499</code></pre>
</div>
<p>Getting this data on a tidy format is not trivial, but a resulting,
tidy, organised dataset would look something like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 40 × 7
   country      year new   method sex   age_group cases
   &lt;fct&gt;       &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;     &lt;dbl&gt;
 1 Afghanistan  2000 new   sp     m     0-14         52
 2 Afghanistan  2000 new   sp     m     15-24       228
 3 Afghanistan  2000 new   sp     m     25-34       183
 4 Afghanistan  2000 new   sp     m     35-44       149
 5 Afghanistan  2001 new   sp     m     0-14        129
 6 Afghanistan  2001 new   sp     m     15-24       379
 7 Afghanistan  2001 new   sp     m     25-34       349
 8 Afghanistan  2001 new   sp     m     35-44       274
 9 Afghanistan  2002 new   sp     m     0-14         90
10 Afghanistan  2002 new   sp     m     15-24       476
# ℹ 30 more rows</code></pre>
</div>
<p>The fact that we are recording “new” cases is now a variable in it
self. The method used is also a variable, and the categorical variabel
sex is similarly a separate variable as is the age group.</p>
<p>The variables <code>new</code>, <code>method</code> and
<code>sex</code> might appear redundant - all values are identical,
however the entire dataset contains data on non-new cases, other methods
for diagnosis and the other sex, recorded as “f”.</p>
</section><section><h2 class="section-heading" id="dos-and-donts-in-excel">Do’s and dont’s in Excel<a class="anchor" aria-label="anchor" href="#dos-and-donts-in-excel"></a>
</h2>
<hr class="half-width">
<p>Excel is a very useful tool, especially for collecting data.</p>
<p>But even though we are able to do everything we can do in R, in
Excel, we will normally do the main part of our work with data in R.</p>
<p>It is therefor a very good idea to think about how we collect and
organise the data in Excel, to make our life easier later on.</p>
<p>We have collected some good rules of thumb for structuring data in
Excel, based on time-consuming and traumatic experiences wrangling data
from Excel to R.</p>
<p><strong>Always</strong></p>
<ul>
<li>Use one column for one variable</li>
<li>Use one row for one observation</li>
<li>Use one cell for one value</li>
<li>Begin your data in the upper left corner (cell A1)</li>
<li>Use one sheet for each type of data</li>
</ul>
<p><strong>Never (EVER!)</strong></p>
<ul>
<li>Modify your raw data - always make a copy before making any
change</li>
<li>Merge cells</li>
<li>Use colours for information</li>
</ul>
<p>Illustrations from the Openscapes blog Tidy Data for reproducibility,
efficiency, and collaboration by Julia Lowndes and Allison Horst</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>tidy data provides a consistent way of organizing data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-normal-distribution"><p>Content from <a href="normal-distribution.html">The normal distribution</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/normal-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What even is a normal distribution?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-the-normal-distribution">What is the normal distribution<a class="anchor" aria-label="anchor" href="#what-is-the-normal-distribution"></a>
</h2>
<hr class="half-width">
<p>A probability distribution is a mathematical function, that describes
the likelihood of different outcomes in a random experiment. It gives us
probabilities for all possible outcomes, and is normalised so that the
sum of all the probabilities is 1.</p>
<figure><img src="fig/normal-distribution-rendered-4-distibutions-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Probability distributions can be discrete, or they can be continuous.
The normal distribution is just one of several different continuous
probability distributions.</p>
<p>The normal distribution is especially important, for a number of
reasons:</p>
<ol style="list-style-type: decimal">
<li><p>If we take a lot of samples from a population and calculate the
averages of a given variable in those samples, the averages, or means
will be normally distributed. This is know as the <a href="CLT-en.html">Central Limit Theorem</a>.</p></li>
<li><p>Many natural (and human made) processes follow a normal
distribution.</p></li>
<li><p>The normal distribution have useful mathematical properties. It
might not appear to be simple working with the normal distribution. But
the alternative is worse.</p></li>
<li><p>Many statistical methods and tests are based on assumptions of
normality.</p></li>
</ol></section><section><h2 class="section-heading" id="how-does-it-look---mathematically">How does it look - mathematically?<a class="anchor" aria-label="anchor" href="#how-does-it-look---mathematically"></a>
</h2>
<hr class="half-width">
<p>The normal distribution follows this formula:</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>If a variable in our population is normally distributed, have a mean
<span class="math inline">\(\mu\)</span> and a standard deviation <span class="math inline">\(\sigma\)</span>, we can find the probability of
observing the value <span class="math inline">\(x\)</span> of the
varibel by plugging in the values, and calculate <span class="math inline">\(f(x)\)</span>.</p>
<p>Note that we are here working with the population mean and standard
deviation. Those are the “true” mean and standard deviation for the
<em>entire</em> universe. That is signified by using the greek letters
<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. In practise we do not know what
those true values are.</p>
<div id="what-does-it-mean-that-our-data-is-normally-distributed" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-does-it-mean-that-our-data-is-normally-distributed" class="callout-inner">
<h3 class="callout-title">What does it mean that our data is normally distributed</h3>
<div class="callout-content">
<p>We have an entire section on that - but in short: The probabilities
we get from the formula above should match the frequencies we observe in
our data.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="how-does-it-look--graphically">How does it look- graphically?<a class="anchor" aria-label="anchor" href="#how-does-it-look--graphically"></a>
</h2>
<hr class="half-width">
<p>It is useful to be able to compare the distributions of different
variables. That can be difficult if one have a mean of 1000, and the
other have a mean of 2. Therefore we often work with standardized normal
distributions, where we transform the data to have a mean of 0 and a
standard deviation of 1. So let us look at the standardized normal
distribution.</p>
<p>If we plot it, it looks like this:</p>
<p><img src="fig/The_Normal_Distribution.svg" alt="The Normal Distribution." class="figure"> The area under the curve is 1,
equivalent to 100%.</p>
<p>The normal distribution have a lot of nice mathematical properties,
some of which are indicated on the graph.</p>
</section><section><h2 class="section-heading" id="so---what-is-the-probability">So - what <em>is</em> the probability?<a class="anchor" aria-label="anchor" href="#so---what-is-the-probability"></a>
</h2>
<hr class="half-width">
<p>The normal distribution curve tell what the probability density for a
given observation is. But in general we are interested in the
probability that something is larger, or smaller, than something. Or
between certain values.</p>
<p>Rather that plotting the probability density, we can plot the
cumulative density.</p>
<figure><img src="fig/normal-distribution-rendered-cdf-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that we also find the cumulitive probability in the original
plot of the normal distribution - now it is a bit more direct.</p>
<p>This allow us to see that the probability of observing a value that
is 2 standard deviations smaller than the mean is rather small.</p>
<p>We can also, more indirectly, note that the probability of observing
a value that is 2 standard deviations larger than the mean is rather
small. Note that the probability of an observation that is smaller than
2 standard deviations larger than the mean is 97.7% (hard to read on the
graph, but we will get to that). Since the total probability is 100%,
the probability of an observation being larger than 2 standard
deviations is 100 - 97.7 = 2.3%</p>
</section><section><h2 class="section-heading" id="do-not-read-the-graph---do-the-calculation">Do not read the graph - do the calculation<a class="anchor" aria-label="anchor" href="#do-not-read-the-graph---do-the-calculation"></a>
</h2>
<hr class="half-width">
<p>Instead of trying to measure the values on the graph, we can do the
calculations directly.</p>
<p>R provides us with a set of functions:</p>
<ul>
<li>
<em>pnorm</em> returns the probability of having a smaller value
than x</li>
<li>
<em>qnorm</em> the value x corresponding to a given probability</li>
<li>
<em>dnorm</em> returns the probability density of the normal
distribution at a given x.</li>
</ul>
<p>We have an additional <em>rnorm</em> that returns a random value,
drawn from a normal distribution.</p>
<div id="try-it-your-self" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-your-self" class="callout-inner">
<h3 class="callout-title">Try it your self!</h3>
<div class="callout-content">
<p>Assuming that our observations are normally distributed with a mean
of 0 and a standard deviation of 1.</p>
<p>What is the probability of an observation x &lt; 2?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.9772499</code></pre>
</div>
<p>About 98% of the observations are smaller than 2</p>
</div>
</div>
</div>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Making the same assumptions, what is the value of the observation,
for which 42% of the observations is smaller?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qnorm</span><span class="op">(</span><span class="fl">0.42</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.2018935</code></pre>
</div>
<p>42% of the observations are smaller than -0.2</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="what-about-other-means-and-standard-deviations">What about other means and standard deviations?<a class="anchor" aria-label="anchor" href="#what-about-other-means-and-standard-deviations"></a>
</h2>
<hr class="half-width">
<p>Being able to find out what the probablity of some observation being
smaller when the mean is 0 and the standard deviation is 1, is nice. But
this is not a common problem.</p>
<p>Rather we might know that adult men in a given country have an
average height of 183 cm, and that the standard deviation of their
height is 9.7 cm.</p>
<p>What is the probability to encounter a man that is taller than 2
meters?</p>
<p>The R-functions handle this easily, we “simply” specify the mean and
standard deviation in the function:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">200</span>, mean <span class="op">=</span> <span class="fl">183</span>, sd <span class="op">=</span> <span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983729</code></pre>
</div>
<p>The function calculate the probability of a man being shorter than
200 cm, if the distribution is normal and the mean and standard devation
is 183 and 9.7 respectively. The probability of the man having a height
is 1 (equivalent to 100%). So if the probability of the man being
shorter than 200 cm is 96%, the probability of him being taller than 200
cm is 4%</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> How does that work? </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>We have a lot of men with an average height of 183. They all have an
individual heigth. If we subtract 183 from their height, and use that as
a measurement of their height, that will have a mean of 0.</p>
<p>We are not going into the details, but if we divide all the heights
with the original standard deviation, and do all the math, we will
discover that the standard deviation of the new heights will be 1.</p>
<p>Therefore, if we subtract 183 from all the individual heights, and
divide them by 9.7, the resulting measurements of the heights have a
mean of 0 and a standard deviation of 1. Bringing all that together, we
get:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="op">(</span><span class="fl">200</span><span class="op">-</span><span class="fl">183</span><span class="op">)</span><span class="op">/</span><span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983729</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="how-many-men-are-in-an-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="how-many-men-are-in-an-interval" class="callout-inner">
<h3 class="callout-title">How many men are in an interval?</h3>
<div class="callout-content">
<p>How many men have a height between 170 and 190 cm?</p>
<p>Assume mean = 183 cm and sd = 9.7</p>
</div>
</div>
</div>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Hint </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" aria-labelledby="headingSpoiler2" data-bs-parent="#accordionSpoiler2">
<div class="accordion-body">
<p>What proportion of men are shorter than 190 cm? And what proportion
of men are shorter than 170 cm?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">190</span>, mean <span class="op">=</span><span class="fl">183</span>, sd <span class="op">=</span> <span class="fl">9.7</span> <span class="op">)</span>  <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">170</span>, mean <span class="op">=</span> <span class="fl">183</span>, sd <span class="op">=</span> <span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.6746558</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="clt">CLT<a class="anchor" aria-label="anchor" href="#clt"></a>
</h2>
<hr class="half-width">
<p>But my data is not normally distributed?</p>
<p>No, it is not. Actually most data is not normally distributed. Often
it <em>cannot</em> be normally distributed. Serum molybdenum, an
essential trace metal in human physiology has a mean of 1.55 and a
standard deviation of 0.74 in normal healthy adult humans.</p>
<div id="how-many-danes-have-negative-serum-molybdenum" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="how-many-danes-have-negative-serum-molybdenum" class="callout-inner">
<h3 class="callout-title">How many danes have negative serum molybdenum?</h3>
<div class="callout-content">
<p>Assuming an adult population of 5000000 danes, a mean of 1.55 and a
standard deviation of 0.74, how many danes have a negative concentration
of Molybdenum (Mo) in their blood?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>We begin by calculating the probability of observing a Mo
concentration lower than 0:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">0</span>, mean <span class="op">=</span> <span class="fl">1.55</span>, sd <span class="op">=</span> <span class="fl">0.74</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01810352</code></pre>
</div>
<p>We then multiply by the number of people:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5000000</span><span class="op">*</span><span class="fl">0.01810352</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 90517.6</code></pre>
</div>
<p>About 90000 adult danes have not only none, but actually negative
amounts of Molybdenum in their blood. Which is impossible.</p>
</div>
</div>
</div>
</div>
<p>So - your data is not normally distributed. But the properties of
your samples are!</p>
<p>We are not actually measuring the average height of all men in the
world ever. We are taking a sample, and calculating the mean. And
standard deviation. And proportion.</p>
<p>And those, the mean etc, <em>are</em> normally distributed, even if
the underlying distribution of the population is not.</p>
<p>The Central Limit Theorem allow us to assume that, if we take enough
random samples, the mean and standard deviation of these samples, will
be normally distributed.</p>
<p>This is what we use when doing statistical tests. We posit a
null-hypothesis that the “true” mean of some value should be something.
We take a sample, and calculate the mean. And using the normal
distribution, we can look at the CDF-plot above, and determine the
probability of seeing the value we get.</p>
<p>In practice we are usually not using the normal distribution, but
rather the t-distribution, to correct for the fact that we do not
actually know the true mean and varians/standard deviation of the
population. It gives us a more conservative estimate taht is more likely
to be “true”.</p>
<div id="what-is-normal" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="what-is-normal" class="callout-inner">
<h3 class="callout-title">What is normal?</h3>
<div class="callout-content">
<p>The normal distribution is normal, because Karl Pearson and Francis
Galton in the 19th century took a lot of samples of different
phenomenons in the population data. Height, weight, intelligence etc.
Calculating the mean (and other descriptive statistical parameters) they
noted that these means followed a specific distribution. This was not
the case for every phenomenon. But for a lot.</p>
<p>Looking at the distributions describing a lot of phenomenons, the
most common was one specific distribution.</p>
<p>In descriptive statistics, the normal observation is simply the most
frequent. In this set of numbers:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5 5</code></pre>
</div>
<p>5 is the normal observation - because it is the most frequent, even
if it only represents 20% of the observations. In a statistical sense
normal is not normative. The normal colour eye among humans is brown.
Not because there is anything wrong with other colours, but simply
because brown is the most frequent.</p>
<p>The most frequent, ie normal, distribution found, was named the
normal distribution.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-is-it-normal"><p>Content from <a href="is-it-normal.html">Testing for normality</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/is-it-normal.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we determine if a dataset might be normally distributed?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to visually estimate normality</li>
<li>Explain how to get numerical indications of normality</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A common question is: Is my data normally distributed?</p>
<p>Before panicking make sure that it actually is a problem that your
data might not be normally distributed. Making a linear regression eg
does not require the data to be normally distributed.</p>
<p>On the other hand, a linear regression requires the residuals to be
normally distributed. So it is useful to be able to determine if it
is.</p>
<div class="section level3">
<h3 id="what-does-it-mean-that-it-is-normally-distributed">What does it mean that it is normally distributed?<a class="anchor" aria-label="anchor" href="#what-does-it-mean-that-it-is-normally-distributed"></a>
</h3>
<p>It means that the distribution of our data has the same properties as
the normal distribution.</p>
<p>Let us get some data that we can test, first by loading the
<code>palmerpenguins</code> dataset:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<p>And then by extracting the bill depth of chinstrap penguins:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Chinstrap"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="mean-and-median">Mean and median<a class="anchor" aria-label="anchor" href="#mean-and-median"></a>
</h3>
<p>One of the properties of the normal distribution is that the mean and
median of the data is equal. Let us look at the penguins:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> bill_depth_mm
 Min.   :16.40
 1st Qu.:17.50
 Median :18.45
 Mean   :18.42
 3rd Qu.:19.40
 Max.   :20.80  </code></pre>
</div>
<p>This is actually pretty close! But equality between median and mean
is a neccesary, not a sufficient condition.</p>
<p>What next. A histogram of the data should look normal. Let us take a
closer look at bill_depth_mm where mean and median are closest:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>A normal distribution would have this shape:</p>
<p><img src="fig/is-it-normal-rendered-normal_curve-1.png" style="display: block; margin: auto;" class="figure">
Our histogram does not really look like the theoretical curve. The fact
that mean and median are almost identical was not a sufficient criterium
for normalcy.</p>
<p>The shape of a histogram is heavily dependent on the bins we choose.
Density plots are often a better way of visualizing the
distribution:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-densityplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can think of this as a histogram with infinitely small bins.</p>
<p>This does look more normal - but it would be nice to be able to
quantize the degree of normalcy.</p>
</div>
<section><h2 class="section-heading" id="percentiels-and-qq-plots-as-a-test">Percentiels and QQ-plots as a test<a class="anchor" aria-label="anchor" href="#percentiels-and-qq-plots-as-a-test"></a>
</h2>
<hr class="half-width">
<p>We know a lot about the properties of the normal distribution.</p>
<ul>
<li>50% of the observations in the data are smaller than the mean
<ul>
<li>conversely 50% are larger.</li>
</ul>
</li>
<li>We also know that 50% of the observations should be in the
interquartile range.</li>
<li>2.5% of the observations (the 2.5 percentile) are smaller than the
mean minus 1.96 times the standard deviation.</li>
</ul>
<p>And for each of the observations we actually have, we can calculate
which quantile, or percentile it <em>is</em> in. And we can calculate
what percentile it <em>should</em> be in.</p>
<p>Comparing those gives us an indication of how well the data conforms
to a normal distribution.</p>
<p>Rather than doing that by hand, we can get R to do it for us in a
nice graphical way:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-qq-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>geom_qq</code> function calculate and plots which
percentile an observation is in.</p>
<p>Rather than being given percentiles, we are given the value that the
percentile corresponds to if we calculate it as number of standard
deviations from the mean.</p>
<p>This results in plots that are more comparable.</p>
<p><code>geom_qq_line</code> plots the line corresponding til the values
the percentiles should have, if the data was normally distributed.</p>
<p>A common theme is that the midle of the data falls relatively close
to the line, and that there are deviations from the line at both ends.
In this case the deviations are largish, indicating that the data is not
normally distributed.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> How skewed is the plot? </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>We have two tails in the qq-plot, a left and a right. And they can be
either above or below the qq-line.</p>
<p>That results in four different cases, that informs us about what is
wrong with the data - in regards to how it deviates from normalcy.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="15%">
<col width="15%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Left tail</th>
<th>Right tail</th>
<th>Name</th>
<th>What</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Above</td>
<td>Below</td>
<td>Leptokurtic</td>
<td>Heavier tails - ie. more extreme values. Higher kurtosis</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Above</td>
<td>Platykurtic</td>
<td>Lighter tails - ie. fewer extreme values. Lower kurtosis</td>
</tr>
<tr class="odd">
<td>Above</td>
<td>Above</td>
<td>Right skewed</td>
<td>A tail that stretches to the higher values - the extreme values are
larger.</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Below</td>
<td>Left skewed</td>
<td>A tail that stretches to the lower values - the extreme values are
smaller.</td>
</tr>
</tbody>
</table>
<figure><img src="fig/is-it-normal-rendered-different_kurtoses-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="numerical-measures-rather-than-graphical">Numerical measures rather than graphical<a class="anchor" aria-label="anchor" href="#numerical-measures-rather-than-graphical"></a>
</h2>
<hr class="half-width">
<p>With experience the qq-plots can be used to determine if the data is
normally distributed - the points are exactly on the line. But only
rarely will the points match exactly - even if the data is normally
distributed <em>enough</em>. And how much can the tails deviate from the
line before the data is not normally distributed <em>enough</em>?</p>
<p>The deviations can be described numerically using two parameters:</p>
<p>Kurtosis and skewness.</p>
<p>Base-R do not have functions for this, but the package
<code>e1071</code> does:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="skewness">Skewness<a class="anchor" aria-label="anchor" href="#skewness"></a>
</h4>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">skewness</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.006578141</code></pre>
</div>
<p>As a rule of thumb, skewness should be within +/-0.5 if the data is
normally distributed. Values between +/-0.5 and +/- 1 indicates a
moderate skewness, where data <em>can</em> still be approximately
normally distributed. Values larger that +/-1 indicates a significant
skewness, and the data is probably not normally distributed.</p>
</div>
<div class="section level4">
<h4 id="kurtosis">Kurtosis<a class="anchor" aria-label="anchor" href="#kurtosis"></a>
</h4>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kurtosis</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.960087</code></pre>
</div>
<p>Evaluating the kurtosis is a bit more complicated as the kurtosis for
a normal distribution is 3. We therefore look at excess kurtosis, where
we subtract 3 from the calculated kurtosis. * An value of +/-1 excess
kurtosis indicates that the data has a ‘tailedness’ close to the normal
distribution. * Values between +/-1 and +/-2 indicates a moderate
deviation from the normal distribution, but the data can still be
approximately normally distributed. * Values larger than +/-2 is in
general taken as an indication that the data is not normally
distributed.</p>
</div>
</section><section><h2 class="section-heading" id="more-direct-tests">More direct tests<a class="anchor" aria-label="anchor" href="#more-direct-tests"></a>
</h2>
<hr class="half-width">
<p>The question of whether or not data is normally distributed is
important in many contexts, and it should come as no surprise that a
multitude of tests has been devised for testing exactly that.</p>

<div class="section level3">
<h3 id="shapiro-wilk">Shapiro-Wilk<a class="anchor" aria-label="anchor" href="#shapiro-wilk"></a>
</h3>
<p>The Shapiro-Wilk test is especially suited for small sample sizes
(&lt;50, some claim it works well up to &lt;2000).</p>
<p>It is a measure of the linear correlation between data and the
normally distributed quantiles, what we see in the qqplot.</p>
<p>The null-hypothesis is that data is normally distributed, and the
Shapiro-Wilk test returns a p-value reporting the risk of being wrong if
we reject the null-hypothesis.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shapiro.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Shapiro-Wilk normality test

data:  normal_test_data$bill_depth_mm
W = 0.97274, p-value = 0.1418</code></pre>
</div>
<p>The p-value in this case is 0.1418 - and we do not have enough
evidense to reject the null-hypothesis. The data is probably normally
distributed.</p>
</div>
<div class="section level3">
<h3 id="kolmogorov-smirnov">Kolmogorov-Smirnov<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov"></a>
</h3>
<p>The KS-test allows us to test if the data is distributed as a lot of
different distributions, not only the normal distribution. Because of
this, we need to specify the specific distribution we are testing for,
in this case a normal distribution with specific values for mean and
standard deviation.</p>
<p>Therefore we need to calculate those:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">ks.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, <span class="st">"pnorm"</span>, mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in ks.test.default(normal_test_data$bill_depth_mm, "pnorm", mean =
mean, : ties should not be present for the one-sample Kolmogorov-Smirnov test</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Asymptotic one-sample Kolmogorov-Smirnov test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.8565
alternative hypothesis: two-sided</code></pre>
</div>
<p>In this test the null-hypothesis is also that data is normally
distributed. The p-values is very high, and therefore we cannot reject
the null-hypothesis. Again, this is not the same as the data
<em>actually</em> being normally distributed.</p>
<p>This test assumes that there are no repeated values in the data, as
that can affect the precision of the test. The p-value is still very
high, and we will conclude that we cannot rule out that the data is not
normally distributed.</p>
<p>Note that the KS-test assumes that we actually know the true mean and
standard deviation. Here we calculate those values based on the sample,
which is problematic.</p>
</div>
<div class="section level3">
<h3 id="liliefors-test">Liliefors test<a class="anchor" aria-label="anchor" href="#liliefors-test"></a>
</h3>
<p>This is a variation on the KS-test, that is designed specifically for
testing for normality. It does not require us to know the true mean and
standard deviation for the population.</p>
<p>This test is also not available in base-R, but can be found in the
<code>nortest</code> package:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="fu">lillie.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Lilliefors (Kolmogorov-Smirnov) normality test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.483</code></pre>
</div>
<p>Again the p-value is so high, that we cannot reject the
null-hypothesis.</p>
</div>
<div class="section level3">
<h3 id="anderson-darling-test">Anderson-Darling test<a class="anchor" aria-label="anchor" href="#anderson-darling-test"></a>
</h3>
<p>This test is more sensitive for deviations in the tails.</p>
<p>It is not available in base-R, but can be found in the
<code>nortest</code> package.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ad.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Anderson-Darling normality test

data:  normal_test_data$bill_depth_mm
A = 0.44788, p-value = 0.2714</code></pre>
</div>
<p>In this case the null-hypothesis is also that data is normally
distributed, and the p-value indicates that we cannot reject the
null-hypothesis.</p>
</div>
</section><section><h2 class="section-heading" id="and-is-it-actually-normally-distributed">And is it actually normally distributed?<a class="anchor" aria-label="anchor" href="#and-is-it-actually-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Probably not. Except for the excess kurtosis, all the tests we have
done indicate that the depth of the beaks of chinstrap penguins
<em>can</em> be normally distributed. Or rather, that we cannot reject
the null-hypothesis that they are normally distributed.</p>
<p>But the fact that we cannot reject this hypothesis is not the same as
concluding that the data actually <strong>is</strong> normally
distributed.</p>
<p>Based on the excess kurtosis and the qq-plot, it would be reasonable
to conclude that it is not.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Begin by a visual inspection to assess if data is normally
distributed</li>
<li>Use a statistical test to support your conclusion</li>
<li>Do not fret too much about non-normality. It is quite normal.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-which-distribution"><p>Content from <a href="which-distribution.html">How is the data distributed?</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/which-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>If my data is not normally distributed - which distribution does it
actually follow?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show how to identify possible distributions describing the data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Your data was not normally distributed. Now what?</p>
<p>The process generating your data is probably following some
distribution. The size distribution of cities appears to follow a Pareto
distibution, as is wealth. The number of mutations in a string of DNA
appears to follow a poisson distribution. And the distribution of wind
speeds as well as times to failure for technical components both follow
the Weibull distribution.</p>
<p>If you have a theoretical foundation for which distribution you data
generating function follows, that is nice.</p>
<p>If you do not - we will be interested in figuring out which
distribution your data actually follow.</p>
</section><section><h2 class="section-heading" id="how">How?<a class="anchor" aria-label="anchor" href="#how"></a>
</h2>
<hr class="half-width">
<p>We fit our data to a distribution. Or rather - we fit the data to
several different distributions and then choose the best.</p>
<p>Let us look at some data. The <code>faithful</code> data set contains
272 observations of the Old Faithful geyser in Yellowstone National Park
in USA. We only look at eruptions that lasts longer than 3 minutes:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="va">eruption_example</span> <span class="op">&lt;-</span> <span class="va">faithful</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">eruptions</span><span class="op">)</span></span></code></pre>
</div>

<p>Rather than testing a lot of different distributions, we can use the
<code>gamlss</code> package, and two add-ons to that.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.dist</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.add</span><span class="op">)</span></span></code></pre>
</div>
<p><code>gamlss</code> has the advantage of implementing a <em>lot</em>
of different statistical distributions.</p>
<p>The function <code>fitDist()</code> from <code>gamlss</code> will fit
the data to a selection of different statistical distributions,
calculate a measure of the goodness of fit, and return the best fit (and
information on all the others). Rather than testing against all 97
different distributions supported by <code>gamlss</code>, we can specify
only a selection, in this case <code>realplus</code>, that only includes
the 23 distributions that are defined for positive, real numbers:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fitDist</span><span class="op">(</span><span class="va">eruptions</span>, type <span class="op">=</span> <span class="st">"realplus"</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   4%  |                                                                              |======                                                                |   9%  |                                                                              |=========                                                             |  13%  |                                                                              |============                                                          |  17%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |===============                                                       |  22%  |                                                                              |==================                                                    |  26%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |===========================                                           |  39%  |                                                                              |==============================                                        |  43%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  61%  |                                                                              |==============================================                        |  65%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  74%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=======================================================               |  78%  |                                                                              |==========================================================            |  83%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |=============================================================         |  87%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |================================================================      |  91%  |                                                                              |===================================================================   |  96%  |                                                                              |======================================================================| 100%</code></pre>
</div>
<p>If you do this yourself, you will notice a lot of error-messages. It
is not possible to fit this particular data to <em>all</em> the
distributions, and the ones where the fit fails (enough), we will get an
error message.</p>
<p>The output from <code>fitDist()</code> will return the best fit:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>We are told that the statistical distribution that best fits the data
is <code>Weibull type 2</code> and that the AIC-measurement of goodness
of fit is 170.245.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Is that a good fit? That is a good question. It strongly depends on
the values in the dataset. In this dataset, the length of the eruptions
are measured in minutes If we choose to measure that length in another
unit, eg seconds, the distribution should not change. But the AIC
will.</p>
<p>We can use the AIC to decide that one distribution fits the data
better than another, but not to conclude that that distribution is the
correct one.</p>
</div>
</div>
</div>
<p>The <code>fit</code> object containing the output of the
<code>fitDist()</code> function contains quite a bit more.</p>
<p>If we start by getting the errors out of the way,
<code>fit$failed</code> returns the two distributions that failed enough
to cause errors:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">failed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
[1] "GIG"

[[2]]
[1] "LNO"</code></pre>
</div>
<p>As mentioned <code>fitDist()</code> fitted the data to 23 different
distributions. We can inspect the rest, and their associated AIC-values
like this:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">fits</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    WEI2     WEI3      WEI       GG    BCPEo     BCPE    BCCGo     BCCG
179.2449 179.2449 179.2449 181.1349 181.4953 181.4953 183.1245 183.1245
     GB2      BCT     BCTo   exGAUS       GA   LOGNO2    LOGNO       IG
183.1354 185.1245 185.1245 190.2994 194.4665 198.3047 198.3047 198.3558
  IGAMMA      EXP       GP PARETO2o  PARETO2
202.6759 861.8066 863.8067 863.8079 863.8081 </code></pre>
</div>
<p>Here we get <code>WEI2</code> first, with an AIC of 179.2449, but we
can see that <code>WEI3</code> and <code>WEI1</code> have almost exactly
the same AIC. Not that surprising if we guess that
<code>Weibull type 3</code> is probably rather similar to
<code>Weibull type 2</code>.</p>
<p>The difference in AIC for the first two distributions tested is very
small. Is it large enough for us to think that <code>WEI2</code> is
significantly better than <code>WEI3</code>?</p>
<p>No. As a general rule of thumb, the difference between the AIC of two
distributions have to be larger than 2 for us to see a significant
difference.</p>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>*******************************************************************
Family:  c("WEI2", "Weibull type 2")

Call:  gamlssML(formula = y, family = DIST[i])

Fitting method: "nlminb"


Coefficient(s):
             Estimate  Std. Error  t value   Pr(&gt;|t|)
eta.mu    -18.6934274   1.1306427 -16.5334 &lt; 2.22e-16 ***
eta.sigma   2.5242093   0.0589965  42.7858 &lt; 2.22e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>And we can get at graphical description as well:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/which-distribution-rendered-plot-fit-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
	      Summary of the Quantile Residuals
                           mean   =  -0.001205749
                       variance   =  0.9953007
               coef. of skewness  =  0.09022876
               coef. of kurtosis  =  2.529951
Filliben correlation coefficient  =  0.9976953
******************************************************************</code></pre>
</div>
</section><section><h2 class="section-heading" id="what-about-the-other-options">What about the other options?<a class="anchor" aria-label="anchor" href="#what-about-the-other-options"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="general-comments">General comments<a class="anchor" aria-label="anchor" href="#general-comments"></a>
</h3>
<p>Above we got the “best” fit. But we also noted that in order for us
to conclude that one distribution is a better fit than another, the
difference in AIC should be at least 2.</p>
<p>What we are looking for might not actually be the probability
distribution that best fits our data. Our data might be noisy or there
might me systematic errors. The probability distribution we really want,
is the one that best matches the underlying data generating function,
the mechanisms in the real world that we are studying, that actually is
at the hearth of the data we collect.</p>
<p>We might not be able to find that. But we should consider if some of
the other possibilities provided by <code>fitDist()</code> might
actually be better.</p>

<p>First step is to look at the relevant distributions. In the setup
with <code>gamlss</code>, <code>gamlss.dist</code> and
<code>gamlss.add</code> we can test distributions of different types.
The complete list can be found using the help function for
<code>fitDist()</code>, but falls in the following families:</p>
<ul>
<li>realline - continuous distributions for all real values</li>
<li>realplus - continuous distributions for positive real values</li>
<li>realAll - all continuous distributions - the combination of realline
and realplus</li>
<li>real0to1 - continuous distributions defined for real values between
0 and 1</li>
<li>counts - distributions for counts</li>
<li>binom - binomial distributions</li>
</ul>
<p>Begin by considering which type whatever your data is describing,
best matches.</p>
</div>
<div class="section level3">
<h3 id="actually-looking-at-the-fits">Actually looking at the fits<a class="anchor" aria-label="anchor" href="#actually-looking-at-the-fits"></a>
</h3>
<p>For the selection of eruptions that we fitted, we chose the
“realplus” selection of distibutions to test. We did that, because the
eruption times are all positive, and on the real number line.</p>

<p>Behind the scenes <code>fitDist</code> fits the data to the chosen
selection of distributions, and returns the best.</p>
<p>Looking at the result of the fit we see this:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>In the <code>Call</code> part of the output, we see this:</p>
<p><code>Call:  gamlssML(formula = y, family = DIST[i])</code></p>
<p>and from that we can deduces that if we want to fit the data to eg
the log-normal distribution (in the documentation we find that the
abbreviation for that is “LOGNO”), we can do it like this:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_norm_fit</span> <span class="op">&lt;-</span> <span class="fu">gamlss</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">LOGNO</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>GAMLSS-RS iteration 1: Global Deviance = 194.3047
GAMLSS-RS iteration 2: Global Deviance = 194.3047 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">log_norm_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
Family:  c("LOGNO", "Log Normal")

Call:
gamlss(formula = eruptions ~ 1, family = LOGNO, data = eruption_example)

Fitting method: RS()

------------------------------------------------------------------
Mu link function:  identity
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.451832   0.007461   194.6   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  log
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -2.31561    0.05345  -43.32   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  175
Degrees of Freedom for the fit:  2
      Residual Deg. of Freedom:  173
                      at cycle:  2

Global Deviance:     194.3047
            AIC:     198.3047
            SBC:     204.6343
******************************************************************</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The data generating function is not necessarily the same as the
distribution that best fit the data</li>
<li>Chose the distribution that best describes your data - not the one
that fits best</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-linear-regression"><p>Content from <a href="linear-regression.html">Linear regression</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/linear-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make a linear regression?</li>
<li>How do I interpret the results of a linear regression?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to fit data to a linear equation in one dimension</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Here is some data, observations of the distance (in ft) it takes to
stop a car driving at different speeds (in mph):</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/linear-regression-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Not surprisingly the faster the car travels, the longer distance it
takes to stop it.</p>
<p>If we want to predict how long a car traveling at 10 mph takes to
stop, we could look at the observations at 10 mph and note that there is
some variation. We might take the average of those observations, and use
that as an estimate of how many feet it takes to stop a car traveling at
10 mph.</p>
<p>But what if we want to predict how long it takes to stop the car if
we are driving it at 12.5 mph instead? That would be nice to know, in
order to avoid hitting stuff. There are no observations in the data at
12.5 mph! We could estimate it as the average of the (average) stopping
distance at 12 mph and at 13 mph (21.5 and 35 ft respectively) and give
an estimate of 28.25 ft.</p>
<p>This is easy - 12.5 is exactly at the middle of the interval of 12 to
13 mph. But what if we want the distance at 12.4 mph?</p>
<p>Instead of fiddling with the numbers manually, we note that it
appears to be possible to draw a straight line through the points,
describing the connection between the two variables.</p>
<p>Let’s do that:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/linear-regression-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points do not fall precisely on the line, but it’s not very
bad.</p>

<p>When we want to figure out how long it takes to stop a car driving at
12.5 mph, we can locate 12.5 on the x-axis, move vertically up to the
line, and read the corresponding value on the y-axis, about 30 mph.</p>
<p>But we can do better. Such a line can be described mathematically.
Straight lines in two dimensions can in general be described using the
formula:</p>
<p><span class="math display">\[
y = ax + b
\]</span> or, in this specific case:</p>
<p><span class="math display">\[
dist = a*speed + b
\]</span></p>
<p><code>a</code> and <code>b</code> are the coefficients of this
“model”. <code>a</code> is the slope, or how much the distance changes,
if we change speed by one. <code>b</code> is the intercept, the value
where the line crosses the y-axis. Or the distance it takes to stop a
car, traveling at a speed of 0 miles per hour - a value that does not
necessarily make sense, but is still a part of the model.</p>
<p>If we want to be very strict about it, that <code>=</code> is not
really equal. The expression describes the straight line, but the actual
observations do not actually fall on the line. If, for a given dist and
speed, we want the expression to actually be equal, there is some
variation that we need to include. We do that by adding a
<code>residual</code>:</p>
<p><span class="math display">\[
dist = a*speed + b + \epsilon
\]</span></p>
<p>And, if we want to be very mathematical concise, instead of using
<code>a</code>and <code>b</code> for the coefficients in the expression,
we would instead write it like this:</p>
<p><span class="math display">\[
dist = \beta_0 + \beta_1 speed + \epsilon
\]</span></p>
<p>That is all very nice. But how do we find the actual <code>a</code>
and <code>b</code> (or <span class="math inline">\(\beta_i\)</span>)?
What is the “best” line or model for this?</p>
<p>We do that by fitting <code>a</code> and <code>b</code> to values
that minimizes <span class="math inline">\(\epsilon\)</span>, that is,
we need to find the difference between the actual observed values, and
the prediction from the expression or model. Instead of looking at the
individual differences one by one, we look at the sum of the
differences, and minimizes that. However, the observed values can be
larger than the prediction, or smaller. The differences can therefore be
both negative and positive, and the sum can become zero because the
difference might cancel each other out.</p>
<p>To avoid that problem, we square the differences, and then minimize
the sum of the squares. That is the reason for calling the method for
minimizing <span class="math inline">\(\epsilon\)</span>, and by that
finding the optimal <code>a</code> and <code>b</code>, “least
squares”.</p>
<p>In a simple linear model like this, we can calculate the coefficients
directly:</p>
<p><span class="math display">\[\beta_1 = \frac{\sum_{i=1}^{n} (x_i -
\overline{x})(y_i - \overline{y})}{\sum_{i=1}^{n} (x_i -
\overline{x})^2}\]</span></p>
<p><span class="math display">\[\beta_0 = \overline{y} -
\beta_1\overline{x}\]</span></p>
<p>We do not want to do that - R can do it for us, with the function
<code>lm()</code></p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<p>y~x is the “formula notation” in R, and describes that y is a
function of x.</p>
<p>Using the example from above:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">dist</span><span class="op">~</span><span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span></code></pre>
</div>
<p>We saved the result of the function in an object, in order to be able
to work with it. If we just want the coefficients, we can output the
result directly:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Coefficients:
(Intercept)        speed
    -17.579        3.932  </code></pre>
</div>
<p>This gives us the coefficients of the model. The intercept,
<code>b</code> or <span class="math inline">\(\beta_0\)</span> is
-17.579. And the slope, <code>a</code> or <span class="math inline">\(\beta_1\)</span> is 3.932.</p>
<p>Having a negative intercept, or in this case any intercept different
from 0 does not make physical sense - a car travelling at 0 miles pr
hour should have a stopping distance of 0 ft.</p>
<p>The slope tells us, that if we increase the speed of the car by 1
mph, the stopping distance will increase by 3.932 ft.</p>
<div id="challenge-1-can-you-do-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?</h3>
<div class="callout-content">
<p>What stopping distance does the model predict if the speed i 12.5
mph?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>3.932*12.5 - 17.579 = 31.571 ft</p>
</div>
</div>
</div>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout-inner">
<h3 class="callout-title">Challenge 2: Might there be a problem with that prediction?</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Yep. We might be able to measure the speed with the implied
precision. But the prediction implies a precision on the scale of
1/10000 mm.</p>
</div>
</div>
</div>
</div>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max
-29.069  -9.525  -2.272   9.215  43.201

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -17.5791     6.7584  -2.601   0.0123 *
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared:  0.6511,	Adjusted R-squared:  0.6438
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
<p>Let us look at that output in detail.</p>
<p><code>Call</code> simply repeats the model that we build, just in
case we have forgotten it - but also to have the actual model included
in the output, in order for other functions to access it and use it. We
will get to that.</p>
<p>The residuals are included. It is often important to take a look at
those, and we will do that shortly.</p>
<p>Now, the coefficients.</p>
<p>The estimates for intercept and speed, that is the intercept and the
slope of the line, are given. Those are the same we saw previously. We
also get a standard error. We need that for testing how much trust we
have in the result.</p>
<p>We are almost certain that the estimates of the values for intercept
and slope are not correct. They are estimates after all and we will
never know what the <em>true</em> values are. But we can test if they
are zero.</p>
<p>The hypothesis we can test is - is the coefficient for the slope
actually zero, even though the estimate we get is 3.9? If it is zero,
speed will not have any influence on the stopping distance. So; with
what certainty can we rule out that it is in fact zero?</p>
<p>We are testing the hypothesis that we have gotten a value for speed
of 3.9 by random chance, but that the true value is zero. If it is zero,
the value of 3.9 is 9.5 standard errors away from 0: 3.9324/0.4155 =
9.46426. And, using the t-distribution which describes these sorts of
things pretty well, that will happen very rarely. The Pr, or p-value, is
1.49e-12. That is the chance, or probability, that we will get a value
for the slope in our model that is 9.464 standard errors away from zero,
if the true value of the slope is zero.</p>
<p>In general if the p-value is smaller than 0.05, we reject the
hypothesis that the true value of the slope is 0.</p>
<p>Since we can assume that the estimates are normally distributed, we
can see that, <em>if</em> the true value of the slope was zero, the
value we get here, is 3.9324/0.4155 = 9.46426, standard errors away from
zero.</p>
<p>RSE is the squareroot of the sum of the squared residuals, divided by
the number of observations, <span class="math inline">\(n\)</span> minus
the number of parameters in the model, in this case 2. It is an estimate
of the average difference between the observed values, and the values
the model predicts. We want RSE to be as small as possible. What is
small? That depends on the size of the values. If we predict values in
the range of 0 to 2, an RSE of 15 is very large. If we predict values in
the range 0 to 1000, it is small.</p>
<p>Multiple R-squared, is a measure of how much of the variation in
<code>dist</code> that our model explains. In this case the model
explains ~65% of the variation. Not that impressive, but acceptable.</p>
<p>The adjusted R-squared adjusts the multiple R-square by the number of
independent variables in the model. It becomes an important measure of
how good the model is, when we get to multiple linear regression,
because we will get a better R-squared by adding independent variables,
even if these variables do not actually have any connection to the
dependent variables.</p>
<p>The F-statistic is 89.57 and has a p-value of 1.49e-12.</p>
<p>This tests our model against a model where all the slopes (we only
have one in this case) are 0; that is, is the overall model significant.
In this case it is, and there is overall strong evidence for the claim
that the speed of the car influences the stopping distance.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Make a model, where you describe the length of the flipper of a
penguin, as a function of its weigth. You find data on penguins in the
library <code>palmerpenguins</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'palmerpenguins'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:datasets':

    penguins, penguins_raw</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">~</span><span class="va">body_mass_g</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = flipper_length_mm ~ body_mass_g, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max
-23.7626  -4.9138   0.9891   5.1166  16.6392

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.367e+02  1.997e+00   68.47   &lt;2e-16 ***
body_mass_g 1.528e-02  4.668e-04   32.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.913 on 340 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.759,	Adjusted R-squared:  0.7583
F-statistic:  1071 on 1 and 340 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="testing-the-assumptions">Testing the assumptions<a class="anchor" aria-label="anchor" href="#testing-the-assumptions"></a>
</h2>
<hr class="half-width">
<p>We can <em>always</em> make a linear model. The questions is: should
we?</p>
<p>There are certain assumptions that needs to be met in order to trust
a linear model.</p>
<ol style="list-style-type: decimal">
<li><p>There should be a linear connection between the dependent and
independent variable. We test that by comparing the observed values with
the predicted values (the straight line).</p></li>
<li><p>Independence. The observations needs to be independent. If one
measurement influences another measurement, we are not allowed to use a
linear model.</p></li>
<li><p>Normality of residuals. The residuals must be normally
distributed.</p></li>
</ol>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> The assumptions - differently defined </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>The three assumptions can be formulated in different ways, and it can
be useful to read more than one in order to understand them. This is a
different way:</p>
<ol style="list-style-type: decimal">
<li>For any given value of x, the corresponding value of y has an
average value of <span class="math inline">\(\alpha + \beta
x\)</span>
</li>
<li>For any two data points, the error terms are independent of each
other.</li>
<li>For any given value of x, the corresponding value of y is normally
distributed about <span class="math inline">\(\alpha + \beta x\)</span>
with the same variance <span class="math inline">\(\sigma^2\)</span> for
any x</li>
</ol>
</div>
</div>
</div>
</div>
<p>In general we know our data well enough to determine if the first two
are fulfilled. The third assumptions can be tested using a
<code>qqplot</code>. We begin by extracting the residuals from our
model:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<p>And then plotting them:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/linear-regression-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points should be (close to be) on the straight line in the plot.
In this case they are close enough.</p>
<p>This is also a handy way to test if our data is normally
distributed.</p>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Test if the residuals in our penguin model from before, are normally
distributed.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span>
<span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/linear-regression-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure">
They are relatively close to normal.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Linear regression show the (linear) relationship between
variables.</li>
<li>The assumption of normalcy is on the residuals, not the data!</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-multiple-linear-regression"><p>Content from <a href="multiple-linear-regression.html">Multiple Linear Regression</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/multiple-linear-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you run a multiple linear regression?</li>
<li>What about conditional effects?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to build and trim a model with multiple independent
variabels</li>
<li>Learn how to build a model with interaction terms</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A linear regression is relatively simple to understand and visualise.
We have a dependent variable that we try to predict - model - using an
independent variable. In principle we can change the independent
variable, and the model will predict the change in the dependent
variable. We can visualise this using a relatively simple graph,
plotting the two variables against each other, and adding the line
representing the model.</p>
<p>But what if we have reason to believe that the dependent variable
depends on more than one independent variable?</p>
<p>Let us find some data for illustrating this.</p>
<p>Before anything else, we load the <code>tidyverse</code> package,
download the data, and read it using <code>read_csv()</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="fu">download.file</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/BONEDEN.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/BONEDEN.csv"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span><span class="va">boneden</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/BONEDEN.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>The data records the bonedensity in different parts of the skeleton
of female monozygotic twins, as well as height, age, weight, smoking,
alcohol, tea and coffee-habits. We are going to study the second twins,
where all variables are suffixed with the digit “2”:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">boneden</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">density</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 12
    age   ht2   wt2  tea2  cof2  alc2  cur2  men2  pyr2   ls2   fn2   fs2
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    27   160    56    42    21     0     0     0  13.8  0.76  0.68  1.04
2    42   159    72    20    21     1     1     0  48    0.89  0.64  1.11
3    59   156    54     7    28     0     0     1  20.5  0.51  0.64  0.86
4    61   162    58    21    35     0     0     1  29.8  0.85  0.69  1.03
5    47   150    58    91     0     0     1     1  25    0.59  0.54  0.96
6    33   158    54    14    14     0     0     0   5    0.83  0.5   1.06</code></pre>
</div>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The package <code>tidyselect</code> is a part of the
<code>tidyverse</code>. It contains functions that allow us to choose
variables/columns based on patterns in their names rather than
specifying the names directly. <code>contains("2")</code> here return
all columns with a name containing the string “2”.</p>
</div>
</div>
</div>
<p>More specically we are trying to model the bone density in the
femoral shaft (lårbensskaft). As an intial hypothesis, we are going to
assume that the density depends on height (<code>ht2</code>), age
(<code>age</code>), weight (<code>wt2</code>), tea (<code>tea2</code>)
and coffee consumption (<code>cof2</code>).</p>
<p>That is, we assume that there is a linear correlation between the
bone density and each of the independent variables.</p>
<p>The simple linear regresion between just the bone density and the
height, can be done with:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2, data = density)

Residuals:
     Min       1Q   Median       3Q      Max
-0.41406 -0.02810  0.00190  0.07658  0.30722

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -1.78744    0.71928  -2.485 0.017351 *
ht2          0.01766    0.00445   3.969 0.000301 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1315 on 39 degrees of freedom
Multiple R-squared:  0.2877,	Adjusted R-squared:  0.2694
F-statistic: 15.75 on 1 and 39 DF,  p-value: 0.0003006</code></pre>
</div>
<p>Where we pipe the output of the regression to the summary function to
take a closer look. There is a significant correlation between bone
density and height. If we increase the height of a woman by one
centimeter, the density of her femoral shaft is expected to increase by
0.0177 <span class="math inline">\(g/cm^3\)</span>. The correlation is
significant, that is, we are rather sure that the estimate of this
coefficient is different from 0.</p>
<p>Now we would like to add the other independent variables to the
model.</p>
<p>The model we are building can be described using math as:</p>
<p><span class="math display">\[ \text{fs2} = w_0 + w_1\text{ht2} +
w_2\text{wt2} + w_3\text{tea2} + w_4\text{cof2} + \epsilon  \]</span>
That is - we would like to figure out which coefficients <span class="math inline">\(w_1\)</span> to <span class="math inline">\(w_4\)</span>, and which intercept <span class="math inline">\(w_0\)</span> will give us estimates of fs2, that
minimizes the error <span class="math inline">\(\epsilon\)</span></p>
<p>This is pretty straight forward. Instead of running
<code>lm(fs2~ht2, data = density</code>, we add the additional
independent variables using the <code>+</code> sign. And again we pipe
the result to the summary function to take a closer look:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">tea2</span> <span class="op">+</span> <span class="va">cof2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + tea2 + cof2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.247601 -0.061517  0.005634  0.067826  0.166474

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.2800114  0.7774507  -0.360 0.720887
ht2          0.0090956  0.0046455   1.958 0.058246 .
age         -0.0068373  0.0015669  -4.364 0.000108 ***
wt2          0.0038274  0.0014934   2.563 0.014836 *
tea2        -0.0009246  0.0009837  -0.940 0.353677
cof2        -0.0005310  0.0009328  -0.569 0.572778
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1043 on 35 degrees of freedom
Multiple R-squared:  0.5978,	Adjusted R-squared:  0.5403
F-statistic:  10.4 on 5 and 35 DF,  p-value: 3.566e-06</code></pre>
</div>
<p>It is <em>that</em> simple. Interpreting the results on the other
hand is a bit more complicated.</p>
<p>The bone density, for a newborn woman (0 years old), that is 0
centimeters high, weighing 0 kilogram, who does not drink either tea or
coffee, is -0.28 <span class="math inline">\(g/cm^3\)</span> - which is
obviously either impossible, or a discovery that would get you an
invitation to Stockholm.</p>
<p>For each centimeter the woman grows, <em>if all other variables are
held constant!</em> the bone density is expected to <em>increase</em> by
0.0091 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>For each year the woman grows older, <em>if all other variables are
held constant!</em> the bone density is expected to <em>decrease</em> by
0.0068 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>For each kilogram the woman puts on weight, <em>if all other
variables are held constant!</em> the bone density is expected to
<em>increase</em> by 0.0038 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>The coefficient for the height variable is not significant (if we
have decided on a 5% significanse level), and neither consumption of teo
nor coffee has a significant influence on bone density. According to
this model.</p>
<p>Is this a good model? No. The coefficients for Tea and coffee
consumption are not significant, and should not be in the model. Let us
remove them.</p>
<p>But let us remove them one by one. First coffee that has the worst
p-value:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">tea2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + tea2, data = density)

Residuals:
     Min       1Q   Median       3Q      Max
-0.26036 -0.06261  0.01682  0.06366  0.17393

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.2209640  0.7632342  -0.290   0.7739
ht2          0.0085364  0.0044976   1.898   0.0657 .
age         -0.0068645  0.0015514  -4.425 8.58e-05 ***
wt2          0.0041140  0.0013927   2.954   0.0055 **
tea2        -0.0007497  0.0009257  -0.810   0.4233
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1034 on 36 degrees of freedom
Multiple R-squared:  0.5941,	Adjusted R-squared:  0.5489
F-statistic: 13.17 on 4 and 36 DF,  p-value: 1.048e-06</code></pre>
</div>
<p>Note that not only is the coefficient for tea still not significant,
it actually gets “worse”. On the other hand, the coefficient for weight
now is larger, ie explains more of the variation.</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Why does this happen?</p>
<p>What the model does is “trying” to explain the variation in
<code>fs2</code>, using the independent variables. We have an underlying
assumption that we can change those variables independently. However,
they are often correlated. In this case there is a relatively large
correlation between <code>cof2</code> and <code>wt2</code>. When we
remove <code>cof2</code> from the model, some of the variation explained
by <code>cof2</code> can now be captured by <code>wt2</code>.</p>
</div>
</div>
</div>
<p>We do not actually explain that much of the variation in
<code>fs2</code>. The R<sup>2</sup> value tells us how much of the
variation is explained by the model, and 0.5941 is not <em>that</em>
impressive. We will be able to explain everything, including random
noise in the data. We just need to add enough independent variables to
our model. Some of the random noise will be explained by even a random
varible.</p>
<p>This is called <code>overfitting</code>, and one of ways we try to
identify that, is by looking at the <code>Adjusted R-squared</code>
instead. This adjusts the R<sup>2</sup> for the number of variables we
have in the model. This is the measure of how good the model is, that we
prefer.</p>
<p>We continue our “leave-one-out” approach. <code>tea2</code> is the
“worst” performing variable measured by the p-value, and that is the
next one we will remove:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> , data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.273490 -0.058038  0.005241  0.067527  0.169512

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.569569   0.627355  -0.908  0.36981
ht2          0.010524   0.003751   2.806  0.00796 **
age         -0.006489   0.001474  -4.404 8.74e-05 ***
wt2          0.004077   0.001385   2.943  0.00559 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1029 on 37 degrees of freedom
Multiple R-squared:  0.5867,	Adjusted R-squared:  0.5531
F-statistic:  17.5 on 3 and 37 DF,  p-value: 3.078e-07</code></pre>
</div>
<p>Now we have a model where all coefficients are significant.</p>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>What about the intercept?</p>
<p>The estimate of the intercept is not significant. Is that a
problem?</p>
<p>No, not in this case. The intercept is the estimate of what
<code>fs2</code> would be if all the independent variables are 0. That
might be meaningful for age, but definitely not for height or
weight.</p>
<p>Also the thing we are interested in is not actually making
predictions, in that case we would like a better estimate of the
intercept, but in studying the effect of height, age and weight on
bonedensity.</p>
</div>
</div>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>The dataset contains more variables than we have examined here.
Alcohol consumption <code>alc</code>, and how many years the individual
women have been smoking <code>pyr</code>.</p>
<p>We also only studied half of the dataset, the variables ending in
“2”. Data on the other twins have variables ending in “1”.</p>
<p>Build a model predicting the bonedensity of the femoral shaft
<code>fs1</code> using a selection of the variables <code>age</code>,
ht1<code>,</code>wt1<code>,</code>tea1<code>,</code>cof1<code>,</code>alc1<code>and</code>pyr1`.</p>
<p>Make sure that only significant (p&lt;0.05) variables are
included.</p>
<p>What is the adjusted R squared value?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dens_exercise</span> <span class="op">&lt;-</span> <span class="va">boneden</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"1"</span><span class="op">)</span>, <span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="va">cur1</span>, <span class="va">ls1</span>, <span class="va">fn1</span>, <span class="va">men1</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">wt1</span><span class="op">+</span> <span class="va">cof1</span> <span class="op">+</span> <span class="va">alc1</span> <span class="op">+</span><span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_3</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">wt1</span> <span class="op">+</span> <span class="va">alc1</span> <span class="op">+</span><span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_4</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">wt1</span> <span class="op">+</span> <span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_5</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_6</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model_6</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.2555525</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="categorical-data">Categorical data<a class="anchor" aria-label="anchor" href="#categorical-data"></a>
</h2>
<hr class="half-width">
<p>We also have categorical variables in the data. Can we use them?</p>
<p>Yes!</p>
<div class="section level3">
<h3 id="first-way---categorical-values-as-independent-variables">First way - categorical values as independent variables<a class="anchor" aria-label="anchor" href="#first-way---categorical-values-as-independent-variables"></a>
</h3>
<p>Let us add information about menopausal status,
<code>men2</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">density</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>men2 <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">men2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cat_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">men2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">cat_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + men2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.282979 -0.049356 -0.006728  0.066710  0.171457

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.532553   0.643852  -0.827 0.413764
ht2          0.010650   0.003898   2.732 0.009799 **
age         -0.008232   0.002098  -3.924 0.000389 ***
wt2          0.004191   0.001414   2.963 0.005450 **
men21        0.053401   0.051460   1.038 0.306514
men22       -0.026286   0.059796  -0.440 0.662939
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1032 on 35 degrees of freedom
Multiple R-squared:  0.6067,	Adjusted R-squared:  0.5505
F-statistic:  10.8 on 5 and 35 DF,  p-value: 2.462e-06</code></pre>
</div>
<p>There are three different categorical values in <code>men2</code>. 0:
premenopausal, 1: Postmenopausal and 2: Unknown or hysterectomy.</p>
<p>If we want to add categorical data to the model, we need to make sure
they are encoded as categorical, otherwise the model will treat them as
continous values. We do that by running <code>factor()</code> on the
relevant variable.</p>
<p>Again this is relatively simple, the interpretation on the other hand
is a bit more complex. The coefficients for <code>ht2</code>,
<code>age</code> and <code>wt2</code> now tells us how the value of
<code>fs2</code> changes for the base case 0, premenopausal. The
coefficient of <code>factor(men2)1</code> tells us that there is an
added “bonus” to the bonedensity to become postmenopausal. And
<code>factor(men2)2</code> that there is a “penalty” of -0.026286 to
have the “unknown” status. The coefficients are not significant, so this
might be a bad example.</p>
</div>
<div class="section level3">
<h3 id="the-second-way---interaction">The second way - interaction<a class="anchor" aria-label="anchor" href="#the-second-way---interaction"></a>
</h3>
<p>Maybe the influence of menopause status is not direct, but rather in
the form that the coefficient for <code>wt2</code> depends on menopausal
status. Ie increasing weight might lead to increasing bonedensity. But
to different degrees depending on menopausal status.</p>
<p>We can add this interaction term to the model by multiplying the
categorical variable to the variabel where we suspect that there might
be an interaction:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interact_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span><span class="op">*</span><span class="va">men2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">interact_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 * men2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.264590 -0.053534 -0.000568  0.057129  0.168441

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.355334   0.648878  -0.548 0.587642
ht2          0.009842   0.004014   2.452 0.019661 *
age         -0.007966   0.002084  -3.823 0.000555 ***
wt2          0.003272   0.002281   1.434 0.160913
men21       -0.166698   0.196497  -0.848 0.402355
men22        0.149021   0.264316   0.564 0.576703
wt2:men21    0.003455   0.003070   1.126 0.268439
wt2:men22   -0.002592   0.004025  -0.644 0.524081
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1021 on 33 degrees of freedom
Multiple R-squared:  0.637,	Adjusted R-squared:  0.5601
F-statistic: 8.274 on 7 and 33 DF,  p-value: 8.211e-06</code></pre>
</div>
<p>Once again it is “simple” to do, more complicated to interpret.</p>
<p>The (estimated) coefficients for <code>ht2</code>and <code>age</code>
should be understood as before.</p>
<p>But now we have a good deal more coefficients.
<code>factor(men2)1</code> and <code>factor(men2)2</code> should also be
understood as before.</p>
<p><code>wt2</code> is also still the same as before. But we have two
new. If the specific woman is postmenopausal, there is an additional
term, wt2:men21 that needs to be added to the prediction.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>What is the prediction for <code>fs2</code> for a 52 year old, 164
centimeter high, postmenopausal woman weighing 62 kg?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>We find it by adding all the terms:</p>
<ul>
<li>intercept: -0.355334</li>
<li>52 × age: 52 × -0.007966 = -0.414232</li>
<li>164 × ht2: 164 × 0.009842 = 1.613488</li>
<li>62 × wt2: 62 × 0.003272 = 0.202864</li>
<li>factor(men2)1 = -0.166698 (because men2 is = 1)</li>
<li>65 × wt2:men21 = 62 × 0.003455 = 0.21421</li>
</ul>
<p>The result is: 1.094298</p>
<p>An alternative way would be to construct a dataframe containing the
values for which we want to make the prediction, and use the
<code>predict</code> function:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  ht2 <span class="op">=</span> <span class="fl">164</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">52</span>,</span>
<span>  wt2 <span class="op">=</span> <span class="fl">62</span>,</span>
<span>  men2 <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fl">1</span>, levels <span class="op">=</span> <span class="fu">levels</span><span class="op">(</span><span class="va">density</span><span class="op">$</span><span class="va">men2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">predict</span><span class="op">(</span><span class="va">interact_model</span>, newdata <span class="op">=</span> <span class="va">new_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>       <span class="fl">1</span></span>
<span><span class="fl">1.094928</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We can do linear regression on multiple independent variables</li>
<li>Be careful not to overfit - only retain variables that are
significant (and sensible)</li>
<li>We can fit just as well on categorical variables - but make sure
they <em>are</em> categorical</li>
<li>Interpreting linear models with multiple variables are not trivial _
Interpreting linear models with interaction terms are even less
trivial</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-logistic-regression"><p>Content from <a href="logistic-regression.html">Logistic regression</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/logistic-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you run a logistic regression?</li>
<li>What is the connection between odds and probabilities?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to run a logistic regression</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<section><h2 class="section-heading" id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h2>
<hr class="half-width">
<p>Using linear regression, or even non-linear multiple regression
techniques, we can predict the expected value of a dependent continuous
variable given values of one or more independent variables.</p>
<p>But what if the dependent variable we want to predict is not
continous, but categorical?</p>
<p>Eg, if we try to predict an outcome like “Healthy/Sick” based on a
number of independent variables?</p>
<p>We do that using the logistic regression. Strictly speaking the
logistic model does not predict a yes/no answer, but rather the
probability that the answer is yes (and conversely that it is no).
Rather than the continous outcome the linear methods model for the
dependent variable, the logistic regression returns a probability. By
definition that lies somewhere between 0 and 1 (or 0% and 100%).</p>
<p>And since the linear methods we would like to use for doing the
actual logistic regression does not play nice with those bounds, we need
to think about probabilities in a different way.</p>
</section><section><h2 class="section-heading" id="a-new-way-of-thinking-about-probability-">A new way of thinking about probability.<a class="anchor" aria-label="anchor" href="#a-new-way-of-thinking-about-probability-"></a>
</h2>
<hr class="half-width">
<p>We often talk about there being a “67%” probability or chance of
something. Reading p-values, we do that all the time. A p-value of 0.05,
equivalent to 5%, tells us that if we run the test often enough, there
is a 5% chance of seeing a result as extreme as the test value purely by
chance, if the null-hypothesis is true.</p>
<p>5% is equivalent to 5 instances out of 100 possibilities. As
indicated above, we want to convert those 5% to something that does not
have a range between 0 and 1.</p>
<p>Therefore, we convert probabilities to odds.</p>
<p>Odds are a different way of representing probabilities. A lot of
statistics and probability theory have their roots in gaming and
betting, so let us use that as an example.</p>
<p>If two soccer-teams play, and we want to bet on the outcome, the
betting company we place our bet at, will give us odds. 1:9 indicates
that if the two teams play 10 times, one team will win 1 game, and the
other will win 9 times (assuming that a tie is not possible, and
glossing over a lot of other details that relates more to the companys
profits). That is equivalent to one team having a 10% chance of winning,
and the other having a 90% chance of winning.</p>
<p>The connection between the two numbers is found by:</p>
<p><span class="math display">\[odds = \frac{p}{1-p}\]</span></p>
<p>We have now transformed a probability going between 0 and 1, to odds,
that can go between 0 and positive infinity.</p>
</section><section><h2 class="section-heading" id="going-a-step-further">Going a step further<a class="anchor" aria-label="anchor" href="#going-a-step-further"></a>
</h2>
<hr class="half-width">
<p>Modelling probabilities is difficult, because they can only have
values between 0 and 1. Converting them to odds, give us something that
can have values between 0 and infinity (positive). If we take one extra
step, we can convert those odds to something that is continuous and, can
have any value.</p>
<p>We do that by taking the (natural) logarithm of the odds, and the
entire conversion from probability to log-odds, is called the
logit-function:</p>
<p><span class="math display">\[logit(p) =
\log(\frac{p}{1-p})\]</span></p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Remember the probabilities of the soccer-match? One team had a 10%
probability of winning, corresponding to odds 1:9. That means that the
other team have a 90% probability of winning, or odds 9:1. Try to run
the logit function on both of those probabilities. Do you notice a nice
relation between them?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log</span><span class="op">(</span><span class="fl">0.1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -2.197225</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log</span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.197225</code></pre>
</div>
<p>The two log-odds values have different signs, but are otherwise
identical. This is nice and symmetrical.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="so---what-are-we-modelling">So - what are we modelling?<a class="anchor" aria-label="anchor" href="#so---what-are-we-modelling"></a>
</h2>
<hr class="half-width">
<p>This:</p>
<p><span class="math display">\[\text{logit}(p) = \beta_0 + \beta_1 X_1
+ \beta_2 X_2 + \dots + \beta_k X_k\]</span></p>
<p>And that looks familiar, and the net result of <em>all</em> the stuff
about odds, logit-functions etc. have exactly that as their goal; we can
now use all the nice techniques from the linear regressions to model
categorical values.</p>
<p>It’s not exactly that simple. In the linear regression we fit the
data to a line, where we in the logistic regression fits the data to a
sigmoid curve:</p>
<figure><img src="fig/logistic-regression-rendered-logit_func_plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="ok-lets-make-a-fit-already">OK, lets make a fit already!<a class="anchor" aria-label="anchor" href="#ok-lets-make-a-fit-already"></a>
</h2>
<hr class="half-width">
<p>We start be getting some data. Download the FEV dataset, but start by
creating a folder called “data”:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/FEV.csv"</span>, <span class="st">"data/FEV.csv"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 654 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (6): Id, Age, FEV, Hgt, Sex, Smoke

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fev</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/FEV.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>The data contains measurements of age, height, sex and lung function
for 654 children, as well as an indication of wether or not they
smoke.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fev</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 654 × 6
      Id   Age   FEV   Hgt   Sex Smoke
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1   301     9  1.71  57       0     0
 2   451     8  1.72  67.5     0     0
 3   501     7  1.72  54.5     0     0
 4   642     9  1.56  53       1     0
 5   901     9  1.90  57       1     0
 6  1701     8  2.34  61       0     0
 7  1752     6  1.92  58       0     0
 8  1753     6  1.42  56       0     0
 9  1901     8  1.99  58.5     0     0
10  1951     9  1.94  60       0     0
# ℹ 644 more rows</code></pre>
</div>
<p>We will do a logistic regression, to see if we can predict wether or
not a child is smoking, based on all the other variables (except the Id
value).</p>
<p>As both Sex and Smoke are categorical values, it is important that
they are actually coded as categorical values in the data, in order for
R to be able to handle them as such:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fev</span> <span class="op">&lt;-</span> <span class="va">fev</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Sex <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>,</span>
<span>         Smoke <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">Smoke</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>We can now build a model. It looks almost like the linear model, but
rather than using the <code>lm()</code> function we use the
<code>glm()</code>, or “generalised linear model”, which is able to
handle logistic models. It <em>is</em> general, so we need to specify
that we are running a binomial (ie two possible outcomes) fit. We save
the result to an object, so we can take a closer look:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_model</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">Smoke</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">+</span> <span class="va">FEV</span> <span class="op">+</span> <span class="va">Hgt</span> <span class="op">+</span> <span class="va">Sex</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">fev</span><span class="op">)</span></span></code></pre>
</div>
<p>The result in itself looks like this:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_model</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:  glm(formula = Smoke ~ Age + FEV + Hgt + Sex, family = "binomial",
    data = fev)

Coefficients:
(Intercept)          Age          FEV          Hgt         Sex1
   -18.6141       0.4308      -0.5452       0.2122      -1.1652

Degrees of Freedom: 653 Total (i.e. Null);  649 Residual
Null Deviance:	    423.4
Residual Deviance: 300 	AIC: 310</code></pre>
</div>
<p>And if we take a closer look:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">log_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = Smoke ~ Age + FEV + Hgt + Sex, family = "binomial",
    data = fev)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -18.61406    3.51282  -5.299 1.17e-07 ***
Age           0.43075    0.07098   6.069 1.29e-09 ***
FEV          -0.54516    0.31662  -1.722 0.085103 .
Hgt           0.21224    0.06371   3.331 0.000865 ***
Sex1         -1.16517    0.38943  -2.992 0.002772 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 423.45  on 653  degrees of freedom
Residual deviance: 300.02  on 649  degrees of freedom
AIC: 310.02

Number of Fisher Scoring iterations: 7</code></pre>
</div>
<p>Interestingly lungfunction does not actually predict smoking status
very well.</p>
<p>But what does the coefficients actually mean?</p>
<p>The intercept is not very interesting in itself, and we do not
generally interpret directly on it. It represents the log-odds of
smoking if all the predictive variables (Age, FEV, Hgt, and Sex) are 0.
And the log-odds in that case is not very informative.</p>
<p>We have a positive coefficient for Age. That means, that for each
unit increase in age, here 1 year, the log-odds for smoking increase by
0.43075, <em>if all other</em> variables are kept constant. Since we
have log-odds, we can find the increase in odds for smoking by taking
the exponential of the log-odds:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fl">0.43075</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.538411</code></pre>
</div>
<p>That is - the odds for smoking increase by 53.8% for each year a
child get older.</p>
<p>The coefficients for FEV and Hgt are treated similarly. Note that for
FEV, the coefficient is negative. That means the log-odds, and therefore
odds, for smoking decreases as lungfunction measured by FEV, increases.
As always <em>if all other</em> variables are kept constant.</p>
<p>Sex is a bit different. Because Sex is a categorical variable, the
coefficient indicates that there is a difference between the two
different sexes. And because it is negative, we can calculate that the
odds for smoking if the child is female is</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="op">-</span><span class="fl">1.16517</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3118696</code></pre>
</div>
<p>compared with male childre, equivalent to a reduction in odds by
about 68.8%</p>
</section><section><h2 class="section-heading" id="how-to-get-the-odds-quickly">How to get the odds quickly?<a class="anchor" aria-label="anchor" href="#how-to-get-the-odds-quickly"></a>
</h2>
<hr class="half-width">
<p>We can get the odds in one go, rather than running the exponential
function on them one by one:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fu">coef</span><span class="op">(</span><span class="va">log_model</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> (Intercept)          Age          FEV          Hgt         Sex1
8.241685e-09 1.538413e+00 5.797479e-01 1.236439e+00 3.118701e-01 </code></pre>
</div>
<p>We use the <code>coef()</code> function to extract the coefficients,
and then take the exponential on all of them.</p>
</section><section><h2 class="section-heading" id="and-what-about-the-probabilities">And what about the probabilities?<a class="anchor" aria-label="anchor" href="#and-what-about-the-probabilities"></a>
</h2>
<hr class="half-width">
<p>Sometimes it would be nice to get probabilities instead of odds. We
can get those using this expression:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu">exp</span><span class="op">(</span><span class="op">-</span><span class="fu">coef</span><span class="op">(</span><span class="va">log_model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> (Intercept)          Age          FEV          Hgt         Sex1
8.241685e-09 6.060530e-01 3.669876e-01 5.528606e-01 2.377294e-01 </code></pre>
</div>
</section><section><h2 class="section-heading" id="and-interpreting-the-probabilities">And interpreting the probabilities?<a class="anchor" aria-label="anchor" href="#and-interpreting-the-probabilities"></a>
</h2>
<hr class="half-width">
<p>A probability of 0.606 means that for each unit increase in Age, the
probabililty of the the outcome “smoking” increases by 60.6%</p>
<p>A probablity of 0.367 means that for each unit increase in FEV, the
probability of that outcome decreases by 36.7%</p>
</section><section><h2 class="section-heading" id="what-about-the-p-values">What about the p-values?<a class="anchor" aria-label="anchor" href="#what-about-the-p-values"></a>
</h2>
<hr class="half-width">
<p>p-values in logistic regression models are interpreted in the same
way as p-values in other statistical tests:</p>
<p>Given the NULL-hypothesis that the true value for the coefficient for
FEV in our model predicting the odds for smoking/non-smoking, is 0.</p>
<p>What is the probability of getting a value for the coefficient that
is as extreme as -0.54516?</p>
<p>If we run the experiment, or take the sample, often enough, we will
see a coefficient this large, or larger (in absolute values), 8.5% of
the times. If we decide that the criterium for significanse is 5%, this
coefficient is not significant.</p>
</section><section><h2 class="section-heading" id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h2>
<hr class="half-width">
<p>We generally experience that students are not really interested in
predicting an outcome. However part of the rationale behind building
these models is to be able to predict - outcomes.</p>
<p>Given a certain age, height, FEV and sex of a child, what is the
log-odds of that child smoking?</p>
<p>The easiest and most general way of predicting outcomes based on a
model, is to use the <code>predict()</code> function in R.</p>
<p>It takes a model, and some new data, and returns a result.</p>
<p>We begin by building a dataframe containing the new data:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_child</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>Age <span class="op">=</span> <span class="fl">13</span>, Hgt <span class="op">=</span> <span class="fl">55</span>, FEV <span class="op">=</span> <span class="fl">1.8</span>, Sex <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fl">1</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Here we are predicting on a boy (Sex = 1), aged 13, with a lungvolume
of 1.8l and a height of 55 inches.</p>
<p>It is important that we use the same units as the model. That is, we
need to use inches for the height, liters for the lung volume, and the
correct categorical value for Sex.</p>
<p>Now we plug that into the predict function, along with the model:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">predict</span><span class="op">(</span><span class="va">log_model</span>, newdata <span class="op">=</span> <span class="va">new_child</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>        <span class="fl">1</span></span>
<span><span class="op">-</span><span class="fl">3.487813</span> </span></code></pre>
</div>
<p>This will return the predicted log-odds, and we can either calculate
the probability from that. Or we can add a parameter to the predict
model, to the the probability directly:_</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">predict</span><span class="op">(</span><span class="va">log_model</span>, newdata <span class="op">=</span> <span class="va">new_child</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>         <span class="fl">1</span></span>
<span><span class="fl">0.02966099</span> </span></code></pre>
</div>
<div id="do-the-conversion-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-the-conversion-yourself" class="callout-inner">
<h3 class="callout-title">Do the conversion yourself</h3>
<div class="callout-content">
<p>Convert the predicted log-odds to a probability</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>We run the prediction:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted_odds</span> <span class="op">&lt;-</span> <span class="fu">predict</span><span class="op">(</span><span class="va">log_model</span>, newdata <span class="op">=</span> <span class="va">new_child</span><span class="op">)</span></span></code></pre>
</div>
<p>And then:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu">exp</span><span class="op">(</span><span class="op">-</span><span class="va">predicted_odds</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>         <span class="fl">1</span></span>
<span><span class="fl">0.02966099</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="what-about-another-child" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="what-about-another-child" class="callout-inner">
<h3 class="callout-title">What about another child?</h3>
<div class="callout-content">
<p>What is the probability for smoking for a 10 year old 110 cm tall
girl, with a lung volume of 1.1 liter?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Begin by making a dataframe describing the girl:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_girl</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>Age <span class="op">=</span> <span class="fl">10</span>, Hgt <span class="op">=</span> <span class="fl">110</span><span class="op">/</span><span class="fl">2.54</span>, FEV <span class="op">=</span> <span class="fl">1.1</span>, Sex <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fl">0</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And use <code>predict()</code> with the correct <code>type</code>
argument to get the result directly:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">predict</span><span class="op">(</span><span class="va">log_model</span>, newdata <span class="op">=</span> <span class="va">new_girl</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>          <span class="fl">1</span></span>
<span><span class="fl">0.003285539</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Using the predict-function to predict results is the easier way</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-clt"><p>Content from <a href="clt.html">Central Limit Theorem</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/clt.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>An important phenomenon working with data is the “Central Limit
Theorem”.</p>
<p>It states that, if we take a lot of samples from a distribution, the
mean of those samples will approximate the normal distribution, even
though the distribution in it self is not normally distributed.</p>
<p>The uniform distribution is not normally distributed. Without any
additional arguments, it will produce x random values between 0 and 1,
with equal probability for all possible values. Here we get 100 random
values, and plot a histogram of them:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_numbers</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> </span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/clt-rendered-random-histogram-1.png" style="display: block; margin: auto;" class="figure">
This is definitely not normally distributed.</p>
<p>The mean of these random numbers is:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4724241</code></pre>
</div>
<p>The important point of the Central Limit Theorem is, that if we take
a large number of random samples, and calculate the mean of each of
these samples, the means will be normally distributed.</p>
<p>We could also have found the mean of the 100 random numbers like
this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4911905</code></pre>
</div>
<p>And we can use the <code>replicate()</code> function to repeat that
calculation several times, in this case 1000 times:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated_means</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span><span class="fl">1000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>When we plot the histogram of these 1000 means of 100 random numbers,
we get this result:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">repeated_means</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/clt-rendered-repeated-means-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The histogram looks quite normally distributed, even though the
distribution from which we drew the random samples were not.</p>
<p>This is the essense of the Central Limit Theorem. The distrubution of
the means of our samples will approximate the normal distribution,
regardless of the underlying distribution.</p>
<p>Because of this, we are able to treat the mean (and a number of other
statistical descriptors), as normally distributed - <em>and</em> use the
properties we know the normal distribution to have to work with
them.</p>
<p>The math required for proving this theorem is relatively complicated,
but can be found in the (extra material)[<a href="https://kubdatalab.github.io/R-toolbox/CLT-dk.html" class="external-link uri">https://kubdatalab.github.io/R-toolbox/CLT-dk.html</a>] on
this page. Note that the proof is in Danish, we are working on an
english version.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The mean of a sample can be treated as if it is normally
distributed</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-barcharts"><p>Content from <a href="barcharts.html">Nicer barcharts</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/barcharts.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we style barcharts to look better?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use ggplot to make barcharts look better</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Barcharts are easy to make, but how can we get them to look
nicer.</p>
<p>This is a checklist for cleaning up your barchart.</p>
<p>We start by getting some data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'palmerpenguins'

The following objects are masked from 'package:datasets':

    penguins, penguins_raw</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<p>Barcharts and histograms are often confused. Histograms visualizes 1
dimentional data, barcharts 2 dimensional. The easy way to distinguish
them is the white space between the columns. Histograms are describing a
continious set of data, broken down into bins. Therefore there is no
breaks between the columns. Barcharts describes values in discrete
categories.</p>
<p>A further distinction in ggplot is between bar charts and column
charts.</p>
<p>Bar charts, made with <code>geom_bar()</code> makes the height of the
bar propotional to the number of cases/observations in each group, where
as <code>geom_col</code> makes the heights proportional to a value in
the group - that is just one value pr. group.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The way this happens is in the inner workings of the ggplot object.
All <code>geom</code>s come with an associated function/argument
<code>stats</code>, that controls the statistical transformation of the
input data. In <code>geom_bar</code> that transformation is
<code>stat_count()</code>, that counts the observations in each group.
In <code>geom_col´ it is ´stat_identity()</code>, which does nothing
with the data.</p>
</div>
</div>
</div>

<p>The us make the first barchart:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-first-example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This barchart is <em>boring</em>. Grey in grey.</p>
</section><section><h2 class="section-heading" id="step-1---colours-and-labels">Step 1 - colours and labels<a class="anchor" aria-label="anchor" href="#step-1---colours-and-labels"></a>
</h2>
<hr class="half-width">
<p>The first step would be to do something about the colours, and add
labels and a title to the plot:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-colours-labels-1.png" style="display: block; margin: auto;" class="figure">
It is not strictly necessary to remove the label of the x-axis, but it
is superfluous in this case.</p>
</section><section><h2 class="section-heading" id="second-step---the-order-of-the-bars">Second step - the order of the bars<a class="anchor" aria-label="anchor" href="#second-step---the-order-of-the-bars"></a>
</h2>
<hr class="half-width">
<p>Note that the plot orders the species of penguins in alphabetical
order. For some purposes this is perfectly fine. But in general we
prefer to have the categories ordered by size, that is the number of
observations.</p>
<p>The order of categories can be controlled by converting the
observations to a categorical value, and ordering the levels in that
<code>factor</code> by frequency.</p>
<p>The <code>forcats</code> library makes that relatively easy, using
the function <code>fct_infreq()</code>, which converts the character
vector that is <code>species</code> to a factor with levels ordered by
frequency:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-order-1.png" style="display: block; margin: auto;" class="figure">
This facilitates the reading of the graph - it becomes very easy to see
that the most frequent species of penguin is Adelie penguins.</p>

</section><section><h2 class="section-heading" id="rotating-the-plot">Rotating the plot<a class="anchor" aria-label="anchor" href="#rotating-the-plot"></a>
</h2>
<hr class="half-width">
<p>We only have three here, but if we have a lot of categories, it is
often preferable to have the columns as bars on the y-axis. We do that
by changing the <code>x</code> in the <code>aes()</code> function to
<code>y</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-rotation-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="size-of-text">Size of text<a class="anchor" aria-label="anchor" href="#size-of-text"></a>
</h2>
<hr class="half-width">
<p>The default size of the text on labels, title etc is a bit to the
small side. To improve readability, we change the base_size parameter in
the default theme of ggplot to 14. You might need to play around with
the value, depending on the number of categories.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-text-size-1.png" style="display: block; margin: auto;" class="figure">
We also changed the scaling of the title of the plot. The size of that
is now 10% larger than the base size. We can do that by specifying a
specific size, but here we have done it using the <code>rel()</code>
function which changes the size relative to the base font size in the
plot.</p>
</section><section><h2 class="section-heading" id="removing-unnecessary-space">Removing unnecessary space<a class="anchor" aria-label="anchor" href="#removing-unnecessary-space"></a>
</h2>
<hr class="half-width">
<p>There is a bit of empty space between the columns and the labels on
the y-axis.</p>
<p>Let us get rid of that:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-unnecessary-space-1.png" style="display: block; margin: auto;" class="figure">
We control what is happening on the x-scale by using the family of
<code>scale_x</code> functions. Because it is a continuous scale, more
specifically <code>scale_x_continuous()</code>.</p>
<p>What is happening by default is that the scale is expanded relative
to the minimum and maximum values of the data. If we want to change
that, we cab either add absolute values (or subtract by using negative
values), or we can make a change relative to the data. That makes the
change robust to changes in the underlying data.</p>
<p>The mult() function in this case add 0 expansion to the left side of
the scale, and 1% ~ 0.01 to the righthand side of the scale.</p>
</section><section><h2 class="section-heading" id="remove-clutter">Remove clutter<a class="anchor" aria-label="anchor" href="#remove-clutter"></a>
</h2>
<hr class="half-width">
<p>There ar horizontal lines in the plot background that are
unnessecary. And the grey background we get by default is not very nice.
Remove them:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-decluttering-1.png" style="display: block; margin: auto;" class="figure">
First we change the default theme of the plot from
<code>theme_grey</code> to <code>theme_minimal</code>, which gets rid of
the grey background. In the additional <code>theme()</code> function we
remove the gridlines, both major and minor gridlines, on the y-axis, by
setting them to the speciel plot element
<code>element_blank()</code></p>
</section><section><h2 class="section-heading" id="add-raw-numbers-to-the-plot">Add raw numbers to the plot<a class="anchor" aria-label="anchor" href="#add-raw-numbers-to-the-plot"></a>
</h2>
<hr class="half-width">
<p>Especially for barcharts, it can make sense to add the raw values to
the columns, rather than relying on reading the values from the
x-axis.</p>
<p>That <em>can</em> be done, but a more general, and easier to
understand, approach is to construct a dataframe with the data:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_count</span> <span class="op">&lt;-</span> <span class="fu">count</span><span class="op">(</span><span class="va">penguin_example</span>, <span class="va">species</span><span class="op">)</span></span>
<span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguin_count</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-count_penguins-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In general it is a good idea to remove all extraneous pixels in the
graph. And when we add the counts directly to the plot, we can get rid
of the x-axis entirely.</p>
<p>On the other hand, it can be a good idea in this specific example, to
add a vertical indication of where the x=0 intercept is:
<code>geom_vline(xintercept = 0)</code>.</p>
<p>And: Always remember to think about the contrast between the colour
of the bars and the text!</p>
</section><section><h2 class="section-heading" id="add-labels-to-the-plot">Add labels to the plot<a class="anchor" aria-label="anchor" href="#add-labels-to-the-plot"></a>
</h2>
<hr class="half-width">
<p>We can do the same with labels if we want:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"white"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-labelling-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="slimmer-bars">Slimmer bars<a class="anchor" aria-label="anchor" href="#slimmer-bars"></a>
</h2>
<hr class="half-width">
<p>Depending on aspect ratio of the final plot, number of categories
etc, we might want to adjust the width of the bars:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"darkorchid3"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.4</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-slimmer-bars-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Relatively small changes to a bar chart can make it look much more
professional</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-powerberegninger"><p>Content from <a href="powerberegninger.html">Power Calculations</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/powerberegninger.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How large of a sample do I need to identify a result?</li>
<li>How much confidence can I get using a specific sample size?</li>
<li>How much power can I get using a specific sample size?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>We have some data on the lung volume of children, and want to see if
there is a difference between the (mean) lung volume of the two sexes.
Ie if the mean for boys is 1.87 and for girls is 1.84, there obviously
is a difference. But is it significant?</p>
<p>We would do that by running at two-sample t-test. The null-hypothesis
is that there is no difference between the mean of the two samples, and
if the p-value is smaller than (typically) 0.05, we will reject the
null-hypothesis.</p>
<p>That is not the same as concluding that there <em>is</em> a
difference, just that the risk of of observing such a difference by
random chance, if there really were no difference, is low (less than
5%).</p>
<p>This can go wrong in two ways. There might actually be no difference,
but we reject the null-hypothesis anyway, and conclude that a difference
exist. That is a false positive; we see a difference where none is. We
also call it a type I error.</p>
<p>On the other hand, there might really be a diffence, but we fail to
reject the null hypothesis, that is we conclude that no difference
exist, even though there <em>is</em> a difference. That is a false
negative, or a type II error.</p>
<p>The risk of a type I error is <span class="math inline">\(\alpha\)</span> - which is what we specify
choosing a level of significance, typically 0.05.</p>
<p>The risk of a type II error is related to the concept of “power”, or
<span class="math inline">\(\beta\)</span>. Thas is the chance of seeing
a difference where such a difference actually exists. And the risk of
not seeing it is therefore <span class="math inline">\(1-\beta\)</span>.</p>
<p>These two concepts are combined in power-calculations.</p>
</section><section><h2 class="section-heading" id="how-many-children-do-we-need-to-test">How many children do we need to test?<a class="anchor" aria-label="anchor" href="#how-many-children-do-we-need-to-test"></a>
</h2>
<hr class="half-width">
<p>We begin by loading the data. You can download the data <a href="https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/FEV.csv" class="external-link">from
this link</a>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/FEV.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 654 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (6): Id, Age, FEV, Hgt, Sex, Smoke

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>The dataset have measurements of the lung capacity (FEV) for boys and
girls between the ages of 3 and 19. Since we know that there
<em>are</em> significant differences between the two sexes once they
reach puberty, we will be looking at the data for prepubescent
children.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p>The means and standard deviations can be calculated like this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span>,</span>
<span>          sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
    Sex  mean    sd
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0  2.00 0.508
2     1  2.07 0.514</code></pre>
</div>
<p>In this dataset the girls are coded as “0” and the boys as “1”. We
see a difference of 0.0757019.</p>
<p>Is there a difference? The null-hypothesis is that there is not. We
have two independent samples, so we are running a two-sample-t-test:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">girls</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">boys</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">boys</span><span class="op">$</span><span class="va">FEV</span>, <span class="va">girls</span><span class="op">$</span><span class="va">FEV</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  boys$FEV and girls$FEV
t = 1.3021, df = 306.88, p-value = 0.1939
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.03870191  0.19010577
sample estimates:
mean of x mean of y
 2.070799  1.995097 </code></pre>
</div>
<p>The p-value is larger than 0.05, so we do not reject the
null-hypothesis, and conclude that even though there might be a
difference, we cannot rule out the possibility that the difference we
see between the two means is happening by chance.</p>
<p>How many children should we measure, if we wanted to see a difference
of 0.0757019?</p>
<p>That is, how large a sample should we have, if we want to detect an
actual difference as small as this? This difference is often called the
effect-size.</p>
<p>The effect size is relative to the absolute size of the means. A
difference of 0.08 is easier to detect when it is between 1.99 and 2.07
than if it is between 5461.31 and 5461.39.</p>
<p>Therefore we measure the effect size in standard deviations rather
than in absolute values. We denote that as <code>d</code> or Cohen’s
d. Often we want to see a specific effect size: 0.2 is considered small,
0.5 as medium and 0.8 as large.</p>
<p>In this case we have an effect size, but needs to convert it to
standard deviations:</p>
<p><span class="math display">\[d = \frac{\mu_{boys} -
\mu_{girls}}{\sigma_{pooled}}\]</span></p>
<p>Where the pooled standard deviation is calculated with:</p>
<p><span class="math display">\[\sigma_{pooled} =
\sqrt{\frac{(n_{boys}-1)s_{boys}^2 +
(n_{girls}-1)s_{girls}^2}{n_{boys}+n_{girls} -2}}\]</span></p>
<p>Which is a weighted average of the two standard deviations.</p>
<p>We need the following values:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 4
    Sex     n  mean    sd
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0   155  2.00 0.508
2     1   154  2.07 0.514</code></pre>
</div>
<p>And now get the pooled standard deviation with:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_p</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fl">154</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5144072</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">155</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5075533</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">154</span><span class="op">+</span><span class="fl">155</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And can then calculate Cohen’s d, or, the effect size in standard
deviations:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2.070799</span><span class="op">-</span><span class="fl">1.995097</span><span class="op">)</span><span class="op">/</span><span class="va">s_p</span></span>
<span><span class="va">d</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1481504</code></pre>
</div>
<p>Now we almost have all our ducks in a row. There is only one number
we need to decide on - the power. In this example we decide that it
should be 0.9. To reiterate: If the difference exists, we want to have a
90% chance of detecting it.</p>
<p>Or, conversely, we are willing to accept a 10% chance of a type II
error, where we fail to detect the difference.</p>
<p>R has a built in function for doing the final calculation for a two
sample t test. But we are going to use the <code>pwr</code> library. The
results are the same, but the calculations are different for different
tests, and <code>pwr</code> provides functions for handling other
tests.</p>
<p>The function we are going to use is <code>pwr.t.test</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">pwr</span><span class="op">)</span></span>
<span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="va">d</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.9</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation

              n = 958.4203
              d = 0.1481504
      sig.level = 0.05
          power = 0.9
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>We specify the effect size (d), the significanse level (0.05), the
power we want (0.9), and the type of test we want to be able to do on
the data (“two.sample”).</p>
<p>And get the result that we need (at least) 959 observations in
<em>each</em> group, in order to see the wanted effect size, with at a
5% significanse level and with a power of 0.9.</p>
</section><section><h2 class="section-heading" id="how-large-effect-sizes-can-we-see">How large effect sizes can we see?<a class="anchor" aria-label="anchor" href="#how-large-effect-sizes-can-we-see"></a>
</h2>
<hr class="half-width">
<p>The function is smart. There are four numbers involved: The effect
size, the significanse level, the power and the number of observations.
They are all connected, and if we specify three of them, we will get the
fourth.</p>
<p>Given the number of observations we have, we can calculate the power
of the test:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">155</span>, d<span class="op">=</span><span class="va">d</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation

              n = 155
              d = 0.1481504
      sig.level = 0.05
          power = 0.2552478
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>There is ~75% chance of getting a type II error.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-kmeans"><p>Content from <a href="kmeans.html">k-means</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/kmeans.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is k-means?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to run a kmeans-clustering on data</li>
<li>Demonstrate the importance of scaling</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Imagine we have a set of data. We might have a lot of data on the
orders from different customers in our bookshop. We would like to target
our email-campaigns to them.</p>
<p>We do not want to go through all our customers manually. We want
something automated, that partitions all our customers into eg. 10
different groups (or clusters) that are similar. Our email-campaign
should focus on books about cars and WW2 when we target customers in the
cluster that tend to buy that kind of books. And on other topics to
other clusters.</p>
<p>This is a real example from a major, danish online bookseller.</p>
<p>This is also an example of an unsupervised clustering. We do not know
the true group any given customer belongs to, and we do not want to
predict which group she will end up in. We simply want to partition our
data/customers into 10 groups.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Why 10?
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>In the case of the online bookseller the number was chosen to get a
relatively small number of clusters, in order not to have to manage 20
or more different marketing mails. But large enough to have a decent
differentation between the groups.</p>
<p>The number is often chose arbitrarily, but methods for choosing an
“optimal” number exists.</p>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="kmeans-is-a-way-of-doing-this">kmeans is a way of doing this<a class="anchor" aria-label="anchor" href="#kmeans-is-a-way-of-doing-this"></a>
</h2>
<hr class="half-width">
<p>Many unsupervised clustering algorithms exist. kmeans is just one. We
provide the data, and specify the number of clusters we want to get. The
algorithm will automatically provide us with them. And it will assign
the datapoints to individual clusters, in a way where the datapoints
have some sort of similarity of their features.</p>
</section><section><h2 class="section-heading" id="wine-as-an-example">Wine as an example<a class="anchor" aria-label="anchor" href="#wine-as-an-example"></a>
</h2>
<hr class="half-width">
<p>We might normally use the kmeans algorithm to cluster data where we
do not know the “true” clusters the data points belongs to.</p>
<p>In order to demonstrate the method, it is useful to have a dataset
where we know the true clusters.</p>
<p>Here we have a dataset, where different variables, have been measured
on wine made from three different types of grapes (cultivars).</p>
<p>The terminology differs. We have a set of columns with variables. But
these variables are also often called parameters or features. Or
dimensions</p>
<p>The dataset can be <a href="https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/wine.data" class="external-link">downloaded
here</a></p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="va">vin</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/win/wine.data"</span>, col_names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">vin</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"cultivar"</span>,</span>
<span>                <span class="st">"Alcohol"</span>,</span>
<span>                <span class="st">"Malicacid"</span>,</span>
<span>                <span class="st">"Ash"</span>,</span>
<span>                <span class="st">"Alcalinityofash"</span>,</span>
<span>                <span class="st">"Magnesium"</span>,</span>
<span>                <span class="st">"Totalphenols"</span>,</span>
<span>                <span class="st">"Flavanoids"</span>,</span>
<span>                <span class="st">"Nonflavanoidphenols"</span>,</span>
<span>                <span class="st">"Proanthocyanins"</span>,</span>
<span>                <span class="st">"Colorintensity"</span>,</span>
<span>                <span class="st">"Hue"</span>,</span>
<span>                <span class="st">"OD280OD315ofdilutedwines"</span>,</span>
<span>                <span class="st">"Proline"</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="what-does-it-do">What does it do?<a class="anchor" aria-label="anchor" href="#what-does-it-do"></a>
</h2>
<hr class="half-width">
<p>Before actually running the algorithm, we should probably take a look
at what it does.</p>
<p>K-means works by chosing K - the number of clusters we want. That is
a choice entirely up to us. In this example we will chose 3. Primarily
because we know that there <em>are</em> three different cultivars.</p>
<p>The algorithm then choses K random points, also called centroids. In
this case these centroids are in 13 dimensions, because we have 13
features in the dataset.</p>
<p>That makes it a bit difficult to visualize.</p>
<p>It then calculates the distance from each observation in the data, to
each of the K centroids. After that, each observation is assigned to the
centroid it is closest to. Each data point will therefore be assigned to
a specific cluster, described by the relevant centroid.</p>
<p>The algorithm then calculates three new centroids. All the
observations assigned to centroid A are averaged, and we get a new
centroid. The same calculations are done for the other two centroids,
and we now have three new centroids. They now actually have a relation
to the data - before they were assigned randomly, now they are based on
the data.</p>
<p>Now the algorithm repeats the calculation of distance. For each
observation in the data, which of the new centroids is it closest to it.
Since we calculated new centroids, some of the observations will switch
and will be assigned to a new centroid.</p>
<p>Again the new assignments of observations are used to calculate new
centroids for the three clusters, and all these calculations are
repeated until no observations swithces between clusters, or we have
repeated the algorithm a set number of times (by default 10 times).</p>
<p>After that, we have clustered our data in three (or whatever K we
chose) clusters, based on the features of the data.</p>
</section><section><h2 class="section-heading" id="how-do-we-actually-do-that">How do we actually do that?<a class="anchor" aria-label="anchor" href="#how-do-we-actually-do-that"></a>
</h2>
<hr class="half-width">
<p>The algorithm only works with numerical data.</p>
<p>Let us begin by removing the variable containing the true
answers.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">vin</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">cultivar</span><span class="op">)</span></span></code></pre>
</div>
<p>There are only numerical values in this example, so we do not have to
remove other variables.</p>
<p>After that, we can run the function <code>kmeans</code>, and specify
that we want three centers (K), and save the result to an object, that
we can work with afterwards:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">clustering</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>K-means clustering with 3 clusters of sizes 28, 50, 100

Cluster means:
   Alcohol Malicacid    Ash Alcalinityofash Magnesium Totalphenols Flavanoids
1 13.82214  1.773929 2.4900        16.96429  105.3571     2.923929   3.111429
2 13.33680  2.396800 2.3718        18.51000  108.6000     2.432400   2.214800
3 12.60250  2.463600 2.3293        20.69600   93.7400     2.050400   1.633500
  Nonflavanoidphenols Proanthocyanins Colorintensity      Hue
1           0.2985714        1.986786       6.202857 1.103571
2           0.3236000        1.707200       5.143600 0.966720
3           0.3987000        1.421900       4.694800 0.911900
  OD280OD315ofdilutedwines Proline
1                 2.984643 1301.50
2                 2.862800  894.60
3                 2.381700  517.75

Clustering vector:
  [1] 2 2 1 1 2 1 1 1 2 2 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 1 1 2 2 1 1 2 1 2 2 2
 [38] 1 2 2 2 2 2 3 2 2 2 2 2 1 1 1 1 1 2 1 2 1 1 3 3 3 3 3 3 3 3 3 2 2 2 3 3 2
 [75] 2 3 3 3 2 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 2 3 3 2 2 3 3
[149] 3 3 3 3 3 3 3 2 3 2 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 2 2 2 2 3

Within cluster sum of squares by cluster:
[1]  550201.0  815783.7 1263330.5
 (between_SS / total_SS =  85.1 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<p>This is a bit overwhelming. The centroids in the three clusters are
defined by their mean values of all the dimensions/variables in them. We
can see that there appears to be a difference between the alcohol
content between all of the three clusters. Whereas the difference
between cluster 1 and 3 for malicacid is very close.</p>
<p>We also get at clustering vector, that gives the number of the
cluster each datapoint is assigned to. And we get some values for the
variation between the clusters.</p>
<div class="section level3">
<h3 id="how-well-did-it-do">How well did it do?<a class="anchor" aria-label="anchor" href="#how-well-did-it-do"></a>
</h3>
<p>We know the true values, so we extract the clusters the algorithm
found, and match them with the true values:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testing_clusters</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>quess <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">cluster</span>, </span>
<span>                           true <span class="op">=</span> <span class="va">vin</span><span class="op">$</span><span class="va">cultivar</span><span class="op">)</span></span></code></pre>
</div>
<p>And count the matches:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">testing_clusters</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     true
quess  1  2  3
    1 28  0  0
    2 30  9 11
    3  1 62 37</code></pre>
</div>
<p>The algorithm have no idea about how the true groups are numbered, so
the numbering does not match. But it appears that i does a relatively
good job on two of the types of grapes. and is a bit confused about the
third.</p>
<p>Does that mean the algorithm does a bad job?</p>
</div>
</section><section><h2 class="section-heading" id="preprocessing-is-necessary">Preprocessing is necessary!<a class="anchor" aria-label="anchor" href="#preprocessing-is-necessary"></a>
</h2>
<hr class="half-width">
<p>Looking at the data give a hint about the problems:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">vin</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 14
  cultivar Alcohol Malicacid   Ash Alcalinityofash Magnesium Totalphenols
     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1        1    14.2      1.71  2.43            15.6       127         2.8
2        1    13.2      1.78  2.14            11.2       100         2.65
3        1    13.2      2.36  2.67            18.6       101         2.8
4        1    14.4      1.95  2.5             16.8       113         3.85
5        1    13.2      2.59  2.87            21         118         2.8
6        1    14.2      1.76  2.45            15.2       112         3.27
# ℹ 7 more variables: Flavanoids &lt;dbl&gt;, Nonflavanoidphenols &lt;dbl&gt;,
#   Proanthocyanins &lt;dbl&gt;, Colorintensity &lt;dbl&gt;, Hue &lt;dbl&gt;,
#   OD280OD315ofdilutedwines &lt;dbl&gt;, Proline &lt;dbl&gt;</code></pre>
</div>
<p>Note the differences between the values of “Malicacid” and
“Magnesium”. One have values between 0.74 and 5.8 and the other bewtten
70 and 162. The latter influences the means much more that the
former.</p>
<p>It is therefore good practice to scale the features to have the same
range and standard deviation. A function <code>scale()</code> that does
exactly that exists in R:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scaled_data</span> <span class="op">&lt;-</span> <span class="fu">scale</span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span></code></pre>
</div>
<p>If we now do the same clustering as before, but now on the scaled
data, we get much better results:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">scaled_data</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="op">(</span>quess <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">cluster</span>, true <span class="op">=</span> <span class="va">vin</span><span class="op">$</span><span class="va">cultivar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">table</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     true
quess  1  2  3
    1 59  3  0
    2  0 65  0
    3  0  3 48</code></pre>
</div>
<p>By chance, the numbering of the clusters now matches the “true”
cluster numbers.</p>
<p>The clustering is not perfect. 3 observations belonging to cluster 2,
are assigned to cluster 1 by the algorithm (and 3 more to cluster
3).</p>
<p>In this caase we know the true values. Had we not, we would still
have gotten the same groups, and could have correctly grouped the
different data points.</p>
</section><section><h2 class="section-heading" id="what-are-those-distances">What are those distances?<a class="anchor" aria-label="anchor" href="#what-are-those-distances"></a>
</h2>
<hr class="half-width">
<p>It is easy to measure the distance between two observations when we
only have two features/dimensions: Plot them on a piece of paper, and
bring out the ruler.</p>
<p>But what is the distance between this point:</p>
<p>1, 14.23, 1.71, 2.43, 15.6, 127, 2.8, 3.06, 0.28, 2.29, 5.64, 1.04,
3.92, 1065</p>
<p>and this one:</p>
<p>1, 13.2, 1.78, 2.14, 11.2, 100, 2.65, 2.76, 0.26, 1.28, 4.38, 1.05,
3.4, 1050?</p>
<p>Rather than plotting and measuring, if we only have two observations
with two features, and we call the the observations <span class="math inline">\((x_1, y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span> we can get the distance using
this formula:</p>
<p><span class="math display">\[d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}
\]</span></p>
<p>For an arbitrary number of dimensions we get this: <span class="math display">\[d = \sqrt{\sum_{i=1}^{n} \left(x_2^{(i)} -
x_1^{(i)}\right)^2}\]</span></p>
<p>Where the weird symbol under the squareroot sign indicates that we
add all the squared differences between the pairs of observations.</p>
</section><section><h2 class="section-heading" id="is-the-clustering-reproducible">Is the clustering reproducible?<a class="anchor" aria-label="anchor" href="#is-the-clustering-reproducible"></a>
</h2>
<hr class="half-width">
<p>Not nessecarily. If there <em>are</em> very clear clusters, in
general it will be.</p>
<p>But the algorithm is able to find clusters even if there are
none:</p>
<p>Here we have 1000 observations of two features:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>They are as random as the random number generator can do it.</p>
<p>Let us make one clustering, and then another:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">47</span><span class="op">)</span></span>
<span><span class="va">kmeans_model1</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">test_data</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">kmeans_model2</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">test_data</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<p>And then extract the clustering and match them like before:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>take_one <span class="op">=</span> <span class="va">kmeans_model1</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>        take_two <span class="op">=</span> <span class="va">kmeans_model2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">table</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        take_two
take_one   1   2   3   4   5
       1   2 132   0  23   0
       2   2   0 217   0   2
       3   0   0  11   1 124
       4 127  73   9   0   0
       5   0  68   1 121  87</code></pre>
</div>
<p>Two clusterings on the exact same data. And they are pretty
different.</p>
<p>Do not be confused by the fact that take_one-group-4 matches rather
well with take_two-group-1. The numbering is arbitrary.</p>
<p>Visualizing it makes it even more apparent:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>take_one <span class="op">=</span> <span class="va">kmeans_model1</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>        take_two <span class="op">=</span> <span class="va">kmeans_model2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cbind</span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,colour<span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">take_one</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/kmeans-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>take_one <span class="op">=</span> <span class="va">kmeans_model1</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>        take_two <span class="op">=</span> <span class="va">kmeans_model2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cbind</span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,colour<span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">take_two</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/kmeans-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In other words - the algorithm will find clusters. And the clustering
depends, to a certain degree on the random choice of initial
centroids.</p>
</section><section><h2 class="section-heading" id="can-it-be-use-on-any-data">Can it be use on any data?<a class="anchor" aria-label="anchor" href="#can-it-be-use-on-any-data"></a>
</h2>
<hr class="half-width">
<p>No. Even though there might actually be clusters in the data, the
algorithm is not necessarily able to find them. Consider this data:
<img src="fig/kmeans-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure">
There is obviously a cluster centered around (0,0). And another cluster
more or lesss evenly spread around it.</p>
<p>The algorithm <em>will</em> find two clusters:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidymodels</span><span class="op">)</span></span>
<span><span class="va">kmeans_model3</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">test_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cluster3</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">kmeans_model3</span>, <span class="va">test_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cluster3</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,colour<span class="op">=</span><span class="va">.cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/kmeans-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure">
But not the ones we want.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>kmeans is an unsupervised technique, that will find the hidden
structure in our data that we do not know about</li>
<li>kmeans will find the number of clusters we ask for. Even if there is
no structure in the data at all</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-anova"><p>Content from <a href="anova.html">ANOVA</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/anova.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you perform an ANOVA?</li>
<li>What even is ANOVA?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to run an analysis of variance on models</li>
<li>Explain the requisites for runnin an ANOVA</li>
<li>Explain what an ANOVA is</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Studying the length of penguin flippers, we notice that there is a
difference between the average length between three different species of
penguins:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_flipper_length <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  species   mean_flipper_length
  &lt;fct&gt;                   &lt;dbl&gt;
1 Adelie                   190.
2 Chinstrap                196.
3 Gentoo                   217.</code></pre>
</div>
<p>If we only had two groups, we would use a t-test to determine if
there is a significant difference between the two groups. But here we
have three. And when we have three, or more, we use the ANOVA-method, or
rather the <code>aov()</code> function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">aov</span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summary</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
species       2  52473   26237   594.8 &lt;2e-16 ***
Residuals   339  14953      44
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
2 observations deleted due to missingness</code></pre>
</div>
<p>We are testing if there is a difference in flipper_length_mm when we
explain it as a function of species. Or, in other words, we analyse how
much of the variation in flipper length is caused by variation between
the groups, and how much is caused by variation within the groups. If
the difference between those two parts of the variation is large enough,
we conclude that there is a significant difference between the
groups.</p>
<p>In this case, the p-value is very small, and we reject the
NULL-hypothesis that there is no difference in the variance between the
groups, and conversely that we accept the alternative hypothesis that
there is a difference.</p>
</section><section><h2 class="section-heading" id="are-we-allowed-to-run-an-anova">Are we allowed to run an ANOVA?<a class="anchor" aria-label="anchor" href="#are-we-allowed-to-run-an-anova"></a>
</h2>
<hr class="half-width">
<p>There are some conditions that needs to be fullfilled.</p>
<ol style="list-style-type: decimal">
<li>The observations must be independent.</li>
</ol>
<p>In this example that we can safely assume that the length of the
flipper of a penguin is not influenced by the length of another
penguin.</p>
<ol start="2" style="list-style-type: decimal">
<li>The residuals have to be normally distributed</li>
</ol>
<p>Typically we also test if the data is normally distributed. Let us
look at both:</p>
<p>Is the data normally distributed?</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/anova-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure">
That looks reasonable.</p>
<p>And the residuals?</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">aov</span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span><span class="op">$</span><span class="va">residuals</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">hist</span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/anova-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>That looks fine - if we want a more specific test, those exists, but
will not be covered here.</p>
<ol start="3" style="list-style-type: decimal">
<li>Homoskedacity</li>
</ol>
<p>A weird name, it simply means that the variance in the different
groups are more or less the same. We can calculate the variance and
compare:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>variance <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  species   variance
  &lt;fct&gt;        &lt;dbl&gt;
1 Adelie        42.8
2 Chinstrap     50.9
3 Gentoo        42.1</code></pre>
</div>
<p>Are the variances too different? As a rule of thumb, we have a
problem if the largest variance is more than 4-5 times larger than the
smallest variance. This is OK for this example.</p>
<p>If there is too large difference in the size of the three groups,
smaller differences in variance can be problematic.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> More specific methods exist. </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>There are probably more than than three tests for homoskedacity, here
are three:</p>
<p>Fligner-Killeen test:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fligner.test</span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Fligner-Killeen test of homogeneity of variances

data:  flipper_length_mm by species
Fligner-Killeen:med chi-squared = 0.69172, df = 2, p-value = 0.7076</code></pre>
</div>
<p>Bartlett’s test:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bartlett.test</span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Bartlett test of homogeneity of variances

data:  flipper_length_mm by species
Bartlett's K-squared = 0.91722, df = 2, p-value = 0.6322</code></pre>
</div>
<p>Levene test:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">car</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: carData</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'car'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">leveneTest</span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(&gt;F)
group   2  0.3306 0.7188
      339               </code></pre>
</div>
<p>For all three tests - if the p-value is &gt;0.05, there is a
significant difference in the variance - and we are not allowed to use
the ANOVA-method. In this case we are on the safe side.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="but-where-is-the-difference">But where is the difference?<a class="anchor" aria-label="anchor" href="#but-where-is-the-difference"></a>
</h3>
<p>Yes, there is a difference between the average flipper length of the
three species. But that might arise from one of the species having
extremely long flippers, and there not being much difference between the
two other species.</p>
<p>So we do a posthoc analysis to confirm where the differences are.</p>
<p>The most common is the tukeyHSD test, HSD standing for “Honest
Significant Differences”. We do that by saving the result of our
ANOVa-analysis and run the <code>TukeyHSD()</code> function on the
result:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov_model</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TukeyHSD</span><span class="op">(</span><span class="va">aov_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = flipper_length_mm ~ species, data = penguins)

$species
                      diff       lwr       upr p adj
Chinstrap-Adelie  5.869887  3.586583  8.153191     0
Gentoo-Adelie    27.233349 25.334376 29.132323     0
Gentoo-Chinstrap 21.363462 19.000841 23.726084     0</code></pre>
</div>
<p>We get the estimate of the pair-wise differences and lower and upper
95% confidence intervals for those differences.</p>
<div id="try-it-on-your-own" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-on-your-own" class="callout-inner">
<h3 class="callout-title">Try it on your own</h3>
<div class="callout-content">
<p>The <code>iris</code> dataset, build into R, contains measurements of
three different species of the iris-family of flowers.</p>
<p>Is there a significant difference between the
<code>Sepal.Width</code> of the three species?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">aov</span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
Species       2  11.35   5.672   49.16 &lt;2e-16 ***
Residuals   147  16.96   0.115
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="try-it-on-your-own" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-on-your-own" class="callout-inner">
<h3 class="callout-title">Try it on your own<em> (continued)</em>
</h3>
<div class="callout-content">
<p>The result only reveal that there is a difference. Or rather that we
can reject the hypothesis that there is no difference.</p>
<p>Which species differ?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">aov</span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">TukeyHSD</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Sepal.Width ~ Species, data = iris)

$Species
                       diff         lwr        upr     p adj
versicolor-setosa    -0.658 -0.81885528 -0.4971447 0.0000000
virginica-setosa     -0.454 -0.61485528 -0.2931447 0.0000000
virginica-versicolor  0.204  0.04314472  0.3648553 0.0087802</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-cohens-kappa"><p>Content from <a href="cohens-kappa.html">Cohens Kappa</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/cohens-kappa.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can agrement on classification be quantised?</li>
<li>How is Cohens <span class="math inline">\(\kappa\)</span>
calculated?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn to calculate Cohens <span class="math inline">\(\kappa\)</span>
</li>
<li>Become familiar with the usecases for Cohens <span class="math inline">\(\kappa\)</span>
</li>
<li>Know the limitations of Cohens <span class="math inline">\(\kappa\)</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-do-we-use-it-for">What do we use it for?<a class="anchor" aria-label="anchor" href="#what-do-we-use-it-for"></a>
</h2>
<hr class="half-width">
<p>We use Cohens Kappa (or <span class="math inline">\(\kappa\)</span>),
to compare if two sets of categorisations is done reliably.</p>
<p>Imagine a set of images. We ask two persons to answer a simple
question - is there a cat on the images. To what degree do the two
persons agree on the presence or absence of cats?</p>
<p>That seems simple enough. However if they agree that there is a cat,
this might indicate that they are both good at identifying cats, and of
course agrees. But they might just as well be very bad at recognizing
cats - but agree by random chance.</p>
</section><section><h2 class="section-heading" id="where-is-it-used">Where is it used?<a class="anchor" aria-label="anchor" href="#where-is-it-used"></a>
</h2>
<hr class="half-width">
<p><em>Inter-Rater Reliability</em>. That is the example from earlier.
To what degree do two “raters” agree on their rating or classification
of something? This is useful in subjects and research where subjective
assessments are important, such as psychology, medicine and
languages.</p>
<p><em>Intra-Rater Reliability</em>. Here we test how consistent a
single rater is. Are my ratings from a week ago, consistent with the
ratings I make today?</p>
<p><em>Comparison of diagnostic tests</em>. It can be used to compare
the results of two different diagnostic tests for some medical
condition. Does the cheaper, less invasive test, give the same results
as the more expensive invasive test?</p>
<p><em>Natural language processing</em> (NLP). When we categorise
textual data, eg, evaluating the sentiment of a text, or identify named
entities - how well does two methods or persons agree?</p>
<p><em>Educational research</em>. Will two teachers give the same grade
to the same papers turned in by students.</p>
<p>In humanities we are concerned with intersubjectively transferability
- based on available data, are the subjective evaluation of two
different persons in agreement.</p>
</section><section><h2 class="section-heading" id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<hr class="half-width">
<p>Cohens <span class="math inline">\(\kappa\)</span> can be used
directly for two nominal (no order of the classes) categorical
variables. The main limitation is that Cohens <span class="math inline">\(\kappa\)</span> only applies for exactly two
raters.</p>
</section><section><h2 class="section-heading" id="how-do-we-calculate-it">How do we calculate it?<a class="anchor" aria-label="anchor" href="#how-do-we-calculate-it"></a>
</h2>
<hr class="half-width">
<p>The library <code>vcd</code> contains a function <code>Kappa()</code>
that does the heavy lifting.</p>
<p>It needs a so called confusion matrix. Let us begin by constructing
one.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Constructing the data
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Ja, dette bør ligge i et datasæt der kan indlæses.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diagnoses</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span><span class="op">~</span><span class="va">rater1</span>, <span class="op">~</span><span class="va">rater2</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dep"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"sch"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"sch"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"neu"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"neu"</span>,</span>
<span>  <span class="st">"dep"</span>, <span class="st">"neu"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"dis"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"sch"</span>,</span>
<span>  <span class="st">"dis"</span>, <span class="st">"sch"</span>,</span>
<span>  <span class="st">"sch"</span>, <span class="st">"sch"</span>,</span>
<span>  <span class="st">"sch"</span>, <span class="st">"sch"</span>,</span>
<span>  <span class="st">"neu"</span>, <span class="st">"neu"</span>,</span>
<span>  <span class="st">"oth"</span>, <span class="st">"oth"</span>,</span>
<span>  <span class="st">"oth"</span>, <span class="st">"oth"</span>,</span>
<span>  <span class="st">"oth"</span>, <span class="st">"oth"</span>,</span>
<span>  <span class="st">"oth"</span>, <span class="st">"oth"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The object <code>diagnoses</code> now contains 30 observations.
Imagine two psychiatrists both evaluating 30 patients. They diagnose one
of these disorders: Depression (dep), Schizophrenia (sch), Dissociative
disorder (dis), Neurosis (neu) and Other (oth). To what degree do they
agree?</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">diagnoses</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 2
  rater1 rater2
  &lt;chr&gt;  &lt;chr&gt;
1 dep    dep
2 dep    dep
3 dep    dep
4 dep    dep
5 dep    dep
6 dep    dep   </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conf_table</span> <span class="op">&lt;-</span> <span class="fu">table</span><span class="op">(</span><span class="va">diagnoses</span><span class="op">)</span></span>
<span><span class="va">conf_table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      rater2
rater1 dep dis neu oth sch
   dep   7   1   3   0   2
   dis   0   8   0   0   2
   neu   0   0   1   0   0
   oth   0   0   0   4   0
   sch   0   0   0   0   2</code></pre>
</div>
<p>This is the confusion matrix. 7 patients are diagnosed with
depression by both raters (psychiatrists). But looking at Schizophrenia,
we see that two patients are diagnosed with Schizophrenia by rater2, but
with Depression by rater1.</p>
<p>This is the table we need to provide to the <code>Kappa()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: grid</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.k</span> <span class="op">&lt;-</span> <span class="fu">Kappa</span><span class="op">(</span><span class="va">conf_table</span><span class="op">)</span></span>
<span><span class="va">res.k</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            value    ASE     z  Pr(&gt;|z|)
Unweighted 0.6507 0.0999 6.513 7.372e-11
Weighted   0.5588 0.1282 4.359 1.304e-05</code></pre>
</div>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Unweighted vs Weighted?
  </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<p>For some use cases it does not really matter what kind of
disagreement the two raters have. They of course should agree, but the
disagreement of classifying a Golden Retriver as a Labrador Retriver, is
not as serious as mistaking it for a Chihuahua.</p>
<p>The Unweighted <span class="math inline">\(\kappa\)</span> is
calculated with the assumption that the different disagreements are of
equal seriousness.</p>
<p>The Weighted <span class="math inline">\(\kappa\)</span> assumes that
some disagreements are worse than others.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="how-confident-are-we-in-kappa">How confident are we in <span class="math inline">\(\kappa\)</span>?<a class="anchor" aria-label="anchor" href="#how-confident-are-we-in-kappa"></a>
</h2>
<hr class="half-width">
<p>The function <code>confint()</code> will give us the 95% confidence
interval of the <span class="math inline">\(\kappa\)</span>
calculated:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">confint</span><span class="op">(</span><span class="va">res.k</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Kappa              lwr       upr
  Unweighted 0.4548491 0.8464610
  Weighted   0.3075771 0.8100699</code></pre>
</div>
</section><section><h2 class="section-heading" id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h2>
<hr class="half-width">
<p>Cohens <span class="math inline">\(\kappa\)</span> takes into account
the possibility that the two raters agree by chance. This makes it a
more robust measure of agreement than simply looking at the precent
agreement. It returns a value between -1 and 1, 1 indicating perfect
agreement, 0 no agreement besides random chance, and negative values
less agreement than we would expect by chance.</p>
<p>So. Is an unweighted <span class="math inline">\(\kappa\)</span> of
0.6507 good or bad?</p>
<p>That depends on what we are actually classifying. Classifying
psychiatric disorders is obviously more important than classifying dog
breeds.</p>
<p><a href="https://onlinelibrary.wiley.com/doi/book/10.1002/0471445428" class="external-link">Fleiss
et al (2003)</a>, argues that the rules-of-thumb in this table are good
indications:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Value of K</th>
<th align="left">Level of agreement</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">&gt;0.75</td>
<td align="left">Excellent agreement beyond chance</td>
</tr>
<tr class="even">
<td align="left">0.4&gt; value &lt; 0.75</td>
<td align="left">Fair to good agreement beyond chance</td>
</tr>
<tr class="odd">
<td align="left">&lt;0.4</td>
<td align="left">Poor agreement beyond chance</td>
</tr>
</tbody>
</table>
<p>Whereas <a href="https://doi.org/10.11613/BM.2012.031" class="external-link">McHugh
(2012)</a> presents this table:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Value of K</th>
<th align="left">Level of agreement</th>
<th align="right">% of data that are reliable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0 - 0.20</td>
<td align="left">None</td>
<td align="right">0 - 4%</td>
</tr>
<tr class="even">
<td align="left">0.21 - 0.39</td>
<td align="left">Minimal</td>
<td align="right">4 - 15%</td>
</tr>
<tr class="odd">
<td align="left">0.40 - 0.59</td>
<td align="left">Weak</td>
<td align="right">15 - 35%</td>
</tr>
<tr class="even">
<td align="left">0.60 - 0.79</td>
<td align="left">Moderate</td>
<td align="right">35 - 63%</td>
</tr>
<tr class="odd">
<td align="left">0.80 - 0.90</td>
<td align="left">Strong</td>
<td align="right">64 - 81%</td>
</tr>
<tr class="even">
<td align="left">Above 0.90</td>
<td align="left">Almost Perfect</td>
<td align="right">82 - 100%</td>
</tr>
</tbody>
</table>
<p>The estimates of the % of data that are reliable depends on the
distribution of the classifications, and the values in this table should
be taken with a grain of salt.</p>
</section><section><h2 class="section-heading" id="assumptions">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions"></a>
</h2>
<hr class="half-width">
<p>Cohens <span class="math inline">\(\kappa\)</span> have the following
requirements:</p>
<ul>
<li><p>Two raters (or coders). No more, no less.</p></li>
<li><p>Nominal scale – there are no order to the
classifications.</p></li>
<li><p>Same set of items – both raters rate the exact same
cases.</p></li>
<li><p>Independence of ratings – the two ratings must not influence each
other.</p></li>
<li><p>Mutually exclusive categories – an arbitrary case can only get
<em>one</em> classification.</p></li>
</ul></section><section><h2 class="section-heading" id="the-math">The math<a class="anchor" aria-label="anchor" href="#the-math"></a>
</h2>
<hr class="half-width">
<p>We define <span class="math inline">\(\kappa\)</span> as:</p>
<p><span class="math display">\[\kappa =  \frac{P_0 -
P_e}{1-P_e}\]</span> Where <span class="math inline">\(P_0\)</span> is
the degree of agreement we observe, and <span class="math inline">\(P_e\)</span> is the degree of agreement that is
random.</p>
<p>The null hypothesis declares that any agreement is random, and <span class="math inline">\(\kappa\)</span> is 0. If <span class="math inline">\(\kappa\)</span> is different from 0, the agreement
is not random.</p>
<p>If we are looking at two raters, in this example doctors, determining
if a patient is sick, a simple yes/no question in this case we will get
these results:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##        Doctor2</span></span>
<span><span class="co">## Doctor1 Yes No Total</span></span>
<span><span class="co">##   Yes   a   b  R1   </span></span>
<span><span class="co">##   No    c   d  R2   </span></span>
<span><span class="co">##   Total C1  C2 N</span></span></code></pre>
</div>
<p><span class="math inline">\(P_0\)</span>, the observed percentage of
agreement is now easy to calculate. It is the sum of “a” and “d”,
divided by the number of patients:</p>
<p><span class="math display">\[P_0 = \frac{a + d}{N}\]</span></p>
<p>The random agreement <span class="math inline">\(P_e\)</span> takes a
bit more math:</p>
<ul>
<li>Doctor 1 answers “yes” in <span class="math inline">\(\frac{R_1}{N}\)</span> cases.</li>
<li>Doctor 2 answers “yes” in <span class="math inline">\(\frac{C_1}{N}\)</span> cases.</li>
</ul>
<p>Based on this, the probability that they both, randomly and by
chance, answers “yes” is:</p>
<p><span class="math display">\[\frac{R1}{N}  \frac{C1}{N}\]</span></p>
<p>And for the random agreement of “no”:</p>
<p><em>Doctor1 answers “no” in <span class="math inline">\(\frac{R2}{N}\)</span> cases </em> Doctor2 answers
“no” in <span class="math inline">\(\frac{C2}{N}\)</span> cases</p>
<p>And the probability that they both, again randomly and by chance,
answers “no” is:</p>
<p><span class="math display">\[\frac{R2}{N} \frac{C2}{N}\]</span></p>
<p>We then calculate the total probability that the two raters agree by
chance by adding the two ways they can do that:</p>
<p><span class="math display">\[P_e = \frac{R1}{N}  \frac{C1}{N}+
\frac{R2}{N} \frac{C2}{N}\]</span></p>
<p>Now that we have both <span class="math inline">\(P_0\)</span> and
<span class="math inline">\(P_e\)</span>, we can calculate <span class="math inline">\(\kappa\)</span>, and confidence intervals: <span class="math inline">\(\kappa \pm Z_{\alpha/2} SE_\kappa\)</span> based
on the Z-distribution (if normality is assured, otherwise the
t-distribution).</p>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  This looks like something I have seen before?
  </h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<p>If you have ever looked at how the math in a <span class="math inline">\(\chi^2\)</span> test works, this might look
familiar. Thats because it actually is.</p>
<p>With two raters and two categories, that <span class="math inline">\(\kappa\)</span> statistic is the same. And if you
want to delve deeper into that, you can look up this paper:</p>
<p>Feingold, Marcia (1992). “The Equivalence of Cohen’s Kappa and
Pearson’s Chi-Square Statistics in the 2 × 2 Table.” Educational and
Psychological Measurement 52(1): 57-61. <a href="https://hdl.handle.net/2027.42/67443" class="external-link uri">https://hdl.handle.net/2027.42/67443</a></p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="alternatives">Alternatives<a class="anchor" aria-label="anchor" href="#alternatives"></a>
</h2>
<hr class="half-width">
<p>Cohens <span class="math inline">\(\kappa\)</span> only works
(directly) for nominal values, and two raters. The option of weighting
the data give us some options for using it on ordinal values, but more
direct options exist.</p>
<ul>
<li>Weighted <span class="math inline">\(\kappa\)</span> is used for
ordinal values. We use the function <code>kappa2()</code> from the
<code>irr</code> package.</li>
<li>Light’s <span class="math inline">\(\kappa\)</span> is used for
studying interrater agreement between more than 2 raters. We use the
function <code>kappamlight()</code> from the <code>irr</code>
package.</li>
<li>Fleiss <span class="math inline">\(\kappa\)</span> is also used when
having more than 2 raters. <em>But</em> does <em>not</em> require the
same raters for each subject.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>With two raters Cohens <span class="math inline">\(\kappa\)</span>
can be used as a measure of interrater agreement on categorical, nominal
classes.</li>
<li>Other methods exists for ordinal classes, and more than two
raters.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-ucloud"><p>Content from <a href="ucloud.html">R on Ucloud</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/ucloud.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Ucloud?</li>
<li>How do we use R and RStudio on Ucloud?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to acces RStudio and R on Ucloud</li>
<li>Demonstrate how to setup drives and additional software working with
Ucloud</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>You need to run R on a computer that have more muscles than you
own.</p>
<p>If you are a student at UCPH, you are in luck, because you have
access to a High Performance Computing (HPC) facility; ucloud. It can be
acessed at cloud.sdu.dk using the normal UCPH login and password.</p>
<p>Depending on the user allowances, it will look something like
this.</p>
<figure><img src="fig/ucloud_front.png" class="figure mx-auto d-block"></figure><p>Ucloud provides access to a multitude of different applications
organized in the application store:</p>
<figure><img src="fig/ucloud_store.png" class="figure mx-auto d-block"></figure><p>Amongst the more popular picks from the store is RStudio:</p>
<figure><img src="fig/ucloud_picks.png" class="figure mx-auto d-block"></figure><p>This allow us to start a session of RStudio, accessible in the
browser.</p>
<figure><img src="fig/ucloud_rstudio.png" class="figure mx-auto d-block"></figure><p>Note that we can chose different machine types. Parallel processing
is not the solution to every problem, but sometimes it is, and here we
get access to a <em>lot</em> of cores.</p>
<p>You select a suitable type of machine, chose how long you want it to
run, click submit, and after a short wait, you can click “Interface”,
and you will have, in your browser, something that looks almost exactly
like RStudio.</p>
<section><h2 class="section-heading" id="this-is-not-a-computer-as-such">This is not a computer as such<a class="anchor" aria-label="anchor" href="#this-is-not-a-computer-as-such"></a>
</h2>
<hr class="half-width">
<p>What we can start is not a computer. It is a virtual machine. A
virtual machine is not a real computer, it is a simulation of a
computer, that runs on a larger computer. Rather than installing an
operating system and software on a real computer, we ask the larger
computer to start a simulation of a computer. Since we interact with it
through the web, we might not discover the difference. But there are
some, which are important to know about.</p>
<div class="section level3">
<h3 id="compute">Compute<a class="anchor" aria-label="anchor" href="#compute"></a>
</h3>
<p>Running a virtual computer on a HPC-facility gives us access to a lot
of resources, primarily “CPU”s and “RAM”.</p>
<p>Your own computer have a CPU. It is the physical unit that actually
runs your code. When we ask R to calculate <code>1+1</code>, it is the
CPU that does the calculation.</p>
<p>Most modern CPU have multiple “cores”. So in reality it is not the
CPU that actually performs the calculation, it is one of the cores in
the CPU.</p>
<p>The computer used for writing this text have 20 cores.</p>
<p>This is nice, for the core can - in principle - only do one
calculation at a time. When we calculate <code>1+1</code>, that is the
only thing the core can do at that precise moment.</p>
<p>The thruth is a lot more complicated, but the analogy is useful in
order to understand why it can be nice to have more than one.</p>
<p>Having access to more than one core allow us to run some of our
calculations in parallel. If you are asked to do 10 simple
multiplications, you are finished when you have done 10 multiplications.
Ask a friend to help, and do 5 yourself, and let your friend do 5 - you
will be done in half the time.</p>
<p>Some calculations we want to do in R can be parallelized, where we
ask one core to distribute the tasks to 10 different cores. The
calculation will then be done much faster, than if only one core worked
on the problem.</p>
<p>Chosing a machine on Ucloud with a lot of cores will not necesarily
speed up your work. The code you run will have to be written to make use
of all the cores. And sometimes it takes longer to do that, than just
leaving all the work to a single core.</p>
<p>How do we find out how many cores we have? It should be simple. The
library <code>parallel</code> have a function <code>detectCores()</code>
that returns the number of cores we have access to:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Reading the documentation reveals that it is not that simple:</p>
<p>“Where virtual machines are in use, one would hope that the result
for logical = TRUE represents the number of CPUs available (or
potentially available) to that particular VM.”</p>
<p>Or use this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu">availableCores</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="memory">Memory<a class="anchor" aria-label="anchor" href="#memory"></a>
</h3>
<p>Looking at the interface, we see that we also get access to more
memory, or RAM.</p>
<p>RAM is the short term memory of the computer. If we want to
manipulate 10 Gb data, we need to be able to have 10 Gb of data in the
memory of the computer. And we probably need to have access to much more
than 10 Gb, because R likes to use a lot of memory, and tends to make a
copy of the data it manipulates.</p>
<p>We might therefore have to chose a certain size of virtual machine,
not because we actually need 64 cores, but because we need the
memory.</p>
</div>
<div class="section level3">
<h3 id="it-will-go-away">It will go away!<a class="anchor" aria-label="anchor" href="#it-will-go-away"></a>
</h3>
<p>Because we are running a virtual computer, rather than a real
computer, most of what we do will disappear when we restart the
computer. In R we typically installs a number of libraries or packages.
Those will vanish into thin air when the virtual machine is closed down.
In a section below we will cover access to drives on Ucloud which to a
certain degree can help us. But if we do not take precautions, we will
have to install R-packages every time we start up a new virtual machine
on Ucloud</p>
</div>
<div class="section level3">
<h3 id="cost">Cost<a class="anchor" aria-label="anchor" href="#cost"></a>
</h3>
<p>We might be tempted to let the virtual machine run forever, instead
of only for 1 hour. But Ucloud is a limited resource, and we only have a
specific allowance in total. Running a machine with one virutal CPU for
one hour consumes 1 “core-hour” of our allowance. Running a machine with
64 virtual CPUs for one hour consumes 64 core-hours. And when we run out
of allowance - the machine will close down.</p>
<p>It will also close down when the time we chose ran out.</p>
<p>Therefore, do not request more cores than you actually need.</p>
<p>On the other hand, do not request less than you need. If you chose 1
CPU, with 6 Gb RAM, and discover that you actually needed 12 Gb RAM -
you will have to shut down the virtual machine, and start a larger.</p>
<p>And because we are not running on a real computer, everything will be
lost.</p>
</div>
<div class="section level3">
<h3 id="your-drive">Your drive<a class="anchor" aria-label="anchor" href="#your-drive"></a>
</h3>
<p>Not all is lost when you restart a virtual machine. Ucloud provides
you with a drive:</p>
<figure><img src="fig/ucloud_drive.png" class="figure mx-auto d-block"></figure><p>In it we find a listing of what is in our drive: <img src="fig/ucloud_drive_2.png" class="figure"></p>
<p>The folder “Jobs” contains data from the individual runs of virtual
machines you have done. And Trash contains deleted files.</p>
<p>Note that the content of both these folders counts towards the total
storage you have available - so consider deleting them regularly.</p>
<p>It is recommended to create a folder for your work. Choose “Create
folder” and give it a name. For this example we will call it
“ml-course”.</p>
<div id="caution1" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Caution</h3>
<div class="callout-content">
<p>Do not use white spaces in your folder or file names. Most
programming languages are able to handle them, but will almost always
require special steps to be taken. Having white spaces in file names
introduces a potential for problems that can be difficult to identify
and fix.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="lets-get-started">Lets get started!<a class="anchor" aria-label="anchor" href="#lets-get-started"></a>
</h2>
<hr class="half-width">
<p>Go to the app-store as shown above, and chose RStudio.</p>
<p>Chose the “u1-standard-2” machinetype with 2 virtual CPUs and 12 GB
memory.</p>
<p>In order to be able to access our files, go to “Select folders to
use” and click add folder:</p>
<figure><img src="fig/ucloud_start.png" class="figure mx-auto d-block"></figure><p>Click in “No directory selected” and then on “Use” to choose
“ml-course”:</p>
<figure><img src="fig/ucloud_start_1.png" class="figure mx-auto d-block"></figure><p>And than click “Submit”</p>
<p>Your request is being processed:</p>
<figure><img src="fig/ucloud_start_2.png" class="figure mx-auto d-block"></figure><p>And after a short while, you get this:</p>
<figure><img src="fig/ucloud_start_3.png" class="figure mx-auto d-block"></figure><p>We can see what type of machine we chose, and how much time is
remaining. We chose 1 hour, and we can extend the runtime by 1, 8 or 24
hours.</p>
<p>We can also see the “Open interface” button.</p>
<p>If we click that, RStudio opens and we can begin working with R.</p>
<p>The very first thing we should always do, is to create a project. At
the upper right hand corner we see where we can do that:</p>
<figure><img src="fig/ucloud_rstudio_2.png" class="figure mx-auto d-block"></figure><p>Click new project, create it in a “new Directory” and change the
subdirectory in which the project is created to the directory we made
earlier. THIS IS IMPORTANT!</p>
<figure><img src="fig/ucloud_rstudio_3.png" class="figure mx-auto d-block"></figure><p>We now have a project running in RStudio on a virtual machine on
UCloud, and we are ready to work!</p>
</section><section><h2 class="section-heading" id="housekeeping">Housekeeping<a class="anchor" aria-label="anchor" href="#housekeeping"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="what-to-do-if-rstudio-appears-to-freeze">What to do if RStudio appears to freeze?<a class="anchor" aria-label="anchor" href="#what-to-do-if-rstudio-appears-to-freeze"></a>
</h3>
<p>First of all - have patience. RStudio appears almost the same when it
is frozen and if it is working on something that takes time. But take
advantadge of the fact that this is just a web interface to what is
actually running on a virtual remote machine. Close the interface, and
open it again. R will still be there.</p>
</div>
<div class="section level3">
<h3 id="where-can-i-find-the-job-again">Where can I find the job again?<a class="anchor" aria-label="anchor" href="#where-can-i-find-the-job-again"></a>
</h3>
<p>Sometimes we close a window, or nagivate away from it. Where can we
find it again? In the navigationbar to the left in Ucloud we find this
icon. <img src="fig/ucloud_running_jobs.png" class="figure"> It provides us with a
list or running jobs (yes, we can have more than one). Click on the job,
and we get back to the job, where we can extend time or open the
interface again.</p>
</div>
<div class="section level3">
<h3 id="im-done-early---how-do-i-stop-the-job">I’m done early - how do I stop the job?<a class="anchor" aria-label="anchor" href="#im-done-early---how-do-i-stop-the-job"></a>
</h3>
<p>If you are done with your work, and there is no reason to continue
running the machine, you can stop it early. Find the job (see above),
and click and hold the “Stop application” button. Remember to save your
scripts in RStudio first!</p>
<ul>
<li>how to download an entire folder, so they can download their work at
the end of the semester (without having to learn how to sync folders,
which I imagine will be too much to ask from this workshop)
archiver…</li>
</ul>
</div>
<div class="section level3">
<h3 id="how-do-i-get-files-out-of-ucloud">How do I get files out of UCloud?<a class="anchor" aria-label="anchor" href="#how-do-i-get-files-out-of-ucloud"></a>
</h3>
<p>This can be done in several different ways. Ucloud provides guides on
how to syncronise files. And there are archiving tools that can zip and
download your files.</p>
<p>The easy way is to do it through RStudio. Select the folder and/or
files you want to save, click on the little cogwheel saying “More” and
chose “Export”. RStudio will now zip the files, and ask you where to
save them. <img src="fig/ucloud_save.png" class="figure"></p>
</div>
<div class="section level3">
<h3 id="how-do-i-get-files-into-ucloud">How do I get files into UCloud<a class="anchor" aria-label="anchor" href="#how-do-i-get-files-into-ucloud"></a>
</h3>
<p>Again - Ucloud have services that can assist. But the easiest way is
to note that there is an “Upload” button in the Files pane in RStudio.
Use that.</p>
</div>
<div class="section level3">
<h3 id="what-types-of-machines-did-i-have-access-to">What types of machines did I have access to?<a class="anchor" aria-label="anchor" href="#what-types-of-machines-did-i-have-access-to"></a>
</h3>
<p>UCloud offers the possibility of “projects” where you choices might
be different. If you’re not in a “project” these will be the default
options:</p>
<table class="table">
<thead><tr class="header">
<th>name</th>
<th>vcpu</th>
<th>memory (GB)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>u1-standard-1</td>
<td>1</td>
<td>6</td>
</tr>
<tr class="even">
<td>u1-standard-2</td>
<td>2</td>
<td>12</td>
</tr>
<tr class="odd">
<td>u1-standard-4</td>
<td>4</td>
<td>24</td>
</tr>
<tr class="even">
<td>u1-standard-8</td>
<td>8</td>
<td>48</td>
</tr>
<tr class="odd">
<td>u1-standard-16</td>
<td>16</td>
<td>96</td>
</tr>
<tr class="even">
<td>u1-standard-32</td>
<td>32</td>
<td>192</td>
</tr>
<tr class="odd">
<td>u1-standard-64</td>
<td>64</td>
<td>384</td>
</tr>
</tbody>
</table>
</div>
</section><section><h2 class="section-heading" id="setup-issues">Setup issues<a class="anchor" aria-label="anchor" href="#setup-issues"></a>
</h2>
<hr class="half-width">
<p>We can save our work, and as long as we do not delete it again, we
have access to it. And keeping stuff in a project in R makes everything
easy(ish) to locate.</p>
<p>That, in general works nicely on a “real” computer, where libraries
and other elements of what we work with is saved locally.</p>
<p>On a virtual computer, locally is in the memory of a larger computer,
and as hinted at, these locally stored files disappear when the virtual
machine is restarted.</p>
<p>If you usually start your code with <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>,
you will, on a virtual machine, have to start with
<code>install.packages("tidyverse")</code> instead. <em>Every
time!</em></p>
<p>Working with machine learning makes this even worse. Many of the
algorithms we work with requires us to have specific Python libraries
installed, and available to R. They also disappear.</p>
<p>And to complicate matters even more, some of them require specific
versions of Python, and are unable to run on the newest version. And by
default the version of Python on Ucloud is the newest.</p>
<p>Below we present two ways of handling this. First “The Good
Solution”. Which could be better. And “The Sledgehammer Solution”. Which
is the reason we call “The Good Solution” good.</p>
</section><section><h2 class="section-heading" id="the-good-solution">The Good Solution<a class="anchor" aria-label="anchor" href="#the-good-solution"></a>
</h2>
<hr class="half-width">
<p>First of all, and <em>this is important!</em> you chose the folder we
demonstrated how to use earlier:</p>
<figure><img src="fig/ucloud_start_1.png" class="figure mx-auto d-block"></figure><p>The method requires the setup to know exactly where your files
are.</p>
<p>Secondly, and for the same reason, you <em>must</em> create a project
in the folder you attached to the run of the virtual machine.</p>
<p>Then make a script-file. It is not important what you call it, here
we call it “setup.R”</p>
<p>Copy the code below into that file, and run the code
<em>line-by-line</em>.</p>
<p>Some of the lines of code restart R. This is necessary for R to
read-in new options and settings. And when R is restarted, it does not
know where to continue.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set path to renv cache</span></span>
<span><span class="fu">writeLines</span><span class="op">(</span><span class="st">'RENV_PATHS_CACHE = "renv/cache"'</span>, <span class="st">".Renviron"</span><span class="op">)</span></span>
<span><span class="co"># restart R in order to set the environment variable</span></span>
<span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initializing renv. You will be asked if you want to do it. You do.</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">init</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Yes, it should be possible to do this in one go. </span></span>
<span><span class="co"># It fails. So, three lines of code...</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"reticulate"</span>, prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">'rstudio/tensorflow'</span>, prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"rstudio/keras"</span>, prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install miniconda - control where</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">install_miniconda</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"python_env"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Storing information about installed packages</span></span>
<span><span class="co"># You might be asked if you want to proceed. You do.</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># restart R to ensure that R knows where miniconda is installed</span></span>
<span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create python environment</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_create</span><span class="op">(</span></span>
<span>  envname <span class="op">=</span> <span class="st">"my_project_env"</span>,</span>
<span>  packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"python=3.10"</span>, <span class="st">"openssl=3.3.0"</span><span class="op">)</span>,</span>
<span>  channels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"conda-forge"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install Python packages in the environment</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_install</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"my_project_env"</span>, </span>
<span>                          packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"numpy&gt;=1.24"</span>, </span>
<span>                                       <span class="st">"pandas&gt;=2.1"</span>, </span>
<span>                                       <span class="st">"tensorflow&gt;=2.13"</span>, </span>
<span>                                       <span class="st">"keras&gt;=2.13"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_install</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"my_project_env"</span>, packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"transformers&gt;=4.30"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_install</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"my_project_env"</span>, packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"pytorch"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Restart R - this might not be necessary - we do it anyway</span></span>
<span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify which environment is to be used</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">use_condaenv</span><span class="op">(</span><span class="st">"my_project_env"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Storing information about installed packages</span></span>
<span><span class="co"># You might be asked if you want to proceed. You do.</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>

<p>One way to check that everything worked, is to run the following
script:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">use_condaenv</span><span class="op">(</span><span class="st">"my_project_env"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">keras3</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">keras_model_sequential</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_dense</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">32</span>, input_shape <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">784</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_activation</span><span class="op">(</span><span class="st">"relu"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_dense</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_activation</span><span class="op">(</span><span class="st">"softmax"</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#importing the transformers python module</span></span>
<span><span class="va">transformers</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="st">"transformers"</span><span class="op">)</span> </span>
<span><span class="va">autotoken</span> <span class="op">&lt;-</span> <span class="va">transformers</span><span class="op">$</span><span class="va">AutoTokenizer</span></span>
<span><span class="va">autoModelClass</span> <span class="op">&lt;-</span> <span class="va">transformers</span><span class="op">$</span><span class="va">AutoModelForSequenceClassification</span></span>
<span></span>
<span><span class="va">modelname</span> <span class="op">&lt;-</span> <span class="st">"distilbert-base-uncased-finetuned-sst-2-english"</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">autoModelClass</span><span class="op">$</span><span class="fu">from_pretrained</span><span class="op">(</span><span class="va">modelname</span><span class="op">)</span></span></code></pre>
</div>
<p>If you get a nice summary, everything worked. You might get messages
about “ssl not installed”. Those can be ignored. And you will also get
warnings about tensorflow not being compiled for working with “GPU”s.
Since we do not have access to GPU on the kind of virtual machines we
can run RStudio on, on UCloud, these can safely be ignored.</p>
<div class="section level4">
<h4 id="do-i-have-to-do-this-every-time">Do I have to do this every time?<a class="anchor" aria-label="anchor" href="#do-i-have-to-do-this-every-time"></a>
</h4>
<p>Good news everybody! No.</p>
<p><em>If</em> you start a new virtual machine, and add the
<em>same</em> folder in you drive on Ucloud to the run, you can open
your project again: Navigate to the project folder (you did remember the
name, right?), and click on the .Rproj file with the same name as your
project.</p>
<p>Due to the way Renv works, it might take some time to open the
project:¨</p>
<figure><img src="fig/ucloud_taking_longer.png" class="figure mx-auto d-block"></figure><p>And for reasons we do not entirely understand at KUB Datalab (yet),
we also have to run the</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">use_condaenv</span><span class="op">(</span><span class="st">"my_project_env"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>Before actually doing anything.</p>
</div>
<div class="section level4">
<h4 id="what-about-other-packages">What about other packages?<a class="anchor" aria-label="anchor" href="#what-about-other-packages"></a>
</h4>
<p>When you have run the setup above, and opened the project,
<code>renv</code> is running and keeping track of stuff.</p>
<p>That also means that if you need another package -
<code>tidyverse</code> comes to mind as a frequently used set of
packages, you simply install tidyverse running
<code>install.packages("tidyverse")</code> just as you would normally
do. These new packages are now installed in your project and will be
available without having to install them repeatedly.</p>
<p>But remember to run <code>renv::snapshot()</code> afterwards to
update the registration <code>renv</code> keeps of installed
packages.</p>
</div>
<div class="section level4">
<h4 id="other-issues">Other issues<a class="anchor" aria-label="anchor" href="#other-issues"></a>
</h4>
<p>Renv is a bit finicky. You might get messages about packages being in
“an inconsistent state”. Try running this first:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">restore</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>And if that does not solve the problem, try:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">rehash</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">restore</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Sometimes renv forgets that a library is installed…</p>
<p>Fortunately the libraries are easily available, so an</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"rstudio/keras3"</span><span class="op">)</span></span></code></pre>
</div>
<p>is fast. The example shows keras3 - exchange the package name for
what is actually missing.</p>
</div>
<div class="section level3">
<h3 id="the-sledgehammer-solution">The sledgehammer solution<a class="anchor" aria-label="anchor" href="#the-sledgehammer-solution"></a>
</h3>
<p>This has worked consistently. But take a long time and needs to be
repeated every time you start a new machine. It will work, but only by
being pretty violent with the virtual machine.</p>
<p>When you have started the virtual machine, and opened a project, make
a new R-script in the project, copy the following code (or download it
from here), and run it line by line.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run shell commands from R</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"sudo"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"add-apt-repository"</span>, <span class="st">"-y"</span>, <span class="st">"ppa:deadsnakes/ppa"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"sudo"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"apt-get"</span>, <span class="st">"update"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"sudo"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"apt-get"</span>, <span class="st">"install"</span>, <span class="st">"-y"</span>, <span class="st">"python3.9"</span>, <span class="st">"python3.9-venv"</span>, <span class="st">"python3.9-dev"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Python setup</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"ensurepip"</span>, <span class="st">"--upgrade"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, <span class="st">"--upgrade"</span>, <span class="st">"pip"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, <span class="st">"numpy"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create and activate environment</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"venv"</span>, <span class="st">"~/r-tensorflow"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Activate virtual environment and install packages</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"bash"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-c"</span>, <span class="st">"source ~/r-tensorflow/bin/activate &amp;&amp; pip install numpy tensorflow keras spacy &amp;&amp; python -m spacy download en_core_web_sm &amp;&amp; deactivate"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># R packages and setup</span></span>
<span><span class="fu">Sys.unsetenv</span><span class="op">(</span><span class="st">'RETICULATE_PYTHON'</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">reticulate</span><span class="op">)</span></span>
<span><span class="fu">use_virtualenv</span><span class="op">(</span><span class="st">'~/r-tensorflow'</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">'remotes'</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'rstudio/tensorflow'</span>, upgrade <span class="op">=</span> <span class="st">'always'</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tensorflow</span><span class="op">)</span></span>
<span><span class="fu">install_tensorflow</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">'~/r-tensorflow'</span>, restart_session <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'rstudio/keras'</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">keras3</span><span class="op">)</span></span>
<span><span class="fu">install_keras</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">'~/r-tensorflow'</span><span class="op">)</span></span></code></pre>
</div>
<p>You can check that it is working similarly to the better solution
above.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Notes on the good solution </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Data analysis is not worth much, if we are not able to reproduce our
results. A significant amount of work have therefore gone into providing
infrastructure for exactly that. One issue is the question of which
libraries are used for the analysis.</p>
<p>Enter <code>renv</code>. <code>renv</code> is a library that
establishes scaffolding for installing libraries in a specific location
in an R-project, making it self contained and easy to distribute.
Normally we would distribute a “lock file” that describes exactly which
versions of which packages are used in a project.</p>
<p>You will see a lot of stuff in the “files” tab. A folder called
“renv”, a file “renv.lock”, and probably a file “.Rprofile”.</p>
<p>Looking into that, we will find a line of code
“source(”renv/activate.R”)”</p>
<p>When ever we start the project, what ever we have written to
.Rprofile will be run. What will be run in this case is the script
“activate.R” which does a lot of interesting stuff. The important thing
is, that the renv-library is started. And whenever we now install a
package, it will be installed in the renv folder. Do not delve too deep
into that, leave it to the machine.</p>
<p>One issue with this is, that there are still installed packages weird
places on the machine. Caches of the packages are stored outside our
project. The idea is that other projects might use these cached
packages, and cut down on install time.</p>
<p>In our case, that is not helpful. This cache will disappear when the
virtual machine is stopped.</p>
<p>In order to handle this, we can specify where the cache should be
stored. We can do that manually. Or, and this is the preffered solution,
make a file .Renviron where we specify where renv should place the
cache. Having done that we need to restart R, and now we can install
packages to our hearts delight, and renv will place both the libraries
and the cache in our local project.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Ucloud provide access to a multitude of advanced software that we
are not able to run locally</li>
<li>Running RStudio on Ucloud give us access to more compute and memory
than we have on our own computer</li>
<li>More advanced work might require a quite complicated setup</li>
<li>Restarting a virtual machine means all our work and setup might be
lost, unless we take certain precautions.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-pipes"><p>Content from <a href="pipes.html">A deeper dive into pipes</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/pipes.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the differences between the two pipes?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain some of the differences between the two families of
pipes</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Almost everywhere in this course material, you will see the pipe.</p>
<p>But the story about the pipe is larger than <code>%&gt;%</code>.</p>
<p>The <code>%&gt;%</code> version come from the <code>magrittr</code>
package, and was introduced to the R-world in 2014. It became one of the
defining features of the R-dialect “tidyverse”. It proved useful enough
that a similar pipe <code>|&gt;</code> was introduced in “base-R” with
version 4.1 in May 2021.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> R dialects </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>R-programmers tend to write in one dialect of R, small variations
that are understandable - but still different. The three common dialects
are “base R”, the tidyverse and data.table. One of the defining features
of the tidyverse dialect has been the magrittr pipe. This differences is
eroding with the introduction of the native pipe in base R.</p>
<p>KUB Datalab speaks the tidyverse dialect, and will continue to use
the magrittr pipe until the default keyboard shortcut to the pipe in
RStudio changes</p>
</div>
</div>
</div>
</div>
<p>The base-R pipe function in a similar way to the magrittr pipe. But
there are differences:</p>
<table style="width:99%;" class="table">
<colgroup>
<col width="19%">
<col width="45%">
<col width="25%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th>Topic</th>
<th>Magrittr 2.0.3</th>
<th>Base 4.3.0</th>
<th>note</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Operator</td>
<td><code>%\&gt;%  %\&lt;\&gt;%  %$%  %!&gt;%  %T&gt;%</code></td>
<td><code>|&gt;</code></td>
<td>1</td>
</tr>
<tr class="even">
<td>Function calls</td>
<td><code>1:2 %&gt;% sum()</code></td>
<td><code>1:2 |&gt; sum()</code></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td><strong><code>1:2 %&gt;% sum</code></strong></td>
<td>Needs the parentheses</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>
<code>1:3 %&gt;%</code>`+` <code>4</code>
</td>
<td>Not every function is supported</td>
<td></td>
</tr>
<tr class="odd">
<td>Insert on first empty place</td>
<td><code>mtcars %&gt;% lm(formula=mpg ~ disp)</code></td>
<td><code>mtcars |&gt; lm(formula = mpg ~ disp)</code></td>
<td>2</td>
</tr>
<tr class="even">
<td>placeholder</td>
<td>.</td>
<td>_</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td><code>mtcars %&gt;% lm(mpg~disp, data = .)</code></td>
<td><code>mtcars |&gt; lm(mpg ~ disp, data = _)</code></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><code>mtcars %&gt;% lm(mpg~disp, .)</code></td>
<td>Needs named argument</td>
<td>3</td>
</tr>
<tr class="odd">
<td></td>
<td><code>1:3 %&gt;% setNames(., .)</code></td>
<td>Can only appear once</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><code>1:3 %&gt;% {sum(sqrt(.))}</code></td>
<td>Nested calls not allowed</td>
<td>4</td>
</tr>
<tr class="odd">
<td>Extraction call</td>
<td>
<p><code>mtcars %&gt;% .$cyl</code></p>
<p><code>mtcars %&gt;% {.$cyl[[3]]}</code></p>
<p><code>mtcars %$% cyl[[3]]</code></p>
</td>
<td>
<p><code>mtcars |&gt; _$cyl</code></p>
<p><code>mtcars |&gt; _$cyl[[3]]</code></p>
</td>
<td></td>
</tr>
<tr class="even">
<td>Environment</td>
<td>
<code>%&gt;%</code> has additional function environment. Use:
<code>"x" %!&gt; assign(1)</code>
</td>
<td><code>"x" |&gt; assign(1)</code></td>
<td>4</td>
</tr>
<tr class="odd">
<td>Create Function</td>
<td><code>top6 &lt;- . %&gt;% sort() %&gt;% tail()</code></td>
<td>Not possible</td>
<td></td>
</tr>
<tr class="even">
<td>Speed</td>
<td>Slower because overhead of function call</td>
<td>Faster because syntax transformation</td>
<td>5</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>Unless we explicitly import the <code>magrittr</code> package, we
typically only have access to the simple pipe, <code>%&gt;%</code> which
is included in many packages. This however is only one of several pipes
available from the <code>magrittr</code> package. See below.</li>
<li>Note that both pipes insert the input from the left-hand-side at the
first <em>unnamed</em> argument. Naming other arguments allow us to
handle functions that do not take data as the <em>first</em>
argument.</li>
<li>The placeholder allow us to reference the input in functions. One
important difference is that the base-R pipe need to be specified with a
named argument. Which is probably best practice anyway.</li>
<li>This is related to the way the pipes actually work, see also 5.</li>
<li>The magrittr pipe works by rewriting the right-hand-side in a
function, with its own environment - where the left-hand-side is
available with the symbol `.`</li>
</ol>
<section><h2 class="section-heading" id="the-other-pipes">The other pipes<a class="anchor" aria-label="anchor" href="#the-other-pipes"></a>
</h2>
<hr class="half-width">
<p>As indicated in the comparative table, the <code>magrittr</code> pipe
have a number of siblings.</p>
<div class="section level3">
<h3 id="the-tee-pipe-t">The tee-pipe %T&gt;%<a class="anchor" aria-label="anchor" href="#the-tee-pipe-t"></a>
</h3>
<p>This pipe allow us to inject a function into a longer set of pipes,
without affecting the rest of the flow.</p>
<figure><img src="fig/tee-pipe.png" class="figure mx-auto d-block"></figure><p>The tee-pipe sends data to two functions. The immediate next, which
we want to run for plotting, logging or printing data, and to the next
function over, which get the original input data, rather than what is
returned by the intermediate function.</p>
<p>We are here using an intermediate function, not for what it does to
the data, but for its side effects.</p>
<div id="try-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>Use the tee-pipe to send the dataset <code>mtcars</code> to a view
function, and then filter to only show rows where <code>am</code> is
equal to 1.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>mtcars <span class="sc">%T&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">view</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">filter</span>(am <span class="sc">==</span> <span class="sc">!</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="assignment-pipen">Assignment pipen<a class="anchor" aria-label="anchor" href="#assignment-pipen"></a>
</h2>
<hr class="half-width">
<p>After constructing a longer pipe in order to get at specific result,
we end up assigning the result to a new object. Sometimes the same
object:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">my_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">lending</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>area <span class="op">=</span> <span class="va">lenght</span> <span class="op">*</span> <span class="va">width</span><span class="op">)</span></span></code></pre>
</div>
<p>The assignment pipe can shorten this:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">%&lt;&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">lending</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>area <span class="op">=</span> <span class="va">lenght</span> <span class="op">*</span> <span class="va">width</span><span class="op">)</span></span></code></pre>
</div>
<p>It needs to be the first pipe in the flow, and will pass the data
from its left hand side to the flow on the right hand side. And assign
the result of the entire pipe back into the original left hand side.</p>
<p>This will shorten your code. But it is generally recommended not to
use it.</p>
<p>Reading R-code can be difficult enough as it is, and
<code>%&gt;%</code> is visually rather close to <code>%&lt;&gt;%</code>
which makes it easy to overlook.</p>
<div class="section level3">
<h3 id="the-eager-pipe">The eager pipe %!&gt;%<a class="anchor" aria-label="anchor" href="#the-eager-pipe"></a>
</h3>
<p>We definitely need an episode in this material that cover the concept
of <code>lazy evaluation</code>. But currently we are too lazy to write
it.</p>
<p>But. The usual pipe <code>%&gt;%</code> i “lazy”. An expression in a
set of pipes is only evaluated when R absolutely have to. This can do
weird things, especially if we run functions for their side effects,
e.g. when we use the tee-pipe to do logging of intermediate results.</p>
<p>Enter the eager pipe, <code>%!&gt;%</code>. This will force the
evaluation rather than postpone it to later.</p>
<p>Let us define three functions. The code is not that important, but
they take an input, prints a text indicating their name (ie function f
prints “function f”), and return the input unchanged. This printing is
the side effect.</p>
<p>Take a look below if you are curious:</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Defining three functions </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"function f"</span><span class="op">)</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"function g"</span><span class="op">)</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"function h"</span><span class="op">)</span></span>
<span>  <span class="fu">invisible</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p><code>invisible()</code> returns x, but withou printing it.</p>
</div>
</div>
</div>
</div>
<p>We can now run these three functions in a pipe:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">magrittr</span><span class="op">)</span></span>
<span></span>
<span><span class="cn">NULL</span> <span class="op">%&gt;%</span> <span class="fu">f</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">g</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">h</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "function h"
[1] "function g"
[1] "function f"</code></pre>
</div>
<p>This is the lazy evaluation. The first print come from the last
function, and function g is only evaluated when it has to be. Because
function h needs it. The last function to be evaluated is function f -
the first we actually have in the pipes. Because it is only evaluated
when needed. That is, when function g needs it.</p>
<p>Eager evaluation, where the functions are not evaluated when needed,
but immediately, can be achieved using the eager pipe:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">NULL</span> <span class="op">%!&gt;%</span> <span class="fu">f</span><span class="op">(</span><span class="op">)</span> <span class="op">%!&gt;%</span> <span class="fu">g</span><span class="op">(</span><span class="op">)</span> <span class="op">%!&gt;%</span> <span class="fu">h</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "function f"
[1] "function g"
[1] "function h"</code></pre>
</div>
<p>Now the first message printed is from function f. Becaus function f
is the first, and we are using the eager pipe rather than the lazy.</p>
<div id="r-use-lazy-evaluation-for-a-reason" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<div id="r-use-lazy-evaluation-for-a-reason" class="callout-inner">
<h3 class="callout-title">R use lazy evaluation for a reason</h3>
<div class="callout-content">
<p>It might be tempting to use the eager pipe every time. After all, it
is bad to be lazy and the evaluation have to be done at one point,
right. But! R, and especially the tidyverse functions use lazy
evaluation because it improves performance. If something in the pipe is
not actually used, it is not evaluated. This saves time.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-exposition-pipe">The exposition pipe<a class="anchor" aria-label="anchor" href="#the-exposition-pipe"></a>
</h3>
<p>The power of the pipes comes from the fact that we can use them to
forward data to a function that use a dataframe.</p>
<p>But not all functions have an argument that allow them to take a
dataframe as input. And because the pipe inserts whatever is on the
lefthand side of it, into the first empty argument in the function on
the right hand side, this can lead to problems.</p>
<div id="try-it-yourself-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself-1" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>You will fail!</p>
<p>Use the <code>cor()</code> function in conjunction with the ordinary
pipe (%&gt;%), to find the correlation between the Sepal.Length and the
Sepal.Width in the iris dataset.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>Something like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cor</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span></span></code></pre>
</div>
<p>Might be tempting. Try to add other named arguments to the function
(look at the help file) if you do not succeed at first.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>This cannot be done.</p>
<p>In this attempt:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cor</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">Sepal.Width</span>,</span>
<span>      use <span class="op">=</span> <span class="st">"everything"</span><span class="op">)</span></span></code></pre>
</div>
<p>We add more and more named arguments to the function. In this code,
we will get an error, telling us that we are supplying a dataframe to
the argument “method”. Looking at the help, we can see that
<code>cor</code> besides the arguments we have already named in the
function call, take a final argument “method”. That is the first empty
argument in the function, and the pipe will place the dataframe
<code>iris</code> on that place, leading to an error. If we supply the
method argument inserting <code>method = "pearson"</code>, the pipe will
still add the dataframe to the function, resulting in an error telling
us that we are supplying an argument that is unused.</p>
</div>
</div>
</div>
</div>
<p>The exposition pipe, <code>%$%</code> exposes the variables in the
left hand side, and does not insert anything anywhere unless we specify
it:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">%$%</span> </span>
<span>  <span class="fu">cor</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.1175698</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="that-weird-note-about-function-calls">That weird note about function calls<a class="anchor" aria-label="anchor" href="#that-weird-note-about-function-calls"></a>
</h3>
<p>In the table comparing the native pipe (<code>|&gt;</code>) and the
magrittr pipe (<code>%&gt;%</code>) it was noted that the latter was
slower than the first, because of “overhead of function call”. Or
conversely that the first was faster because of “syntax transformation”.
What does that actually mean?</p>
<p>The magrittr pipe, as are other operators, is a function.
Conceptually this <code>a %&gt;% b()</code>, is the same as
<code>%&gt;%(a, b())</code></p>
<p>Or:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>become this:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">`%&gt;%`</span><span class="op">(</span><span class="fu">`%&gt;%`</span><span class="op">(</span><span class="va">data</span>, <span class="fu">filter</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, <span class="fu">summarize</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>We can count 5 functions, 2 of them the pipe function.</p>
<p>The native pipe on the other hand is not a function. The R-parser,
which interprets our code befor actually evaluating it, rewrites code
containg the native pipe. That means, that <code>a |&gt; b()</code>
becomes <code>b(a)</code></p>
<p>Or that:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>become:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summarize</span><span class="op">(</span><span class="fu">filter</span><span class="op">(</span><span class="va">data</span>, <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>We can count 3 functions in this expression. Intuitively this should
be faster. And it is.</p>
</div>
</section><section><h2 class="section-heading" id="what-if-i-want-the-other-pipe">What if I want the other pipe?<a class="anchor" aria-label="anchor" href="#what-if-i-want-the-other-pipe"></a>
</h2>
<hr class="half-width">
<p>The keyboard shortcut to get a pipe operator in RStudio is
ctrl+shift+m on windows and cmd+shift+m on macos.</p>
<p>This default can be changed:</p>
<p>Tools → Global Options → Code</p>
<p><img src="fig/change_pipe.png" class="figure"> Place a tickmark in the box next to
“Use native pipe operator, |&gt;”.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The base-R, native, pipe |&gt; is faster than the magrittr pipe,
%&gt;%</li>
<li>The magrittr package provides a selection of other useful pipes</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-gis_setup"><p>Content from <a href="gis_setup.html">Setup for GIS</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/gis_setup.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I get ready for working with geospatial data in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get your R-environment prepared for working with geospatial
data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>This workshop is designed to be run on your local machine. First, you
will need to download the data we use in the workshop. Then, you need to
set up your machine to analyse and process geospatial data. We provide
instructions below to install all components manually.</p>
<section><h2 class="section-heading" id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<hr class="half-width">
<p>For a full description of the data used in this workshop see the <a href="data.html">data page</a>.</p>
<p>Note that the page includes a lot of other datasets, not just
GIS-related.</p>
</section><section><h2 class="section-heading" id="local-installation">Local Installation<a class="anchor" aria-label="anchor" href="#local-installation"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="software">Software<a class="anchor" aria-label="anchor" href="#software"></a>
</h3>
<table class="table">
<colgroup>
<col width="18%">
<col width="18%">
<col width="18%">
<col width="18%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>Software</th>
<th>Install</th>
<th>Manual</th>
<th>Available for</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://www.r-project.org" class="external-link">R</a></td>
<td><a href="https://cloud.r-project.org" class="external-link">Link</a></td>
<td><a href="https://cloud.r-project.org" class="external-link">Link</a></td>
<td>Linux, MacOS</td>
<td>Software environment for statistical and scientific computing</td>
</tr>
<tr class="even">
<td><a href="https://www.rstudio.com" class="external-link">RStudio</a></td>
<td><a href="https://www.rstudio.com/products/rstudio/download/#download" class="external-link">Link</a></td>
<td></td>
<td>Linux, MacOS</td>
<td>GUI for R</td>
</tr>
</tbody>
</table>
<p>We provide quick instructions below for installing the various
software needed for this workshop. At points, they assume familiarity
with the command line and with installation in general. As there are
different operating systems and many different versions of operating
systems and environments, these may not work on your computer. If an
installation doesn’t work for you, please refer to the installation
instructions for that software listed in the table above.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-Windows" name="Windows" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Windows" type="button" role="tab" aria-controls="nav-tabpanel-1-Windows" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-Windows">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-macOS-one-click" name="macOS-one-click" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-macOS-one-click" type="button" role="tab" aria-controls="nav-tabpanel-1-macOS-one-click" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-macOS-one-click">
  macOS - one-click
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-macOS-3commands" name="macOS-3commands" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-macOS-3commands" type="button" role="tab" aria-controls="nav-tabpanel-1-macOS-3commands" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-macOS-3commands">
  macOS - 3 commands
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Linux" name="Linux" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Linux" type="button" role="tab" aria-controls="nav-tabpanel-1-Linux" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Linux">
  Linux
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-Windows" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-1-Windows">
<p>To install the geospatial libraries, install the latest version <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">RTools</a></p>
</div>
<div id="nav-tabpanel-1-macOS-one-click" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-macOS-one-click">
<p>The simplest way to install these geospatial libraries is to install
the latest version of <a href="https://www.kyngchaos.com/software/frameworks" class="external-link">Kyng Chaos’s
pre-built package</a> for GDAL Complete. Be aware that several other
libraries are also installed, including the UnixImageIO, SQLite3, and
<code>NumPy</code>.</p>
<p>After downloading the package in the link above, you will need to
double-click the cardbord box icon to complete the installation.
Depending on your security settings, you may get an error message about
“unidentified developers”. You can enable the installation by following
<a href="https://kb.wisc.edu/page.php?id=25443" class="external-link">these instructions</a>
for installing programs from unidentified developers.</p>
</div>
<div id="nav-tabpanel-1-macOS-3commands" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-macOS-3commands">
<p>Alternatively, participants who are comfortable with the command line
can install the geospatial libraries individually using <a href="https://brew.sh" class="external-link">homebrew</a>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> brew install proj</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> brew install geos</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">$</span> brew install gdal</span></code></pre>
</div>
</div>
<div id="nav-tabpanel-1-Linux" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-Linux">
<p>Steps for installing the geospatial libraries will vary based on
which form of Linux you are using. These instructions are adapted from
the <a href="https://github.com/r-spatial/sf" class="external-link"><code>sf</code> package’s
<code>README</code></a>.</p>
<p>For <strong>Ubuntu</strong>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> sudo add-apt-repository ppa:ubuntugis</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">$</span> sudo apt-get update</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="ex">$</span> sudo apt-get install libgdal-dev libgeos-dev libproj-dev</span></code></pre>
</div>
<p>For <strong>Fedora</strong>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> sudo dnf install gdal-devel proj-devel geos-devel</span></code></pre>
</div>
<p>For <strong>Arch</strong>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> pacman <span class="at">-S</span> gdal proj geos</span></code></pre>
</div>
<p>For <strong>Debian</strong>: The <a href="https://github.com/rocker-org/geospatial" class="external-link">rocker geospatial</a>
Dockerfiles may be helpful. Ubuntu Dockerfiles are found <a href="https://github.com/r-spatial/sf/tree/master/inst/docker" class="external-link">here</a>.
These may be helpful to get an idea of the commands needed to install
the necessary dependencies.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="udunits">UDUNITS<a class="anchor" aria-label="anchor" href="#udunits"></a>
</h3>
<p>Linux users will have to install UDUNITS separately. Like the
geospatial libraries discussed above, this is a dependency for the
<code>R</code> package <code>sf</code>. Due to conflicts, it does not
install properly on Linux machines when installed as part of the
<code>sf</code> installation process. It is therefore necessary to
install it using the command line ahead of time.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Linux
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>Steps for installing the geospatial will vary based on which form of
Linux you are using. These instructions are adapted from the <a href="https://github.com/r-spatial/sf" class="external-link"><code>sf</code> package’s
<code>README</code></a>.</p>
<p>For <strong>Ubuntu</strong>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> sudo apt-get install libudunits2-dev</span></code></pre>
</div>
<p>For <strong>Fedora</strong>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> sudo dnf install udunits2-devel</span></code></pre>
</div>
<p>For <strong>Arch</strong>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> pacaur/yaourt/whatever <span class="at">-S</span> udunits</span></code></pre>
</div>
<p>For <strong>Debian</strong>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> sudo apt-get install <span class="at">-y</span> libudunits2-dev</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="r-packages">R Packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h3>
<p>The following <code>R</code> packages are used in the various
geospatial lessons. If you have taken other of our cources, you probably
have a number of them installed already.</p>
<ul>
<li><a href="https://cran.r-project.org/package=dplyr" class="external-link"><code>dplyr</code></a></li>
<li><a href="https://cran.r-project.org/package=ggplot2" class="external-link"><code>ggplot2</code></a></li>
<li><a href="https://cran.r-project.org/package=raster" class="external-link"><code>raster</code></a></li>
<li><a href="https://cran.r-project.org/package=rasterVis" class="external-link"><code>rasterVis</code></a></li>
<li><a href="https://CRAN.R-project.org/package=RColorBrewer" class="external-link"><code>RColorBrewer</code></a></li>
<li><a href="https://cran.r-project.org/package=remotes" class="external-link"><code>remotes</code></a></li>
<li><a href="https://CRAN.R-project.org/package=reshape" class="external-link"><code>reshape</code></a></li>
<li><a href="https://cran.r-project.org/package=scales" class="external-link"><code>scales</code></a></li>
<li><a href="https://cran.r-project.org/package=sf" class="external-link"><code>sf</code></a></li>
<li><a href="https://cran.r-project.org/package=terra" class="external-link"><code>terra</code></a></li>
<li><a href="https://CRAN.R-project.org/package=tidyr" class="external-link"><code>tidyr</code></a></li>
<li><a href="https://CRAN.R-project.org/package=maps" class="external-link"><code>maps</code></a></li>
</ul>
<p>To install these packages in RStudio, copy the following into the
console and hit enter.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"raster"</span>, <span class="st">"rasterVis"</span>, <span class="st">"RColorBrewer"</span>, <span class="st">"remotes"</span>, <span class="st">"reshape"</span>, <span class="st">"scales"</span>, <span class="st">"sf"</span>, , <span class="st">"tidyr"</span>, <span class="st">"maps"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>You should see a status message starting with: terra skal nok også
være der et sted. men det fejler i git-actions.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.5/dplyr_0.7.6.tgz'
Content type 'application/x-gzip' length 5686536 bytes (5.4 MB)
==================================================
downloaded 5.4 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.5/ggplot2_3.0.0.tgz'
Content type 'application/x-gzip' length 3577658 bytes (3.4 MB)
==================================================
downloaded 3.4 MB</code></pre>
</div>
<p>When the installation is complete, you will see a status message
like:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The downloaded binary packages are in
/var/folders/7g/r8_n81y534z0vy5hxc6dx1t00000gn/T//RtmpJECKXM/downloaded_packages</code></pre>
</div>
<p>You are now ready for the workshop!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Working with geospatial data requires additional software</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-fence-test"><p>Content from <a href="fence-test.html">Fences på vores undervisningssider</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/fence-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Hvilke fences har vi til rådighed i det her setup?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Lever en oversigt over fences vi kan bruge i
undervisningsmaterialet.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Fences. Det vi bruger til at indsætte de små (eller ikke så små)
farvede blokke på siderne. De starter alle med mindst fire “:” og
derefter ordet; eksempelvis “callout”. Og når man er færdig med
indholdet, skal der være mindst fire “:” igen.</p>
<p>Hvad er ordet så? Ordet er altid det der står på position X i: “dette
er en X fence”.</p>
<div id="dette-er-en-callout-fence" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="dette-er-en-callout-fence" class="callout-inner">
<h3 class="callout-title">dette er en callout fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-prereq-fence" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="dette-er-en-prereq-fence" class="callout-inner">
<h3 class="callout-title">dette er en prereq fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-checklist-fence" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="dette-er-en-checklist-fence" class="callout-inner">
<h3 class="callout-title">dette er en checklist fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<p>Bemærk at hint-fencen mangler en ikon til venstre.</p>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">
  dette er en hint fence
  </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="dette-er-en-discussion-fence" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="dette-er-en-discussion-fence" class="callout-inner">
<h3 class="callout-title">dette er en discussion fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-testimonial-fence" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="dette-er-en-testimonial-fence" class="callout-inner">
<h3 class="callout-title">dette er en testimonial fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-caution-fence" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<div id="dette-er-en-caution-fence" class="callout-inner">
<h3 class="callout-title">Dette er en caution fence</h3>
<div class="callout-content">
<p>Bemærk at sandpaper vil insistere på ikke at kende til denne fence.
Men den fungerer altså fint alligevel, så det er fejl under bygningen af
siden man roligt kan ignorere.</p>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  dette er en spoiler fence
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="dette-er-en-challenge-fence" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="dette-er-en-challenge-fence" class="callout-inner">
<h3 class="callout-title">dette er en challenge fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Den optræder som regel med en solution fence
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Og den er “inde i” challenge fencen.</p>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="fanegruppe-eksempel">Fanegruppe Eksempel<a class="anchor" aria-label="anchor" href="#fanegruppe-eksempel"></a>
</h2>
<hr class="half-width">
<p>Vi starter med en group-tab fence, og så har vi nogen overskrifter
til de forskellige tabs, og deres indhold. Vær opmærksom på at når man
skifter til eksempelvis “Mac” i en group-tab, så skifter de andre
group-tabs også til “Mac”.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-Windows" name="Windows" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Windows" type="button" role="tab" aria-controls="nav-tabpanel-1-Windows" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-Windows">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Mac" name="Mac" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Mac" type="button" role="tab" aria-controls="nav-tabpanel-1-Mac" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Mac">
  Mac
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Linux" name="Linux" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Linux" type="button" role="tab" aria-controls="nav-tabpanel-1-Linux" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Linux">
  Linux
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-Windows" class="tab-pane show active" aria-labelledby="nav-tab-1-Windows" role="tabpanel">
<p>1</p>
</div>
<div id="nav-tabpanel-1-Mac" class="tab-pane" aria-labelledby="nav-tab-1-Mac" role="tabpanel">
<p>2</p>
</div>
<div id="nav-tabpanel-1-Linux" class="tab-pane" aria-labelledby="nav-tab-1-Linux" role="tabpanel">
<p>3</p>
</div>
</div>
</div>
<div class="tabs">
<nav><div id="nav-tab-2" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-2-Windows" name="Windows" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Windows" type="button" role="tab" aria-controls="nav-tabpanel-2-Windows" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-2-Windows">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Mac" name="Mac" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Mac" type="button" role="tab" aria-controls="nav-tabpanel-2-Mac" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Mac">
  Mac
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Linux" name="Linux" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Linux" type="button" role="tab" aria-controls="nav-tabpanel-2-Linux" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Linux">
  Linux
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-raspbian" name="raspbian" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-raspbian" type="button" role="tab" aria-controls="nav-tabpanel-2-raspbian" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-raspbian">
  raspbian
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-2" class="tab-content">
<div id="nav-tabpanel-2-Windows" class="tab-pane show active" aria-labelledby="nav-tab-2-Windows" role="tabpanel">
<p>4</p>
</div>
<div id="nav-tabpanel-2-Mac" class="tab-pane" aria-labelledby="nav-tab-2-Mac" role="tabpanel">
<p>5</p>
</div>
<div id="nav-tabpanel-2-Linux" class="tab-pane" aria-labelledby="nav-tab-2-Linux" role="tabpanel">
<p>6</p>
</div>
<div id="nav-tabpanel-2-Windows" class="tab-pane" aria-labelledby="nav-tab-2-Windows" role="tabpanel">
<p>7</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Brug fences til at fremhæve eller skjule indhold på siderne.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-making-a-new-course"><p>Content from <a href="making-a-new-course.html">Make a new course</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/making-a-new-course.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make a new course-page based on this??</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to make a new lesson based on this template</li>
<li>Provide a checklist for doing so</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>This page is defined as a template-repo at GitHub. That means, that
you can easily initialize a new repository based on this page.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  How do you make a template-repo?
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Go to the main page of the repo you want to make a template.</p>
<p>Click “settings”, and, just under the box where you can change the
repository name, you will find a tick-box called “Template repository”.
Tick it.</p>
</div>
</div>
</div>
</div>
<p>Go to the <a href="https://github.com/KUBDatalab/R-toolbox" class="external-link">github-repo</a>, and
click on the green button “Use this template”. Choose “Create a new
repository”.</p>
<p>Giv the new repository a name. We prefer to let our R-courses begin
with “R-”.</p>
<p>Make sure the repository is placed under “KUBDatalab”, if you want it
to be part of our eco-system. Otherwise, place it wherever you want.</p>
<p>Also make sure that the repository is “Public”.</p>
<p>After GitHub have initialized the new repository based on this
template, you need to edit the “config.yaml” file.</p>
<ul>
<li>title - selfexplanatory</li>
<li>created - the date you did all this.</li>
<li>source - change it to the url of the new github-repo. This makes it
easier to edit the page in the future.</li>
<li>episodes - remove all episodes not to be included in your new
course. Change the order if necessary.</li>
</ul>
<p>Either do this directly on GitHub, or follow the usual process of
forking to your own GitHub account, and cloning the repo to your
computer.</p>
<p>You will also need to update the CITATION.cff file, otherwise the
citation will point to this site, rather than your own.</p>
<p>You can use <a href="https://citation-file-format.github.io/cff-initializer-javascript/#/" class="external-link uri">https://citation-file-format.github.io/cff-initializer-javascript/#/</a>
to edit the existing, or make a new one.</p>
<div id="consider-deleting-stuff" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="consider-deleting-stuff" class="callout-inner">
<h3 class="callout-title">Consider deleting stuff</h3>
<div class="callout-content">
<p>When the page is generated, the scripts identifies all libraries used
in all episodes. Even if these episodes will not be shown on the
page.</p>
<p>This requires the scripts to download and install all these
libraries. And that takes time!</p>
<p>If you delete all unused episodes, you will speed up the following
step considerably.</p>
</div>
</div>
</div>
<p>After you have committed your changes to config.yaml, actions begins
building the site. Have patience! The first build of the R-PUFF site
took 54 minutes.</p>
<p>Don’t worry, future changes are a lot faster. An update of the page
you are currently reading, took 6 minutes. The scripts only rebuild the
pages that are changed.</p>
<p>You can follow the process under “Actions” on the repo.</p>
<p>When all actions have run - look for the green checkmarks, go to
“Settings”, choose “Pages”.</p>
<div id="renv-messes-things-up" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<div id="renv-messes-things-up" class="callout-inner">
<h3 class="callout-title">renv messes things up!</h3>
<div class="callout-content">
<p>Sandpaper uses the renv environment manager to handle dependencies in
the packages you use. But that handling appears to be different on a
windows machine and on the virtual Linux machine that GitHub actions
uses.</p>
<p>So: DO NOT COMMIT AND PUSH ANY renv TO GITHUB. IT WILL BREAK THE
GENERATION OF THE PAGES.</p>
<p>If you do - delete the renv directory.</p>
</div>
</div>
</div>
<p>Under “Build and deployment”, we are told that the page is “deployed
from a branch”, and below that, you can choose which branch. Chose
“gh-pages”.</p>
<p>Click “Save”. GitHub actions begins again, but do not worry, this
step is very fast (depending on a lot of things, we are not paying
GitHub, so we depend on shared ressources).</p>
<div id="changes-are-local" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="changes-are-local" class="callout-inner">
<h3 class="callout-title">Changes are local</h3>
<div class="callout-content">
<p>You have made a new repo based on the master-version of the toolbox.
Any changes made to R-toolbox, will <em>not</em> affect your new
page.</p>
<p>Changes made on your new page are similarly not affecting
R-toolbox.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="editing">Editing<a class="anchor" aria-label="anchor" href="#editing"></a>
</h2>
<hr class="half-width">
<p>There are a lot of useful information on <a href="https://carpentries.github.io/sandpaper-docs" class="external-link uri">https://carpentries.github.io/sandpaper-docs</a></p>
</section><section><h2 class="section-heading" id="updating">Updating<a class="anchor" aria-label="anchor" href="#updating"></a>
</h2>
<hr class="half-width">
<p>You have a course based on this. Time have passed and there is an
update here, that you would like to incorporate in your course.</p>
<p>The easiest way to update is to simply copy the relevant episode from
here, to your own local repo. Then commit, push etc.</p>
<p>Remember that any changes you have made will be gone!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>It is fairly easy to make a new course page</li>
<li>Have patience!</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-stat-tests-1"><p>Content from <a href="stat-tests-1.html">Statistical tests</a></p>
<hr>
<p>Last updated on 2025-06-10 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/stat-tests-1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A collection of statistical tests</p>
<p>For all tests, the approach is:</p>
<ol style="list-style-type: decimal">
<li>Formulate hypotheses</li>
<li>Calculate test statistic</li>
<li>Determine p-value</li>
<li>Make decision</li>
</ol>
<p>The cutoff chosen for all tests is a p-value of 0.05 unless otherwise
indicated.</p>
<p>If a specific test is prefaced with “EJ KORREKTURLÆST” the text,
examples etc have not been checked.</p>
<section><h2 class="section-heading" id="one-sample-tests">One sample tests<a class="anchor" aria-label="anchor" href="#one-sample-tests"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="one-sample-chi-square-test">One-sample chi-square test<a class="anchor" aria-label="anchor" href="#one-sample-chi-square-test"></a>
</h3>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Details </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<div class="section level4">
<h4 id="used-for">Used for<a class="anchor" aria-label="anchor" href="#used-for"></a>
</h4>
<p>Testing whether observed categorical frequencies differ from expected
frequencies under a specified distribution.</p>
<p><strong>Real-world example:</strong> Mars Inc. claims a specific
distribution of colours in their M&amp;M bags. Does the observed
proportions in a given bag match their claim?</p>
</div>
<div class="section level4">
<h4 id="assumptions">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Categories are mutually exclusive and collectively exhaustive.</li>
<li>
<em>Expected</em> count in each category is at least 5 (for the
chi-square approximation to be valid). The observed counts can be
smaller.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths">Strengths<a class="anchor" aria-label="anchor" href="#strengths"></a>
</h4>
<ul>
<li>Simple to compute and interpret.</li>
<li>Does not require the data to be normally distributed.</li>
<li>Applicable to any number of categories.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses"></a>
</h4>
<ul>
<li>Sensitive to small expected counts.<br>
</li>
<li>Does not indicate which categories contribute most to the
discrepancy without further investigation.</li>
<li>Requires independence; cannot be used for paired or repeated
measures.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The proportions of M&amp;M
colours equal the manufacturer’s claimed distribution.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The proportion of at
least one colour differs from the claimed distribution.</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed counts of M&amp;M colors:</span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>red <span class="op">=</span> <span class="fl">20</span>, blue <span class="op">=</span> <span class="fl">25</span>, green <span class="op">=</span> <span class="fl">15</span>, brown <span class="op">=</span> <span class="fl">18</span>, orange <span class="op">=</span> <span class="fl">12</span>, yellow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manufacturer's claimed proportions:</span></span>
<span><span class="va">p_expected</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>red <span class="op">=</span> <span class="fl">0.20</span>, blue <span class="op">=</span> <span class="fl">0.20</span>, green <span class="op">=</span> <span class="fl">0.20</span>, brown <span class="op">=</span> <span class="fl">0.20</span>, orange <span class="op">=</span> <span class="fl">0.10</span>, yellow <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform one-sample chi-square goodness-of-fit test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, p <span class="op">=</span> <span class="va">p_expected</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Chi-squared test for given probabilities

data:  observed
X-squared = 3.1, df = 5, p-value = 0.6846</code></pre>
</div>
<p><em>Interpretation</em>: The test yields χ² = 3.1 with a p-value =
0.685. We fail to reject the null hypothesis”, and there is no evidence
to conclude a difference from the claimed distribution.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample z test </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<div class="section level4">
<h4 id="used-for-1">Used for<a class="anchor" aria-label="anchor" href="#used-for-1"></a>
</h4>
<ul>
<li>Testing whether the mean of a single sample differs from a known
population mean when the population standard deviation is known.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if the average
diameter of manufactured ball bearings equals the specified 5.00 cm when
σ is known. This checks if the average is different, ie either smaller
<em>or</em> larger. We can also test if it <em>is</em> smaller or
larger.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-1">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-1"></a>
</h4>
<ul>
<li>Sample is a simple random sample from the population.<br>
</li>
<li>Observations are independent.<br>
</li>
<li>Population standard deviation (σ) is known.<br>
</li>
<li>The sampling distribution of the mean is approximately normal
(either the population is normal or n is large, e.g. ≥ 30).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-1">Strengths<a class="anchor" aria-label="anchor" href="#strengths-1"></a>
</h4>
<ul>
<li>More powerful than the t-test when σ is truly known.<br>
</li>
<li>Simple calculation and interpretation.<br>
</li>
<li>Relies on the normal distribution, which is well understood.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-1">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-1"></a>
</h4>
<ul>
<li>The true population σ is only very rarely known in practice.<br>
</li>
<li>Sensitive to departures from normality for small samples.<br>
</li>
<li>Misspecification of σ leads to incorrect inferences.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-1">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-1"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The true mean diameter μ =
5.00 cm.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ ≠ 5.00 cm.</li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample of diameters (cm) for 25 ball bearings:</span></span>
<span><span class="va">diameters</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.03</span>, <span class="fl">4.97</span>, <span class="fl">5.01</span>, <span class="fl">5.05</span>, <span class="fl">4.99</span>, <span class="fl">5.02</span>, <span class="fl">5.00</span>, <span class="fl">5.04</span>, <span class="fl">4.96</span>, <span class="fl">5.00</span>,</span>
<span>               <span class="fl">5.01</span>, <span class="fl">4.98</span>, <span class="fl">5.02</span>, <span class="fl">5.03</span>, <span class="fl">4.94</span>, <span class="fl">5.00</span>, <span class="fl">5.02</span>, <span class="fl">4.99</span>, <span class="fl">5.01</span>, <span class="fl">5.03</span>,</span>
<span>               <span class="fl">4.98</span>, <span class="fl">5.00</span>, <span class="fl">5.04</span>, <span class="fl">4.97</span>, <span class="fl">5.02</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Known population standard deviation:</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co"># Hypothesized mean:</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">5.00</span></span>
<span></span>
<span><span class="co"># Compute test statistic:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">diameters</span><span class="op">)</span></span>
<span><span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">diameters</span><span class="op">)</span></span>
<span><span class="va">z_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xbar</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">/</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two-sided p-value:</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Larger p-value</span></span>
<span><span class="va">larger_p_value</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Smaller p-value</span></span>
<span><span class="va">smaller_p_value</span> <span class="op">&lt;-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">z_stat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output results:</span></span>
<span><span class="va">z_stat</span>; <span class="va">p_value</span>; <span class="va">larger_p_value</span>; <span class="va">smaller_p_value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.44</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.6599371</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3299686</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.6700314</code></pre>
</div>
<p>Interpretation: The sample mean is 5.004 cm. The z-statistic is 0.44
with a two-sided p-value of 0.66. We fail to reject the null hypothesis.
Thus, there is no evidence to conclude a difference from the specified
diameter of 5.00 cm.</p>
<p>We can similarly reject the hypothesis that the average diameter is
larger (p = 0.3299686) or that it is smaller (p = 0.6700314)</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample t test </h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<p>EJ KORREKTURLÆST!</p>
<p>Her kan vi nok med fordel bruge samme eksempel som i z-testen.</p>
<div class="section level4">
<h4 id="used-for-2">Used for<a class="anchor" aria-label="anchor" href="#used-for-2"></a>
</h4>
<ul>
<li>Testing whether the mean of a single sample differs from a known or
hypothesized population mean when the population standard deviation is
unknown.<br>
</li>
<li>
<strong>Real-world example:</strong> Determining if the average exam
score of a class differs from the passing threshold of 70%.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-2">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-2"></a>
</h4>
<ul>
<li>Sample is a simple random sample from the population.<br>
</li>
<li>Observations are independent.<br>
</li>
<li>The data are approximately normally distributed (especially
important for small samples; n ≥ 30 reduces sensitivity).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-2">Strengths<a class="anchor" aria-label="anchor" href="#strengths-2"></a>
</h4>
<ul>
<li>Does not require knowing the population standard deviation.<br>
</li>
<li>Robust to mild departures from normality for moderate-to-large
sample sizes.<br>
</li>
<li>Widely applicable and easily implemented.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-2">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-2"></a>
</h4>
<ul>
<li>Sensitive to outliers in small samples.<br>
</li>
<li>Performance degrades if normality assumption is seriously violated
and n is small.<br>
</li>
<li>Degrees of freedom reduce power relative to z-test.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-2">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-2"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The true mean exam score μ =
70.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ ≠ 70.</li>
</ul>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample of exam scores for 20 students:</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">68</span>, <span class="fl">74</span>, <span class="fl">71</span>, <span class="fl">69</span>, <span class="fl">73</span>, <span class="fl">65</span>, <span class="fl">77</span>, <span class="fl">72</span>, <span class="fl">70</span>, <span class="fl">66</span>,</span>
<span>            <span class="fl">75</span>, <span class="fl">68</span>, <span class="fl">71</span>, <span class="fl">69</span>, <span class="fl">74</span>, <span class="fl">67</span>, <span class="fl">72</span>, <span class="fl">70</span>, <span class="fl">73</span>, <span class="fl">68</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hypothesized mean:</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">70</span></span>
<span></span>
<span><span class="co"># Perform one-sample t-test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, mu <span class="op">=</span> <span class="va">mu0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	One Sample t-test

data:  scores
t = 0.84675, df = 19, p-value = 0.4077
alternative hypothesis: true mean is not equal to 70
95 percent confidence interval:
 69.1169 72.0831
sample estimates:
mean of x
     70.6 </code></pre>
</div>
<p>Interpretation: The sample mean is 70.6. The t-statistic is 0.85 with
19 degrees of freedom and a two-sided p-value of 0.408. We fail to
reject the null hypothesis. Thus, there is no evidence to conclude the
average score differs from the passing threshold of 70.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler4" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler4" aria-expanded="false" aria-controls="collapseSpoiler4">
  <h3 class="accordion-header" id="headingSpoiler4">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample Poisson test </h3>
</button>
<div id="collapseSpoiler4" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler4" aria-labelledby="headingSpoiler4">
<div class="accordion-body">
<p>EJ KORREKTURLÆST!</p>
<div class="section level4">
<h4 id="used-for-3">Used for<a class="anchor" aria-label="anchor" href="#used-for-3"></a>
</h4>
<ul>
<li>Testing whether the observed count of events in a fixed period
differs from a hypothesized Poisson rate.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if the number of
customer arrivals per hour at a call center matches the expected rate of
30 calls/hour.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-3">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-3"></a>
</h4>
<ul>
<li>Events occur independently.<br>
</li>
<li>The rate of occurrence (λ) is constant over the observation
period.<br>
</li>
<li>The count of events in non-overlapping intervals is
independent.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-3">Strengths<a class="anchor" aria-label="anchor" href="#strengths-3"></a>
</h4>
<ul>
<li>Exact test based on the Poisson distribution (no large-sample
approximation needed).<br>
</li>
<li>Valid for small counts and rare events.<br>
</li>
<li>Simple to implement in R via <code>poisson.test()</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-3">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-3"></a>
</h4>
<ul>
<li>Sensitive to violations of the Poisson assumptions (e.g.,
overdispersion or time-varying rate).<br>
</li>
<li>Only assesses the overall rate, not the dispersion or clustering of
events.<br>
</li>
<li>Cannot handle covariates or more complex rate structures.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-3">Example<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-3">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-3"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The event rate λ = 30
calls/hour.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> λ ≠ 30
calls/hour.</li>
</ul>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed number of calls in one hour:</span></span>
<span><span class="va">observed_calls</span> <span class="op">&lt;-</span> <span class="fl">36</span></span>
<span></span>
<span><span class="co"># Hypothesized rate (calls per hour):</span></span>
<span><span class="va">lambda0</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="co"># Perform one-sample Poisson test (two-sided):</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed_calls</span>, T <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="va">lambda0</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact Poisson test

data:  observed_calls time base: 1
number of events = 36, time base = 1, p-value = 0.272
alternative hypothesis: true event rate is not equal to 30
95 percent confidence interval:
 25.21396 49.83917
sample estimates:
event rate
        36 </code></pre>
</div>
<p>Interpretation: The test reports an observed count of 36 calls versus
an expected 30 calls, yielding a p-value of 0.272. We fail to reject the
null hypothesis. Thus, there is no evidence to conclude the call rate
differs from 30 calls/hour.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler5" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler5" aria-expanded="false" aria-controls="collapseSpoiler5">
  <h3 class="accordion-header" id="headingSpoiler5">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Shapiro–Wilk test for normality </h3>
</button>
<div id="collapseSpoiler5" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler5" aria-labelledby="headingSpoiler5">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-4">Used for<a class="anchor" aria-label="anchor" href="#used-for-4"></a>
</h4>
<ul>
<li>Testing whether a sample comes from a normally distributed
population.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if the distribution of
daily blood glucose measurements in a patient cohort is approximately
normal.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-4">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-4"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Data are continuous.<br>
</li>
<li>No extreme ties or many identical values.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-4">Strengths<a class="anchor" aria-label="anchor" href="#strengths-4"></a>
</h4>
<ul>
<li>Good power for detecting departures from normality in small to
moderate samples (n ≤ 50).<br>
</li>
<li>Widely implemented and easy to run in R.<br>
</li>
<li>Provides both a test statistic (W) and p-value.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-4">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-4"></a>
</h4>
<ul>
<li>Very sensitive to even slight deviations from normality in large
samples (n &gt; 2000).<br>
</li>
<li>Does not indicate the nature of the departure (e.g., skewness
vs. kurtosis).<br>
</li>
<li>Ties or repeated values can invalidate the test.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-4">Example<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-4">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-4"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The sample is drawn from a
normal distribution.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The sample is not
drawn from a normal distribution.</li>
</ul>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a sample of 30 observations from a normal distribution:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Shapiro–Wilk test:</span></span>
<span><span class="va">sw_result</span> <span class="op">&lt;-</span> <span class="fu">shapiro.test</span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">sw_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Shapiro-Wilk normality test

data:  sample_data
W = 0.97894, p-value = 0.7966</code></pre>
</div>
<p>Interpretation: The Shapiro–Wilk statistic W = 0.979 with p-value =
0.797. We fail to reject the null hypothesis. Thus, there is no evidence
to conclude a departure from normality.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler6" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler6" aria-expanded="false" aria-controls="collapseSpoiler6">
  <h3 class="accordion-header" id="headingSpoiler6">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kolmogorov–Smirnov én-prøve-test (goodness-of-fit) </h3>
</button>
<div id="collapseSpoiler6" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler6" aria-labelledby="headingSpoiler6">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-5">Used for<a class="anchor" aria-label="anchor" href="#used-for-5"></a>
</h4>
<ul>
<li>Testing whether a sample comes from a specified continuous
distribution.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if patient systolic
blood pressures follow a normal distribution with mean 120 mmHg and SD
15 mmHg.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-5">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-5"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Data are continuous (no ties).<br>
</li>
<li>The null distribution is fully specified (parameters known, not
estimated from the data).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-5">Strengths<a class="anchor" aria-label="anchor" href="#strengths-5"></a>
</h4>
<ul>
<li>Nonparametric: makes no assumption about distribution shape beyond
continuity.<br>
</li>
<li>Sensitive to any kind of departure (location, scale, shape).<br>
</li>
<li>Exact distribution of the test statistic under H₀.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-5">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-5"></a>
</h4>
<ul>
<li>Requires that distribution parameters (e.g., mean, SD) are known a
priori; if estimated from data, p-values are invalid.<br>
</li>
<li>Less powerful than parametric tests when the parametric form is
correct.<br>
</li>
<li>Sensitive to ties and discrete data.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-5">Example<a class="anchor" aria-label="anchor" href="#example-5"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-5">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-5"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The blood pressure values
follow a Normal(μ = 120, σ = 15) distribution.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The blood pressure
values do not follow Normal(120, 15).</li>
</ul>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate systolic blood pressure for 40 patients:</span></span>
<span><span class="va">sample_bp</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform one-sample Kolmogorov–Smirnov test against N(120,15):</span></span>
<span><span class="va">ks_result</span> <span class="op">&lt;-</span> <span class="fu">ks.test</span><span class="op">(</span><span class="va">sample_bp</span>, <span class="st">"pnorm"</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show results:</span></span>
<span><span class="va">ks_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact one-sample Kolmogorov-Smirnov test

data:  sample_bp
D = 0.11189, p-value = 0.6573
alternative hypothesis: two-sided</code></pre>
</div>
<p>Interpretation: The KS statistic D = 0.112 with p-value = 0.657. We
fail to reject the null hypothesis. Thus, there is no evidence to
conclude deviation from Normal(120,15).</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler7" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler7" aria-expanded="false" aria-controls="collapseSpoiler7">
  <h3 class="accordion-header" id="headingSpoiler7">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> χ² goodness-of-fit test </h3>
</button>
<div id="collapseSpoiler7" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler7" aria-labelledby="headingSpoiler7">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-6">Used for<a class="anchor" aria-label="anchor" href="#used-for-6"></a>
</h4>
<ul>
<li>Testing whether observed categorical frequencies differ from
expected categorical proportions.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing the distribution of
blood types in a sample of donors to known population proportions.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-6">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-6"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Categories are mutually exclusive and exhaustive.<br>
</li>
<li>Expected count in each category is at least 5 for the chi-square
approximation to hold.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-6">Strengths<a class="anchor" aria-label="anchor" href="#strengths-6"></a>
</h4>
<ul>
<li>Simple to compute and interpret.<br>
</li>
<li>Nonparametric: no requirement of normality.<br>
</li>
<li>Flexible for any number of categories.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-6">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-6"></a>
</h4>
<ul>
<li>Sensitive to small expected counts (invalidates
approximation).<br>
</li>
<li>Doesn’t identify which categories drive the discrepancy without
further post-hoc tests.<br>
</li>
<li>Requires independence—unsuitable for paired or repeated
measures.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-6">Example<a class="anchor" aria-label="anchor" href="#example-6"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-6">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-6"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The sample blood type
proportions equal the known population proportions (A=0.42, B=0.10,
AB=0.04, O=0.44).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one blood
type proportion differs from its known value.</li>
</ul>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed counts of blood types in 200 donors:</span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>A <span class="op">=</span> <span class="fl">85</span>, B <span class="op">=</span> <span class="fl">18</span>, AB <span class="op">=</span> <span class="fl">6</span>, O <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Known population proportions:</span></span>
<span><span class="va">p_expected</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.42</span>, B <span class="op">=</span> <span class="fl">0.10</span>, AB <span class="op">=</span> <span class="fl">0.04</span>, O <span class="op">=</span> <span class="fl">0.44</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform chi-square goodness-of-fit test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, p <span class="op">=</span> <span class="va">p_expected</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Chi-squared test for given probabilities

data:  observed
X-squared = 0.81418, df = 3, p-value = 0.8461</code></pre>
</div>
<p>Interpretation: The test yields χ² = 0.81 with p-value = 0.846. We
fail to reject the null hypothesis. Thus, there is no evidence to
conclude the sample proportions differ from the population.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="to-prøve-tests-og-parrede-tests">To-prøve-tests og parrede tests<a class="anchor" aria-label="anchor" href="#to-pr%C3%B8ve-tests-og-parrede-tests"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler8" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler8" aria-expanded="false" aria-controls="collapseSpoiler8">
  <h3 class="accordion-header" id="headingSpoiler8">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample F test for variance </h3>
</button>
<div id="collapseSpoiler8" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler8" aria-labelledby="headingSpoiler8">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<p>We use this when we want to determine if two independent samples
originate from populations with the same variance.</p>
<div class="section level4">
<h4 id="used-for-7">Used for<a class="anchor" aria-label="anchor" href="#used-for-7"></a>
</h4>
<ul>
<li>Testing whether two independent samples have equal variances.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing the variability in
systolic blood pressure measurements between two clinics.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-7">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-7"></a>
</h4>
<ul>
<li>Both samples consist of independent observations.<br>
</li>
<li>Each sample is drawn from a normally distributed population.<br>
</li>
<li>Samples are independent of one another.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-7">Strengths<a class="anchor" aria-label="anchor" href="#strengths-7"></a>
</h4>
<ul>
<li>Simple calculation and interpretation.<br>
</li>
<li>Directly targets variance equality, a key assumption in many
downstream tests (e.g., t-test).<br>
</li>
<li>Exact inference under normality.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-7">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-7"></a>
</h4>
<ul>
<li>Highly sensitive to departures from normality.<br>
</li>
<li>Only compares variance—doesn’t assess other distributional
differences.<br>
</li>
<li>Not robust to outliers.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-7">Example<a class="anchor" aria-label="anchor" href="#example-7"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-7">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-7"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> σ₁² = σ₂² (the two population
variances are equal).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> σ₁² ≠ σ₂² (the
variances differ).</li>
</ul>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate systolic BP (mmHg) from two clinics:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">clinicA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">clinicB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">118</span>, sd <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform two-sample F-test for variances:</span></span>
<span><span class="va">f_result</span> <span class="op">&lt;-</span> <span class="fu">var.test</span><span class="op">(</span><span class="va">clinicA</span>, <span class="va">clinicB</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">f_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	F test to compare two variances

data:  clinicA and clinicB
F = 0.41748, num df = 29, denom df = 24, p-value = 0.02606
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.1882726 0.8992623
sample estimates:
ratio of variances
         0.4174837 </code></pre>
</div>
<p>The F statistic is 0.417 with numerator df = 29 and denominator df =
24, and p-value = 0.0261. We</p>
<p>reject the null hypothesis. Thus, there is evidence that the
variability in blood pressure differs between the two clinics.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler9" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler9" aria-expanded="false" aria-controls="collapseSpoiler9">
  <h3 class="accordion-header" id="headingSpoiler9">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Paired t-test </h3>
</button>
<div id="collapseSpoiler9" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler9" aria-labelledby="headingSpoiler9">
<div class="accordion-body">
<p>EJ KORREKTURLÆST #### Used for - Testing whether the mean difference
between two related (paired) samples differs from zero.<br>
- <strong>Real-world example:</strong> Comparing patients’ blood
pressure before and after administering a new medication.</p>
<div class="section level4">
<h4 id="assumptions-8">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-8"></a>
</h4>
<ul>
<li>Paired observations are independent of other pairs.<br>
</li>
<li>Differences between pairs are approximately normally
distributed.<br>
</li>
<li>The scale of measurement is continuous (interval or ratio).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-8">Strengths<a class="anchor" aria-label="anchor" href="#strengths-8"></a>
</h4>
<ul>
<li>Controls for between‐subject variability by using each subject as
their own control.<br>
</li>
<li>More powerful than unpaired tests when pairs are truly
dependent.<br>
</li>
<li>Easy to implement and interpret.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-8">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-8"></a>
</h4>
<ul>
<li>Sensitive to outliers in the difference scores.<br>
</li>
<li>Requires that differences be approximately normal, especially for
small samples.<br>
</li>
<li>Not appropriate if pairing is not justified or if missing data break
pairs.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-8">Example<a class="anchor" aria-label="anchor" href="#example-8"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-8">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-8"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The mean difference Δ = 0 (no
change in blood pressure).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Δ ≠ 0 (blood pressure
changes after medication).</li>
</ul>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated systolic blood pressure (mmHg) for 15 patients before and after treatment:</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">142</span>, <span class="fl">138</span>, <span class="fl">150</span>, <span class="fl">145</span>, <span class="fl">133</span>, <span class="fl">140</span>, <span class="fl">147</span>, <span class="fl">139</span>, <span class="fl">141</span>, <span class="fl">136</span>, <span class="fl">144</span>, <span class="fl">137</span>, <span class="fl">148</span>, <span class="fl">142</span>, <span class="fl">139</span><span class="op">)</span></span>
<span><span class="va">after</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">135</span>, <span class="fl">132</span>, <span class="fl">144</span>, <span class="fl">138</span>, <span class="fl">128</span>, <span class="fl">135</span>, <span class="fl">142</span>, <span class="fl">133</span>, <span class="fl">136</span>, <span class="fl">130</span>, <span class="fl">139</span>, <span class="fl">132</span>, <span class="fl">143</span>, <span class="fl">137</span>, <span class="fl">133</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform paired t-test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">before</span>, <span class="va">after</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Paired t-test

data:  before and after
t = 29.437, df = 14, p-value = 5.418e-14
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 5.19198 6.00802
sample estimates:
mean difference
            5.6 </code></pre>
</div>
<p>Interpretation: The mean difference (before – after) is 5.6 mmHg. The
t‐statistic is 29.44 with 14 degrees of freedom and a two‐sided p‐value
of<code>r signif(test_result$p.value, 3)</code>. We reject the null
hypothesis. Thus, there is evidence that the medication significantly
changed blood pressure.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler10" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler10" aria-expanded="false" aria-controls="collapseSpoiler10">
  <h3 class="accordion-header" id="headingSpoiler10">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample t test (equal variances) </h3>
</button>
<div id="collapseSpoiler10" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler10" aria-labelledby="headingSpoiler10">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-8">Used for<a class="anchor" aria-label="anchor" href="#used-for-8"></a>
</h4>
<ul>
<li>Testing whether the means of two independent samples differ,
assuming equal variances.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing average systolic
blood pressure between male and female patients when variability is
similar.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-9">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-9"></a>
</h4>
<ul>
<li>Observations in each group are independent.<br>
</li>
<li>Both populations are normally distributed (especially important for
small samples).<br>
</li>
<li>The two populations have equal variances (homoscedasticity).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-9">Strengths<a class="anchor" aria-label="anchor" href="#strengths-9"></a>
</h4>
<ul>
<li>More powerful than Welch’s t-test when variances truly are
equal.<br>
</li>
<li>Simple computation and interpretation via pooled variance.<br>
</li>
<li>Widely implemented and familiar to practitioners.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-9">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-9"></a>
</h4>
<ul>
<li>Sensitive to violations of normality in small samples.<br>
</li>
<li>Incorrect if variances differ substantially—can inflate Type I
error.<br>
</li>
<li>Assumes homogeneity of variance, which may not hold in
practice.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-9">Example<a class="anchor" aria-label="anchor" href="#example-9"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-9">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-9"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> μ₁ = μ₂ (the two population
means are equal).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ₁ ≠ μ₂ (the means
differ).</li>
</ul>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate systolic BP (mmHg):</span></span>
<span><span class="va">groupA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">122</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># e.g., males</span></span>
<span><span class="va">groupB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">118</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># e.g., females</span></span>
<span></span>
<span><span class="co"># Perform two-sample t-test with equal variances:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">groupA</span>, <span class="va">groupB</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Two Sample t-test

data:  groupA and groupB
t = 2.6245, df = 48, p-value = 0.0116
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
  1.733091 13.086377
sample estimates:
mean of x mean of y
 125.2119  117.8021 </code></pre>
</div>
<p>Interpretation: The pooled estimate of the difference in means is
7.41 mmHg. The t-statistic is 2.62 with df = 48 and p-value = 0.0116. We
reject the null hypothesis. Thus, there is evidence that the average
systolic blood pressure differs between the two groups.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler11" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler11" aria-expanded="false" aria-controls="collapseSpoiler11">
  <h3 class="accordion-header" id="headingSpoiler11">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample t test (unequal variances) </h3>
</button>
<div id="collapseSpoiler11" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler11" aria-labelledby="headingSpoiler11">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-9">Used for<a class="anchor" aria-label="anchor" href="#used-for-9"></a>
</h4>
<ul>
<li>Testing whether the means of two independent samples differ when
variances are unequal.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing average recovery
times for two different therapies when one therapy shows more variable
outcomes.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-10">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-10"></a>
</h4>
<ul>
<li>Observations in each group are independent.<br>
</li>
<li>Each population is approximately normally distributed (especially
important for small samples).<br>
</li>
<li>Does <strong>not</strong> assume equal variances across groups.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-10">Strengths<a class="anchor" aria-label="anchor" href="#strengths-10"></a>
</h4>
<ul>
<li>Controls Type I error when variances differ.<br>
</li>
<li>More reliable than the pooled‐variance t‐test under
heteroskedasticity.<br>
</li>
<li>Simple to implement via <code>t.test(..., var.equal = FALSE)</code>
in R.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-10">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-10"></a>
</h4>
<ul>
<li>Slight loss of power compared to equal-variance t‐test when
variances truly are equal.<br>
</li>
<li>Sensitive to departures from normality in small samples.<br>
</li>
<li>Degrees of freedom are approximated (Welch–Satterthwaite), which can
reduce interpretability.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-10">Example<a class="anchor" aria-label="anchor" href="#example-10"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-10">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-10"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> μ₁ = μ₂ (the two population
means are equal).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> μ₁ ≠ μ₂ (the means
differ).</li>
</ul>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate recovery times (days) for two therapies:</span></span>
<span><span class="va">therapyA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co"># Therapy A</span></span>
<span><span class="va">therapyB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>   <span class="co"># Therapy B (more variable)</span></span>
<span></span>
<span><span class="co"># Perform two-sample t-test with unequal variances:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">therapyA</span>, <span class="va">therapyB</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  therapyA and therapyB
t = -1.7792, df = 32.794, p-value = 0.08449
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -3.8148079  0.2558875
sample estimates:
mean of x mean of y
 10.41320  12.19266 </code></pre>
</div>
<p>Interpretation: The estimated difference in means is -1.78 days. The
Welch t‐statistic is<code>r round(test_result$statistic, 2)</code> with
df ≈ 32.8 and two‐sided p‐value
=<code>r signif(test_result$p.value, 3</code>). We fail to reject the
null hypothesis. Thus, there is no evidence of a difference in average
recovery times..</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler12" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler12" aria-expanded="false" aria-controls="collapseSpoiler12">
  <h3 class="accordion-header" id="headingSpoiler12">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Mann–Whitney U-test (Wilcoxon rank-sum) </h3>
</button>
<div id="collapseSpoiler12" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler12" aria-labelledby="headingSpoiler12">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-10">Used for<a class="anchor" aria-label="anchor" href="#used-for-10"></a>
</h4>
<ul>
<li>Comparing the central tendencies of two independent samples when the
data are ordinal or not normally distributed.<br>
</li>
<li>
<strong>Real-world example:</strong> Testing whether pain scores
(0–10) differ between patients receiving Drug A versus Drug B when
scores are skewed.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-11">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-11"></a>
</h4>
<ul>
<li>Observations are independent both within and between groups.<br>
</li>
<li>The response variable is at least ordinal.<br>
</li>
<li>The two distributions have the same shape (so that differences
reflect location shifts).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-11">Strengths<a class="anchor" aria-label="anchor" href="#strengths-11"></a>
</h4>
<ul>
<li>Nonparametric: does not require normality or equal variances.<br>
</li>
<li>Robust to outliers and skewed data.<br>
</li>
<li>Simple rank-based calculation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-11">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-11"></a>
</h4>
<ul>
<li>Less powerful than t-test when data are truly normal.<br>
</li>
<li>If distributions differ in shape as well as location, interpretation
becomes ambiguous.<br>
</li>
<li>Only tests for location shift, not differences in dispersion.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-11">Example<a class="anchor" aria-label="anchor" href="#example-11"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-11">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-11"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The distributions of pain
scores are identical for Drug A and Drug B.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The distributions
differ in location (median pain differs between drugs).</li>
</ul>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate pain scores (0–10) for two independent groups:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">drugA</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">4</span>,  <span class="co"># skewed lower</span></span>
<span>           <span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">drugB</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">7</span>,  <span class="co"># skewed higher</span></span>
<span>           <span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Mann–Whitney U test (Wilcoxon rank-sum):</span></span>
<span><span class="va">mw_result</span> <span class="op">&lt;-</span> <span class="fu">wilcox.test</span><span class="op">(</span><span class="va">drugA</span>, <span class="va">drugB</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">mw_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Wilcoxon rank sum test with continuity correction

data:  drugA and drugB
W = 20.5, p-value = 9.123e-07
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<p>Interpretation: The Wilcoxon rank-sum statistic W = 20.5 with p-value
= 9.12^{-7}. We reject the null hypothesis. Thus, there is evidence that
median pain scores differ between Drug A and Drug B.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler13" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler13" aria-expanded="false" aria-controls="collapseSpoiler13">
  <h3 class="accordion-header" id="headingSpoiler13">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Wilcoxon signed-rank test </h3>
</button>
<div id="collapseSpoiler13" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler13" aria-labelledby="headingSpoiler13">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-11">Used for<a class="anchor" aria-label="anchor" href="#used-for-11"></a>
</h4>
<ul>
<li>Testing whether the median difference between paired observations is
zero.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing patients’ pain scores
before and after a new analgesic treatment when differences may not be
normally distributed.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-12">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-12"></a>
</h4>
<ul>
<li>Observations are paired and the pairs are independent.<br>
</li>
<li>Differences are at least ordinal and symmetrically distributed
around the median.<br>
</li>
<li>No large number of exact zero differences (ties).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-12">Strengths<a class="anchor" aria-label="anchor" href="#strengths-12"></a>
</h4>
<ul>
<li>Nonparametric: does not require normality of differences.<br>
</li>
<li>Controls for within‐subject variability by using paired
design.<br>
</li>
<li>Robust to outliers in the paired differences.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-12">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-12"></a>
</h4>
<ul>
<li>Less powerful than the paired t-test when differences are truly
normal.<br>
</li>
<li>Requires symmetry of the distribution of differences.<br>
</li>
<li>Cannot easily handle many tied differences.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-12">Example<a class="anchor" aria-label="anchor" href="#example-12"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-12">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-12"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The median difference in pain
score (before – after) = 0 (no change).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The median difference
≠ 0 (pain changes after treatment).</li>
</ul>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated pain scores (0–10) for 12 patients:</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">after</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Wilcoxon signed-rank test:</span></span>
<span><span class="va">wsr_result</span> <span class="op">&lt;-</span> <span class="fu">wilcox.test</span><span class="op">(</span><span class="va">before</span>, <span class="va">after</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">wsr_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Wilcoxon signed rank test with continuity correction

data:  before and after
V = 66, p-value = 0.001586
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<p>Interpretation: The Wilcoxon signed‐rank test statistic V =66 with
p-value =<code>r signif(wsr_result$p.value, 3)</code>. We reject the
null hypothesis. Thus, there is evidence that median pain scores change
after treatment..</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler14" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler14" aria-expanded="false" aria-controls="collapseSpoiler14">
  <h3 class="accordion-header" id="headingSpoiler14">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kolmogorov–Smirnov two-sample-test </h3>
</button>
<div id="collapseSpoiler14" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler14" aria-labelledby="headingSpoiler14">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-12">Used for<a class="anchor" aria-label="anchor" href="#used-for-12"></a>
</h4>
<ul>
<li>Testing whether two independent samples come from the same
continuous distribution.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing the distribution of
recovery times for patients receiving Drug A versus Drug B.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-13">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-13"></a>
</h4>
<ul>
<li>Observations in each sample are independent.<br>
</li>
<li>Data are continuous with no ties.<br>
</li>
<li>The two samples are drawn from fully specified continuous
distributions (no parameters estimated from the same data).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-13">Strengths<a class="anchor" aria-label="anchor" href="#strengths-13"></a>
</h4>
<ul>
<li>Nonparametric: makes no assumption about the shape of the
distribution.<br>
</li>
<li>Sensitive to differences in location, scale, or overall shape.<br>
</li>
<li>Exact distribution under the null when samples are not too
large.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-13">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-13"></a>
</h4>
<ul>
<li>Less powerful than parametric alternatives if the true form is known
(e.g., t-test for normal data).<br>
</li>
<li>Invalid p-values if there are ties or discrete data.<br>
</li>
<li>Does not indicate how distributions differ—only that they do.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-13">Example<a class="anchor" aria-label="anchor" href="#example-13"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-13">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-13"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The two samples come from the
same distribution.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The two samples come
from different distributions.</li>
</ul>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate recovery times (days) for two therapies:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">therapyA</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co"># Therapy A</span></span>
<span><span class="va">therapyB</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>   <span class="co"># Therapy B</span></span>
<span></span>
<span><span class="co"># Perform two-sample Kolmogorov–Smirnov test:</span></span>
<span><span class="va">ks_result</span> <span class="op">&lt;-</span> <span class="fu">ks.test</span><span class="op">(</span><span class="va">therapyA</span>, <span class="va">therapyB</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">ks_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Asymptotic two-sample Kolmogorov-Smirnov test

data:  therapyA and therapyB
D = 0.43333, p-value = 0.007153
alternative hypothesis: two-sided</code></pre>
</div>
<p>Interpretation: The KS statistic D = 0.433 with p-value = 0.00715. We
reject the null hypothesis. Thus, there is evidence that the
distribution of recovery times differs between therapies.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler15" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler15" aria-expanded="false" aria-controls="collapseSpoiler15">
  <h3 class="accordion-header" id="headingSpoiler15">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Levene’s test for homoskedasticitet </h3>
</button>
<div id="collapseSpoiler15" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler15" aria-labelledby="headingSpoiler15">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-13">Used for<a class="anchor" aria-label="anchor" href="#used-for-13"></a>
</h4>
<ul>
<li>Testing whether multiple groups have equal variances.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if the variability in
patient blood pressure differs between three different clinics.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-14">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-14"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>The underlying distributions within each group are approximately
symmetric (Levene’s test is robust to non-normality but assumes no
extreme skew).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-14">Strengths<a class="anchor" aria-label="anchor" href="#strengths-14"></a>
</h4>
<ul>
<li>More robust to departures from normality than Bartlett’s test.<br>
</li>
<li>Applicable to two or more groups.<br>
</li>
<li>Simple to implement and interpret.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-14">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-14"></a>
</h4>
<ul>
<li>Less powerful than tests that assume normality when data truly are
normal.<br>
</li>
<li>Can be sensitive to extreme outliers despite its robustness.<br>
</li>
<li>Does not indicate which groups differ in variance without follow-up
comparisons.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-14">Example<a class="anchor" aria-label="anchor" href="#example-14"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-14">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-14"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> All groups have equal
variances (σ₁² = σ₂² = … = σₖ²).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group’s
variance differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data for three groups (n = 10 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">group</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"ClinicA"</span>, <span class="st">"ClinicB"</span>, <span class="st">"ClinicC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>             <span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>             <span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>      <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">group</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Levene’s test for homogeneity of variances:</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">car</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: carData</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">levene_result</span> <span class="op">&lt;-</span> <span class="fu">leveneTest</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show results:</span></span>
<span><span class="va">levene_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2   0.872 0.4296
      27               </code></pre>
</div>
<p>Interpretation: Levene’s test yields an F-statistic of 0.87 with a
p-value of 0.43. We fail to reject the null hypothesis. This means there
is no evidence of differing variances across clinics.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler16" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler16" aria-expanded="false" aria-controls="collapseSpoiler16">
  <h3 class="accordion-header" id="headingSpoiler16">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Bartlett’s test for homoskedasticitet </h3>
</button>
<div id="collapseSpoiler16" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler16" aria-labelledby="headingSpoiler16">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-14">Used for<a class="anchor" aria-label="anchor" href="#used-for-14"></a>
</h4>
<ul>
<li>Testing whether multiple groups have equal variances under the
assumption of normality.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if the variability in
laboratory test results differs across three different
laboratories.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-15">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-15"></a>
</h4>
<ul>
<li>Observations within each group are independent.<br>
</li>
<li>Each group is drawn from a normally distributed population.<br>
</li>
<li>Groups are independent of one another.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-15">Strengths<a class="anchor" aria-label="anchor" href="#strengths-15"></a>
</h4>
<ul>
<li>More powerful than Levene’s test when normality holds.<br>
</li>
<li>Directly targets equality of variances under the normal model.<br>
</li>
<li>Simple to compute in R via <code>bartlett.test()</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-15">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-15"></a>
</h4>
<ul>
<li>Highly sensitive to departures from normality—small deviations can
inflate Type I error.<br>
</li>
<li>Does not indicate which groups differ without further pairwise
testing.<br>
</li>
<li>Not robust to outliers.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-15">Example<a class="anchor" aria-label="anchor" href="#example-15"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-15">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-15"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> All group variances are equal
(σ₁² = σ₂² = σ₃²).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group
variance differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data for three laboratories (n = 12 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">lab</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"LabA"</span>, <span class="st">"LabB"</span>, <span class="st">"LabC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">values</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>              <span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>              <span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>       <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">lab</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Bartlett’s test for homogeneity of variances:</span></span>
<span><span class="va">bartlett_result</span> <span class="op">&lt;-</span> <span class="fu">bartlett.test</span><span class="op">(</span><span class="va">values</span> <span class="op">~</span> <span class="va">lab</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">bartlett_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Bartlett test of homogeneity of variances

data:  values by lab
Bartlett's K-squared = 10.387, df = 2, p-value = 0.005552</code></pre>
</div>
<p>Interpretation: Bartlett’s K-squared = 10.39 with df = 2 and p-value
= 0.00555. We reject the null hypothesis. Thus, there is evidence that
at least one laboratory’s variance differs from the others.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="variansanalyse-anovaancova">Variansanalyse (ANOVA/ANCOVA)<a class="anchor" aria-label="anchor" href="#variansanalyse-anovaancova"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler17" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler17" aria-expanded="false" aria-controls="collapseSpoiler17">
  <h3 class="accordion-header" id="headingSpoiler17">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-way ANOVA </h3>
</button>
<div id="collapseSpoiler17" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler17" aria-labelledby="headingSpoiler17">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-15">Used for<a class="anchor" aria-label="anchor" href="#used-for-15"></a>
</h4>
<ul>
<li>Testing whether the means of three or more independent groups
differ.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing average test scores
among students taught by three different teaching methods.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-16">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-16"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Each group’s residuals are approximately normally distributed.<br>
</li>
<li>Homogeneity of variances across groups.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-16">Strengths<a class="anchor" aria-label="anchor" href="#strengths-16"></a>
</h4>
<ul>
<li>Controls Type I error rate when comparing multiple groups.<br>
</li>
<li>Simple to compute and interpret via F-statistic.<br>
</li>
<li>Foundation for many extensions (e.g., factorial ANOVA, mixed
models).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-16">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-16"></a>
</h4>
<ul>
<li>Sensitive to heterogeneity of variances, especially with unequal
group sizes.<br>
</li>
<li>Only tells you that at least one mean differs—does not indicate
which groups differ without post-hoc tests.<br>
</li>
<li>Assumes normality; moderately robust for large samples, but small
samples can be problematic.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-16">Example<a class="anchor" aria-label="anchor" href="#example-16"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-16">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-16"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> μ₁ = μ₂ = μ₃ (all three group
means are equal).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group
mean differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate exam scores for three teaching methods (n = 20 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Lecture"</span>, <span class="st">"Online"</span>, <span class="st">"Hybrid"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">75</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">80</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">78</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>     <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">method</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANOVA:</span></span>
<span><span class="va">anova_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">method</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize ANOVA table:</span></span>
<span><span class="va">anova_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">anova_fit</span><span class="op">)</span></span>
<span><span class="va">anova_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
method       2    146   72.79   1.184  0.314
Residuals   57   3505   61.48               </code></pre>
</div>
<p>Interpretation: The ANOVA yields F = 1.18 with df₁
=<code>r anova_summary[[1]]["method","Df"]</code> and df₂
=<code>r anova_summary[[1]]["Residuals","Df"]</code>, and p-value =
0.314. We fail to reject the null hypothesis. Thus, there is no evidence
of a difference in mean scores among methods.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler18" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler18" aria-expanded="false" aria-controls="collapseSpoiler18">
  <h3 class="accordion-header" id="headingSpoiler18">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-way ANCOVA </h3>
</button>
<div id="collapseSpoiler18" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler18" aria-labelledby="headingSpoiler18">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-16">Used for<a class="anchor" aria-label="anchor" href="#used-for-16"></a>
</h4>
<ul>
<li>Comparing group means on a continuous outcome while adjusting for
one continuous covariate.<br>
</li>
<li>
<strong>Real-world example:</strong> Evaluating whether three
different teaching methods lead to different final exam scores after
accounting for students’ prior GPA.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-17">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-17"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>The relationship between the covariate and the outcome is linear and
the same across groups (homogeneity of regression slopes).<br>
</li>
<li>Residuals are normally distributed with equal variances across
groups.<br>
</li>
<li>Covariate is measured without error and is independent of group
assignment.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-17">Strengths<a class="anchor" aria-label="anchor" href="#strengths-17"></a>
</h4>
<ul>
<li>Removes variability due to the covariate, increasing power to detect
group differences.<br>
</li>
<li>Controls for confounding by the covariate.<br>
</li>
<li>Simple extension of one-way ANOVA with interpretation familiar to
ANOVA users.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-17">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-17"></a>
</h4>
<ul>
<li>Sensitive to violation of homogeneity of regression slopes.<br>
</li>
<li>Mis‐specification of the covariate‐outcome relationship biases
results.<br>
</li>
<li>Requires accurate measurement of the covariate.<br>
</li>
<li>Does not accommodate multiple covariates without extension to
factorial ANCOVA or regression.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-17">Example<a class="anchor" aria-label="anchor" href="#example-17"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-17">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-17"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> After adjusting for prior
GPA, the mean final exam scores are equal across the three teaching
methods (μ_Lecture = μ_Online = μ_Hybrid).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one adjusted
group mean differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Lecture"</span>,<span class="st">"Online"</span>,<span class="st">"Hybrid"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior_gpa</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">3.0</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate final exam scores with a covariate effect:</span></span>
<span><span class="co"># true intercepts 75, 78, 80; slope = 5 points per GPA unit; noise sd = 5</span></span>
<span><span class="va">final_score</span> <span class="op">&lt;-</span> <span class="fl">75</span> <span class="op">+</span> </span>
<span>               <span class="fu">ifelse</span><span class="op">(</span><span class="va">method</span><span class="op">==</span><span class="st">"Online"</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fu">ifelse</span><span class="op">(</span><span class="va">method</span><span class="op">==</span><span class="st">"Hybrid"</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fl">5</span> <span class="op">*</span> <span class="va">prior_gpa</span> <span class="op">+</span> </span>
<span>               <span class="fu">rnorm</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">method</span>, <span class="va">prior_gpa</span>, <span class="va">final_score</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANCOVA:</span></span>
<span><span class="va">ancova_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">final_score</span> <span class="op">~</span> <span class="va">prior_gpa</span> <span class="op">+</span> <span class="va">method</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">ancova_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">ancova_fit</span><span class="op">)</span></span>
<span><span class="va">ancova_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)
prior_gpa    1  166.5   166.5   5.967 0.01775 *
method       2  296.8   148.4   5.320 0.00767 **
Residuals   56 1562.4    27.9
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p>Interpretation: After adjusting for prior GPA, the effect of teaching
method yields F = 5.32 (df₁
=<code>r ancova_summary[[1]]["method","Df"]</code>, df₂
=<code>r ancova_summary[[1]]["Residuals","Df"]</code>) with p
=<code>r signif(ancova_summary[[1]]["method","Pr(&gt;F)"], 3</code>). We
reject the null hypothesis. Thus, there is evidence that, controlling
for prior GPA, at least one teaching method leads to a different average
final score..</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler19" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler19" aria-expanded="false" aria-controls="collapseSpoiler19">
  <h3 class="accordion-header" id="headingSpoiler19">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Welch’s ANOVA (uden antagelse om lige varianser) </h3>
</button>
<div id="collapseSpoiler19" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler19" aria-labelledby="headingSpoiler19">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-17">Used for<a class="anchor" aria-label="anchor" href="#used-for-17"></a>
</h4>
<ul>
<li>Testing whether the means of three or more independent groups differ
when variances are unequal.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing average systolic
blood pressure across three clinics known to have different measurement
variability.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-18">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-18"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Each group’s residuals are approximately normally distributed.<br>
</li>
<li>Does <strong>not</strong> assume equal variances across groups.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-18">Strengths<a class="anchor" aria-label="anchor" href="#strengths-18"></a>
</h4>
<ul>
<li>Controls Type I error under heteroskedasticity better than ordinary
ANOVA.<br>
</li>
<li>Simple to implement via
<code>oneway.test(..., var.equal = FALSE)</code>.<br>
</li>
<li>More powerful than nonparametric alternatives when normality
holds.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-18">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-18"></a>
</h4>
<ul>
<li>Sensitive to departures from normality, especially with small sample
sizes.<br>
</li>
<li>Does not provide post-hoc comparisons by default; requires
additional tests.<br>
</li>
<li>Still assumes independence and approximate normality within each
group.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-18">Example<a class="anchor" aria-label="anchor" href="#example-18"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-18">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-18"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> All group means are equal (μ₁
= μ₂ = μ₃).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group
mean differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate systolic BP (mmHg) for three clinics with unequal variances:</span></span>
<span><span class="va">clinic</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bp_values</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">125</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">118</span>, sd <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">clinic</span>, <span class="va">bp_values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Welch’s one-way ANOVA:</span></span>
<span><span class="va">welch_result</span> <span class="op">&lt;-</span> <span class="fu">oneway.test</span><span class="op">(</span><span class="va">bp_values</span> <span class="op">~</span> <span class="va">clinic</span>, data <span class="op">=</span> <span class="va">df</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">welch_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	One-way analysis of means (not assuming equal variances)

data:  bp_values and clinic
F = 2.7802, num df = 2.000, denom df = 23.528, p-value = 0.08244</code></pre>
</div>
<p>Interpretation: The Welch statistic = 2.78 with df ≈ 2, 23.53, and
p-value = 0.0824. We fail to reject the null hypothesis. Thus, there is
no evidence of a difference in mean blood pressure among the
clinics.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler20" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler20" aria-expanded="false" aria-controls="collapseSpoiler20">
  <h3 class="accordion-header" id="headingSpoiler20">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Repeated-measures ANOVA </h3>
</button>
<div id="collapseSpoiler20" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler20" aria-labelledby="headingSpoiler20">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-18">Used for<a class="anchor" aria-label="anchor" href="#used-for-18"></a>
</h4>
<ul>
<li>Testing whether the means of three or more related (within‐subject)
conditions differ.<br>
</li>
<li>
<strong>Real-world example:</strong> Assessing whether students’
reaction times change across three levels of sleep deprivation (0 h, 12
h, 24 h) measured on the same individuals.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-19">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-19"></a>
</h4>
<ul>
<li>Observations (subjects) are independent.<br>
</li>
<li>The dependent variable is approximately normally distributed in each
condition.<br>
</li>
<li>
<strong>Sphericity:</strong> variances of the pairwise differences
between conditions are equal.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-19">Strengths<a class="anchor" aria-label="anchor" href="#strengths-19"></a>
</h4>
<ul>
<li>Controls for between‐subject variability by using each subject as
their own control.<br>
</li>
<li>More powerful than independent‐groups ANOVA when measures are
correlated.<br>
</li>
<li>Can model complex within‐subject designs (e.g. time × treatment
interactions).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-19">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-19"></a>
</h4>
<ul>
<li>Sensitive to violations of sphericity (inflates Type I error).<br>
</li>
<li>Missing data in any condition drops the entire subject (unless using
more advanced mixed‐model methods).<br>
</li>
<li>Interpretation can be complex when there are many levels or
interactions.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-19">Example<a class="anchor" aria-label="anchor" href="#example-19"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-19">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-19"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The mean reaction time is the
same across 0 h, 12 h, and 24 h sleep deprivation.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
condition’s mean reaction time differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n_subj</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_subj</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"0h"</span>,<span class="st">"12h"</span>,<span class="st">"24h"</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">n_subj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Simulate reaction times (ms):</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">300</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>        <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">320</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>        <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_subj</span>, mean <span class="op">=</span> <span class="fl">340</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">subject</span>, <span class="va">condition</span>, <span class="va">rt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit repeated-measures ANOVA:</span></span>
<span><span class="va">rm_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">subject</span><span class="op">/</span><span class="va">condition</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">rm_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">rm_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">rm_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Error: subject
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   9892   899.3

Error: subject:condition
          Df Sum Sq Mean Sq F value Pr(&gt;F)
condition  2   1000     500   1.188  0.324
Residuals 22   9262     421               </code></pre>
</div>
<p>Interpretation: The within‐subjects effect of sleep deprivation
yields F = 1.19 with df₁ = 2 and df₂ =
<code>r rm_summary[[2]][[1]]["Residuals","Df"]</code>, p = 0.324. We
fail to reject the null hypothesis. Thus, there is no evidence that
reaction times differ across sleep deprivation conditions.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler21" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler21" aria-expanded="false" aria-controls="collapseSpoiler21">
  <h3 class="accordion-header" id="headingSpoiler21">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> MANOVA </h3>
</button>
<div id="collapseSpoiler21" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler21" aria-labelledby="headingSpoiler21">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-19">Used for<a class="anchor" aria-label="anchor" href="#used-for-19"></a>
</h4>
<ul>
<li>Testing for differences on multiple continuous dependent variables
across one or more grouping factors simultaneously.<br>
</li>
<li>
<strong>Real-world example:</strong> Evaluating whether three
different diets lead to different patterns of weight loss and
cholesterol reduction.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-20">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-20"></a>
</h4>
<ul>
<li>Multivariate normality of the dependent variables within each
group.<br>
</li>
<li>Homogeneity of covariance matrices across groups.<br>
</li>
<li>Observations are independent.<br>
</li>
<li>Linear relationships among dependent variables.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-20">Strengths<a class="anchor" aria-label="anchor" href="#strengths-20"></a>
</h4>
<ul>
<li>Controls family-wise Type I error by testing all DVs together.<br>
</li>
<li>Can detect patterns that univariate ANOVAs might miss.<br>
</li>
<li>Provides multiple test statistics (Pillai, Wilks, Hotelling–Lawley,
Roy) for flexibility.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-20">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-20"></a>
</h4>
<ul>
<li>Sensitive to violations of multivariate normality and homogeneity of
covariances.<br>
</li>
<li>Requires larger sample sizes as the number of DVs increases.<br>
</li>
<li>Interpretation can be complex; follow-up analyses often needed to
determine which DVs drive effects.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-20">Example<a class="anchor" aria-label="anchor" href="#example-20"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-20">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-20"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The vector of means for
weight loss and cholesterol change is equal across the three diet
groups.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one diet
group differs on the combination of weight loss and cholesterol
change.</li>
</ul>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n_per_group</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">diet</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"LowFat"</span>, <span class="st">"LowCarb"</span>, <span class="st">"Mediterranean"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_per_group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate outcomes:</span></span>
<span><span class="va">weight_loss</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">5</span>,  sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">8</span>,  sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">7</span>,  sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cholesterol</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="fl">9</span>,  sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">diet</span>, <span class="va">weight_loss</span>, <span class="va">cholesterol</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit MANOVA:</span></span>
<span><span class="va">manova_fit</span> <span class="op">&lt;-</span> <span class="fu">manova</span><span class="op">(</span><span class="fu">cbind</span><span class="op">(</span><span class="va">weight_loss</span>, <span class="va">cholesterol</span><span class="op">)</span> <span class="op">~</span> <span class="va">diet</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize using Pillai’s trace:</span></span>
<span><span class="va">manova_summary</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">manova_fit</span>, test <span class="op">=</span> <span class="st">"Pillai"</span><span class="op">)</span></span>
<span><span class="va">manova_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          Df  Pillai approx F num Df den Df    Pr(&gt;F)
diet       2 0.58953   8.7773      4     84 5.708e-06 ***
Residuals 42
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p>Interpretation: Pillai’s trace = 0.59, F = 8.78 with df = 42, and
p-value = 5.71^{-6}. We reject the null hypothesis. This indicates that
there is</p>
<p>a significant multivariate effect of diet on weight loss and
cholesterol change.</p>
<p>Pillai?</p>
<p>Der er fire almindeligt brugte taststatistikker i MANOVA. Pillai,
Wilks’ lambd, Hotelling-Lawleys trace og Roys largest root.</p>
<p>Pillai’s trace (også kaldet Pillai–Bartlett’s trace) er én af fire
almindeligt brugte multivariate test-statistikker i MANOVA (ud over
Wilks’ lambda, Hotelling–Lawley’s trace og Roy’s largest root). Kort om
Pillai:</p>
<p>Definition: Summen af egenværdierne divideret med (1 + egenværdierne)
for hver kanonisk variabel. Det giver en samlet målestok for, hvor stor
en andel af den totale variation der forklares af gruppetilhørsforholdet
på tværs af alle afhængige variable.</p>
<p>Fortolkning: Højere Pillai-værdi (op til 1) indikerer stærkere
multivariat effekt.</p>
<p>Hvorfor vælge Pillai?</p>
<p>Robusthed: Pillai’s trace er den mest robuste over for overtrædelser
af antagelserne om homogen kovarians og multivariat normalitet. Hvis
dine data har ulige gruppe-størrelser eller let skæve fordelinger, er
Pillai ofte det sikreste valg.</p>
<p>Type I-kontrol: Den holder typisk kontrol med falsk positive (Type
I-fejl) bedre end de andre, når antagelser brydes.</p>
<p>Er det altid det bedste valg?</p>
<p>Ikke nødvendigvis. Hvis dine data strengt opfylder antagelserne
(multivariat normalitet, homogen kovarians og rimeligt store, ensartede
grupper), kan de andre statistikker være mere “kraftfulde” (dvs. give
større chance for at opdage en ægte effekt).</p>
<p>Wilks’ lambda er mest brugt i traditionel litteratur og har ofte god
power under idéelle forhold.</p>
<p>Hotelling–Lawley’s trace kan være særligt følsom, når få kanoniske
dimensioner bærer meget af effekten.</p>
<p>Roy’s largest root er ekstremt kraftfuld, hvis kun én kanonisk
variabel adskiller grupperne, men er også mest sårbar
gruppe-størrelser.over for antagelsesovertrædelser.</p>
<p>Kort anbefaling:</p>
<p>Brug Pillai’s trace som standard, især hvis du er usikker på
antagelsesopfyldelsen eller har små/ulige</p>
<p>Overvej Wilks’ lambda eller andre, hvis dine data opfylder alle
antagelser solidt, og du ønsker maksimal statistisk power.</p>
<p>Tjek altid flere tests; hvis de konkluderer ens, styrker det din
konklusion.</p>
</div>
</div>
<div class="section level4">
<h4 id="wilks-lambda">Wilks’ lambda<a class="anchor" aria-label="anchor" href="#wilks-lambda"></a>
</h4>
<ul>
<li>
<strong>Definition:</strong> Ratio of the determinant of the
within‐groups SSCP (sum of squares and cross‐products) matrix to the
determinant of the total SSCP matrix:<br><span class="math display">\[
  \Lambda = \frac{\det(W)}{\det(T)} = \prod_{i=1}^s \frac{1}{1 +
\lambda_i}
\]</span><br>
hvor <span class="math inline">\(\lambda_i\)</span> er de canoniske
egenværdier.<br>
</li>
<li>
<strong>Fortolkning:</strong> Værdier nær 0 indikerer stor
multivariat effekt (mellem‐grupper‐variation &gt;&gt;
inden‐gruppe‐variation), værdier nær 1 indikerer lille eller ingen
effekt.<br>
</li>
<li>
<strong>Styrker:</strong>
<ul>
<li>Klassisk og mest udbredt i litteraturen.<br>
</li>
<li>God power under ideal antagelsesopfyldelse (multivariat normalitet,
homogene kovarianser).<br>
</li>
</ul>
</li>
<li>
<strong>Svagheder:</strong>
<ul>
<li>Mindre robust ved skæve fordelinger eller ulige
gruppe‐størrelser.<br>
</li>
<li>Kan undervurdere effektstørrelse, hvis én eller flere kanoniske
variabler bærer effekten ujævnt.<br>
</li>
</ul>
</li>
<li>
<strong>Anbefaling:</strong>
<ul>
<li>Brug Wilks’ lambda, når du er sikker på, at antagelserne er opfyldt,
og du ønsker en velkendt statistisk test med god power under
idealforhold.</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="hotellinglawleys-trace">Hotelling–Lawley’s trace<a class="anchor" aria-label="anchor" href="#hotellinglawleys-trace"></a>
</h4>
<ul>
<li>
<strong>Definition:</strong> Summen af de canoniske
egenværdier:<br><span class="math display">\[
  T = \sum_{i=1}^s \lambda_i
\]</span><br>
</li>
<li>
<strong>Fortolkning:</strong> Højere værdi betyder større samlet
multivariat effekt.<br>
</li>
<li>
<strong>Styrker:</strong>
<ul>
<li>Sensitiv over for effekter fordelt over flere kanoniske
dimensioner.<br>
</li>
<li>Kan være mere kraftfuld end Wilks’ lambda, hvis flere dimensioner
bidrager til forskellen.<br>
</li>
</ul>
</li>
<li>
<strong>Svagheder:</strong>
<ul>
<li>Mindre robust over for antagelsesbrud end Pillai’s trace.<br>
</li>
<li>Kan overvurdere effektstørrelse, hvis én dimension dominerer
kraftigt.<br>
</li>
</ul>
</li>
<li>
<strong>Anbefaling:</strong>
<ul>
<li>Overvej Hotelling–Lawley’s trace, når du forventer, at effekten
spreder sig over flere kanoniske variabler, og antagelserne er rimeligt
dækket.</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="roys-largest-root">Roy’s largest root<a class="anchor" aria-label="anchor" href="#roys-largest-root"></a>
</h4>
<ul>
<li>
<strong>Definition:</strong> Den største canoniske egenværdi
alene:<br><span class="math display">\[
  \Theta = \max_i \lambda_i
\]</span><br>
</li>
<li>
<strong>Fortolkning:</strong> Måler den stærkeste
enkeltdimensionseffekt.<br>
</li>
<li>
<strong>Styrker:</strong>
<ul>
<li>Højest power, når én kanonisk variabel står for størstedelen af
gruppedifferensen.<br>
</li>
<li>Let at beregne og fortolke, hvis fokus er på “den stærkeste
effekt”.<br>
</li>
</ul>
</li>
<li>
<strong>Svagheder:</strong>
<ul>
<li>Meget følsom over for antagelsesbrud (normalitet, homogene
kovarianser).<br>
</li>
<li>Ikke informativ, hvis flere dimensioner bidrager jævnt.<br>
</li>
</ul>
</li>
<li>
<strong>Anbefaling:</strong>
<ul>
<li>Brug Roy’s largest root, når du har en stærk a priori mistanke om én
dominerende kanonisk dimension og er komfortabel med
forudsætningerne.</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Tips:</strong> Sammenlign altid flere test‐statistikker –
hvis de peger i samme retning, styrker det din konklusion. Pillai’s
trace er generelt mest robust, Wilks’ lambda mest almindelig,
Hotelling–Lawley god til flere dimensioner, og Roy’s largest root bedst,
når én dimension dominerer.</p>
</blockquote>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler22" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler22" aria-expanded="false" aria-controls="collapseSpoiler22">
  <h3 class="accordion-header" id="headingSpoiler22">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Friedman test (nonparametrisk gentagne målinger) </h3>
</button>
<div id="collapseSpoiler22" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler22" aria-labelledby="headingSpoiler22">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-20">Used for<a class="anchor" aria-label="anchor" href="#used-for-20"></a>
</h4>
<ul>
<li>Testing for differences in central tendency across three or more
related (paired) groups when assumptions of repeated‐measures ANOVA are
violated.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing median pain scores at
baseline, 1 hour, and 24 hours after surgery in the same patients.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-21">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-21"></a>
</h4>
<ul>
<li>Observations are paired and the sets of scores for each condition
are related (e.g., repeated measures on the same subjects).<br>
</li>
<li>Data are at least ordinal.<br>
</li>
<li>The distribution of differences across pairs need not be
normal.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-21">Strengths<a class="anchor" aria-label="anchor" href="#strengths-21"></a>
</h4>
<ul>
<li>Nonparametric: does not require normality or sphericity.<br>
</li>
<li>Controls for between‐subject variability by using each subject as
their own block.<br>
</li>
<li>Robust to outliers and skewed data.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-21">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-21"></a>
</h4>
<ul>
<li>Less powerful than repeated‐measures ANOVA when normality and
sphericity hold.<br>
</li>
<li>Only indicates that at least one condition differs—post‐hoc tests
are needed to locate differences.<br>
</li>
<li>Assumes similar shaped distributions across conditions.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-21">Example<a class="anchor" aria-label="anchor" href="#example-21"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-21">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-21"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The distributions of scores
are the same across all conditions (no median differences).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
condition’s distribution (median) differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate pain scores (0–10) for 12 patients at 3 time points:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">patient</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">timepoint</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Baseline"</span>,<span class="st">"1hr"</span>,<span class="st">"24hr"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">12</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Baseline</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">12</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,   <span class="co"># 1 hour post-op</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">12</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>    <span class="co"># 24 hours post-op</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">patient</span>, <span class="va">timepoint</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Friedman test:</span></span>
<span><span class="va">friedman_result</span> <span class="op">&lt;-</span> <span class="fu">friedman.test</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">timepoint</span> <span class="op">|</span> <span class="va">patient</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">friedman_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Friedman rank sum test

data:  scores and timepoint and patient
Friedman chi-squared = 1.6364, df = 2, p-value = 0.4412</code></pre>
</div>
<p>Interpretation: The Friedman chi-squared = 1.64 with df = 2 and
p-value = 0.441. We fail to reject the null hypothesis. Thus, there is
no evidence that pain scores differ across time points.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler23" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler23" aria-expanded="false" aria-controls="collapseSpoiler23">
  <h3 class="accordion-header" id="headingSpoiler23">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Post-hoc: Tukey HSD </h3>
</button>
<div id="collapseSpoiler23" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler23" aria-labelledby="headingSpoiler23">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-21">Used for<a class="anchor" aria-label="anchor" href="#used-for-21"></a>
</h4>
<ul>
<li>Performing pairwise comparisons of group means after a significant
one‐way ANOVA to identify which groups differ.<br>
</li>
<li>
<strong>Real-world example:</strong> Determining which teaching
methods (Lecture, Online, Hybrid) differ in average exam scores after
finding an overall effect.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-22">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-22"></a>
</h4>
<ul>
<li>A significant one‐way ANOVA has been obtained.<br>
</li>
<li>Observations are independent.<br>
</li>
<li>Residuals from the ANOVA are approximately normally
distributed.<br>
</li>
<li>Homogeneity of variances across groups (though Tukey’s HSD is fairly
robust).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-22">Strengths<a class="anchor" aria-label="anchor" href="#strengths-22"></a>
</h4>
<ul>
<li>Controls the family‐wise error rate across all pairwise tests.<br>
</li>
<li>Provides confidence intervals for each mean difference.<br>
</li>
<li>Widely available and simple to interpret.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-22">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-22"></a>
</h4>
<ul>
<li>Requires balanced or nearly balanced designs for optimal
power.<br>
</li>
<li>Less powerful than some alternatives if variances are highly
unequal.<br>
</li>
<li>Only applies after a significant omnibus ANOVA.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-22">Example<a class="anchor" aria-label="anchor" href="#example-22"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-22">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-22"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> All pairwise mean differences
between teaching methods are zero (e.g., μ_Lecture – μ_Online = 0,
etc.).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one pairwise
mean difference ≠ 0.</li>
</ul>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate exam scores for three teaching methods (n = 20 each):</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Lecture"</span>, <span class="st">"Online"</span>, <span class="st">"Hybrid"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">75</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">80</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>            <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">78</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span>     <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">method</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANOVA:</span></span>
<span><span class="va">anova_fit</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">method</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Tukey HSD post-hoc:</span></span>
<span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu">TukeyHSD</span><span class="op">(</span><span class="va">anova_fit</span>, <span class="st">"method"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">tukey_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = scores ~ method, data = df)

$method
                    diff       lwr      upr     p adj
Lecture-Hybrid -2.542511 -8.509478 3.424457 0.5640694
Online-Hybrid   1.192499 -4.774468 7.159467 0.8805866
Online-Lecture  3.735010 -2.231958 9.701978 0.2956108</code></pre>
</div>
<p>Interpretation: Each row of the output gives the estimated difference
in means, a 95% confidence interval, and an adjusted p‐value. For
example, if the Lecture–Online comparison shows a mean difference of
–5.0 (95% CI: –8.0 to –2.0, p adj = 0.002), we conclude that the Online
method yields significantly higher scores than Lecture. Comparisons with
p adj &lt; 0.05 indicate significant mean differences between those
teaching methods.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler24" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler24" aria-expanded="false" aria-controls="collapseSpoiler24">
  <h3 class="accordion-header" id="headingSpoiler24">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Post-hoc: Dunnett’s test </h3>
</button>
<div id="collapseSpoiler24" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler24" aria-labelledby="headingSpoiler24">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-22">Used for<a class="anchor" aria-label="anchor" href="#used-for-22"></a>
</h4>
<ul>
<li>Comparing multiple treatment groups to a single control while
controlling the family‐wise error rate.<br>
</li>
<li>
<strong>Real-world example:</strong> Testing whether two new
fertilizers (Fertilizer A, Fertilizer B) improve crop yield compared to
the standard fertilizer (Control).</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-23">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-23"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Residuals from the ANOVA are approximately normally
distributed.<br>
</li>
<li>Homogeneity of variances across groups.<br>
</li>
<li>A significant overall ANOVA (omnibus F-test) has been observed or
intended.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-23">Strengths<a class="anchor" aria-label="anchor" href="#strengths-23"></a>
</h4>
<ul>
<li>Controls the family-wise error rate when making multiple comparisons
to a control.<br>
</li>
<li>More powerful than Tukey HSD when only control comparisons are of
interest.<br>
</li>
<li>Provides simultaneous confidence intervals and adjusted
p-values.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-23">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-23"></a>
</h4>
<ul>
<li>Only compares each group to the control; does not test all pairwise
contrasts.<br>
</li>
<li>Sensitive to violations of normality and homogeneity of
variances.<br>
</li>
<li>Requires a pre-specified control group.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-23">Example<a class="anchor" aria-label="anchor" href="#example-23"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-23">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-23"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Each treatment mean equals
the control mean (e.g., μ_A = μ_Control, μ_B = μ_Control).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one treatment
mean differs from the control mean (e.g., μ_A ≠ μ_Control, μ_B ≠
μ_Control).</li>
</ul>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate crop yields (kg/plot) for Control and two new fertilizers:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"FertilizerA"</span>, <span class="st">"FertilizerB"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yield</span>     <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Control</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">55</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Fertilizer A</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">53</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>    <span class="co"># Fertilizer B</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">yield</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit one-way ANOVA:</span></span>
<span><span class="va">fit_anova</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Dunnett's test (each treatment vs. Control):</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">multcomp</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: survival</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: TH.data</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: MASS</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'multcomp'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked _by_ '.GlobalEnv':

    cholesterol</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dunnett_result</span> <span class="op">&lt;-</span> <span class="fu">glht</span><span class="op">(</span><span class="va">fit_anova</span>, linfct <span class="op">=</span> <span class="fu">mcp</span><span class="op">(</span>treatment <span class="op">=</span> <span class="st">"Dunnett"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary with adjusted p-values:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">dunnett_result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = yield ~ treatment, data = df)

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)
FertilizerA - Control == 0    4.209      1.550   2.716   0.0165 *
FertilizerB - Control == 0    2.714      1.550   1.751   0.1503
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">confint</span><span class="op">(</span><span class="va">dunnett_result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	 Simultaneous Confidence Intervals

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = yield ~ treatment, data = df)

Quantile = 2.2682
95% family-wise confidence level


Linear Hypotheses:
                           Estimate lwr     upr
FertilizerA - Control == 0  4.2094   0.6942  7.7246
FertilizerB - Control == 0  2.7141  -0.8011  6.2292</code></pre>
</div>
<p>Interpretation: The Dunnett contrasts compare each fertilizer to
Control. For example, if the contrast FertilizerA–Control shows an
estimate of r round(coef(dunnett_result)[1], 2) kg with a 95%
simultaneous CI [4.21, 0.69] and adjusted p-value = 0.0165, we reject
the null for Fertilizer A vs. Control—i.e., Fertilizer A yields
significantly different crop output. Similarly, for FertilizerB
vs. Control (contrast index 2), the estimate is 2.71 kg (CI [2.71,
-0.8], p-value = 0.15, so we fail to reject the null for Fertilizer B
vs. Control.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler25" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler25" aria-expanded="false" aria-controls="collapseSpoiler25">
  <h3 class="accordion-header" id="headingSpoiler25">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Post-hoc: Bonferroni korrektion </h3>
</button>
<div id="collapseSpoiler25" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler25" aria-labelledby="headingSpoiler25">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-23">Used for<a class="anchor" aria-label="anchor" href="#used-for-23"></a>
</h4>
<ul>
<li>Adjusting p-values when performing multiple hypothesis tests to
control the family-wise error rate.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing mean blood pressure
between four different diets with all six pairwise t-tests, using
Bonferroni to adjust for multiple comparisons.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-24">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-24"></a>
</h4>
<ul>
<li>The individual tests (e.g., pairwise t-tests) satisfy their own
assumptions (independence, normality, equal variances if
applicable).<br>
</li>
<li>Tests are independent or positively dependent (Bonferroni remains
valid under any dependency but can be conservative).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-24">Strengths<a class="anchor" aria-label="anchor" href="#strengths-24"></a>
</h4>
<ul>
<li>Simple to calculate: multiply each p-value by the number of
comparisons.<br>
</li>
<li>Guarantees control of the family-wise error rate at the chosen α
level.<br>
</li>
<li>Applicable to any set of p-values regardless of test type.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-24">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-24"></a>
</h4>
<ul>
<li>Very conservative when many comparisons are made, reducing
power.<br>
</li>
<li>Can inflate Type II error (miss true effects), especially with large
numbers of tests.<br>
</li>
<li>Does not take into account the magnitude of dependency among
tests.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-24">Example<a class="anchor" aria-label="anchor" href="#example-24"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-24">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-24"></a>
</h5>
<ul>
<li>
<strong>Null hypotheses (H₀):</strong> For each pair of diets, the
mean blood pressure is equal (e.g., μ_A = μ_B, μ_A = μ_C, …).<br>
</li>
<li>
<strong>Alternative hypotheses (H₁):</strong> For at least one pair,
the means differ.</li>
</ul>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate blood pressure for four diet groups (n = 15 each):</span></span>
<span><span class="va">diet</span>  <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bp</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">125</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">130</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">135</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform all pairwise t-tests with Bonferroni adjustment:</span></span>
<span><span class="va">pairwise_result</span> <span class="op">&lt;-</span> <span class="fu">pairwise.t.test</span><span class="op">(</span><span class="va">bp</span>, <span class="va">diet</span>, p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">pairwise_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pairwise comparisons using t tests with pooled SD

data:  bp and diet

  A       B      C
B 0.4313  -      -
C 0.0432  1.0000 -
D 1.7e-05 0.0083 0.1154

P value adjustment method: bonferroni </code></pre>
</div>
<p>Interpretation: The output shows adjusted p-values for each pair of
diets. For example, if the A vs D comparison has p adj = 0.004 (&lt;
0.05), we reject H₀ for that pair and conclude a significant mean
difference. Comparisons with p adj ≥ 0.05 fail to reject H₀, indicating
no evidence of difference after correction.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="ikke-parametriske-k-prøve-tests">Ikke-parametriske k-prøve-tests<a class="anchor" aria-label="anchor" href="#ikke-parametriske-k-pr%C3%B8ve-tests"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler26" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler26" aria-expanded="false" aria-controls="collapseSpoiler26">
  <h3 class="accordion-header" id="headingSpoiler26">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kruskal–Wallis test </h3>
</button>
<div id="collapseSpoiler26" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler26" aria-labelledby="headingSpoiler26">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-24">Used for<a class="anchor" aria-label="anchor" href="#used-for-24"></a>
</h4>
<ul>
<li>Comparing the central tendency of three or more independent groups
when the outcome is ordinal or not normally distributed.<br>
</li>
<li>
<strong>Real-world example:</strong> Testing whether median pain
scores differ across four treatment groups in a clinical trial when
scores are skewed.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-25">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-25"></a>
</h4>
<ul>
<li>Observations are independent both within and between groups.<br>
</li>
<li>The response variable is at least ordinal.<br>
</li>
<li>The distributions of the groups have the same shape (so differences
reflect shifts in location).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-25">Strengths<a class="anchor" aria-label="anchor" href="#strengths-25"></a>
</h4>
<ul>
<li>Nonparametric: does not require normality or equal variances.<br>
</li>
<li>Handles ordinal data and skewed continuous data.<br>
</li>
<li>Controls Type I error when comparing multiple groups without
assuming normality.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-25">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-25"></a>
</h4>
<ul>
<li>Less powerful than one-way ANOVA when normality holds.<br>
</li>
<li>If group distributions differ in shape, interpretation of a location
shift is ambiguous.<br>
</li>
<li>Only indicates that at least one group differs—post-hoc tests needed
to identify which.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-25">Example<a class="anchor" aria-label="anchor" href="#example-25"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-25">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-25"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The distributions (medians)
of the four treatment groups are equal.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one group’s
median pain score differs.</li>
</ul>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate pain scores (0–10) for four treatment groups (n = 15 each):</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Placebo"</span>,<span class="st">"DrugA"</span>,<span class="st">"DrugB"</span>,<span class="st">"DrugC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,   <span class="co"># Placebo</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,   <span class="co"># Drug A</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,   <span class="co"># Drug B</span></span>
<span>  <span class="fu">rpois</span><span class="op">(</span><span class="fl">15</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>    <span class="co"># Drug C</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">group</span>, <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Kruskal–Wallis rank‐sum test:</span></span>
<span><span class="va">kw_result</span> <span class="op">&lt;-</span> <span class="fu">kruskal.test</span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">kw_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Kruskal-Wallis rank sum test

data:  scores by group
Kruskal-Wallis chi-squared = 21.621, df = 3, p-value = 7.82e-05</code></pre>
</div>
<p>Interpretation: The Kruskal–Wallis chi-squared = 21.62 with df = 3
and p-value = 7.82^{-5}. We reject the null hypothesis. Thus, there is
evidence that at least one treatment group’s median pain score
differs.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler27" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler27" aria-expanded="false" aria-controls="collapseSpoiler27">
  <h3 class="accordion-header" id="headingSpoiler27">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Rank correlation </h3>
</button>
<div id="collapseSpoiler27" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler27" aria-labelledby="headingSpoiler27">
<div class="accordion-body">
<p>EJ KORREKTURLÆST HAV SÆRLIGT FOKUS PÅ OM DER ER FORSKEL PÅ DENNE OG
SPEARMAN-RANK CORRELATION SENERE</p>
<div class="section level4">
<h4 id="used-for-25">Used for<a class="anchor" aria-label="anchor" href="#used-for-25"></a>
</h4>
<ul>
<li>Assessing the strength and direction of a monotonic association
between two variables using their ranks.<br>
</li>
<li>
<strong>Real-world example:</strong> Evaluating whether patients’
pain rankings correlate with their anxiety rankings.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-26">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-26"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Variables are at least ordinal.<br>
</li>
<li>The relationship is monotonic (but not necessarily linear).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-26">Strengths<a class="anchor" aria-label="anchor" href="#strengths-26"></a>
</h4>
<ul>
<li>Nonparametric: does not require normality.<br>
</li>
<li>Robust to outliers in the original measurements.<br>
</li>
<li>Captures any monotonic relationship, not limited to linear.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-26">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-26"></a>
</h4>
<ul>
<li>Less powerful than Pearson’s correlation when data are bivariate
normal and relationship is linear.<br>
</li>
<li>Does not distinguish between different monotonic shapes (e.g.,
concave vs. convex).<br>
</li>
<li>Ties reduce the effective sample size and complicate exact p-value
calculation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-26">Example<a class="anchor" aria-label="anchor" href="#example-26"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-26">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-26"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> There is no monotonic
association between X and Y (ρ = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> There is a nonzero
monotonic association (ρ ≠ 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate two variables with a monotonic relationship:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>               <span class="co"># roughly increasing with x</span></span>
<span><span class="co"># Perform Spearman rank correlation test:</span></span>
<span><span class="va">spearman_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">spearman_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Spearman's rank correlation rho

data:  x and y
S = 300, p-value = 5.648e-14
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho
0.9332592 </code></pre>
</div>
<p>Interpretation: Spearman’s ρ = 0.933 with p-value = 5.65^{-14}. We
reject the null hypothesis. Thus, there is evidence of a monotonic
association between X and Y.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler28" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler28" aria-expanded="false" aria-controls="collapseSpoiler28">
  <h3 class="accordion-header" id="headingSpoiler28">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Anderson–Darling test </h3>
</button>
<div id="collapseSpoiler28" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler28" aria-labelledby="headingSpoiler28">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-26">Used for<a class="anchor" aria-label="anchor" href="#used-for-26"></a>
</h4>
<ul>
<li>Testing whether a sample comes from a specified continuous
distribution (most commonly normal).<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if daily measurement
errors from a laboratory instrument follow a normal distribution.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-27">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-27"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Data are continuous (no excessive ties).<br>
</li>
<li>For goodness‐of‐fit to a non‐normal distribution (e.g. exponential),
the distribution’s parameters must be fully specified a priori.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-27">Strengths<a class="anchor" aria-label="anchor" href="#strengths-27"></a>
</h4>
<ul>
<li>More sensitive than the Shapiro–Wilk test to departures in the tails
of the distribution.<br>
</li>
<li>Applicable to a wide range of target distributions (with the
appropriate implementation).<br>
</li>
<li>Provides both a test statistic (A²) and p-value.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-27">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-27"></a>
</h4>
<ul>
<li>Very sensitive in large samples—small deviations can yield
significant results.<br>
</li>
<li>If parameters are estimated from the data (e.g. normal mean/SD),
p-values may be conservative.<br>
</li>
<li>Does not indicate the form of the departure (e.g. skew
vs. kurtosis).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-27">Example<a class="anchor" aria-label="anchor" href="#example-27"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-27">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-27"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The sample is drawn from a
Normal distribution.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The sample is not
drawn from a Normal distribution.</li>
</ul>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load nortest if necessary:</span></span>
<span><span class="co"># install.packages("nortest")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a sample of 40 observations:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Anderson–Darling test for normality:</span></span>
<span><span class="va">ad_result</span> <span class="op">&lt;-</span> <span class="fu">ad.test</span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">ad_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Anderson-Darling normality test

data:  sample_data
A = 0.13614, p-value = 0.9754</code></pre>
</div>
<p>Interpretation: The Anderson–Darling statistic A² = 0.136 with
p-value = 0.975. We fail to reject the null hypothesis. Thus, there is
no evidence to conclude a departure from normality.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="regression-og-korrelation">Regression og korrelation<a class="anchor" aria-label="anchor" href="#regression-og-korrelation"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler29" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler29" aria-expanded="false" aria-controls="collapseSpoiler29">
  <h3 class="accordion-header" id="headingSpoiler29">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Simple linear regression </h3>
</button>
<div id="collapseSpoiler29" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler29" aria-labelledby="headingSpoiler29">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-27">Used for<a class="anchor" aria-label="anchor" href="#used-for-27"></a>
</h4>
<ul>
<li>Modeling and quantifying the linear relationship between a
continuous predictor and a continuous outcome.<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting house sale price
based on living area in square feet.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-28">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-28"></a>
</h4>
<ul>
<li>A linear relationship between predictor and outcome.<br>
</li>
<li>Residuals are independent and normally distributed with mean
zero.<br>
</li>
<li>Homoscedasticity: constant variance of residuals across values of
the predictor.<br>
</li>
<li>No influential outliers or high-leverage points.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-28">Strengths<a class="anchor" aria-label="anchor" href="#strengths-28"></a>
</h4>
<ul>
<li>Provides an interpretable estimate of the change in outcome per unit
change in predictor.<br>
</li>
<li>Inference on slope and intercept via hypothesis tests and confidence
intervals.<br>
</li>
<li>Basis for more complex regression models and diagnostics.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-28">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-28"></a>
</h4>
<ul>
<li>Only captures linear patterns; will miss nonlinear
relationships.<br>
</li>
<li>Sensitive to outliers, which can distort estimates and
inference.<br>
</li>
<li>Extrapolation beyond observed predictor range is unreliable.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-28">Example<a class="anchor" aria-label="anchor" href="#example-28"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-28">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-28"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The slope β₁ = 0 (no linear
association between x and y).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> β₁ ≠ 0 (a linear
association exists).</li>
</ul>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit simple linear regression:</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show summary of model:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max
-4.6258 -1.4244 -0.0462  1.6635  3.6410

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.5009     0.6267   2.395   0.0206 *
x             1.5554     0.1023  15.210   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.057 on 48 degrees of freedom
Multiple R-squared:  0.8282,	Adjusted R-squared:  0.8246
F-statistic: 231.3 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot data with regression line:</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simple Linear Regression of y on x"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Predictor (x)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Outcome (y)"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/stat-tests-1-rendered-simple_linear_regression-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Interpretation: The estimated slope is 1.555, with a p-value of
5.51^{-20}. We reject the null hypothesis, indicating that there is
evidence of a significant linear association between x and y.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler30" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler30" aria-expanded="false" aria-controls="collapseSpoiler30">
  <h3 class="accordion-header" id="headingSpoiler30">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Multiple regression </h3>
</button>
<div id="collapseSpoiler30" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler30" aria-labelledby="headingSpoiler30">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-28">Used for<a class="anchor" aria-label="anchor" href="#used-for-28"></a>
</h4>
<ul>
<li>Modeling the relationship between one continuous outcome and two or
more predictors (continuous or categorical).<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting house sale price
based on living area, number of bedrooms, and neighborhood quality.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-29">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-29"></a>
</h4>
<ul>
<li>Correct specification: linear relationship between each predictor
and the outcome (additivity).<br>
</li>
<li>Residuals are independent and normally distributed with mean
zero.<br>
</li>
<li>Homoscedasticity: constant variance of residuals for all predictor
values.<br>
</li>
<li>No perfect multicollinearity among predictors.<br>
</li>
<li>No influential outliers unduly affecting the model.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-29">Strengths<a class="anchor" aria-label="anchor" href="#strengths-29"></a>
</h4>
<ul>
<li>Can adjust for multiple confounders or risk factors
simultaneously.<br>
</li>
<li>Provides estimates and inference (CI, p-values) for each predictor’s
unique association with the outcome.<br>
</li>
<li>Basis for variable selection, prediction, and causal modeling in
observational data.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-29">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-29"></a>
</h4>
<ul>
<li>Sensitive to multicollinearity, which inflates variances of
coefficient estimates.<br>
</li>
<li>Assumes a linear, additive form; interactions or nonlinearity
require extension.<br>
</li>
<li>Outliers and high-leverage points can distort estimates and
inference.<br>
</li>
<li>Interpretation can be complex when including many predictors or
interactions.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-29">Example<a class="anchor" aria-label="anchor" href="#example-29"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-29">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-29"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> All regression coefficients
for predictors (β₁, β₂, β₃) are zero (no association).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one βᵢ ≠
0.</li>
</ul>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># Simulate predictors:</span></span>
<span><span class="va">living_area</span>     <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">800</span>, <span class="fl">3500</span><span class="op">)</span>        <span class="co"># in square feet</span></span>
<span><span class="va">bedrooms</span>        <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">neighborhood</span>    <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Medium"</span>,<span class="st">"High"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Simulate price with true model:</span></span>
<span><span class="va">price</span> <span class="op">&lt;-</span> <span class="fl">50000</span> <span class="op">+</span></span>
<span>         <span class="fl">30</span> <span class="op">*</span> <span class="va">living_area</span> <span class="op">+</span> </span>
<span>         <span class="fl">10000</span> <span class="op">*</span> <span class="va">bedrooms</span> <span class="op">+</span> </span>
<span>         <span class="fu">ifelse</span><span class="op">(</span><span class="va">neighborhood</span><span class="op">==</span><span class="st">"Medium"</span>, <span class="fl">20000</span>, </span>
<span>                <span class="fu">ifelse</span><span class="op">(</span><span class="va">neighborhood</span><span class="op">==</span><span class="st">"High"</span>, <span class="fl">50000</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">30000</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">price</span>, <span class="va">living_area</span>, <span class="va">bedrooms</span>, <span class="va">neighborhood</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple linear regression:</span></span>
<span><span class="va">model_mlr</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">price</span> <span class="op">~</span> <span class="va">living_area</span> <span class="op">+</span> <span class="va">bedrooms</span> <span class="op">+</span> <span class="va">neighborhood</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show model summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model_mlr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = price ~ living_area + bedrooms + neighborhood, data = df)

Residuals:
   Min     1Q Median     3Q    Max
-76016 -17437   1258  20097  72437

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)        119719.729  12445.109   9.620 1.07e-15 ***
living_area            26.498      3.685   7.190 1.47e-10 ***
bedrooms             8292.136   2147.637   3.861 0.000206 ***
neighborhoodLow    -59241.209   7084.797  -8.362 5.18e-13 ***
neighborhoodMedium -34072.271   6927.394  -4.918 3.65e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 28490 on 95 degrees of freedom
Multiple R-squared:  0.5891,	Adjusted R-squared:  0.5718
F-statistic: 34.05 on 4 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Interpretation:</p>
<p>The overall F-test (in 34.05 on df₁ = 4, df₂ = 95 has p-value =
1.3^{-17}, so reject the null hypothesis.</p>
<p>Individual coefficients: for example, living_area’s estimate is 26.5
(p = 1.47^{-10}), indicating a significant positive association: each
additional square foot increases price by about $30 on average.</p>
<p>Similar interpretation applies to bedrooms and neighborhood
indicators.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler31" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler31" aria-expanded="false" aria-controls="collapseSpoiler31">
  <h3 class="accordion-header" id="headingSpoiler31">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Pearson correlation </h3>
</button>
<div id="collapseSpoiler31" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler31" aria-labelledby="headingSpoiler31">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-29">Used for<a class="anchor" aria-label="anchor" href="#used-for-29"></a>
</h4>
<ul>
<li>Assessing the strength and direction of a linear relationship
between two continuous variables.<br>
</li>
<li>
<strong>Real-world example:</strong> Examining whether students’
hours of study correlate with their exam scores.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-30">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-30"></a>
</h4>
<ul>
<li>Observations are independent pairs.<br>
</li>
<li>Both variables are approximately normally distributed (bivariate
normality).<br>
</li>
<li>Relationship is linear.<br>
</li>
<li>No extreme outliers.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-30">Strengths<a class="anchor" aria-label="anchor" href="#strengths-30"></a>
</h4>
<ul>
<li>Provides both a correlation coefficient (r) and hypothesis test
(t‐statistic, p‐value).<br>
</li>
<li>Confidence interval for the true correlation can be obtained.<br>
</li>
<li>Well understood and widely used.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-30">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-30"></a>
</h4>
<ul>
<li>Sensitive to outliers, which can distort r.<br>
</li>
<li>Only measures linear association—will miss non‐linear
relationships.<br>
</li>
<li>Reliant on normality; departures can affect Type I/II error
rates.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-30">Example<a class="anchor" aria-label="anchor" href="#example-30"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-30">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-30"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The true Pearson correlation
ρ = 0 (no linear association).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> ρ ≠ 0 (a linear
association exists).</li>
</ul>
<div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">hours_studied</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># Make exam_scores roughly increase with hours_studied + noise:</span></span>
<span><span class="va">exam_scores</span>   <span class="op">&lt;-</span> <span class="fl">50</span> <span class="op">+</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="va">hours_studied</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Pearson correlation test:</span></span>
<span><span class="va">pearson_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">hours_studied</span>, <span class="va">exam_scores</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">pearson_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's product-moment correlation

data:  hours_studied and exam_scores
t = 14.086, df = 28, p-value = 3.108e-14
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8689058 0.9694448
sample estimates:
      cor
0.9361291 </code></pre>
</div>
<p>Interpretation: The sample Pearson correlation is 0.936, with t =
14.09 on df = 28 and p-value = 3.11^{-14}. We reject the null
hypothesis, indicating that there is evidence of a significant linear
association between hours studied and exam scores.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler32" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler32" aria-expanded="false" aria-controls="collapseSpoiler32">
  <h3 class="accordion-header" id="headingSpoiler32">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Spearman’s rank correlation </h3>
</button>
<div id="collapseSpoiler32" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler32" aria-labelledby="headingSpoiler32">
<div class="accordion-body">
<p>EJ KORREKTURLÆST #### Used for - Assessing the strength and direction
of a monotonic association between two variables using their
ranks.<br>
- <strong>Real-world example:</strong> Evaluating whether patients’ pain
rankings correlate with their anxiety rankings.</p>
<div class="section level4">
<h4 id="assumptions-31">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-31"></a>
</h4>
<ul>
<li>Observations are independent pairs.<br>
</li>
<li>Variables are at least ordinal.<br>
</li>
<li>The relationship is monotonic (consistently increasing or
decreasing).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-31">Strengths<a class="anchor" aria-label="anchor" href="#strengths-31"></a>
</h4>
<ul>
<li>Nonparametric: does not require normality of the underlying
data.<br>
</li>
<li>Robust to outliers in the original measurements.<br>
</li>
<li>Captures any monotonic relationship, not limited to linear.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-31">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-31"></a>
</h4>
<ul>
<li>Less powerful than Pearson’s correlation when the true relationship
is linear and data are bivariate normal.<br>
</li>
<li>Does not distinguish between different monotonic shapes
(e.g. concave vs. convex).<br>
</li>
<li>Tied ranks reduce effective sample size and can complicate exact
p-value calculation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-31">Example<a class="anchor" aria-label="anchor" href="#example-31"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-31">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-31"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The true Spearman rank
correlation ρ = 0 (no monotonic association).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> ρ ≠ 0 (a monotonic
association exists).</li>
</ul>
<div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate two variables with a monotonic relationship:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">30</span><span class="op">)</span>                   <span class="co"># e.g., anxiety scores ranked</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>              <span class="co"># roughly increasing with x, plus noise</span></span>
<span></span>
<span><span class="co"># Perform Spearman rank correlation test:</span></span>
<span><span class="va">spearman_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">spearman_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Spearman's rank correlation rho

data:  x and y
S = 486, p-value = 3.73e-11
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho
0.8918799 </code></pre>
</div>
<p>Interpretation: Spearman’s rho = 0.892 with p-value = 3.73^{-11}. We
reject the null hypothesis. This indicates that there is evidence of a
significant monotonic association between the two variables.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler33" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler33" aria-expanded="false" aria-controls="collapseSpoiler33">
  <h3 class="accordion-header" id="headingSpoiler33">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kendall’s tau </h3>
</button>
<div id="collapseSpoiler33" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler33" aria-labelledby="headingSpoiler33">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-30">Used for<a class="anchor" aria-label="anchor" href="#used-for-30"></a>
</h4>
<ul>
<li>Assessing the strength and direction of a monotonic association
between two variables based on concordant and discordant pairs.<br>
</li>
<li>
<strong>Real-world example:</strong> Evaluating whether the ranking
of students by homework completion correlates with their ranking by
final exam performance.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-32">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-32"></a>
</h4>
<ul>
<li>Observations are independent pairs.<br>
</li>
<li>Variables are measured on at least an ordinal scale.<br>
</li>
<li>The relationship is monotonic (but not necessarily linear).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-32">Strengths<a class="anchor" aria-label="anchor" href="#strengths-32"></a>
</h4>
<ul>
<li>Nonparametric: does not require any distributional
assumptions.<br>
</li>
<li>Robust to outliers and tied values (with appropriate
corrections).<br>
</li>
<li>Directly interprets probability of concordance vs. discordance.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-32">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-32"></a>
</h4>
<ul>
<li>Less powerful than Spearman’s rho when the relationship is strictly
monotonic and no ties.<br>
</li>
<li>Tied ranks reduce effective sample size and require tie
corrections.<br>
</li>
<li>Only measures monotonic association, not form or magnitude of
change.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-32">Example<a class="anchor" aria-label="anchor" href="#example-32"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-32">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-32"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Kendall’s τ = 0 (no
association between the two rankings).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> τ ≠ 0 (a monotonic
association exists).</li>
</ul>
<div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate two sets of rankings for 25 students:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">homework_rank</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>                  <span class="co"># ranking by homework completion</span></span>
<span><span class="va">exam_rank</span>     <span class="op">&lt;-</span> <span class="va">homework_rank</span> <span class="op">+</span> <span class="fu">rpois</span><span class="op">(</span><span class="fl">25</span>, lambda<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>  <span class="co"># roughly related with some noise</span></span>
<span></span>
<span><span class="co"># Perform Kendall’s tau test:</span></span>
<span><span class="va">kendall_result</span> <span class="op">&lt;-</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">homework_rank</span>, <span class="va">exam_rank</span>,</span>
<span>                          method  <span class="op">=</span> <span class="st">"kendall"</span>,</span>
<span>                          exact   <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">kendall_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Kendall's rank correlation tau

data:  homework_rank and exam_rank
z = 6.3518, p-value = 2.129e-10
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau
0.9203643 </code></pre>
</div>
<p>Interpretation: Kendall’s τ = 0.92 with a two-sided p-value =
2.13^{-10}. We reject the null hypothesis. Thus, there is evidence of a
significant monotonic association between homework and exam
rankings.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler34" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler34" aria-expanded="false" aria-controls="collapseSpoiler34">
  <h3 class="accordion-header" id="headingSpoiler34">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Multiple logistic regression </h3>
</button>
<div id="collapseSpoiler34" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler34" aria-labelledby="headingSpoiler34">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-31">Used for<a class="anchor" aria-label="anchor" href="#used-for-31"></a>
</h4>
<ul>
<li>Modeling the probability of a binary outcome as a function of two or
more predictors.<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting whether a patient
has heart disease (yes/no) based on age, cholesterol level, and smoking
status.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-33">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-33"></a>
</h4>
<ul>
<li>Outcome is binary (0/1) and observations are independent.<br>
</li>
<li>Log-odds of the outcome are a linear function of the predictors
(linearity in the logit).<br>
</li>
<li>No perfect multicollinearity among predictors.<br>
</li>
<li>Large enough sample so that maximum likelihood estimates are stable
(rule of thumb: ≥10 events per predictor).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-33">Strengths<a class="anchor" aria-label="anchor" href="#strengths-33"></a>
</h4>
<ul>
<li>Adjusts for multiple confounders simultaneously.<br>
</li>
<li>Coefficients have clear interpretation as log‐odds (or odds
ratios).<br>
</li>
<li>Flexible: handles continuous, categorical, and interaction
terms.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-33">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-33"></a>
</h4>
<ul>
<li>Sensitive to complete or quasi‐complete separation (can prevent
convergence).<br>
</li>
<li>Assumes linearity in the logit—requires transformation or splines if
violated.<br>
</li>
<li>Interpretation of interactions and higher‐order terms can be
complex.<br>
</li>
<li>Requires adequate sample size, especially when events are rare.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-33">Example<a class="anchor" aria-label="anchor" href="#example-33"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-33">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-33"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> All predictor coefficients β₁
= β₂ = β₃ = 0 (none of the variables affect disease odds).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one βᵢ ≠ 0
(at least one predictor affects odds).</li>
</ul>
<div class="codewrapper sourceCode" id="cb85">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="co"># Simulate predictors:</span></span>
<span><span class="va">age</span>          <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cholesterol</span>  <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">200</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">smoker</span>       <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate binary outcome via logistic model:</span></span>
<span><span class="va">logit_p</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="va">cholesterol</span> <span class="op">+</span> <span class="fl">1.2</span> <span class="op">*</span> <span class="op">(</span><span class="va">smoker</span><span class="op">==</span><span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="va">p</span>        <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">exp</span><span class="op">(</span><span class="op">-</span><span class="va">logit_p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">disease</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>disease <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">disease</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"No"</span>,<span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="va">age</span>, <span class="va">cholesterol</span>, <span class="va">smoker</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple logistic regression:</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">disease</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">cholesterol</span> <span class="op">+</span> <span class="va">smoker</span>,</span>
<span>             data <span class="op">=</span> <span class="va">df</span>,</span>
<span>             family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show summary and odds ratios:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = disease ~ age + cholesterol + smoker, family = binomial,
    data = df)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -7.016100   1.712922  -4.096 4.20e-05 ***
age          0.075418   0.017734   4.253 2.11e-05 ***
cholesterol  0.008465   0.005440   1.556  0.11971
smokerYes    0.998927   0.360721   2.769  0.00562 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 265.63  on 199  degrees of freedom
Residual deviance: 237.72  on 196  degrees of freedom
AIC: 245.72

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fu">coef</span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(Intercept)         age cholesterol   smokerYes
0.000897318 1.078334765 1.008500725 2.715367476 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fu">confint</span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                   2.5 %     97.5 %
(Intercept) 2.650867e-05 0.02260073
age         1.042852e+00 1.11825331
cholesterol 9.979236e-01 1.01955252
smokerYes   1.347682e+00 5.57661867</code></pre>
</div>
<p>Interpretation:</p>
<p>The Wald test for each coefficient (from summary(model)) gives a
z-statistic and p-value. For example, if the coefficient for age is β̂ =
0.04 (p = 0.01), its odds ratio is exp(0.04) ≈ 1.04 (95% CI from
exp(confint(model))), meaning each additional year of age multiplies the
odds of disease by about 1.04.</p>
<p>A significant p-value (e.g., p &lt; 0.05) for cholesterol indicates
that higher cholesterol is associated with increased odds (OR =
exp(β̂_cholesterol)).</p>
<p>A significant positive coefficient for smoker (β̂ ≈ 1.2, OR ≈ 3.3)
implies smokers have about 3.3 times the odds of disease compared to
non-smokers, adjusting for age and cholesterol.</p>
<p>You would reject the null hypothesis overall, concluding that at
least one predictor is significantly associated with the outcome.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler35" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler35" aria-expanded="false" aria-controls="collapseSpoiler35">
  <h3 class="accordion-header" id="headingSpoiler35">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Poisson regression </h3>
</button>
<div id="collapseSpoiler35" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler35" aria-labelledby="headingSpoiler35">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-32">Used for<a class="anchor" aria-label="anchor" href="#used-for-32"></a>
</h4>
<ul>
<li>Modeling count data (events per unit time or space) as a function of
one or more predictors.<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting the number of daily
emergency room visits based on average daily temperature.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-34">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-34"></a>
</h4>
<ul>
<li>Counts follow a Poisson distribution (mean = variance).<br>
</li>
<li>Events occur independently.<br>
</li>
<li>The log of the expected count is a linear function of the
predictors.<br>
</li>
<li>No excessive zero‐inflation (if present, consider zero‐inflated
models).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-34">Strengths<a class="anchor" aria-label="anchor" href="#strengths-34"></a>
</h4>
<ul>
<li>Naturally handles non‐negative integer outcomes.<br>
</li>
<li>Estimates incidence rate ratios (IRRs) that are easy to
interpret.<br>
</li>
<li>Can include both categorical and continuous predictors.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-34">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-34"></a>
</h4>
<ul>
<li>Sensitive to overdispersion (variance &gt; mean); may need
quasi‐Poisson or negative binomial.<br>
</li>
<li>Assumes log‐linear relationship—misspecification leads to
bias.<br>
</li>
<li>Influential observations (e.g., days with extreme counts) can
distort estimates.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-34">Example<a class="anchor" aria-label="anchor" href="#example-34"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-34">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-34"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Temperature has no effect on
the expected number of ER visits (β₁ = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Temperature affects
the expected number of ER visits (β₁ ≠ 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate 100 days of data:</span></span>
<span><span class="va">n_days</span>      <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">temp</span>        <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n_days</span>, min <span class="op">=</span> <span class="fl">0</span>,  max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>              <span class="co"># average daily temperature (°C)</span></span>
<span><span class="co"># True model: log(rate) = 1 + 0.05 * temp</span></span>
<span><span class="va">log_rate</span>    <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">temp</span></span>
<span><span class="va">expected</span>    <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">log_rate</span><span class="op">)</span></span>
<span><span class="va">er_visits</span>   <span class="op">&lt;-</span> <span class="fu">rpois</span><span class="op">(</span><span class="va">n_days</span>, lambda <span class="op">=</span> <span class="va">expected</span><span class="op">)</span>              <span class="co"># simulated counts</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">er_visits</span>, <span class="va">temp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Poisson regression:</span></span>
<span><span class="va">pois_fit</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">er_visits</span> <span class="op">~</span> <span class="va">temp</span>, family <span class="op">=</span> <span class="fu">poisson</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">pois_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = er_visits ~ temp, family = poisson(link = "log"),
    data = df)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) 0.982531   0.101027   9.725   &lt;2e-16 ***
temp        0.052793   0.004823  10.945   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 233.15  on 99  degrees of freedom
Residual deviance: 104.41  on 98  degrees of freedom
AIC: 463.81

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<p>Interpretation: The estimated coefficient for temperature is 0.053,
giving an incidence rate ratio IRR = 1.054. With a p-value = 7.01^{-28},
we reject the null hypothesis. This means each 1 °C increase in average
daily temperature is associated with a multiplicative change of
approximately 1.054 in the expected number of ER visits.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler36" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler36" aria-expanded="false" aria-controls="collapseSpoiler36">
  <h3 class="accordion-header" id="headingSpoiler36">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Negative binomial regression </h3>
</button>
<div id="collapseSpoiler36" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler36" aria-labelledby="headingSpoiler36">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-33">Used for<a class="anchor" aria-label="anchor" href="#used-for-33"></a>
</h4>
<ul>
<li>Modeling overdispersed count data (variance &gt; mean) as a function
of one or more predictors.<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting the number of daily
asthma attacks per patient based on air pollution level when counts show
extra-Poisson variation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-35">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-35"></a>
</h4>
<ul>
<li>Counts follow a negative binomial distribution (allows variance &gt;
mean).<br>
</li>
<li>Events occur independently.<br>
</li>
<li>The log of the expected count is a linear function of the
predictors.<br>
</li>
<li>Overdispersion parameter is constant across observations.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-35">Strengths<a class="anchor" aria-label="anchor" href="#strengths-35"></a>
</h4>
<ul>
<li>Handles overdispersion naturally without biasing standard
errors.<br>
</li>
<li>Estimates incidence rate ratios (IRRs) with correct inference.<br>
</li>
<li>Can include both continuous and categorical predictors.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-35">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-35"></a>
</h4>
<ul>
<li>Requires estimation of an extra dispersion parameter, which may be
unstable in small samples.<br>
</li>
<li>Sensitive to model misspecification (link function, omitted
covariates).<br>
</li>
<li>Influential observations can still distort estimates if
extreme.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-35">Example<a class="anchor" aria-label="anchor" href="#example-35"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-35">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-35"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Air pollution level has no
effect on the expected number of asthma attacks (β₁ = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Air pollution level
affects the expected number of asthma attacks (β₁ ≠ 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("MASS")  # if necessary</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">MASS</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span><span class="co"># Simulate predictor: average daily PM2.5 level (µg/m³)</span></span>
<span><span class="va">pm25</span>       <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n_patients</span>, min <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co"># True model: log(µ) = 0.5 + 0.04 * pm25, dispersion theta = 2</span></span>
<span><span class="va">log_mu</span>     <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">pm25</span></span>
<span><span class="va">mu</span>         <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">log_mu</span><span class="op">)</span></span>
<span><span class="va">attacks</span>    <span class="op">&lt;-</span> <span class="fu">rnbinom</span><span class="op">(</span><span class="va">n_patients</span>, mu <span class="op">=</span> <span class="va">mu</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_nb</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">attacks</span>, <span class="va">pm25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit negative binomial regression:</span></span>
<span><span class="va">nb_fit</span> <span class="op">&lt;-</span> <span class="fu">glm.nb</span><span class="op">(</span><span class="va">attacks</span> <span class="op">~</span> <span class="va">pm25</span>, data <span class="op">=</span> <span class="va">df_nb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">nb_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm.nb(formula = attacks ~ pm25, data = df_nb, init.theta = 2.392967844,
    link = log)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) 0.418832   0.170421   2.458    0.014 *
pm25        0.045102   0.005085   8.869   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(2.393) family taken to be 1)

    Null deviance: 250.51  on 149  degrees of freedom
Residual deviance: 167.61  on 148  degrees of freedom
AIC: 823.46

Number of Fisher Scoring iterations: 1

              Theta:  2.393
          Std. Err.:  0.410

 2 x log-likelihood:  -817.455 </code></pre>
</div>
<p>Interpretation: The estimated coefficient for PM2.5 is 0.045, giving
an incidence rate ratio IRR = 1.046. With p-value = 7.38^{-19}, we
reject the null hypothesis. This means each 1 µg/m³ increase in PM2.5 is
associated with a multiplicative change of approximately 1.046 in the
expected number of asthma attacks, accounting for overdispersion.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler37" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler37" aria-expanded="false" aria-controls="collapseSpoiler37">
  <h3 class="accordion-header" id="headingSpoiler37">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Ordinal logistic regression </h3>
</button>
<div id="collapseSpoiler37" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler37" aria-labelledby="headingSpoiler37">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-34">Used for<a class="anchor" aria-label="anchor" href="#used-for-34"></a>
</h4>
<ul>
<li>Modeling an ordinal outcome (with more than two ordered categories)
as a function of one or more predictors.<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting customer
satisfaction levels (Low, Medium, High) based on service wait time and
price.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-36">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-36"></a>
</h4>
<ul>
<li>The dependent variable is ordinal with a meaningful order.<br>
</li>
<li>
<strong>Proportional odds (parallel lines):</strong> the effect of
each predictor is the same across all thresholds between outcome
categories.<br>
</li>
<li>Observations are independent.<br>
</li>
<li>No multicollinearity among predictors.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-36">Strengths<a class="anchor" aria-label="anchor" href="#strengths-36"></a>
</h4>
<ul>
<li>Makes efficient use of the ordering information in the
outcome.<br>
</li>
<li>Provides interpretable odds‐ratios for cumulative
probabilities.<br>
</li>
<li>More powerful than nominal models (e.g., multinomial logit) when the
order matters.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-36">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-36"></a>
</h4>
<ul>
<li>Relies on the proportional‐odds assumption; violation can bias
estimates.<br>
</li>
<li>Interpretation can be less intuitive than linear regression.<br>
</li>
<li>Cannot easily accommodate non‐proportional effects without
extension.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-36">Example<a class="anchor" aria-label="anchor" href="#example-36"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-36">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-36"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Waiting time has no effect on
the odds of higher satisfaction (<span class="math inline">\(\beta_{\text{wait}} = 0\)</span>).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Waiting time affects
the odds of higher satisfaction (<span class="math inline">\(\beta_{\text{wait}} \neq 0\)</span>).</li>
</ul>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data and package</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">MASS</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">120</span></span>
<span><span class="co"># Simulate predictors:</span></span>
<span><span class="va">wait_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>,  <span class="fl">5</span>, <span class="fl">60</span><span class="op">)</span>      <span class="co"># waiting time in minutes</span></span>
<span><span class="va">price</span>     <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>     <span class="co"># price in dollars</span></span>
<span></span>
<span><span class="co"># Simulate an ordinal outcome via latent variable:</span></span>
<span><span class="va">latent</span>   <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">0.03</span> <span class="op">*</span> <span class="va">wait_time</span> <span class="op">-</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="va">price</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># Define thresholds for three satisfaction levels:</span></span>
<span><span class="co"># latent ≤ 0: Low; 0 &lt; latent ≤ 1: Medium; latent &gt; 1: High</span></span>
<span><span class="va">satisfaction</span> <span class="op">&lt;-</span> <span class="fu">cut</span><span class="op">(</span><span class="va">latent</span>,</span>
<span>                    breaks <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Medium"</span>,<span class="st">"High"</span><span class="op">)</span>,</span>
<span>                    ordered_result <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">satisfaction</span>, <span class="va">wait_time</span>, <span class="va">price</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit proportional‐odds (ordinal logistic) model:</span></span>
<span><span class="va">model_polr</span> <span class="op">&lt;-</span> <span class="fu">polr</span><span class="op">(</span><span class="va">satisfaction</span> <span class="op">~</span> <span class="va">wait_time</span> <span class="op">+</span> <span class="va">price</span>, data <span class="op">=</span> <span class="va">df</span>, Hess <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize coefficients and compute p‐values:</span></span>
<span><span class="va">ctable</span> <span class="op">&lt;-</span> <span class="fu">coef</span><span class="op">(</span><span class="fu">summary</span><span class="op">(</span><span class="va">model_polr</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pvals</span>  <span class="op">&lt;-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">ctable</span><span class="op">[</span>,<span class="st">"t value"</span><span class="op">]</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">ctable</span>, <span class="st">"p value"</span> <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="va">pvals</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display thresholds and predictor effects:</span></span>
<span><span class="va">results</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                  Value  Std. Error   t value p value
wait_time   -0.04036665 0.011844352 -3.408093   0.001
price       -0.02267858 0.006578292 -3.447488   0.001
Low|Medium  -3.34230915 0.625031561 -5.347425   0.000
Medium|High -1.78229869 0.564771833 -3.155785   0.002</code></pre>
</div>
<p>Interpretation:</p>
<p>The estimated coefficient for wait_time is -0.04.</p>
<p>The odds‐ratio is 0.96, meaning each additional minute of wait
changes the odds of being in a higher satisfaction category by that
factor.</p>
<p>A p‐value of 0.001 for wait_time indicates rejecting H₀: wait time
significantly affects satisfaction odds.</p>
<p>Similar interpretation applies to price.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler38" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler38" aria-expanded="false" aria-controls="collapseSpoiler38">
  <h3 class="accordion-header" id="headingSpoiler38">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Linear mixed-effects modeller (LME) </h3>
</button>
<div id="collapseSpoiler38" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler38" aria-labelledby="headingSpoiler38">
<div class="accordion-body">
<p>EJ KORREKTURLÆST #### Used for - Modeling continuous outcomes with
both fixed effects (predictors of interest) and random effects (to
account for grouped or repeated measures).<br>
- <strong>Real-world example:</strong> Evaluating the effect of a new
teaching method on student test scores, while accounting for variability
between classrooms and schools.</p>
<div class="section level4">
<h4 id="assumptions-37">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-37"></a>
</h4>
<ul>
<li>Linear relationship between predictors and outcome.<br>
</li>
<li>Residuals are independent and normally distributed with mean
zero.<br>
</li>
<li>Random effects are normally distributed.<br>
</li>
<li>Homoscedasticity: constant variance of residuals.<br>
</li>
<li>Random effects structure correctly specified (e.g., intercepts
and/or slopes).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-37">Strengths<a class="anchor" aria-label="anchor" href="#strengths-37"></a>
</h4>
<ul>
<li>Accounts for correlation within clusters (e.g., pupils within the
same classroom).<br>
</li>
<li>Can handle unbalanced data and missing observations within
clusters.<br>
</li>
<li>Flexibly models complex hierarchical or longitudinal data
structures.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-37">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-37"></a>
</h4>
<ul>
<li>Model specification (random effects structure) can be
challenging.<br>
</li>
<li>Parameter estimation can be computationally intensive and may fail
to converge.<br>
</li>
<li>Inference (p-values) often relies on approximations or additional
packages.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-37">Example<a class="anchor" aria-label="anchor" href="#example-37"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-37">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-37"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The new teaching method has
no effect on student test scores (fixed effect β_method = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The new teaching
method affects student test scores (β_method ≠ 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install/load necessary packages</span></span>
<span><span class="co"># install.packages("lme4"); install.packages("lmerTest")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lme4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: Matrix</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lmerTest</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'lmerTest'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:lme4':

    lmer</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data: 100 students in 10 classrooms within 3 schools</span></span>
<span><span class="va">n_schools</span>   <span class="op">&lt;-</span>  <span class="fl">3</span></span>
<span><span class="va">n_classes</span>   <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">students_pc</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">school</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_schools</span>, each <span class="op">=</span> <span class="va">n_classes</span> <span class="op">*</span> <span class="va">students_pc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">class</span>       <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">students_pc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">method</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"NewMethod"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">students_pc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># True model: intercept = 70, method effect = 5 points, random intercepts for class &amp; school, residual sd = 8</span></span>
<span><span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">70</span> <span class="op">+</span></span>
<span>         <span class="fu">ifelse</span><span class="op">(</span><span class="va">method</span><span class="op">==</span><span class="st">"NewMethod"</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span> <span class="op">*</span> <span class="va">students_pc</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rep</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_schools</span> <span class="op">*</span> <span class="va">n_classes</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">students_pc</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu">rep</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="va">n_schools</span>,            sd <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_classes</span> <span class="op">*</span> <span class="va">students_pc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">score</span>, <span class="va">method</span>, <span class="va">class</span>, <span class="va">school</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit linear mixed-effects model with random intercepts for school and class:</span></span>
<span><span class="va">lme_fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">method</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">/</span><span class="va">class</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize model (includes p-values via lmerTest):</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">lme_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: score ~ method + (1 | school/class)
   Data: df

REML criterion at convergence: 2132.4

Scaled residuals:
     Min       1Q   Median       3Q      Max
-2.69138 -0.67244  0.04868  0.66053  2.86344

Random effects:
 Groups       Name        Variance Std.Dev.
 class:school (Intercept) 20.88    4.570
 school       (Intercept) 91.42    9.561
 Residual                 61.31    7.830
Number of obs: 300, groups:  class:school, 30; school, 3

Fixed effects:
                Estimate Std. Error       df t value Pr(&gt;|t|)
(Intercept)      64.6076     5.6194   2.0276  11.497  0.00712 **
methodNewMethod   5.9555     0.9042 268.9993   6.587 2.35e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
methdNwMthd -0.080</code></pre>
</div>
<p>Interpretation: The fixed-effect estimate for NewMethod is 5.96
points (SE = 0.9), with p = 2.35^{-10}. We reject the null hypothesis.
Thus, there is evidence that the new teaching method significantly
changes test scores, accounting for classroom and school
variability.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler39" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler39" aria-expanded="false" aria-controls="collapseSpoiler39">
  <h3 class="accordion-header" id="headingSpoiler39">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Generalized linear mixed-effects modeller (GLMM) </h3>
</button>
<div id="collapseSpoiler39" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler39" aria-labelledby="headingSpoiler39">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-35">Used for<a class="anchor" aria-label="anchor" href="#used-for-35"></a>
</h4>
<ul>
<li>Modeling non-normal outcomes (e.g. binary, counts) with both fixed
effects and random effects.<br>
</li>
<li>
<strong>Real-world example:</strong> Predicting whether patients are
readmitted (yes/no) based on age and comorbidity score, with random
intercepts for each hospital.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-38">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-38"></a>
</h4>
<ul>
<li>Observations within each cluster (e.g. hospital) are correlated, but
clusters are independent.<br>
</li>
<li>The conditional distribution of the outcome given predictors and
random effects follows a specified exponential‐family distribution
(e.g. binomial, Poisson).<br>
</li>
<li>The link function (e.g. logit, log) correctly relates the linear
predictor to the mean of the outcome.<br>
</li>
<li>Random effects are normally distributed.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-38">Strengths<a class="anchor" aria-label="anchor" href="#strengths-38"></a>
</h4>
<ul>
<li>Can accommodate hierarchical or longitudinal data and non-Gaussian
outcomes.<br>
</li>
<li>Estimates both population‐level (fixed) effects and cluster‐specific
(random) variation.<br>
</li>
<li>Flexible: supports a variety of link functions and
distributions.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-38">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-38"></a>
</h4>
<ul>
<li>Computationally intensive; convergence can fail with complex
random‐effects structures.<br>
</li>
<li>Inference (especially p-values for fixed effects) relies on
approximations.<br>
</li>
<li>Model specification (random slopes, link choice) can be
challenging.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-38">Example<a class="anchor" aria-label="anchor" href="#example-38"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-38">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-38"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The log-odds of readmission
do not depend on age (β_age = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Age affects the
log-odds of readmission (β_age ≠ 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lme4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data for 2000 patients in 20 hospitals:</span></span>
<span><span class="va">n_hospitals</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">patients_per</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">hospital</span>   <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_hospitals</span>, each <span class="op">=</span> <span class="va">patients_per</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">age</span>        <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_hospitals</span> <span class="op">*</span> <span class="va">patients_per</span>, mean <span class="op">=</span> <span class="fl">65</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">comorbidity</span><span class="op">&lt;-</span> <span class="fu">rpois</span><span class="op">(</span><span class="va">n_hospitals</span> <span class="op">*</span> <span class="va">patients_per</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True model: logit(p) = -2 + 0.03*age + 0.5*comorbidity + random intercept by hospital</span></span>
<span><span class="va">logit_p</span>    <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.03</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">comorbidity</span> <span class="op">+</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_hospitals</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">[</span><span class="va">hospital</span><span class="op">]</span></span>
<span><span class="va">p_readmit</span>  <span class="op">&lt;-</span> <span class="fu">plogis</span><span class="op">(</span><span class="va">logit_p</span><span class="op">)</span></span>
<span><span class="va">readmit</span>    <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_hospitals</span> <span class="op">*</span> <span class="va">patients_per</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_readmit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_glmm</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>readmit <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">readmit</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="va">age</span>, <span class="va">comorbidity</span>, <span class="va">hospital</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a binomial GLMM with random intercepts for hospital:</span></span>
<span><span class="va">glmm_fit</span> <span class="op">&lt;-</span> <span class="fu">glmer</span><span class="op">(</span><span class="va">readmit</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">comorbidity</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">hospital</span><span class="op">)</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">df_glmm</span>, family <span class="op">=</span> <span class="fu">binomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">glmm_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: readmit ~ age + comorbidity + (1 | hospital)
   Data: df_glmm

      AIC       BIC    logLik -2*log(L)  df.resid
   2200.4    2222.8   -1096.2    2192.4      1996

Scaled residuals:
    Min      1Q  Median      3Q     Max
-3.9499 -0.9147  0.4555  0.6420  1.7336

Random effects:
 Groups   Name        Variance Std.Dev.
 hospital (Intercept) 0.1931   0.4395
Number of obs: 2000, groups:  hospital, 20

Fixed effects:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -2.132901   0.370427  -5.758 8.51e-09 ***
age          0.035056   0.005317   6.593 4.30e-11 ***
comorbidity  0.457562   0.044238  10.343  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) age
age         -0.932
comorbidity -0.293  0.101</code></pre>
</div>
<p>Interpretation: The fixed‐effect estimate for age is 0.035 (SE =
0.005), giving an odds ratio of 1.036 per year of age. With a z‐value =
6.59 and p ≈ 4.3^{-11}, we reject the null hypothesis. This indicates
that age is significantly associated with higher odds of readmission,
accounting for hospital clustering.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler40" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler40" aria-expanded="false" aria-controls="collapseSpoiler40">
  <h3 class="accordion-header" id="headingSpoiler40">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Generalized Estimating Equations (GEE) </h3>
</button>
<div id="collapseSpoiler40" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler40" aria-labelledby="headingSpoiler40">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-36">Used for<a class="anchor" aria-label="anchor" href="#used-for-36"></a>
</h4>
<ul>
<li>Modeling correlated or clustered data (e.g., repeated measures,
longitudinal, or clustered observations) when interest lies in
population‐averaged effects rather than subject‐specific effects.<br>
</li>
<li>
<strong>Real-world example:</strong> Estimating the effect of a
diabetes education program on the probability of glycemic control (A1C
&lt; 7%) over multiple clinic visits per patient.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-39">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-39"></a>
</h4>
<ul>
<li>Clustered or repeated observations per subject/cluster with some
“working” correlation structure (e.g., exchangeable,
autoregressive).<br>
</li>
<li>Correct specification of the link function and the mean model (e.g.,
logit link for binary outcomes).<br>
</li>
<li>Missing data are missing completely at random (MCAR) or missing at
random (MAR), assuming missingness only depends on observed
covariates.<br>
</li>
<li>Large‐sample inference: GEE relies on asymptotic properties (number
of clusters ≫ 1).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-39">Strengths<a class="anchor" aria-label="anchor" href="#strengths-39"></a>
</h4>
<ul>
<li>Robust (“sandwich”) standard errors even if the working correlation
structure is mis‐specified.<br>
</li>
<li>Provides marginal (population‐averaged) estimates, often of direct
interest in public health/epidemiology.<br>
</li>
<li>Accommodates a variety of outcomes (binary, count, continuous) via
appropriate link and family.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-39">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-39"></a>
</h4>
<ul>
<li>Efficiency can be lost if the working correlation is far from the
truth (though estimates remain consistent).<br>
</li>
<li>Inference is asymptotic—small numbers of clusters can lead to biased
standard errors.<br>
</li>
<li>Does not model subject‐specific trajectories; cannot estimate
random‐effects variance components.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-39">Example<a class="anchor" aria-label="anchor" href="#example-39"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-39">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-39"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The education program has no
effect on odds of glycemic control over time (β_edu = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The education program
changes the odds of glycemic control over time (β_edu ≠ 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install/load necessary package:</span></span>
<span><span class="co"># install.packages("geepack")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data: 100 patients (clusters), each with 4 visits</span></span>
<span><span class="va">n_patients</span>   <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">visits_per</span>   <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">patient_id</span>   <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_patients</span>, each <span class="op">=</span> <span class="va">visits_per</span><span class="op">)</span></span>
<span><span class="va">visit_number</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">visits_per</span>, times <span class="op">=</span> <span class="va">n_patients</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a binary program indicator (0=no program, 1=received education), randomly assigned at baseline</span></span>
<span><span class="va">edu_program</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_patients</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">edu</span>          <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="va">edu_program</span>, each <span class="op">=</span> <span class="va">visits_per</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate time effect (visits 1–4 coded 0–3) and baseline covariate (e.g., age)</span></span>
<span><span class="va">age_cont</span>     <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">age</span>          <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="va">age_cont</span>, each <span class="op">=</span> <span class="va">visits_per</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True population‐averaged logistic model:</span></span>
<span><span class="co"># logit(p_ij) = -1 + 0.4 * edu_i - 0.02 * age_i + 0.3 * visit_number_j</span></span>
<span><span class="co"># For simplicity, ignore cluster‐specific random effect; correlation introduced via GEE working structure.</span></span>
<span><span class="va">lin_pred</span>     <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span></span>
<span>                <span class="fl">0.4</span> <span class="op">*</span> <span class="va">edu</span> <span class="op">+</span></span>
<span>               <span class="op">-</span><span class="fl">0.02</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                <span class="fl">0.3</span> <span class="op">*</span> <span class="va">visit_number</span></span>
<span><span class="va">prob</span>         <span class="op">&lt;-</span> <span class="fu">plogis</span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate binary outcome: glycemic control (1=yes, 0=no)</span></span>
<span><span class="va">gly_control</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_patients</span> <span class="op">*</span> <span class="va">visits_per</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_gee</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  patient_id   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">patient_id</span><span class="op">)</span>,</span>
<span>  visit_number <span class="op">=</span> <span class="va">visit_number</span>,</span>
<span>  edu          <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">edu</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"NoEdu"</span>,<span class="st">"Edu"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  age          <span class="op">=</span> <span class="va">age</span>,</span>
<span>  gly_control  <span class="op">=</span> <span class="va">gly_control</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit GEE with exchangeable working correlation:</span></span>
<span><span class="va">gee_fit</span> <span class="op">&lt;-</span> <span class="fu">geeglm</span><span class="op">(</span></span>
<span>  <span class="va">gly_control</span> <span class="op">~</span> <span class="va">edu</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">visit_number</span>,</span>
<span>  id            <span class="op">=</span> <span class="va">patient_id</span>,</span>
<span>  family        <span class="op">=</span> <span class="fu">binomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  corstr        <span class="op">=</span> <span class="st">"exchangeable"</span>,</span>
<span>  data          <span class="op">=</span> <span class="va">df_gee</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">gee_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
geeglm(formula = gly_control ~ edu + age + visit_number, family = binomial(link = "logit"),
    data = df_gee, id = patient_id, corstr = "exchangeable")

 Coefficients:
             Estimate  Std.err   Wald Pr(&gt;|W|)
(Intercept)  -1.84098  0.87073  4.470   0.0345 *
eduEdu        0.55189  0.24796  4.954   0.0260 *
age          -0.01791  0.01287  1.934   0.1643
visit_number  0.55376  0.10903 25.795  3.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = exchangeable
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)   0.9761  0.1171
  Link = identity

Estimated Correlation Parameters:
      Estimate Std.err
alpha  0.00166 0.03069
Number of clusters:   100  Maximum cluster size: 4 </code></pre>
</div>
<p>Interpretation:</p>
<p>The estimated coefficient for edu (Edu vs. NoEdu) is 0.552 . Its
robust (“sandwich”) standard error is 0.248</p>
<p>, yielding a Wald‐type z = 2.23, with p = 0.026. We reject the null
hypothesis. This indicates that, across all visits and patients, those
in the education program have significantly difference in odds of
glycemic control compared to those without education.</p>
<p>The coefficient for age equals -0.0179 (p = 0.164), indicating each
additional year of age multiplies the odds of control by
exp(-0.0179).</p>
<p>The visit_number effect is 0.554 per visit (p = 3.8^{-7}), showing
whether odds of control change over successive visits.</p>
<p>Because GEE uses a sandwich estimator, these inferences remain valid
even if “exchangeable” correlation is not exactly correct, provided we
have a sufficiently large number of patients.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="kontingenstabel--og-proportions-tests">Kontingenstabel- og proportions-tests<a class="anchor" aria-label="anchor" href="#kontingenstabel--og-proportions-tests"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler41" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler41" aria-expanded="false" aria-controls="collapseSpoiler41">
  <h3 class="accordion-header" id="headingSpoiler41">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Contingency-table methods (χ² osv.) </h3>
</button>
<div id="collapseSpoiler41" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler41" aria-labelledby="headingSpoiler41">
<div class="accordion-body">
<p>EJ KORREKTURLÆST HVOR KATTEN KOMMER DET HER EGENTLIG FRA?</p>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler42" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler42" aria-expanded="false" aria-controls="collapseSpoiler42">
  <h3 class="accordion-header" id="headingSpoiler42">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> McNemar’s test </h3>
</button>
<div id="collapseSpoiler42" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler42" aria-labelledby="headingSpoiler42">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-37">Used for<a class="anchor" aria-label="anchor" href="#used-for-37"></a>
</h4>
<ul>
<li>Testing whether the proportions of paired binary outcomes differ
(i.e., detecting marginal changes in a 2×2 paired table).<br>
</li>
<li>
<strong>Real-world example:</strong> Determining if a new diagnostic
test classification (Positive/Negative) differs from an existing “gold
standard” classification on the same patients.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-40">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-40"></a>
</h4>
<ul>
<li>Data consist of paired binary observations (e.g., before/after,
test1/test2) on the same subjects.<br>
</li>
<li>Discordant cell counts (subjects where Test A=Positive &amp; Test
B=Negative or vice versa) are sufficiently large (≥ 10) for the χ²
approximation; otherwise use exact McNemar.<br>
</li>
<li>Each pair is independent of all other pairs.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-40">Strengths<a class="anchor" aria-label="anchor" href="#strengths-40"></a>
</h4>
<ul>
<li>Simple to implement for paired binary data.<br>
</li>
<li>Specifically tests for a change in proportion rather than overall
association.<br>
</li>
<li>Does not require marginal homogeneity for concordant pairs (only
discordant pairs matter).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-40">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-40"></a>
</h4>
<ul>
<li>Ignores concordant pairs (those where both methods agree), focusing
only on discordant counts.<br>
</li>
<li>χ² approximation can be invalid if discordant counts are
small—requires exact test.<br>
</li>
<li>Only applicable to 2×2 paired tables (binary outcomes).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-40">Example<a class="anchor" aria-label="anchor" href="#example-40"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-40">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-40"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The probability of discordant
outcomes is the same in both directions (b = c).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The probability of
discordant outcomes differs (b ≠ c).</li>
</ul>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated paired binary data: OldTest vs. NewTest (n = 100 patients)</span></span>
<span><span class="co">#      NewTest</span></span>
<span><span class="co"># OldTest  Positive  Negative</span></span>
<span><span class="co"># Positive      30        20   (b = 20)</span></span>
<span><span class="co"># Negative      10        40   (c = 10)</span></span>
<span></span>
<span><span class="va">ctab</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">20</span>,</span>
<span>                 <span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>               nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>                 OldTest <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Positive"</span>,<span class="st">"Negative"</span><span class="op">)</span>,</span>
<span>                 NewTest <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Positive"</span>,<span class="st">"Negative"</span><span class="op">)</span></span>
<span>               <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform McNemar’s test (χ² approximation):</span></span>
<span><span class="va">mcnemar_result</span> <span class="op">&lt;-</span> <span class="fu">mcnemar.test</span><span class="op">(</span><span class="va">ctab</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">mcnemar_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	McNemar's Chi-squared test

data:  ctab
McNemar's chi-squared = 3.3, df = 1, p-value = 0.07</code></pre>
</div>
<p>Interpretation: The McNemar χ² statistic is 3.33 with p-value =
0.0679. We fail to reject the null hypothesis. Since b (OldTest
Positive, NewTest Negative) = 20 and c (OldTest Negative, NewTest
Positive) = 10, a significant result would indicate that the switch in
classifications is not symmetric—i.e., the new test’s positive/negative
calls differ from the old test more often in one direction than the
other.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler43" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler43" aria-expanded="false" aria-controls="collapseSpoiler43">
  <h3 class="accordion-header" id="headingSpoiler43">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Fisher’s exact test </h3>
</button>
<div id="collapseSpoiler43" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler43" aria-labelledby="headingSpoiler43">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-38">Used for<a class="anchor" aria-label="anchor" href="#used-for-38"></a>
</h4>
<ul>
<li>Testing independence between two categorical variables in a
small-sample 2×2 contingency table.<br>
</li>
<li>
<strong>Real-world example:</strong> Examining whether a new
antibiotic leads to cure versus failure in 15 patients (small sample
where χ² might be invalid).</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-41">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-41"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Data form a 2×2 table (binary outcome × binary exposure).<br>
</li>
<li>Marginal totals are fixed (conditional inference on margins).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-41">Strengths<a class="anchor" aria-label="anchor" href="#strengths-41"></a>
</h4>
<ul>
<li>Exact p-value without relying on large-sample approximations.<br>
</li>
<li>Valid even when expected cell counts are very small or zero.<br>
</li>
<li>Simple to implement in R via <code>fisher.test()</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-41">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-41"></a>
</h4>
<ul>
<li>Only directly applies to 2×2 tables; extensions to larger tables
exist but are computationally intensive.<br>
</li>
<li>Does not provide an effect-size estimate beyond the odds ratio
(which must be computed separately).<br>
</li>
<li>Can be conservative (lower power) compared to asymptotic tests with
moderate sample sizes.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-41">Example<a class="anchor" aria-label="anchor" href="#example-41"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-41">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-41"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Treatment and outcome are
independent (odds ratio = 1).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Treatment and outcome
are not independent (odds ratio ≠ 1).</li>
</ul>
<div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct a 2×2 contingency table:</span></span>
<span><span class="co">#               Outcome</span></span>
<span><span class="co"># Treatment   Cure  Failure</span></span>
<span><span class="co">#   New        7      3</span></span>
<span><span class="co">#   Standard   2      3</span></span>
<span></span>
<span><span class="va">ctab</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">7</span>, <span class="fl">3</span>,</span>
<span>                 <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>                 Treatment <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"New"</span>, <span class="st">"Standard"</span><span class="op">)</span>,</span>
<span>                 Outcome   <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Cure"</span>, <span class="st">"Failure"</span><span class="op">)</span></span>
<span>               <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Fisher’s exact test:</span></span>
<span><span class="va">fisher_result</span> <span class="op">&lt;-</span> <span class="fu">fisher.test</span><span class="op">(</span><span class="va">ctab</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">fisher_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Fisher's Exact Test for Count Data

data:  ctab
p-value = 0.3
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  0.2329 59.0957
sample estimates:
odds ratio
     3.196 </code></pre>
</div>
<p>Interpretation: Fisher’s exact test yields an odds ratio estimate of
3.2 with a two-sided p-value = 0.329. We fail to reject the null
hypothesis. Thus, there is no evidence of a difference in cure rates
between the two treatments.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler44" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler44" aria-expanded="false" aria-controls="collapseSpoiler44">
  <h3 class="accordion-header" id="headingSpoiler44">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Barnard’s exact test </h3>
</button>
<div id="collapseSpoiler44" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler44" aria-labelledby="headingSpoiler44">
<div class="accordion-body">
<p>EJ KORREKTURLÆST VÆR SÆRLIGT OPMÆRKSOM HER - DER VAR STORE
UDFORDRINGER… #### Used for - Testing independence in a 2×2 contingency
table via an unconditional exact test.<br>
- <strong>Real-world example:</strong> Determining if a new pain
medication and placebo differ in adverse event rates when sample sizes
are small.</p>
<div class="section level4">
<h4 id="assumptions-42">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-42"></a>
</h4>
<ul>
<li>Observations are independent and each subject contributes exactly
one cell in the 2×2 table.<br>
</li>
<li>Only one margin (row or column totals) is fixed; the other margin is
free.<br>
</li>
<li>Binary outcome (e.g., “Adverse Event: Yes/No”) and binary grouping
(“Medication vs. Placebo”).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-42">Strengths<a class="anchor" aria-label="anchor" href="#strengths-42"></a>
</h4>
<ul>
<li>More powerful than Fisher’s exact test because it does not condition
on both margins.<br>
</li>
<li>Provides an exact p-value without relying on large‐sample
approximations.<br>
</li>
<li>Particularly advantageous when margins are not fixed by design.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-42">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-42"></a>
</h4>
<ul>
<li>Computationally slower than Fisher’s exact test for larger sample
sizes.<br>
</li>
<li>Only applies to 2×2 tables (binary × binary).<br>
</li>
<li>Requires installation of the <strong>Barnard</strong> package (not
in base R).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-42">Example<a class="anchor" aria-label="anchor" href="#example-42"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-42">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-42"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The probability of an adverse
event is the same in the Medication and Placebo groups (no
association).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The probability of an
adverse event differs between Medication and Placebo.</li>
</ul>
<div class="codewrapper sourceCode" id="cb114">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the Barnard package (only once if not already installed):</span></span>
<span><span class="co"># install.packages("Barnard")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">Barnard</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the 2×2 counts:</span></span>
<span><span class="co">#              AdverseEvent</span></span>
<span><span class="co"># Treatment   Yes   No</span></span>
<span><span class="co">#   Medication  2     8</span></span>
<span><span class="co">#   Placebo     7     3</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">2</span>   <span class="co"># Medication &amp; Yes</span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">8</span>   <span class="co"># Medication &amp; No</span></span>
<span><span class="va">n3</span> <span class="op">&lt;-</span> <span class="fl">7</span>   <span class="co"># Placebo    &amp; Yes</span></span>
<span><span class="va">n4</span> <span class="op">&lt;-</span> <span class="fl">3</span>   <span class="co"># Placebo    &amp; No</span></span>
<span></span>
<span><span class="co"># Run Barnard's unconditional exact test:</span></span>
<span><span class="va">barnard_result</span> <span class="op">&lt;-</span> <span class="fu">barnard.test</span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">n3</span>, <span class="va">n4</span>, pooled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Barnard's Unconditional Test

           Treatment I Treatment II
Outcome I            2            8
Outcome II           7            3

Null hypothesis: Treatments have no effect on the outcomes
Score statistic = 2.24733
Nuisance parameter = 0.666 (One sided), 0.5 (Two sided)
P-value = 0.0167869 (One sided), 0.0334587 (Two sided)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb116">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the test result:</span></span>
<span><span class="va">barnard_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$statistic.table
       n1 n2 statistic include.in.p.value
  [1,]  0  1   0.92803                  0
  [2,]  0  2   1.34840                  0
  [3,]  0  3   1.69932                  0
  [4,]  0  4   2.02260                  0
  [5,]  0  5   2.33550                  1
  [6,]  0  6   2.64820                  1
  [7,]  0  7   2.96836                  1
  [8,]  0  8   3.30289                  1
  [9,]  0  9   3.65902                  1
 [10,]  0 10   4.04520                  1
 [11,]  0 11   4.47214                  1
 [12,]  1  0  -1.13426                  0
 [13,]  1  1  -0.14982                  0
 [14,]  1  2   0.44057                  0
 [15,]  1  3   0.89893                  0
 [16,]  1  4   1.29750                  0
 [17,]  1  5   1.66739                  0
 [18,]  1  6   2.02603                  0
 [19,]  1  7   2.38542                  1
 [20,]  1  8   2.75556                  1
 [21,]  1  9   3.14627                  1
 [22,]  1 10   3.56867                  1
 [23,]  1 11   4.03687                  1
 [24,]  2  0  -1.64804                  0
 [25,]  2  1  -0.81819                  0
 [26,]  2  2  -0.22473                  0
 [27,]  2  3   0.25950                  0
 [28,]  2  4   0.68657                  0
 [29,]  2  5   1.08369                  0
 [30,]  2  6   1.46795                  0
 [31,]  2  7   1.85210                  0
 [32,]  2  8   2.24733                  1
 [33,]  2  9   2.66521                  1
 [34,]  2 10   3.11940                  1
 [35,]  2 11   3.62800                  1
 [36,]  3  0  -2.07695                  0
 [37,]  3  1  -1.34840                  0
 [38,]  3  2  -0.77850                  0
 [39,]  3  3  -0.29424                  0
 [40,]  3  4   0.14135                  0
 [41,]  3  5   0.55048                  0
 [42,]  3  6   0.94863                  0
 [43,]  3  7   1.34840                  0
 [44,]  3  8   1.76175                  0
 [45,]  3  9   2.20193                  0
 [46,]  3 10   2.68566                  1
 [47,]  3 11   3.23669                  1
 [48,]  4  0  -2.47207                  2
 [49,]  4  1  -1.81650                  0
 [50,]  4  2  -1.27506                  0
 [51,]  4  3  -0.80099                  0
 [52,]  4  4  -0.36699                  0
 [53,]  4  5   0.04517                  0
 [54,]  4  6   0.44947                  0
 [55,]  4  7   0.85829                  0
 [56,]  4  8   1.28446                  0
 [57,]  4  9   1.74333                  0
 [58,]  4 10   2.25588                  1
 [59,]  4 11   2.85450                  1
 [60,]  5  0  -2.85450                  2
 [61,]  5  1  -2.25588                  2
 [62,]  5  2  -1.74333                  0
 [63,]  5  3  -1.28446                  0
 [64,]  5  4  -0.85829                  0
 [65,]  5  5  -0.44947                  0
 [66,]  5  6  -0.04517                  0
 [67,]  5  7   0.36699                  0
 [68,]  5  8   0.80099                  0
 [69,]  5  9   1.27506                  0
 [70,]  5 10   1.81650                  0
 [71,]  5 11   2.47207                  1
 [72,]  6  0  -3.23669                  2
 [73,]  6  1  -2.68566                  2
 [74,]  6  2  -2.20193                  0
 [75,]  6  3  -1.76175                  0
 [76,]  6  4  -1.34840                  0
 [77,]  6  5  -0.94863                  0
 [78,]  6  6  -0.55048                  0
 [79,]  6  7  -0.14135                  0
 [80,]  6  8   0.29424                  0
 [81,]  6  9   0.77850                  0
 [82,]  6 10   1.34840                  0
 [83,]  6 11   2.07695                  0
 [84,]  7  0  -3.62800                  2
 [85,]  7  1  -3.11940                  2
 [86,]  7  2  -2.66521                  2
 [87,]  7  3  -2.24733                  2
 [88,]  7  4  -1.85210                  0
 [89,]  7  5  -1.46795                  0
 [90,]  7  6  -1.08369                  0
 [91,]  7  7  -0.68657                  0
 [92,]  7  8  -0.25950                  0
 [93,]  7  9   0.22473                  0
 [94,]  7 10   0.81819                  0
 [95,]  7 11   1.64804                  0
 [96,]  8  0  -4.03687                  2
 [97,]  8  1  -3.56867                  2
 [98,]  8  2  -3.14627                  2
 [99,]  8  3  -2.75556                  2
[100,]  8  4  -2.38542                  2
[101,]  8  5  -2.02603                  0
[102,]  8  6  -1.66739                  0
[103,]  8  7  -1.29750                  0
[104,]  8  8  -0.89893                  0
[105,]  8  9  -0.44057                  0
[106,]  8 10   0.14982                  0
[107,]  8 11   1.13426                  0
[108,]  9  0  -4.47214                  2
[109,]  9  1  -4.04520                  2
[110,]  9  2  -3.65902                  2
[111,]  9  3  -3.30289                  2
[112,]  9  4  -2.96836                  2
[113,]  9  5  -2.64820                  2
[114,]  9  6  -2.33550                  2
[115,]  9  7  -2.02260                  0
[116,]  9  8  -1.69932                  0
[117,]  9  9  -1.34840                  0
[118,]  9 10  -0.92803                  0

$nuisance.matrix
         [,1]      [,2]      [,3]
   [1,] 0.000 0.000e+00 0.000e+00
   [2,] 0.001 4.556e-13 1.246e-10
   [3,] 0.002 1.438e-11 1.971e-09
   [4,] 0.003 1.076e-10 9.865e-09
   [5,] 0.004 4.473e-10 3.083e-08
   [6,] 0.005 1.346e-09 7.441e-08
   [7,] 0.006 3.302e-09 1.526e-07
   [8,] 0.007 7.038e-09 2.795e-07
   [9,] 0.008 1.353e-08 4.714e-07
  [10,] 0.009 2.404e-08 7.466e-07
  [11,] 0.010 4.014e-08 1.125e-06
  [12,] 0.011 6.374e-08 1.629e-06
  [13,] 0.012 9.709e-08 2.281e-06
  [14,] 0.013 1.428e-07 3.106e-06
  [15,] 0.014 2.040e-07 4.131e-06
  [16,] 0.015 2.840e-07 5.383e-06
  [17,] 0.016 3.866e-07 6.890e-06
  [18,] 0.017 5.161e-07 8.681e-06
  [19,] 0.018 6.772e-07 1.079e-05
  [20,] 0.019 8.748e-07 1.324e-05
  [21,] 0.020 1.115e-06 1.608e-05
  [22,] 0.021 1.402e-06 1.932e-05
  [23,] 0.022 1.745e-06 2.301e-05
  [24,] 0.023 2.148e-06 2.718e-05
  [25,] 0.024 2.620e-06 3.186e-05
  [26,] 0.025 3.167e-06 3.709e-05
  [27,] 0.026 3.798e-06 4.290e-05
  [28,] 0.027 4.522e-06 4.933e-05
  [29,] 0.028 5.347e-06 5.641e-05
  [30,] 0.029 6.281e-06 6.418e-05
  [31,] 0.030 7.335e-06 7.268e-05
  [32,] 0.031 8.519e-06 8.193e-05
  [33,] 0.032 9.842e-06 9.198e-05
  [34,] 0.033 1.131e-05 1.029e-04
  [35,] 0.034 1.295e-05 1.146e-04
  [36,] 0.035 1.475e-05 1.272e-04
  [37,] 0.036 1.674e-05 1.408e-04
  [38,] 0.037 1.892e-05 1.554e-04
  [39,] 0.038 2.131e-05 1.709e-04
  [40,] 0.039 2.392e-05 1.875e-04
  [41,] 0.040 2.676e-05 2.051e-04
  [42,] 0.041 2.984e-05 2.238e-04
  [43,] 0.042 3.318e-05 2.437e-04
  [44,] 0.043 3.678e-05 2.648e-04
  [45,] 0.044 4.067e-05 2.870e-04
  [46,] 0.045 4.484e-05 3.104e-04
  [47,] 0.046 4.933e-05 3.351e-04
  [48,] 0.047 5.414e-05 3.611e-04
  [49,] 0.048 5.928e-05 3.884e-04
  [50,] 0.049 6.476e-05 4.171e-04
  [51,] 0.050 7.061e-05 4.470e-04
  [52,] 0.051 7.683e-05 4.784e-04
  [53,] 0.052 8.343e-05 5.112e-04
  [54,] 0.053 9.044e-05 5.455e-04
  [55,] 0.054 9.785e-05 5.812e-04
  [56,] 0.055 1.057e-04 6.184e-04
  [57,] 0.056 1.140e-04 6.571e-04
  [58,] 0.057 1.227e-04 6.973e-04
  [59,] 0.058 1.319e-04 7.391e-04
  [60,] 0.059 1.416e-04 7.824e-04
  [61,] 0.060 1.517e-04 8.273e-04
  [62,] 0.061 1.624e-04 8.739e-04
  [63,] 0.062 1.736e-04 9.220e-04
  [64,] 0.063 1.853e-04 9.718e-04
  [65,] 0.064 1.975e-04 1.023e-03
  [66,] 0.065 2.103e-04 1.076e-03
  [67,] 0.066 2.237e-04 1.131e-03
  [68,] 0.067 2.376e-04 1.188e-03
  [69,] 0.068 2.521e-04 1.246e-03
  [70,] 0.069 2.673e-04 1.306e-03
  [71,] 0.070 2.830e-04 1.367e-03
  [72,] 0.071 2.993e-04 1.431e-03
  [73,] 0.072 3.163e-04 1.496e-03
  [74,] 0.073 3.338e-04 1.563e-03
  [75,] 0.074 3.521e-04 1.631e-03
  [76,] 0.075 3.710e-04 1.702e-03
  [77,] 0.076 3.905e-04 1.774e-03
  [78,] 0.077 4.107e-04 1.848e-03
  [79,] 0.078 4.316e-04 1.923e-03
  [80,] 0.079 4.532e-04 2.001e-03
  [81,] 0.080 4.755e-04 2.080e-03
  [82,] 0.081 4.985e-04 2.161e-03
  [83,] 0.082 5.222e-04 2.244e-03
  [84,] 0.083 5.466e-04 2.329e-03
  [85,] 0.084 5.717e-04 2.415e-03
  [86,] 0.085 5.975e-04 2.503e-03
  [87,] 0.086 6.241e-04 2.593e-03
  [88,] 0.087 6.514e-04 2.684e-03
  [89,] 0.088 6.795e-04 2.778e-03
  [90,] 0.089 7.083e-04 2.873e-03
  [91,] 0.090 7.378e-04 2.970e-03
  [92,] 0.091 7.681e-04 3.068e-03
  [93,] 0.092 7.991e-04 3.169e-03
  [94,] 0.093 8.309e-04 3.271e-03
  [95,] 0.094 8.635e-04 3.374e-03
  [96,] 0.095 8.968e-04 3.480e-03
  [97,] 0.096 9.309e-04 3.587e-03
  [98,] 0.097 9.657e-04 3.696e-03
  [99,] 0.098 1.001e-03 3.806e-03
 [100,] 0.099 1.038e-03 3.918e-03
 [101,] 0.100 1.075e-03 4.032e-03
 [102,] 0.101 1.113e-03 4.147e-03
 [103,] 0.102 1.151e-03 4.264e-03
 [104,] 0.103 1.191e-03 4.383e-03
 [105,] 0.104 1.231e-03 4.503e-03
 [106,] 0.105 1.272e-03 4.624e-03
 [107,] 0.106 1.314e-03 4.747e-03
 [108,] 0.107 1.356e-03 4.872e-03
 [109,] 0.108 1.399e-03 4.998e-03
 [110,] 0.109 1.443e-03 5.126e-03
 [111,] 0.110 1.488e-03 5.255e-03
 [112,] 0.111 1.533e-03 5.385e-03
 [113,] 0.112 1.580e-03 5.517e-03
 [114,] 0.113 1.626e-03 5.650e-03
 [115,] 0.114 1.674e-03 5.785e-03
 [116,] 0.115 1.722e-03 5.921e-03
 [117,] 0.116 1.771e-03 6.058e-03
 [118,] 0.117 1.821e-03 6.197e-03
 [119,] 0.118 1.872e-03 6.337e-03
 [120,] 0.119 1.923e-03 6.478e-03
 [121,] 0.120 1.975e-03 6.621e-03
 [122,] 0.121 2.027e-03 6.764e-03
 [123,] 0.122 2.080e-03 6.909e-03
 [124,] 0.123 2.134e-03 7.055e-03
 [125,] 0.124 2.189e-03 7.202e-03
 [126,] 0.125 2.244e-03 7.350e-03
 [127,] 0.126 2.300e-03 7.499e-03
 [128,] 0.127 2.356e-03 7.650e-03
 [129,] 0.128 2.413e-03 7.801e-03
 [130,] 0.129 2.471e-03 7.953e-03
 [131,] 0.130 2.529e-03 8.107e-03
 [132,] 0.131 2.588e-03 8.261e-03
 [133,] 0.132 2.647e-03 8.416e-03
 [134,] 0.133 2.708e-03 8.572e-03
 [135,] 0.134 2.768e-03 8.729e-03
 [136,] 0.135 2.829e-03 8.887e-03
 [137,] 0.136 2.891e-03 9.045e-03
 [138,] 0.137 2.953e-03 9.205e-03
 [139,] 0.138 3.016e-03 9.365e-03
 [140,] 0.139 3.079e-03 9.525e-03
 [141,] 0.140 3.143e-03 9.687e-03
 [142,] 0.141 3.207e-03 9.849e-03
 [143,] 0.142 3.272e-03 1.001e-02
 [144,] 0.143 3.337e-03 1.017e-02
 [145,] 0.144 3.403e-03 1.034e-02
 [146,] 0.145 3.469e-03 1.050e-02
 [147,] 0.146 3.535e-03 1.067e-02
 [148,] 0.147 3.602e-03 1.083e-02
 [149,] 0.148 3.670e-03 1.100e-02
 [150,] 0.149 3.737e-03 1.117e-02
 [151,] 0.150 3.806e-03 1.133e-02
 [152,] 0.151 3.874e-03 1.150e-02
 [153,] 0.152 3.943e-03 1.167e-02
 [154,] 0.153 4.012e-03 1.184e-02
 [155,] 0.154 4.082e-03 1.200e-02
 [156,] 0.155 4.152e-03 1.217e-02
 [157,] 0.156 4.222e-03 1.234e-02
 [158,] 0.157 4.292e-03 1.251e-02
 [159,] 0.158 4.363e-03 1.268e-02
 [160,] 0.159 4.434e-03 1.285e-02
 [161,] 0.160 4.505e-03 1.302e-02
 [162,] 0.161 4.577e-03 1.318e-02
 [163,] 0.162 4.648e-03 1.335e-02
 [164,] 0.163 4.720e-03 1.352e-02
 [165,] 0.164 4.793e-03 1.369e-02
 [166,] 0.165 4.865e-03 1.386e-02
 [167,] 0.166 4.938e-03 1.403e-02
 [168,] 0.167 5.010e-03 1.420e-02
 [169,] 0.168 5.083e-03 1.437e-02
 [170,] 0.169 5.156e-03 1.454e-02
 [171,] 0.170 5.229e-03 1.471e-02
 [172,] 0.171 5.303e-03 1.488e-02
 [173,] 0.172 5.376e-03 1.504e-02
 [174,] 0.173 5.450e-03 1.521e-02
 [175,] 0.174 5.523e-03 1.538e-02
 [176,] 0.175 5.597e-03 1.555e-02
 [177,] 0.176 5.671e-03 1.571e-02
 [178,] 0.177 5.744e-03 1.588e-02
 [179,] 0.178 5.818e-03 1.605e-02
 [180,] 0.179 5.892e-03 1.621e-02
 [181,] 0.180 5.966e-03 1.638e-02
 [182,] 0.181 6.040e-03 1.655e-02
 [183,] 0.182 6.114e-03 1.671e-02
 [184,] 0.183 6.187e-03 1.687e-02
 [185,] 0.184 6.261e-03 1.704e-02
 [186,] 0.185 6.335e-03 1.720e-02
 [187,] 0.186 6.409e-03 1.737e-02
 [188,] 0.187 6.482e-03 1.753e-02
 [189,] 0.188 6.556e-03 1.769e-02
 [190,] 0.189 6.630e-03 1.785e-02
 [191,] 0.190 6.703e-03 1.801e-02
 [192,] 0.191 6.776e-03 1.817e-02
 [193,] 0.192 6.850e-03 1.833e-02
 [194,] 0.193 6.923e-03 1.849e-02
 [195,] 0.194 6.996e-03 1.865e-02
 [196,] 0.195 7.069e-03 1.880e-02
 [197,] 0.196 7.141e-03 1.896e-02
 [198,] 0.197 7.214e-03 1.912e-02
 [199,] 0.198 7.286e-03 1.927e-02
 [200,] 0.199 7.359e-03 1.942e-02
 [201,] 0.200 7.431e-03 1.958e-02
 [202,] 0.201 7.502e-03 1.973e-02
 [203,] 0.202 7.574e-03 1.988e-02
 [204,] 0.203 7.646e-03 2.003e-02
 [205,] 0.204 7.717e-03 2.018e-02
 [206,] 0.205 7.788e-03 2.033e-02
 [207,] 0.206 7.859e-03 2.048e-02
 [208,] 0.207 7.929e-03 2.063e-02
 [209,] 0.208 8.000e-03 2.077e-02
 [210,] 0.209 8.070e-03 2.092e-02
 [211,] 0.210 8.140e-03 2.106e-02
 [212,] 0.211 8.209e-03 2.120e-02
 [213,] 0.212 8.278e-03 2.135e-02
 [214,] 0.213 8.347e-03 2.149e-02
 [215,] 0.214 8.416e-03 2.163e-02
 [216,] 0.215 8.485e-03 2.177e-02
 [217,] 0.216 8.553e-03 2.191e-02
 [218,] 0.217 8.621e-03 2.204e-02
 [219,] 0.218 8.688e-03 2.218e-02
 [220,] 0.219 8.756e-03 2.232e-02
 [221,] 0.220 8.823e-03 2.245e-02
 [222,] 0.221 8.889e-03 2.258e-02
 [223,] 0.222 8.956e-03 2.272e-02
 [224,] 0.223 9.022e-03 2.285e-02
 [225,] 0.224 9.087e-03 2.298e-02
 [226,] 0.225 9.153e-03 2.311e-02
 [227,] 0.226 9.218e-03 2.323e-02
 [228,] 0.227 9.282e-03 2.336e-02
 [229,] 0.228 9.347e-03 2.348e-02
 [230,] 0.229 9.411e-03 2.361e-02
 [231,] 0.230 9.474e-03 2.373e-02
 [232,] 0.231 9.537e-03 2.385e-02
 [233,] 0.232 9.600e-03 2.398e-02
 [234,] 0.233 9.663e-03 2.410e-02
 [235,] 0.234 9.725e-03 2.421e-02
 [236,] 0.235 9.787e-03 2.433e-02
 [237,] 0.236 9.848e-03 2.445e-02
 [238,] 0.237 9.909e-03 2.456e-02
 [239,] 0.238 9.970e-03 2.468e-02
 [240,] 0.239 1.003e-02 2.479e-02
 [241,] 0.240 1.009e-02 2.490e-02
 [242,] 0.241 1.015e-02 2.501e-02
 [243,] 0.242 1.021e-02 2.512e-02
 [244,] 0.243 1.027e-02 2.523e-02
 [245,] 0.244 1.033e-02 2.534e-02
 [246,] 0.245 1.038e-02 2.544e-02
 [247,] 0.246 1.044e-02 2.555e-02
 [248,] 0.247 1.050e-02 2.565e-02
 [249,] 0.248 1.056e-02 2.576e-02
 [250,] 0.249 1.061e-02 2.586e-02
 [251,] 0.250 1.067e-02 2.596e-02
 [252,] 0.251 1.073e-02 2.606e-02
 [253,] 0.252 1.078e-02 2.616e-02
 [254,] 0.253 1.084e-02 2.625e-02
 [255,] 0.254 1.089e-02 2.635e-02
 [256,] 0.255 1.094e-02 2.644e-02
 [257,] 0.256 1.100e-02 2.654e-02
 [258,] 0.257 1.105e-02 2.663e-02
 [259,] 0.258 1.111e-02 2.672e-02
 [260,] 0.259 1.116e-02 2.681e-02
 [261,] 0.260 1.121e-02 2.690e-02
 [262,] 0.261 1.126e-02 2.699e-02
 [263,] 0.262 1.131e-02 2.707e-02
 [264,] 0.263 1.137e-02 2.716e-02
 [265,] 0.264 1.142e-02 2.724e-02
 [266,] 0.265 1.147e-02 2.733e-02
 [267,] 0.266 1.152e-02 2.741e-02
 [268,] 0.267 1.157e-02 2.749e-02
 [269,] 0.268 1.162e-02 2.757e-02
 [270,] 0.269 1.167e-02 2.765e-02
 [271,] 0.270 1.171e-02 2.773e-02
 [272,] 0.271 1.176e-02 2.781e-02
 [273,] 0.272 1.181e-02 2.788e-02
 [274,] 0.273 1.186e-02 2.796e-02
 [275,] 0.274 1.191e-02 2.803e-02
 [276,] 0.275 1.195e-02 2.811e-02
 [277,] 0.276 1.200e-02 2.818e-02
 [278,] 0.277 1.204e-02 2.825e-02
 [279,] 0.278 1.209e-02 2.832e-02
 [280,] 0.279 1.214e-02 2.839e-02
 [281,] 0.280 1.218e-02 2.846e-02
 [282,] 0.281 1.223e-02 2.852e-02
 [283,] 0.282 1.227e-02 2.859e-02
 [284,] 0.283 1.232e-02 2.866e-02
 [285,] 0.284 1.236e-02 2.872e-02
 [286,] 0.285 1.240e-02 2.878e-02
 [287,] 0.286 1.245e-02 2.885e-02
 [288,] 0.287 1.249e-02 2.891e-02
 [289,] 0.288 1.253e-02 2.897e-02
 [290,] 0.289 1.257e-02 2.903e-02
 [291,] 0.290 1.262e-02 2.909e-02
 [292,] 0.291 1.266e-02 2.915e-02
 [293,] 0.292 1.270e-02 2.920e-02
 [294,] 0.293 1.274e-02 2.926e-02
 [295,] 0.294 1.278e-02 2.931e-02
 [296,] 0.295 1.282e-02 2.937e-02
 [297,] 0.296 1.286e-02 2.942e-02
 [298,] 0.297 1.290e-02 2.948e-02
 [299,] 0.298 1.294e-02 2.953e-02
 [300,] 0.299 1.298e-02 2.958e-02
 [301,] 0.300 1.302e-02 2.963e-02
 [302,] 0.301 1.306e-02 2.968e-02
 [303,] 0.302 1.309e-02 2.973e-02
 [304,] 0.303 1.313e-02 2.978e-02
 [305,] 0.304 1.317e-02 2.983e-02
 [306,] 0.305 1.321e-02 2.987e-02
 [307,] 0.306 1.324e-02 2.992e-02
 [308,] 0.307 1.328e-02 2.997e-02
 [309,] 0.308 1.332e-02 3.001e-02
 [310,] 0.309 1.335e-02 3.006e-02
 [311,] 0.310 1.339e-02 3.010e-02
 [312,] 0.311 1.343e-02 3.014e-02
 [313,] 0.312 1.346e-02 3.018e-02
 [314,] 0.313 1.350e-02 3.023e-02
 [315,] 0.314 1.353e-02 3.027e-02
 [316,] 0.315 1.357e-02 3.031e-02
 [317,] 0.316 1.360e-02 3.035e-02
 [318,] 0.317 1.364e-02 3.039e-02
 [319,] 0.318 1.367e-02 3.043e-02
 [320,] 0.319 1.371e-02 3.046e-02
 [321,] 0.320 1.374e-02 3.050e-02
 [322,] 0.321 1.377e-02 3.054e-02
 [323,] 0.322 1.381e-02 3.058e-02
 [324,] 0.323 1.384e-02 3.061e-02
 [325,] 0.324 1.387e-02 3.065e-02
 [326,] 0.325 1.390e-02 3.068e-02
 [327,] 0.326 1.394e-02 3.072e-02
 [328,] 0.327 1.397e-02 3.075e-02
 [329,] 0.328 1.400e-02 3.078e-02
 [330,] 0.329 1.403e-02 3.082e-02
 [331,] 0.330 1.406e-02 3.085e-02
 [332,] 0.331 1.410e-02 3.088e-02
 [333,] 0.332 1.413e-02 3.091e-02
 [334,] 0.333 1.416e-02 3.094e-02
 [335,] 0.334 1.419e-02 3.097e-02
 [336,] 0.335 1.422e-02 3.101e-02
 [337,] 0.336 1.425e-02 3.104e-02
 [338,] 0.337 1.428e-02 3.106e-02
 [339,] 0.338 1.431e-02 3.109e-02
 [340,] 0.339 1.434e-02 3.112e-02
 [341,] 0.340 1.437e-02 3.115e-02
 [342,] 0.341 1.440e-02 3.118e-02
 [343,] 0.342 1.443e-02 3.121e-02
 [344,] 0.343 1.446e-02 3.123e-02
 [345,] 0.344 1.448e-02 3.126e-02
 [346,] 0.345 1.451e-02 3.129e-02
 [347,] 0.346 1.454e-02 3.131e-02
 [348,] 0.347 1.457e-02 3.134e-02
 [349,] 0.348 1.460e-02 3.137e-02
 [350,] 0.349 1.462e-02 3.139e-02
 [351,] 0.350 1.465e-02 3.142e-02
 [352,] 0.351 1.468e-02 3.144e-02
 [353,] 0.352 1.471e-02 3.147e-02
 [354,] 0.353 1.473e-02 3.149e-02
 [355,] 0.354 1.476e-02 3.152e-02
 [356,] 0.355 1.479e-02 3.154e-02
 [357,] 0.356 1.481e-02 3.156e-02
 [358,] 0.357 1.484e-02 3.159e-02
 [359,] 0.358 1.487e-02 3.161e-02
 [360,] 0.359 1.489e-02 3.163e-02
 [361,] 0.360 1.492e-02 3.166e-02
 [362,] 0.361 1.494e-02 3.168e-02
 [363,] 0.362 1.497e-02 3.170e-02
 [364,] 0.363 1.500e-02 3.172e-02
 [365,] 0.364 1.502e-02 3.174e-02
 [366,] 0.365 1.505e-02 3.177e-02
 [367,] 0.366 1.507e-02 3.179e-02
 [368,] 0.367 1.509e-02 3.181e-02
 [369,] 0.368 1.512e-02 3.183e-02
 [370,] 0.369 1.514e-02 3.185e-02
 [371,] 0.370 1.517e-02 3.187e-02
 [372,] 0.371 1.519e-02 3.189e-02
 [373,] 0.372 1.522e-02 3.191e-02
 [374,] 0.373 1.524e-02 3.193e-02
 [375,] 0.374 1.526e-02 3.195e-02
 [376,] 0.375 1.529e-02 3.197e-02
 [377,] 0.376 1.531e-02 3.199e-02
 [378,] 0.377 1.533e-02 3.201e-02
 [379,] 0.378 1.536e-02 3.203e-02
 [380,] 0.379 1.538e-02 3.205e-02
 [381,] 0.380 1.540e-02 3.207e-02
 [382,] 0.381 1.542e-02 3.209e-02
 [383,] 0.382 1.544e-02 3.211e-02
 [384,] 0.383 1.547e-02 3.213e-02
 [385,] 0.384 1.549e-02 3.215e-02
 [386,] 0.385 1.551e-02 3.217e-02
 [387,] 0.386 1.553e-02 3.219e-02
 [388,] 0.387 1.555e-02 3.221e-02
 [389,] 0.388 1.557e-02 3.222e-02
 [390,] 0.389 1.559e-02 3.224e-02
 [391,] 0.390 1.562e-02 3.226e-02
 [392,] 0.391 1.564e-02 3.228e-02
 [393,] 0.392 1.566e-02 3.230e-02
 [394,] 0.393 1.568e-02 3.231e-02
 [395,] 0.394 1.570e-02 3.233e-02
 [396,] 0.395 1.572e-02 3.235e-02
 [397,] 0.396 1.574e-02 3.237e-02
 [398,] 0.397 1.576e-02 3.239e-02
 [399,] 0.398 1.577e-02 3.240e-02
 [400,] 0.399 1.579e-02 3.242e-02
 [401,] 0.400 1.581e-02 3.244e-02
 [402,] 0.401 1.583e-02 3.245e-02
 [403,] 0.402 1.585e-02 3.247e-02
 [404,] 0.403 1.587e-02 3.249e-02
 [405,] 0.404 1.589e-02 3.251e-02
 [406,] 0.405 1.590e-02 3.252e-02
 [407,] 0.406 1.592e-02 3.254e-02
 [408,] 0.407 1.594e-02 3.256e-02
 [409,] 0.408 1.596e-02 3.257e-02
 [410,] 0.409 1.597e-02 3.259e-02
 [411,] 0.410 1.599e-02 3.261e-02
 [412,] 0.411 1.601e-02 3.262e-02
 [413,] 0.412 1.603e-02 3.264e-02
 [414,] 0.413 1.604e-02 3.265e-02
 [415,] 0.414 1.606e-02 3.267e-02
 [416,] 0.415 1.607e-02 3.269e-02
 [417,] 0.416 1.609e-02 3.270e-02
 [418,] 0.417 1.611e-02 3.272e-02
 [419,] 0.418 1.612e-02 3.273e-02
 [420,] 0.419 1.614e-02 3.275e-02
 [421,] 0.420 1.615e-02 3.276e-02
 [422,] 0.421 1.617e-02 3.278e-02
 [423,] 0.422 1.618e-02 3.279e-02
 [424,] 0.423 1.620e-02 3.281e-02
 [425,] 0.424 1.621e-02 3.282e-02
 [426,] 0.425 1.623e-02 3.284e-02
 [427,] 0.426 1.624e-02 3.285e-02
 [428,] 0.427 1.625e-02 3.287e-02
 [429,] 0.428 1.627e-02 3.288e-02
 [430,] 0.429 1.628e-02 3.290e-02
 [431,] 0.430 1.629e-02 3.291e-02
 [432,] 0.431 1.631e-02 3.292e-02
 [433,] 0.432 1.632e-02 3.294e-02
 [434,] 0.433 1.633e-02 3.295e-02
 [435,] 0.434 1.634e-02 3.297e-02
 [436,] 0.435 1.636e-02 3.298e-02
 [437,] 0.436 1.637e-02 3.299e-02
 [438,] 0.437 1.638e-02 3.301e-02
 [439,] 0.438 1.639e-02 3.302e-02
 [440,] 0.439 1.640e-02 3.303e-02
 [441,] 0.440 1.641e-02 3.304e-02
 [442,] 0.441 1.642e-02 3.306e-02
 [443,] 0.442 1.644e-02 3.307e-02
 [444,] 0.443 1.645e-02 3.308e-02
 [445,] 0.444 1.646e-02 3.309e-02
 [446,] 0.445 1.647e-02 3.311e-02
 [447,] 0.446 1.648e-02 3.312e-02
 [448,] 0.447 1.649e-02 3.313e-02
 [449,] 0.448 1.650e-02 3.314e-02
 [450,] 0.449 1.650e-02 3.315e-02
 [451,] 0.450 1.651e-02 3.316e-02
 [452,] 0.451 1.652e-02 3.318e-02
 [453,] 0.452 1.653e-02 3.319e-02
 [454,] 0.453 1.654e-02 3.320e-02
 [455,] 0.454 1.655e-02 3.321e-02
 [456,] 0.455 1.656e-02 3.322e-02
 [457,] 0.456 1.656e-02 3.323e-02
 [458,] 0.457 1.657e-02 3.324e-02
 [459,] 0.458 1.658e-02 3.325e-02
 [460,] 0.459 1.659e-02 3.326e-02
 [461,] 0.460 1.659e-02 3.327e-02
 [462,] 0.461 1.660e-02 3.328e-02
 [463,] 0.462 1.661e-02 3.328e-02
 [464,] 0.463 1.661e-02 3.329e-02
 [465,] 0.464 1.662e-02 3.330e-02
 [466,] 0.465 1.663e-02 3.331e-02
 [467,] 0.466 1.663e-02 3.332e-02
 [468,] 0.467 1.664e-02 3.333e-02
 [469,] 0.468 1.664e-02 3.333e-02
 [470,] 0.469 1.665e-02 3.334e-02
 [471,] 0.470 1.665e-02 3.335e-02
 [472,] 0.471 1.666e-02 3.336e-02
 [473,] 0.472 1.666e-02 3.336e-02
 [474,] 0.473 1.667e-02 3.337e-02
 [475,] 0.474 1.667e-02 3.338e-02
 [476,] 0.475 1.668e-02 3.338e-02
 [477,] 0.476 1.668e-02 3.339e-02
 [478,] 0.477 1.668e-02 3.339e-02
 [479,] 0.478 1.669e-02 3.340e-02
 [480,] 0.479 1.669e-02 3.340e-02
 [481,] 0.480 1.670e-02 3.341e-02
 [482,] 0.481 1.670e-02 3.341e-02
 [483,] 0.482 1.670e-02 3.342e-02
 [484,] 0.483 1.670e-02 3.342e-02
 [485,] 0.484 1.671e-02 3.343e-02
 [486,] 0.485 1.671e-02 3.343e-02
 [487,] 0.486 1.671e-02 3.343e-02
 [488,] 0.487 1.671e-02 3.344e-02
 [489,] 0.488 1.672e-02 3.344e-02
 [490,] 0.489 1.672e-02 3.344e-02
 [491,] 0.490 1.672e-02 3.345e-02
 [492,] 0.491 1.672e-02 3.345e-02
 [493,] 0.492 1.672e-02 3.345e-02
 [494,] 0.493 1.672e-02 3.345e-02
 [495,] 0.494 1.673e-02 3.345e-02
 [496,] 0.495 1.673e-02 3.346e-02
 [497,] 0.496 1.673e-02 3.346e-02
 [498,] 0.497 1.673e-02 3.346e-02
 [499,] 0.498 1.673e-02 3.346e-02
 [500,] 0.499 1.673e-02 3.346e-02
 [501,] 0.500 1.673e-02 3.346e-02
 [502,] 0.501 1.673e-02 3.346e-02
 [503,] 0.502 1.673e-02 3.346e-02
 [504,] 0.503 1.673e-02 3.346e-02
 [505,] 0.504 1.673e-02 3.346e-02
 [506,] 0.505 1.673e-02 3.346e-02
 [507,] 0.506 1.673e-02 3.345e-02
 [508,] 0.507 1.673e-02 3.345e-02
 [509,] 0.508 1.673e-02 3.345e-02
 [510,] 0.509 1.673e-02 3.345e-02
 [511,] 0.510 1.673e-02 3.345e-02
 [512,] 0.511 1.673e-02 3.344e-02
 [513,] 0.512 1.672e-02 3.344e-02
 [514,] 0.513 1.672e-02 3.344e-02
 [515,] 0.514 1.672e-02 3.343e-02
 [516,] 0.515 1.672e-02 3.343e-02
 [517,] 0.516 1.672e-02 3.343e-02
 [518,] 0.517 1.672e-02 3.342e-02
 [519,] 0.518 1.672e-02 3.342e-02
 [520,] 0.519 1.672e-02 3.341e-02
 [521,] 0.520 1.671e-02 3.341e-02
 [522,] 0.521 1.671e-02 3.340e-02
 [523,] 0.522 1.671e-02 3.340e-02
 [524,] 0.523 1.671e-02 3.339e-02
 [525,] 0.524 1.671e-02 3.339e-02
 [526,] 0.525 1.671e-02 3.338e-02
 [527,] 0.526 1.670e-02 3.338e-02
 [528,] 0.527 1.670e-02 3.337e-02
 [529,] 0.528 1.670e-02 3.336e-02
 [530,] 0.529 1.670e-02 3.336e-02
 [531,] 0.530 1.670e-02 3.335e-02
 [532,] 0.531 1.669e-02 3.334e-02
 [533,] 0.532 1.669e-02 3.333e-02
 [534,] 0.533 1.669e-02 3.333e-02
 [535,] 0.534 1.669e-02 3.332e-02
 [536,] 0.535 1.668e-02 3.331e-02
 [537,] 0.536 1.668e-02 3.330e-02
 [538,] 0.537 1.668e-02 3.329e-02
 [539,] 0.538 1.668e-02 3.328e-02
 [540,] 0.539 1.668e-02 3.328e-02
 [541,] 0.540 1.667e-02 3.327e-02
 [542,] 0.541 1.667e-02 3.326e-02
 [543,] 0.542 1.667e-02 3.325e-02
 [544,] 0.543 1.667e-02 3.324e-02
 [545,] 0.544 1.666e-02 3.323e-02
 [546,] 0.545 1.666e-02 3.322e-02
 [547,] 0.546 1.666e-02 3.321e-02
 [548,] 0.547 1.666e-02 3.320e-02
 [549,] 0.548 1.666e-02 3.319e-02
 [550,] 0.549 1.665e-02 3.318e-02
 [551,] 0.550 1.665e-02 3.316e-02
 [552,] 0.551 1.665e-02 3.315e-02
 [553,] 0.552 1.665e-02 3.314e-02
 [554,] 0.553 1.664e-02 3.313e-02
 [555,] 0.554 1.664e-02 3.312e-02
 [556,] 0.555 1.664e-02 3.311e-02
 [557,] 0.556 1.664e-02 3.309e-02
 [558,] 0.557 1.664e-02 3.308e-02
 [559,] 0.558 1.664e-02 3.307e-02
 [560,] 0.559 1.663e-02 3.306e-02
 [561,] 0.560 1.663e-02 3.304e-02
 [562,] 0.561 1.663e-02 3.303e-02
 [563,] 0.562 1.663e-02 3.302e-02
 [564,] 0.563 1.663e-02 3.301e-02
 [565,] 0.564 1.663e-02 3.299e-02
 [566,] 0.565 1.662e-02 3.298e-02
 [567,] 0.566 1.662e-02 3.297e-02
 [568,] 0.567 1.662e-02 3.295e-02
 [569,] 0.568 1.662e-02 3.294e-02
 [570,] 0.569 1.662e-02 3.292e-02
 [571,] 0.570 1.662e-02 3.291e-02
 [572,] 0.571 1.662e-02 3.290e-02
 [573,] 0.572 1.662e-02 3.288e-02
 [574,] 0.573 1.661e-02 3.287e-02
 [575,] 0.574 1.661e-02 3.285e-02
 [576,] 0.575 1.661e-02 3.284e-02
 [577,] 0.576 1.661e-02 3.282e-02
 [578,] 0.577 1.661e-02 3.281e-02
 [579,] 0.578 1.661e-02 3.279e-02
 [580,] 0.579 1.661e-02 3.278e-02
 [581,] 0.580 1.661e-02 3.276e-02
 [582,] 0.581 1.661e-02 3.275e-02
 [583,] 0.582 1.661e-02 3.273e-02
 [584,] 0.583 1.661e-02 3.272e-02
 [585,] 0.584 1.661e-02 3.270e-02
 [586,] 0.585 1.661e-02 3.269e-02
 [587,] 0.586 1.661e-02 3.267e-02
 [588,] 0.587 1.661e-02 3.265e-02
 [589,] 0.588 1.661e-02 3.264e-02
 [590,] 0.589 1.661e-02 3.262e-02
 [591,] 0.590 1.661e-02 3.261e-02
 [592,] 0.591 1.661e-02 3.259e-02
 [593,] 0.592 1.662e-02 3.257e-02
 [594,] 0.593 1.662e-02 3.256e-02
 [595,] 0.594 1.662e-02 3.254e-02
 [596,] 0.595 1.662e-02 3.252e-02
 [597,] 0.596 1.662e-02 3.251e-02
 [598,] 0.597 1.662e-02 3.249e-02
 [599,] 0.598 1.662e-02 3.247e-02
 [600,] 0.599 1.662e-02 3.245e-02
 [601,] 0.600 1.663e-02 3.244e-02
 [602,] 0.601 1.663e-02 3.242e-02
 [603,] 0.602 1.663e-02 3.240e-02
 [604,] 0.603 1.663e-02 3.239e-02
 [605,] 0.604 1.663e-02 3.237e-02
 [606,] 0.605 1.663e-02 3.235e-02
 [607,] 0.606 1.664e-02 3.233e-02
 [608,] 0.607 1.664e-02 3.231e-02
 [609,] 0.608 1.664e-02 3.230e-02
 [610,] 0.609 1.664e-02 3.228e-02
 [611,] 0.610 1.665e-02 3.226e-02
 [612,] 0.611 1.665e-02 3.224e-02
 [613,] 0.612 1.665e-02 3.222e-02
 [614,] 0.613 1.665e-02 3.221e-02
 [615,] 0.614 1.666e-02 3.219e-02
 [616,] 0.615 1.666e-02 3.217e-02
 [617,] 0.616 1.666e-02 3.215e-02
 [618,] 0.617 1.666e-02 3.213e-02
 [619,] 0.618 1.667e-02 3.211e-02
 [620,] 0.619 1.667e-02 3.209e-02
 [621,] 0.620 1.667e-02 3.207e-02
 [622,] 0.621 1.668e-02 3.205e-02
 [623,] 0.622 1.668e-02 3.203e-02
 [624,] 0.623 1.668e-02 3.201e-02
 [625,] 0.624 1.668e-02 3.199e-02
 [626,] 0.625 1.669e-02 3.197e-02
 [627,] 0.626 1.669e-02 3.195e-02
 [628,] 0.627 1.669e-02 3.193e-02
 [629,] 0.628 1.670e-02 3.191e-02
 [630,] 0.629 1.670e-02 3.189e-02
 [631,] 0.630 1.670e-02 3.187e-02
 [632,] 0.631 1.671e-02 3.185e-02
 [633,] 0.632 1.671e-02 3.183e-02
 [634,] 0.633 1.671e-02 3.181e-02
 [635,] 0.634 1.672e-02 3.179e-02
 [636,] 0.635 1.672e-02 3.177e-02
 [637,] 0.636 1.672e-02 3.174e-02
 [638,] 0.637 1.673e-02 3.172e-02
 [639,] 0.638 1.673e-02 3.170e-02
 [640,] 0.639 1.673e-02 3.168e-02
 [641,] 0.640 1.674e-02 3.166e-02
 [642,] 0.641 1.674e-02 3.163e-02
 [643,] 0.642 1.674e-02 3.161e-02
 [644,] 0.643 1.675e-02 3.159e-02
 [645,] 0.644 1.675e-02 3.156e-02
 [646,] 0.645 1.675e-02 3.154e-02
 [647,] 0.646 1.675e-02 3.152e-02
 [648,] 0.647 1.676e-02 3.149e-02
 [649,] 0.648 1.676e-02 3.147e-02
 [650,] 0.649 1.676e-02 3.144e-02
 [651,] 0.650 1.677e-02 3.142e-02
 [652,] 0.651 1.677e-02 3.139e-02
 [653,] 0.652 1.677e-02 3.137e-02
 [654,] 0.653 1.677e-02 3.134e-02
 [655,] 0.654 1.677e-02 3.131e-02
 [656,] 0.655 1.678e-02 3.129e-02
 [657,] 0.656 1.678e-02 3.126e-02
 [658,] 0.657 1.678e-02 3.123e-02
 [659,] 0.658 1.678e-02 3.121e-02
 [660,] 0.659 1.678e-02 3.118e-02
 [661,] 0.660 1.678e-02 3.115e-02
 [662,] 0.661 1.678e-02 3.112e-02
 [663,] 0.662 1.679e-02 3.109e-02
 [664,] 0.663 1.679e-02 3.106e-02
 [665,] 0.664 1.679e-02 3.104e-02
 [666,] 0.665 1.679e-02 3.101e-02
 [667,] 0.666 1.679e-02 3.097e-02
 [668,] 0.667 1.679e-02 3.094e-02
 [669,] 0.668 1.679e-02 3.091e-02
 [670,] 0.669 1.679e-02 3.088e-02
 [671,] 0.670 1.679e-02 3.085e-02
 [672,] 0.671 1.678e-02 3.082e-02
 [673,] 0.672 1.678e-02 3.078e-02
 [674,] 0.673 1.678e-02 3.075e-02
 [675,] 0.674 1.678e-02 3.072e-02
 [676,] 0.675 1.678e-02 3.068e-02
 [677,] 0.676 1.678e-02 3.065e-02
 [678,] 0.677 1.677e-02 3.061e-02
 [679,] 0.678 1.677e-02 3.058e-02
 [680,] 0.679 1.677e-02 3.054e-02
 [681,] 0.680 1.676e-02 3.050e-02
 [682,] 0.681 1.676e-02 3.046e-02
 [683,] 0.682 1.675e-02 3.043e-02
 [684,] 0.683 1.675e-02 3.039e-02
 [685,] 0.684 1.675e-02 3.035e-02
 [686,] 0.685 1.674e-02 3.031e-02
 [687,] 0.686 1.673e-02 3.027e-02
 [688,] 0.687 1.673e-02 3.023e-02
 [689,] 0.688 1.672e-02 3.018e-02
 [690,] 0.689 1.672e-02 3.014e-02
 [691,] 0.690 1.671e-02 3.010e-02
 [692,] 0.691 1.670e-02 3.006e-02
 [693,] 0.692 1.669e-02 3.001e-02
 [694,] 0.693 1.668e-02 2.997e-02
 [695,] 0.694 1.668e-02 2.992e-02
 [696,] 0.695 1.667e-02 2.987e-02
 [697,] 0.696 1.666e-02 2.983e-02
 [698,] 0.697 1.665e-02 2.978e-02
 [699,] 0.698 1.664e-02 2.973e-02
 [700,] 0.699 1.663e-02 2.968e-02
 [701,] 0.700 1.661e-02 2.963e-02
 [702,] 0.701 1.660e-02 2.958e-02
 [703,] 0.702 1.659e-02 2.953e-02
 [704,] 0.703 1.658e-02 2.948e-02
 [705,] 0.704 1.656e-02 2.942e-02
 [706,] 0.705 1.655e-02 2.937e-02
 [707,] 0.706 1.654e-02 2.931e-02
 [708,] 0.707 1.652e-02 2.926e-02
 [709,] 0.708 1.651e-02 2.920e-02
 [710,] 0.709 1.649e-02 2.915e-02
 [711,] 0.710 1.647e-02 2.909e-02
 [712,] 0.711 1.646e-02 2.903e-02
 [713,] 0.712 1.644e-02 2.897e-02
 [714,] 0.713 1.642e-02 2.891e-02
 [715,] 0.714 1.640e-02 2.885e-02
 [716,] 0.715 1.638e-02 2.878e-02
 [717,] 0.716 1.636e-02 2.872e-02
 [718,] 0.717 1.634e-02 2.866e-02
 [719,] 0.718 1.632e-02 2.859e-02
 [720,] 0.719 1.630e-02 2.852e-02
 [721,] 0.720 1.628e-02 2.846e-02
 [722,] 0.721 1.625e-02 2.839e-02
 [723,] 0.722 1.623e-02 2.832e-02
 [724,] 0.723 1.620e-02 2.825e-02
 [725,] 0.724 1.618e-02 2.818e-02
 [726,] 0.725 1.615e-02 2.811e-02
 [727,] 0.726 1.613e-02 2.803e-02
 [728,] 0.727 1.610e-02 2.796e-02
 [729,] 0.728 1.607e-02 2.788e-02
 [730,] 0.729 1.604e-02 2.781e-02
 [731,] 0.730 1.602e-02 2.773e-02
 [732,] 0.731 1.599e-02 2.765e-02
 [733,] 0.732 1.596e-02 2.757e-02
 [734,] 0.733 1.593e-02 2.749e-02
 [735,] 0.734 1.589e-02 2.741e-02
 [736,] 0.735 1.586e-02 2.733e-02
 [737,] 0.736 1.583e-02 2.724e-02
 [738,] 0.737 1.579e-02 2.716e-02
 [739,] 0.738 1.576e-02 2.707e-02
 [740,] 0.739 1.572e-02 2.699e-02
 [741,] 0.740 1.569e-02 2.690e-02
 [742,] 0.741 1.565e-02 2.681e-02
 [743,] 0.742 1.561e-02 2.672e-02
 [744,] 0.743 1.558e-02 2.663e-02
 [745,] 0.744 1.554e-02 2.654e-02
 [746,] 0.745 1.550e-02 2.644e-02
 [747,] 0.746 1.546e-02 2.635e-02
 [748,] 0.747 1.542e-02 2.625e-02
 [749,] 0.748 1.537e-02 2.616e-02
 [750,] 0.749 1.533e-02 2.606e-02
 [751,] 0.750 1.529e-02 2.596e-02
 [752,] 0.751 1.524e-02 2.586e-02
 [753,] 0.752 1.520e-02 2.576e-02
 [754,] 0.753 1.515e-02 2.565e-02
 [755,] 0.754 1.511e-02 2.555e-02
 [756,] 0.755 1.506e-02 2.544e-02
 [757,] 0.756 1.501e-02 2.534e-02
 [758,] 0.757 1.496e-02 2.523e-02
 [759,] 0.758 1.491e-02 2.512e-02
 [760,] 0.759 1.486e-02 2.501e-02
 [761,] 0.760 1.481e-02 2.490e-02
 [762,] 0.761 1.476e-02 2.479e-02
 [763,] 0.762 1.471e-02 2.468e-02
 [764,] 0.763 1.465e-02 2.456e-02
 [765,] 0.764 1.460e-02 2.445e-02
 [766,] 0.765 1.454e-02 2.433e-02
 [767,] 0.766 1.449e-02 2.421e-02
 [768,] 0.767 1.443e-02 2.410e-02
 [769,] 0.768 1.438e-02 2.398e-02
 [770,] 0.769 1.432e-02 2.385e-02
 [771,] 0.770 1.426e-02 2.373e-02
 [772,] 0.771 1.420e-02 2.361e-02
 [773,] 0.772 1.414e-02 2.348e-02
 [774,] 0.773 1.408e-02 2.336e-02
 [775,] 0.774 1.402e-02 2.323e-02
 [776,] 0.775 1.395e-02 2.311e-02
 [777,] 0.776 1.389e-02 2.298e-02
 [778,] 0.777 1.382e-02 2.285e-02
 [779,] 0.778 1.376e-02 2.272e-02
 [780,] 0.779 1.369e-02 2.258e-02
 [781,] 0.780 1.363e-02 2.245e-02
 [782,] 0.781 1.356e-02 2.232e-02
 [783,] 0.782 1.349e-02 2.218e-02
 [784,] 0.783 1.342e-02 2.204e-02
 [785,] 0.784 1.335e-02 2.191e-02
 [786,] 0.785 1.328e-02 2.177e-02
 [787,] 0.786 1.321e-02 2.163e-02
 [788,] 0.787 1.314e-02 2.149e-02
 [789,] 0.788 1.307e-02 2.135e-02
 [790,] 0.789 1.300e-02 2.120e-02
 [791,] 0.790 1.292e-02 2.106e-02
 [792,] 0.791 1.285e-02 2.092e-02
 [793,] 0.792 1.277e-02 2.077e-02
 [794,] 0.793 1.270e-02 2.063e-02
 [795,] 0.794 1.262e-02 2.048e-02
 [796,] 0.795 1.254e-02 2.033e-02
 [797,] 0.796 1.246e-02 2.018e-02
 [798,] 0.797 1.239e-02 2.003e-02
 [799,] 0.798 1.231e-02 1.988e-02
 [800,] 0.799 1.223e-02 1.973e-02
 [801,] 0.800 1.215e-02 1.958e-02
 [802,] 0.801 1.207e-02 1.942e-02
 [803,] 0.802 1.198e-02 1.927e-02
 [804,] 0.803 1.190e-02 1.912e-02
 [805,] 0.804 1.182e-02 1.896e-02
 [806,] 0.805 1.173e-02 1.880e-02
 [807,] 0.806 1.165e-02 1.865e-02
 [808,] 0.807 1.157e-02 1.849e-02
 [809,] 0.808 1.148e-02 1.833e-02
 [810,] 0.809 1.139e-02 1.817e-02
 [811,] 0.810 1.131e-02 1.801e-02
 [812,] 0.811 1.122e-02 1.785e-02
 [813,] 0.812 1.113e-02 1.769e-02
 [814,] 0.813 1.104e-02 1.753e-02
 [815,] 0.814 1.096e-02 1.737e-02
 [816,] 0.815 1.087e-02 1.720e-02
 [817,] 0.816 1.078e-02 1.704e-02
 [818,] 0.817 1.069e-02 1.687e-02
 [819,] 0.818 1.060e-02 1.671e-02
 [820,] 0.819 1.051e-02 1.655e-02
 [821,] 0.820 1.041e-02 1.638e-02
 [822,] 0.821 1.032e-02 1.621e-02
 [823,] 0.822 1.023e-02 1.605e-02
 [824,] 0.823 1.014e-02 1.588e-02
 [825,] 0.824 1.004e-02 1.571e-02
 [826,] 0.825 9.951e-03 1.555e-02
 [827,] 0.826 9.857e-03 1.538e-02
 [828,] 0.827 9.763e-03 1.521e-02
 [829,] 0.828 9.668e-03 1.504e-02
 [830,] 0.829 9.573e-03 1.488e-02
 [831,] 0.830 9.478e-03 1.471e-02
 [832,] 0.831 9.382e-03 1.454e-02
 [833,] 0.832 9.286e-03 1.437e-02
 [834,] 0.833 9.190e-03 1.420e-02
 [835,] 0.834 9.094e-03 1.403e-02
 [836,] 0.835 8.997e-03 1.386e-02
 [837,] 0.836 8.900e-03 1.369e-02
 [838,] 0.837 8.803e-03 1.352e-02
 [839,] 0.838 8.706e-03 1.335e-02
 [840,] 0.839 8.608e-03 1.318e-02
 [841,] 0.840 8.510e-03 1.302e-02
 [842,] 0.841 8.413e-03 1.285e-02
 [843,] 0.842 8.315e-03 1.268e-02
 [844,] 0.843 8.216e-03 1.251e-02
 [845,] 0.844 8.118e-03 1.234e-02
 [846,] 0.845 8.020e-03 1.217e-02
 [847,] 0.846 7.921e-03 1.200e-02
 [848,] 0.847 7.823e-03 1.184e-02
 [849,] 0.848 7.724e-03 1.167e-02
 [850,] 0.849 7.626e-03 1.150e-02
 [851,] 0.850 7.527e-03 1.133e-02
 [852,] 0.851 7.429e-03 1.117e-02
 [853,] 0.852 7.330e-03 1.100e-02
 [854,] 0.853 7.231e-03 1.083e-02
 [855,] 0.854 7.133e-03 1.067e-02
 [856,] 0.855 7.034e-03 1.050e-02
 [857,] 0.856 6.936e-03 1.034e-02
 [858,] 0.857 6.838e-03 1.017e-02
 [859,] 0.858 6.740e-03 1.001e-02
 [860,] 0.859 6.642e-03 9.849e-03
 [861,] 0.860 6.544e-03 9.687e-03
 [862,] 0.861 6.446e-03 9.525e-03
 [863,] 0.862 6.349e-03 9.365e-03
 [864,] 0.863 6.251e-03 9.205e-03
 [865,] 0.864 6.154e-03 9.045e-03
 [866,] 0.865 6.057e-03 8.887e-03
 [867,] 0.866 5.961e-03 8.729e-03
 [868,] 0.867 5.865e-03 8.572e-03
 [869,] 0.868 5.769e-03 8.416e-03
 [870,] 0.869 5.673e-03 8.261e-03
 [871,] 0.870 5.578e-03 8.107e-03
 [872,] 0.871 5.483e-03 7.953e-03
 [873,] 0.872 5.388e-03 7.801e-03
 [874,] 0.873 5.294e-03 7.650e-03
 [875,] 0.874 5.200e-03 7.499e-03
 [876,] 0.875 5.106e-03 7.350e-03
 [877,] 0.876 5.013e-03 7.202e-03
 [878,] 0.877 4.921e-03 7.055e-03
 [879,] 0.878 4.829e-03 6.909e-03
 [880,] 0.879 4.737e-03 6.764e-03
 [881,] 0.880 4.646e-03 6.621e-03
 [882,] 0.881 4.555e-03 6.478e-03
 [883,] 0.882 4.465e-03 6.337e-03
 [884,] 0.883 4.376e-03 6.197e-03
 [885,] 0.884 4.287e-03 6.058e-03
 [886,] 0.885 4.199e-03 5.921e-03
 [887,] 0.886 4.111e-03 5.785e-03
 [888,] 0.887 4.024e-03 5.650e-03
 [889,] 0.888 3.938e-03 5.517e-03
 [890,] 0.889 3.852e-03 5.385e-03
 [891,] 0.890 3.767e-03 5.255e-03
 [892,] 0.891 3.682e-03 5.126e-03
 [893,] 0.892 3.599e-03 4.998e-03
 [894,] 0.893 3.516e-03 4.872e-03
 [895,] 0.894 3.434e-03 4.747e-03
 [896,] 0.895 3.352e-03 4.624e-03
 [897,] 0.896 3.272e-03 4.503e-03
 [898,] 0.897 3.192e-03 4.383e-03
 [899,] 0.898 3.113e-03 4.264e-03
 [900,] 0.899 3.034e-03 4.147e-03
 [901,] 0.900 2.957e-03 4.032e-03
 [902,] 0.901 2.880e-03 3.918e-03
 [903,] 0.902 2.805e-03 3.806e-03
 [904,] 0.903 2.730e-03 3.696e-03
 [905,] 0.904 2.656e-03 3.587e-03
 [906,] 0.905 2.583e-03 3.480e-03
 [907,] 0.906 2.511e-03 3.374e-03
 [908,] 0.907 2.440e-03 3.271e-03
 [909,] 0.908 2.369e-03 3.169e-03
 [910,] 0.909 2.300e-03 3.068e-03
 [911,] 0.910 2.232e-03 2.970e-03
 [912,] 0.911 2.165e-03 2.873e-03
 [913,] 0.912 2.098e-03 2.778e-03
 [914,] 0.913 2.033e-03 2.684e-03
 [915,] 0.914 1.969e-03 2.593e-03
 [916,] 0.915 1.905e-03 2.503e-03
 [917,] 0.916 1.843e-03 2.415e-03
 [918,] 0.917 1.782e-03 2.329e-03
 [919,] 0.918 1.722e-03 2.244e-03
 [920,] 0.919 1.663e-03 2.161e-03
 [921,] 0.920 1.605e-03 2.080e-03
 [922,] 0.921 1.548e-03 2.001e-03
 [923,] 0.922 1.492e-03 1.923e-03
 [924,] 0.923 1.437e-03 1.848e-03
 [925,] 0.924 1.383e-03 1.774e-03
 [926,] 0.925 1.331e-03 1.702e-03
 [927,] 0.926 1.279e-03 1.631e-03
 [928,] 0.927 1.229e-03 1.563e-03
 [929,] 0.928 1.180e-03 1.496e-03
 [930,] 0.929 1.131e-03 1.431e-03
 [931,] 0.930 1.084e-03 1.367e-03
 [932,] 0.931 1.039e-03 1.306e-03
 [933,] 0.932 9.937e-04 1.246e-03
 [934,] 0.933 9.500e-04 1.188e-03
 [935,] 0.934 9.075e-04 1.131e-03
 [936,] 0.935 8.660e-04 1.076e-03
 [937,] 0.936 8.257e-04 1.023e-03
 [938,] 0.937 7.865e-04 9.718e-04
 [939,] 0.938 7.484e-04 9.220e-04
 [940,] 0.939 7.115e-04 8.739e-04
 [941,] 0.940 6.756e-04 8.273e-04
 [942,] 0.941 6.408e-04 7.824e-04
 [943,] 0.942 6.072e-04 7.391e-04
 [944,] 0.943 5.746e-04 6.973e-04
 [945,] 0.944 5.431e-04 6.571e-04
 [946,] 0.945 5.127e-04 6.184e-04
 [947,] 0.946 4.833e-04 5.812e-04
 [948,] 0.947 4.550e-04 5.455e-04
 [949,] 0.948 4.278e-04 5.112e-04
 [950,] 0.949 4.016e-04 4.784e-04
 [951,] 0.950 3.764e-04 4.470e-04
 [952,] 0.951 3.523e-04 4.171e-04
 [953,] 0.952 3.291e-04 3.884e-04
 [954,] 0.953 3.070e-04 3.611e-04
 [955,] 0.954 2.858e-04 3.351e-04
 [956,] 0.955 2.656e-04 3.104e-04
 [957,] 0.956 2.463e-04 2.870e-04
 [958,] 0.957 2.280e-04 2.648e-04
 [959,] 0.958 2.105e-04 2.437e-04
 [960,] 0.959 1.940e-04 2.238e-04
 [961,] 0.960 1.783e-04 2.051e-04
 [962,] 0.961 1.635e-04 1.875e-04
 [963,] 0.962 1.496e-04 1.709e-04
 [964,] 0.963 1.364e-04 1.554e-04
 [965,] 0.964 1.241e-04 1.408e-04
 [966,] 0.965 1.125e-04 1.272e-04
 [967,] 0.966 1.016e-04 1.146e-04
 [968,] 0.967 9.154e-05 1.029e-04
 [969,] 0.968 8.214e-05 9.198e-05
 [970,] 0.969 7.341e-05 8.193e-05
 [971,] 0.970 6.534e-05 7.268e-05
 [972,] 0.971 5.790e-05 6.418e-05
 [973,] 0.972 5.107e-05 5.641e-05
 [974,] 0.973 4.481e-05 4.933e-05
 [975,] 0.974 3.910e-05 4.290e-05
 [976,] 0.975 3.392e-05 3.709e-05
 [977,] 0.976 2.924e-05 3.186e-05
 [978,] 0.977 2.503e-05 2.718e-05
 [979,] 0.978 2.127e-05 2.301e-05
 [980,] 0.979 1.792e-05 1.932e-05
 [981,] 0.980 1.496e-05 1.608e-05
 [982,] 0.981 1.237e-05 1.324e-05
 [983,] 0.982 1.011e-05 1.079e-05
 [984,] 0.983 8.165e-06 8.681e-06
 [985,] 0.984 6.503e-06 6.890e-06
 [986,] 0.985 5.099e-06 5.383e-06
 [987,] 0.986 3.927e-06 4.131e-06
 [988,] 0.987 2.963e-06 3.106e-06
 [989,] 0.988 2.184e-06 2.281e-06
 [990,] 0.989 1.565e-06 1.629e-06
 [991,] 0.990 1.085e-06 1.125e-06
 [992,] 0.991 7.225e-07 7.466e-07
 [993,] 0.992 4.579e-07 4.714e-07
 [994,] 0.993 2.724e-07 2.795e-07
 [995,] 0.994 1.493e-07 1.526e-07
 [996,] 0.995 7.307e-08 7.441e-08
 [997,] 0.996 3.038e-08 3.083e-08
 [998,] 0.997 9.757e-09 9.865e-09
 [999,] 0.998 1.956e-09 1.971e-09
[1000,] 0.999 1.241e-10 1.246e-10
[1001,] 1.000 0.000e+00 0.000e+00

$dp
[1] 0.001

$contingency.matrix
           Treatment I Treatment II
Outcome I            2            8
Outcome II           7            3

$alternative
[1] "One sided" "Two sided"

$statistic
[1] 2.247

$nuisance.parameter
[1] 0.666 0.500

$p.value
[1] 0.01679 0.03346

$pooled
[1] TRUE</code></pre>
</div>
<p>Interpretation: The output includes:</p>
<p>A score statistic (here ≈ 2.24733).</p>
<p>Two nuisance parameter estimates (0.666 for one-sided, 0.500 for
two-sided).</p>
<p>Two p-values in $p.value:</p>
<p>barnard_result$p.value[1] = 0.0167869 (one‐sided)</p>
<p>barnard_result$p.value[2] = 0.0334587 (two‐sided)</p>
<p>Two‐sided p‐value (0.0335): Tests whether the adverse‐event
probabilities differ in either direction. Since 0.0335 &lt; 0.05, we
reject H0</p>
<p>and conclude there is a significant difference in adverse‐event rates
between Medication and Placebo.</p>
<p>One‐sided p‐value (0.0168): Tests specifically whether the Medication
adverse‐event rate is greater than the Placebo rate. Because 0.0168 &lt;
0.05, we also conclude that Medication has a higher adverse‐event
probability than Placebo.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler45" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler45" aria-expanded="false" aria-controls="collapseSpoiler45">
  <h3 class="accordion-header" id="headingSpoiler45">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cochran–Armitage trend test (ordinal tabel) </h3>
</button>
<div id="collapseSpoiler45" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler45" aria-labelledby="headingSpoiler45">
<div class="accordion-body">
<p>EJ KORREKTURLÆST #### Used for - Testing for a linear trend in
proportions across ordered categories in a 2×k contingency table.<br>
- <strong>Real-world example:</strong> Assessing whether increasing
levels of prenatal vitamin dose (Low, Medium, High) correspond to higher
rates of healthy birth outcomes (Yes/No).</p>
<div class="section level4">
<h4 id="assumptions-43">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-43"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Categories of the ordinal predictor have a natural order (e.g., Low
&lt; Medium &lt; High).<br>
</li>
<li>The response is binary within each category (success/failure).<br>
</li>
<li>Expected counts for successes and failures in each category are
sufficiently large for the χ² approximation (generally ≥ 5).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-43">Strengths<a class="anchor" aria-label="anchor" href="#strengths-43"></a>
</h4>
<ul>
<li>Specifically targets a monotonic (linear) increase or decrease in
the success probability across ordered groups.<br>
</li>
<li>More powerful than a general χ² test of independence when a linear
trend is present.<br>
</li>
<li>Straightforward to compute via <code>prop.trend.test()</code> in
R.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-43">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-43"></a>
</h4>
<ul>
<li>Only detects a linear trend; non-monotonic patterns (e.g., U-shaped)
will be missed.<br>
</li>
<li>Requires correct ordering and spacing of category scores;
misordering invalidates the test.<br>
</li>
<li>Sensitive to small expected counts in any group, which can distort
the chi-square approximation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-43">Example<a class="anchor" aria-label="anchor" href="#example-43"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-43">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-43"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> No linear trend in the
probability of a healthy birth outcome across dose levels (slope =
0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> A positive linear
trend exists: higher dose levels correspond to higher healthy birth
rates (slope &gt; 0).</li>
</ul>
<div class="codewrapper sourceCode" id="cb118">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define counts of healthy outcomes by dose:</span></span>
<span><span class="co">#   Low:    30 healthy, 20 unhealthy</span></span>
<span><span class="co">#   Medium: 40 healthy, 10 unhealthy</span></span>
<span><span class="co">#   High:   45 healthy, 5  unhealthy</span></span>
<span></span>
<span><span class="va">successes</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">45</span><span class="op">)</span>   <span class="co"># number of healthy births in Low, Medium, High</span></span>
<span><span class="va">totals</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>   <span class="co"># total births in each dose group</span></span>
<span><span class="va">scores</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>      <span class="co"># equally spaced scores for Low, Medium, High</span></span>
<span></span>
<span><span class="co"># Perform Cochran–Armitage trend test via prop.trend.test:</span></span>
<span><span class="va">trend_result</span> <span class="op">&lt;-</span> <span class="fu">prop.trend.test</span><span class="op">(</span><span class="va">successes</span>, <span class="va">totals</span>, score <span class="op">=</span> <span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">trend_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Chi-squared Test for Trend in Proportions

data:  successes out of totals ,
 using scores: 1 2 3
X-squared = 13, df = 1, p-value = 4e-04</code></pre>
</div>
<p>Interpretation: The Cochran–Armitage test statistic χ² = 12.578 with
p-value = 3.9^{-4}. Because the p-value is &lt; 0.05, we reject the null
hypothesis. Thus, there is evidence of a positive linear trend: higher
prenatal vitamin doses are associated with higher healthy birth
rates.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler46" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler46" aria-expanded="false" aria-controls="collapseSpoiler46">
  <h3 class="accordion-header" id="headingSpoiler46">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cochran’s Q test (≥3 matched proportions) </h3>
</button>
<div id="collapseSpoiler46" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler46" aria-labelledby="headingSpoiler46">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-39">Used for<a class="anchor" aria-label="anchor" href="#used-for-39"></a>
</h4>
<ul>
<li>Testing whether proportions of a binary outcome differ across three
or more related (matched) groups.<br>
</li>
<li>
<strong>Real-world example:</strong> Checking if three different
allergy medications have different proportions of symptom relief in the
same set of patients.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-44">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-44"></a>
</h4>
<ul>
<li>Each subject is measured on the same binary outcome under each
condition (matched/paired design).<br>
</li>
<li>Observations (subjects) are independent of one another.<br>
</li>
<li>The outcome for each subject in each group is binary (e.g., “relief”
vs. “no relief”).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-44">Strengths<a class="anchor" aria-label="anchor" href="#strengths-44"></a>
</h4>
<ul>
<li>Extends McNemar’s test to more than two matched proportions.<br>
</li>
<li>Controls for subject‐level variability by using each subject as
their own block.<br>
</li>
<li>Simple test statistic and interpretation via χ² distribution.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-44">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-44"></a>
</h4>
<ul>
<li>Only addresses overall difference; does not indicate which pairs of
groups differ (post‐hoc tests required).<br>
</li>
<li>Sensitive to missing data: any subject missing a response in one
condition must be excluded.<br>
</li>
<li>Assumes no interactions or clustering beyond the matched sets.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-44">Example<a class="anchor" aria-label="anchor" href="#example-44"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-44">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-44"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The proportion of patients
experiencing symptom relief is the same across all three medications (p₁
= p₂ = p₃).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
medication’s relief proportion differs from the others.</li>
</ul>
<div class="codewrapper sourceCode" id="cb120">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load DescTools if not already installed:</span></span>
<span><span class="co"># install.packages("DescTools")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">DescTools</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'DescTools'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:car':

    Recode</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb123">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate binary relief outcomes for 12 patients on three medications:</span></span>
<span><span class="co"># 1 = relief, 0 = no relief</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">relief_med1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">relief_med2</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">relief_med3</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a matrix: rows = subjects, columns = medications</span></span>
<span><span class="va">relief_matrix</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">relief_med1</span>, <span class="va">relief_med2</span>, <span class="va">relief_med3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Cochran’s Q test:</span></span>
<span><span class="va">cq_result</span> <span class="op">&lt;-</span> <span class="fu">CochranQTest</span><span class="op">(</span><span class="va">relief_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">cq_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Cochran's Q test

data:  y
Q = 0.29, df = 2, p-value = 0.9</code></pre>
</div>
<p>Interpretation: Cochran’s Q statistic = 0.286 with df = 2 and p-value
= 0.867. We fail to reject the null hypothesis. Thus, there is no
evidence that relief proportions differ across the three
medications.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler47" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler47" aria-expanded="false" aria-controls="collapseSpoiler47">
  <h3 class="accordion-header" id="headingSpoiler47">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Stuart–Maxwell test (marginal homogenitet) </h3>
</button>
<div id="collapseSpoiler47" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler47" aria-labelledby="headingSpoiler47">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-40">Used for<a class="anchor" aria-label="anchor" href="#used-for-40"></a>
</h4>
<ul>
<li>Testing marginal homogeneity in a square contingency table of paired
categorical outcomes (k ≥ 3 categories).<br>
</li>
<li>
<strong>Real-world example:</strong> Assessing whether patients’
self‐rated pain levels (None, Mild, Moderate, Severe) before and after a
new analgesic are distributed the same way.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-45">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-45"></a>
</h4>
<ul>
<li>Data consist of paired observations on the same subjects, each
classified into one of k categories at two time points or under two
conditions.<br>
</li>
<li>The contingency table is square (same set of k categories for
“before” and “after”).<br>
</li>
<li>Observations (pairs) are independent of one another.<br>
</li>
<li>No cell has zero counts that prevent the necessary sums for the test
(ideally none of the off‐diagonal cell sums are zero across all
pairs).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-45">Strengths<a class="anchor" aria-label="anchor" href="#strengths-45"></a>
</h4>
<ul>
<li>Generalizes McNemar’s test to k &gt; 2 categories.<br>
</li>
<li>Specifically tests whether the overall marginal (row vs. column)
distributions are the same.<br>
</li>
<li>Computes a χ²‐statistic based on off‐diagonal discordances,
summarizing all category shifts.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-45">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-45"></a>
</h4>
<ul>
<li>Only detects overall marginal changes; does not indicate which
category pairs drive the difference (post‐hoc needed).<br>
</li>
<li>Sensitive to small sample sizes or sparse off‐diagonal entries (may
lack power or violate asymptotic χ² approximation).<br>
</li>
<li>Assumes symmetry under the null; if many pairs move in one direction
but not the reverse, marginal sums can still balance, potentially
masking certain shifts.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-45">Example<a class="anchor" aria-label="anchor" href="#example-45"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-45">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-45"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The marginal distribution of
pain levels is the same before and after treatment.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The marginal
distributions differ (some shifts in categories occurred).</li>
</ul>
<div class="codewrapper sourceCode" id="cb125">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load DescTools if not already installed:</span></span>
<span><span class="co"># install.packages("DescTools")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">DescTools</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate paired pain ratings for 50 patients:</span></span>
<span><span class="co"># Categories: 1=None, 2=Mild, 3=Moderate, 4=Severe</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">before</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># After treatment: some improvement for many, some unchanged or worse</span></span>
<span><span class="va">after</span>  <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="fu">pmax</span><span class="op">(</span><span class="va">before</span> <span class="op">+</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a square contingency table of before vs. after:</span></span>
<span><span class="va">pain_table</span> <span class="op">&lt;-</span> <span class="fu">table</span><span class="op">(</span><span class="fu">factor</span><span class="op">(</span><span class="va">before</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>                    <span class="fu">factor</span><span class="op">(</span><span class="va">after</span>,  levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">dimnames</span><span class="op">(</span><span class="va">pain_table</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  Before <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"None"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span>
<span>  After  <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"None"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Stuart–Maxwell test for marginal homogeneity:</span></span>
<span><span class="va">stuart_result</span> <span class="op">&lt;-</span> <span class="fu">StuartMaxwellTest</span><span class="op">(</span><span class="va">pain_table</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the table and test result:</span></span>
<span><span class="va">pain_table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          After
Before     None Mild Moderate Severe
  None        6    0        0      0
  Mild        8    8        1      0
  Moderate    0    4        9      5
  Severe      0    0        6      3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb127">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stuart_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Stuart-Maxwell test

data:  pain_table
chi-squared = 9.9, df = 3, p-value = 0.02</code></pre>
</div>
<p>Interpretation: The Stuart–Maxwell χ² statistic = 9.89 with df = 3
and p-value = 0.0195. We reject the null hypothesis. Since the p-value
is r round(stuart_result$p.value, 3), we conclude that the marginal
distribution of pain levels differs before vs. after treatment (some
patients shifted categories).</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler48" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler48" aria-expanded="false" aria-controls="collapseSpoiler48">
  <h3 class="accordion-header" id="headingSpoiler48">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample test for binomial proportions / Mantel–Haenszel test </h3>
</button>
<div id="collapseSpoiler48" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler48" aria-labelledby="headingSpoiler48">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-41">Used for<a class="anchor" aria-label="anchor" href="#used-for-41"></a>
</h4>
<ul>
<li>Comparing two independent binomial proportions, possibly stratified
by a third variable (Mantel–Haenszel).<br>
</li>
<li>
<strong>Real-world example:</strong> Assessing whether a new vaccine
reduces infection rates compared to placebo across multiple
clinics.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-46">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-46"></a>
</h4>
<ul>
<li>Observations within each group (and stratum, if stratified) are
independent.<br>
</li>
<li>Each observation has a binary outcome (success/failure).<br>
</li>
<li>In the unstratified case, the two groups are independent and sample
sizes are sufficiently large for the normal approximation (if using a
z-test or <code>prop.test()</code>).<br>
</li>
<li>For the Mantel–Haenszel test: effects are assumed homogeneous across
strata (common odds ratio).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-46">Strengths<a class="anchor" aria-label="anchor" href="#strengths-46"></a>
</h4>
<ul>
<li>Simple two‐sample z‐test or χ²‐based test (<code>prop.test()</code>)
for unstratified comparisons.<br>
</li>
<li>Mantel–Haenszel test controls for confounding by stratification,
providing an overall test of association and a pooled odds ratio.<br>
</li>
<li>Exact or asymptotic inference available (Fisher’s exact for small
counts, Mantel–Haenszel χ² for larger).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-46">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-46"></a>
</h4>
<ul>
<li>The unstratified z‐test/χ² test can give misleading results if
confounders are present.<br>
</li>
<li>Mantel–Haenszel requires the common‐odds‐ratio assumption; if this
fails (effect modification), the pooled estimate may be invalid.<br>
</li>
<li>Both methods rely on adequate sample sizes in each cell (especially
for asymptotic approximations).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-46">Example<a class="anchor" aria-label="anchor" href="#example-46"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-46">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-46"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The infection rates in
Vaccine and Placebo groups are equal across clinics (common odds ratio =
1).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The infection rates
differ between Vaccine and Placebo groups (common odds ratio ≠ 1).</li>
</ul>
<div class="codewrapper sourceCode" id="cb129">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated data from two clinics (strata):</span></span>
<span><span class="co"># Clinic A: Vaccine (5 infections / 100), Placebo (15 infections / 100)</span></span>
<span><span class="co"># Clinic B: Vaccine (8 infections / 120), Placebo (20 infections / 120)</span></span>
<span></span>
<span><span class="co"># Create a 3‐dimensional array: 2 × 2 × 2 (Treatment × Outcome × Clinic)</span></span>
<span><span class="co"># Dimension names: Treatment = Vaccine, Placebo; Outcome = Infected, NotInfected; Clinic = A, B</span></span>
<span><span class="va">mh_table</span> <span class="op">&lt;-</span> <span class="fu">array</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span>  <span class="fl">5</span>,  <span class="fl">95</span>,   <span class="co"># Clinic A, Vaccine</span></span>
<span>     <span class="fl">15</span>,  <span class="fl">85</span>,   <span class="co"># Clinic A, Placebo</span></span>
<span>      <span class="fl">8</span>, <span class="fl">112</span>,   <span class="co"># Clinic B, Vaccine</span></span>
<span>     <span class="fl">20</span>, <span class="fl">100</span> <span class="op">)</span>, <span class="co"># Clinic B, Placebo</span></span>
<span>  dim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    Treatment <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Vaccine"</span>, <span class="st">"Placebo"</span><span class="op">)</span>,</span>
<span>    Outcome   <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Infected"</span>, <span class="st">"NotInfected"</span><span class="op">)</span>,</span>
<span>    Clinic    <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Mantel–Haenszel test:</span></span>
<span><span class="va">mh_result</span> <span class="op">&lt;-</span> <span class="fu">mantelhaen.test</span><span class="op">(</span><span class="va">mh_table</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">mh_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Mantel-Haenszel chi-squared test without continuity correction

data:  mh_table
Mantel-Haenszel X-squared = 11, df = 1, p-value = 8e-04
alternative hypothesis: true common odds ratio is not equal to 1
95 percent confidence interval:
 0.1702 0.6463
sample estimates:
common odds ratio
           0.3316 </code></pre>
</div>
<p>Interpretation: The Mantel–Haenszel χ² statistic = 11.275 with df = 1
and p‐value = 7.86^{-4}. We reject the null hypothesis. Thus, since the
p‐value is 0.001, we conclude there is a significant difference in
infection rates between Vaccine and Placebo after controlling for
clinic.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler49" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler49" aria-expanded="false" aria-controls="collapseSpoiler49">
  <h3 class="accordion-header" id="headingSpoiler49">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Chi-square test for R×C-tabeller </h3>
</button>
<div id="collapseSpoiler49" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler49" aria-labelledby="headingSpoiler49">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-42">Used for<a class="anchor" aria-label="anchor" href="#used-for-42"></a>
</h4>
<ul>
<li>Testing whether two categorical variables (with R rows and C
columns) are independent in an R×C contingency table.<br>
</li>
<li>
<strong>Real-world example:</strong> Assessing if education level
(High School, Bachelor’s, Master’s, PhD) is associated with preferred
news source (TV, Online, Print) in a survey.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-47">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-47"></a>
</h4>
<ul>
<li>Observations are independent (each subject contributes to exactly
one cell).<br>
</li>
<li>The table is R×C with mutually exclusive and exhaustive
categories.<br>
</li>
<li>Expected count in each cell is at least 5 for the χ² approximation
to be valid; otherwise consider collapsing categories or using an exact
test.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-47">Strengths<a class="anchor" aria-label="anchor" href="#strengths-47"></a>
</h4>
<ul>
<li>Simple to compute and interpret via a single χ² statistic and
p-value.<br>
</li>
<li>Applicable to any R×C table, not just 2×2.<br>
</li>
<li>Nonparametric: does not assume any distribution of underlying
continuous variables.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-47">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-47"></a>
</h4>
<ul>
<li>Sensitive to small expected counts—cells with expected &lt; 5 can
invalidate the approximation.<br>
</li>
<li>Does not indicate which specific cells contribute most to the
dependence; follow-up residual analysis or post-hoc tests are
required.<br>
</li>
<li>Requires sufficiently large sample sizes; for sparse tables consider
Fisher’s exact or Monte Carlo methods.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-47">Example<a class="anchor" aria-label="anchor" href="#example-47"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-47">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-47"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Education level and preferred
news source are independent.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> There is an
association between education level and preferred news source (they are
not independent).</li>
</ul>
<div class="codewrapper sourceCode" id="cb131">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a 4×3 contingency table: Education × NewsSource</span></span>
<span><span class="co"># Rows: High School, Bachelor’s, Master’s, PhD</span></span>
<span><span class="co"># Columns: TV, Online, Print</span></span>
<span><span class="va">edu_levels</span>    <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"HighSchool"</span>, <span class="st">"Bachelors"</span>, <span class="st">"Masters"</span>, <span class="st">"PhD"</span><span class="op">)</span></span>
<span><span class="va">news_sources</span>  <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"TV"</span>, <span class="st">"Online"</span>, <span class="st">"Print"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed counts from a survey of 360 respondents:</span></span>
<span><span class="co">#              TV   Online  Print</span></span>
<span><span class="co"># HighSchool   50    40      10</span></span>
<span><span class="co"># Bachelors    45    70      15</span></span>
<span><span class="co"># Masters      30    80      30</span></span>
<span><span class="co"># PhD          10    30      10</span></span>
<span><span class="va">obs_matrix</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">10</span>,</span>
<span>    <span class="fl">45</span>, <span class="fl">70</span>, <span class="fl">15</span>,</span>
<span>    <span class="fl">30</span>, <span class="fl">80</span>, <span class="fl">30</span>,</span>
<span>    <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>Education <span class="op">=</span> <span class="va">edu_levels</span>,</span>
<span>                  NewsSource <span class="op">=</span> <span class="va">news_sources</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform chi-square test of independence:</span></span>
<span><span class="va">chi2_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span><span class="va">obs_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">chi2_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's Chi-squared test

data:  obs_matrix
X-squared = 29, df = 6, p-value = 7e-05</code></pre>
</div>
<p>Interpretation: The test yields χ² = 28.71 with df = 6 and p-value =
6.91^{-5}. We reject the null hypothesis. Since the p-value is 0, we
conclude there is a significant association between education level and
preferred news source.</p>
<p>If the null is rejected, examine standardized residuals: Standardized
residuals identify which cells contribute most:
<code>r</code>round(chi2_result$stdres, 2)` Cells with |residual| &gt; 2
indicate categories where the observed count deviates substantially from
the expected under independence.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler50" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler50" aria-expanded="false" aria-controls="collapseSpoiler50">
  <h3 class="accordion-header" id="headingSpoiler50">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Chi-square test for trend (Mantel-extension) </h3>
</button>
<div id="collapseSpoiler50" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler50" aria-labelledby="headingSpoiler50">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-43">Used for<a class="anchor" aria-label="anchor" href="#used-for-43"></a>
</h4>
<ul>
<li>Testing for a linear (monotonic) association between two ordinal
variables in an R×C contingency table (Mantel’s extension of the χ²
test).<br>
</li>
<li>
<strong>Real-world example:</strong> Assessing whether increasing
pain‐severity category (None &lt; Mild &lt; Moderate &lt; Severe) is
associated with increasing level of inflammation marker (Low &lt; Medium
&lt; High) in the same patients.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-48">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-48"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Both row and column variables are ordinal with a meaningful
order.<br>
</li>
<li>Expected counts in all cells are sufficiently large (≈ ≥ 5) for the
χ² approximation to hold.<br>
</li>
<li>The association between row and column scores is (approximately)
linear on the log‐odds scale.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-48">Strengths<a class="anchor" aria-label="anchor" href="#strengths-48"></a>
</h4>
<ul>
<li>Specifically targets a linear trend across ordered categories rather
than any arbitrary departure from independence.<br>
</li>
<li>More powerful than a general χ² test of independence when the true
association is monotonic.<br>
</li>
<li>Accommodates arbitrary R×C tables (not limited to 2×k or k×2).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-48">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-48"></a>
</h4>
<ul>
<li>Only detects linear-by-linear association; non‐monotonic patterns
(e.g. U‐shaped) may be missed.<br>
</li>
<li>Requires correct ordering of both row and column
categories—misordering invalidates the test.<br>
</li>
<li>Sensitive to small expected counts in any cell, which can bias the
χ² approximation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-48">Example<a class="anchor" aria-label="anchor" href="#example-48"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-48">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-48"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> No linear trend in the
log‐odds of inflammation level across pain‐severity categories (row and
column are independent in a linear sense).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> A positive (or
negative) linear trend exists: higher pain severity is associated with
higher inflammation levels.</li>
</ul>
<div class="codewrapper sourceCode" id="cb133">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the vcd package if not already installed:</span></span>
<span><span class="co"># install.packages("vcd")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: grid</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb135">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a 4×3 table of PainSeverity (rows) vs. InflammationLevel (columns)</span></span>
<span><span class="co"># PainSeverity: 1=None, 2=Mild, 3=Moderate, 4=Severe</span></span>
<span><span class="co"># InflammationLevel: 1=Low, 2=Medium, 3=High</span></span>
<span><span class="va">ctab</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span>,  <span class="fl">5</span>,    <span class="co"># None  </span></span>
<span>    <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">10</span>,    <span class="co"># Mild</span></span>
<span>    <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">20</span>,    <span class="co"># Moderate</span></span>
<span>     <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">35</span><span class="op">)</span>,   <span class="co"># Severe</span></span>
<span>  nrow    <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  byrow   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    PainSeverity     <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"None"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span>
<span>    InflammationLevel <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign equally spaced scores for each ordinal category:</span></span>
<span><span class="va">row_scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>   <span class="co"># PainSeverity scores</span></span>
<span><span class="va">col_scores</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>      <span class="co"># InflammationLevel scores</span></span>
<span></span>
<span><span class="co"># Perform Mantel’s linear‐by‐linear association test via CMHtest:</span></span>
<span><span class="va">mantel_result</span> <span class="op">&lt;-</span> <span class="fu">CMHtest</span><span class="op">(</span></span>
<span>  x     <span class="op">=</span> <span class="va">ctab</span>,</span>
<span>  score <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>row <span class="op">=</span> <span class="va">row_scores</span>, col <span class="op">=</span> <span class="va">col_scores</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in CMHtest(x = ctab, score = list(row = row_scores, col = col_scores)): could not find function "CMHtest"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb137">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display results:</span></span>
<span><span class="va">mantel_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'mantel_result' not found</code></pre>
</div>
<p>Interpretation: The output shows:</p>
<p>A Mantel χ² statistic (linear‐by‐linear association) and its degrees
of freedom (df = 1).</p>
<p>A p‐value testing H₀: “no linear trend in log‐odds of inflammation
across pain severity.”</p>
<p>For example, if you see something like:</p>
<p>Mantel chi‐square statistic = 25.47 on df = 1, p‐value &lt; 0.0001
Because p‐value &lt; 0.05, we reject H₀ and conclude there is a
significant positive linear trend: higher pain‐severity categories are
associated with higher inflammation levels.</p>
<p>If p‐value ≥ 0.05, we would fail to reject H₀, concluding no evidence
of a linear association between pain severity and inflammation
level.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler51" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler51" aria-expanded="false" aria-controls="collapseSpoiler51">
  <h3 class="accordion-header" id="headingSpoiler51">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Chi-square test for heterogenitet (2×k-tabeller) </h3>
</button>
<div id="collapseSpoiler51" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler51" aria-labelledby="headingSpoiler51">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-44">Used for<a class="anchor" aria-label="anchor" href="#used-for-44"></a>
</h4>
<ul>
<li>Testing whether two groups have the same distribution across k
categories (heterogeneity of proportions in a 2×k table).<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing the distribution of
smoking status (Never, Former, Current, Occasional) between males and
females.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-49">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-49"></a>
</h4>
<ul>
<li>Observations are independent.<br>
</li>
<li>Categories (columns) are mutually exclusive and exhaustive.<br>
</li>
<li>Expected count in each cell is at least 5 for the χ² approximation
to be valid.<br>
</li>
<li>The table is 2×k (two groups by k categories).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-49">Strengths<a class="anchor" aria-label="anchor" href="#strengths-49"></a>
</h4>
<ul>
<li>Simple to compute via <code>chisq.test()</code> in R.<br>
</li>
<li>Tests whether proportions differ across all k categories
simultaneously.<br>
</li>
<li>Does not require any parametric distribution beyond categorical
counts.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-49">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-49"></a>
</h4>
<ul>
<li>Sensitive to small expected counts; if many cells have expected &lt;
5, approximation may be invalid.<br>
</li>
<li>Only indicates that distributions differ, not which categories drive
the difference (follow‐up residual or post‐hoc tests needed).<br>
</li>
<li>Requires independence; not suitable for paired or repeated
measures.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-49">Example<a class="anchor" aria-label="anchor" href="#example-49"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-49">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-49"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The two groups have the same
distribution across the k categories (no heterogeneity).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> At least one
category’s proportion differs between the two groups.</li>
</ul>
<div class="codewrapper sourceCode" id="cb139">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a 2×4 table: Sex (Male/Female) × SmokingStatus (Never, Former, Current, Occasional)</span></span>
<span><span class="co"># Observed counts:</span></span>
<span><span class="co">#            Never  Former  Current  Occasional</span></span>
<span><span class="co"># Male         80      30       50           20</span></span>
<span><span class="co"># Female       90      40       30           10</span></span>
<span></span>
<span><span class="va">obs_matrix</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">80</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">20</span>,</span>
<span>    <span class="fl">90</span>, <span class="fl">40</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  nrow    <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  byrow   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    Sex           <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>,</span>
<span>    SmokingStatus <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Never"</span>, <span class="st">"Former"</span>, <span class="st">"Current"</span>, <span class="st">"Occasional"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform chi-square test for heterogeneity:</span></span>
<span><span class="va">chihet_result</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span><span class="va">obs_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">chihet_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's Chi-squared test

data:  obs_matrix
X-squared = 10, df = 3, p-value = 0.02</code></pre>
</div>
<p>Interpretation: The χ² statistic = 10.07 with df = 3 and p-value =
0.018. We reject the null hypothesis. Thus, there is evidence that the
distribution of smoking status differs between males and females.</p>
<p>To see which categories contribute most, examine standardized
residuals:</p>
<p>-1.59, 1.59, -1.6, 1.6, 2.26, -2.26, 1.75, -1.75 Cells with
|residual| &gt; 2 indicate categories where observed counts deviate
substantially from expected under homogeneity.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="incidens--og-rate-tests">Incidens- og rate-tests<a class="anchor" aria-label="anchor" href="#incidens--og-rate-tests"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler52" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler52" aria-expanded="false" aria-controls="collapseSpoiler52">
  <h3 class="accordion-header" id="headingSpoiler52">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> One-sample test for incidence rates </h3>
</button>
<div id="collapseSpoiler52" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler52" aria-labelledby="headingSpoiler52">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-45">Used for<a class="anchor" aria-label="anchor" href="#used-for-45"></a>
</h4>
<ul>
<li>Testing whether an observed incidence rate (events per unit
person‐time) differs from a specified rate.<br>
</li>
<li>
<strong>Real-world example:</strong> Determining if a hospital’s
rate of catheter‐associated infections (per 1,000 patient‐days) equals
the national benchmark.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-50">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-50"></a>
</h4>
<ul>
<li>Events occur independently and follow a Poisson process.<br>
</li>
<li>The incidence rate is constant over the observation period.<br>
</li>
<li>Person‐time is measured accurately and non‐overlapping.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-50">Strengths<a class="anchor" aria-label="anchor" href="#strengths-50"></a>
</h4>
<ul>
<li>Exact test based on the Poisson distribution—no large‐sample
approximation needed.<br>
</li>
<li>Naturally accounts for differing follow‐up times via
person‐time.<br>
</li>
<li>Valid for rare events and small counts.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-50">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-50"></a>
</h4>
<ul>
<li>Sensitive to overdispersion (variance &gt; mean) and violation of
Poisson assumptions.<br>
</li>
<li>Cannot adjust for covariates or time‐varying rates.<br>
</li>
<li>Assumes homogeneity of the rate across the period.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-50">Example<a class="anchor" aria-label="anchor" href="#example-50"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-50">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-50"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The true incidence rate λ = 2
infections per 1,000 patient‐days.<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> λ ≠ 2 infections per
1,000 patient‐days.</li>
</ul>
<div class="codewrapper sourceCode" id="cb141">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed infections and total patient‐days:</span></span>
<span><span class="va">events</span>    <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">patient_days</span> <span class="op">&lt;-</span> <span class="fl">3500</span>   <span class="co"># total follow‐up time in patient‐days</span></span>
<span></span>
<span><span class="co"># Hypothesized rate (infections per 1 patient‐day):</span></span>
<span><span class="co"># 2 per 1,000 patient‐days = 0.002 per patient‐day</span></span>
<span><span class="va">rate0</span>     <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">/</span> <span class="fl">1000</span>  </span>
<span></span>
<span><span class="co"># Perform one‐sample incidence‐rate test:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span>x <span class="op">=</span> <span class="va">events</span>,</span>
<span>                            T <span class="op">=</span> <span class="va">patient_days</span>,</span>
<span>                            r <span class="op">=</span> <span class="va">rate0</span>,</span>
<span>                            alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact Poisson test

data:  events time base: patient_days
number of events = 8, time base = 3500, p-value = 0.7
alternative hypothesis: true event rate is not equal to 0.002
95 percent confidence interval:
 0.0009868 0.0045038
sample estimates:
event rate
  0.002286 </code></pre>
</div>
<p>Interpretation: The test compares the observed 8 infections over
3,500 patient‐days to the expected rate of 2/1,000 patient‐days (i.e., 7
infections). With a p‐value of r signif(test_result<span class="math inline">\(p.value, 3), we
r if(test_result\)</span>p.value &lt; 0.05) “reject the null hypothesis”
else “fail to reject the null hypothesis”. Thus, there is r
if(test_result$p.value &lt; 0.05) “evidence that the hospital’s
infection rate differs from 2 per 1,000 patient‐days.” else “no evidence
that the infection rate differs from the benchmark.”</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler53" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler53" aria-expanded="false" aria-controls="collapseSpoiler53">
  <h3 class="accordion-header" id="headingSpoiler53">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Two-sample comparison of incidence rates </h3>
</button>
<div id="collapseSpoiler53" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler53" aria-labelledby="headingSpoiler53">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-46">Used for<a class="anchor" aria-label="anchor" href="#used-for-46"></a>
</h4>
<ul>
<li>Comparing incidence rates (events per unit person‐time) between two
independent groups.<br>
</li>
<li>
<strong>Real-world example:</strong> Determining if Hospital A’s
rate of central‐line infections (per 1,000 catheter‐days) differs from
Hospital B’s rate.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-51">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-51"></a>
</h4>
<ul>
<li>Events in each group follow a Poisson process.<br>
</li>
<li>The incidence rate is constant over person‐time within each
group.<br>
</li>
<li>Person‐time is measured accurately and non‐overlapping.<br>
</li>
<li>Groups are independent and there is no unaccounted confounding.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-51">Strengths<a class="anchor" aria-label="anchor" href="#strengths-51"></a>
</h4>
<ul>
<li>Accounts for differing follow‐up times via person‐time
denominators.<br>
</li>
<li>Provides an exact test (via Poisson) for comparing rates without
relying on large‐sample normal approximations.<br>
</li>
<li>Outputs both a rate‐ratio estimate and confidence interval.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-51">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-51"></a>
</h4>
<ul>
<li>Sensitive to violations of the Poisson assumption (e.g.,
overdispersion or clustering of events).<br>
</li>
<li>Does not adjust for covariates—only a crude two‐group
comparison.<br>
</li>
<li>Assumes constant risk over time within each group; if rates change,
inference may be biased.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-51">Example<a class="anchor" aria-label="anchor" href="#example-51"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-51">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-51"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The two incidence rates are
equal (<span class="math inline">\(\lambda_A =
\lambda_B\)</span>).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> The incidence rates
differ (<span class="math inline">\(\lambda_A \neq
\lambda_B\)</span>).</li>
</ul>
<div class="codewrapper sourceCode" id="cb143">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed events and person-time:</span></span>
<span><span class="va">events_A</span>    <span class="op">&lt;-</span> <span class="fl">15</span>    <span class="co"># e.g., central-line infections in Hospital A</span></span>
<span><span class="va">person_days_A</span> <span class="op">&lt;-</span> <span class="fl">2000</span>  <span class="co"># total catheter-days in Hospital A</span></span>
<span></span>
<span><span class="va">events_B</span>    <span class="op">&lt;-</span> <span class="fl">25</span>    <span class="co"># e.g., central-line infections in Hospital B</span></span>
<span><span class="va">person_days_B</span> <span class="op">&lt;-</span> <span class="fl">3000</span>  <span class="co"># total catheter-days in Hospital B</span></span>
<span></span>
<span><span class="co"># Perform two-sample Poisson test comparing rates:</span></span>
<span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">events_A</span>, <span class="va">events_B</span><span class="op">)</span>,</span>
<span>  T <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">person_days_A</span>, <span class="va">person_days_B</span><span class="op">)</span>,</span>
<span>  ratio      <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in poisson.test(x = c(events_A, events_B), T = c(person_days_A, : unused argument (ratio = 1)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb145">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display results:</span></span>
<span><span class="va">test_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact Poisson test

data:  events time base: patient_days
number of events = 8, time base = 3500, p-value = 0.7
alternative hypothesis: true event rate is not equal to 0.002
95 percent confidence interval:
 0.0009868 0.0045038
sample estimates:
event rate
  0.002286 </code></pre>
</div>
<p>Interpretation: The test reports a rate ratio (Hospital A
vs. Hospital B) = 0.002, with a 95% CI = [0.001, 0.005], and p-value =
0.702. We fail to reject the null hypothesis. Thus, there is no evidence
to conclude a difference in infection rates between the two
hospitals.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler54" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler54" aria-expanded="false" aria-controls="collapseSpoiler54">
  <h3 class="accordion-header" id="headingSpoiler54">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Trend-test for incidence rates over flere eksponeringsgrupper </h3>
</button>
<div id="collapseSpoiler54" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler54" aria-labelledby="headingSpoiler54">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-47">Used for<a class="anchor" aria-label="anchor" href="#used-for-47"></a>
</h4>
<ul>
<li>Testing whether there is a linear trend in incidence rates across
ordered exposure groups.<br>
</li>
<li>
<strong>Real-world example:</strong> Evaluating whether lung cancer
incidence per 1,000 person‐years increases across smoking intensity
categories (Non‐smoker, Light‐smoker, Heavy‐smoker).</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-52">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-52"></a>
</h4>
<ul>
<li>Events in each group follow a Poisson process.<br>
</li>
<li>The exposure groups have a natural order and can be assigned numeric
scores (e.g., 0, 1, 2).<br>
</li>
<li>Person‐time denominators are measured accurately and
non‐overlapping.<br>
</li>
<li>The log‐rate of events is linearly related to the numeric score of
the exposure groups.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-52">Strengths<a class="anchor" aria-label="anchor" href="#strengths-52"></a>
</h4>
<ul>
<li>Directly tests for a dose‐response (linear) relationship in
rates.<br>
</li>
<li>Accounts for differing person‐time across groups via an offset in
Poisson regression.<br>
</li>
<li>Provides an estimate of the rate‐ratio per one‐unit increase in the
exposure score.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-52">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-52"></a>
</h4>
<ul>
<li>Only detects a linear trend; non‐linear patterns across groups may
be missed.<br>
</li>
<li>Sensitive to misclassification of exposure group ordering or
scoring.<br>
</li>
<li>Assumes no overdispersion; if variance &gt; mean, inference may be
invalid unless corrected.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-52">Example<a class="anchor" aria-label="anchor" href="#example-52"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-52">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-52"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> There is no linear trend in
incidence rates across exposure groups (β = 0).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> β ≠ 0 (the log‐rate
changes linearly with the exposure score).</li>
</ul>
<div class="codewrapper sourceCode" id="cb147">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated data for three smoking categories:</span></span>
<span><span class="co"># Category labels and numeric scores:</span></span>
<span><span class="co">#   0 = Non‐smoker</span></span>
<span><span class="co">#   1 = Light‐smoker</span></span>
<span><span class="co">#   2 = Heavy‐smoker</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  smoke_cat   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Non"</span>, <span class="st">"Light"</span>, <span class="st">"Heavy"</span><span class="op">)</span>, </span>
<span>                       levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Non"</span>,<span class="st">"Light"</span>,<span class="st">"Heavy"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  score       <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  events      <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">12</span>, <span class="fl">30</span>, <span class="fl">55</span><span class="op">)</span>,    <span class="co"># number of lung cancer cases</span></span>
<span>  person_years <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5000</span>, <span class="fl">4000</span>, <span class="fl">3000</span><span class="op">)</span>  <span class="co"># total person‐years in each category</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Poisson regression with offset(log(person_years)):</span></span>
<span><span class="va">trend_fit</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">events</span> <span class="op">~</span> <span class="va">score</span> <span class="op">+</span> <span class="fu">offset</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">person_years</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu">poisson</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary (including coefficient and Wald test for trend):</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">trend_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
glm(formula = events ~ score + offset(log(person_years)), family = poisson(link = "log"),
    data = data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)   -5.949      0.228  -26.10  &lt; 2e-16 ***
score          0.984      0.141    6.96  3.3e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 56.44269  on 2  degrees of freedom
Residual deviance:  0.25604  on 1  degrees of freedom
AIC: 19.69

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<p>Interpretation:</p>
<p>The estimated coefficient for score is 0.984.</p>
<p>Exponentiating gives a rate ratio per one‐unit increase in exposure
score:</p>
<p><span class="math display">\[\text{RR per category} =
\exp\bigl(\beta_{\text{score}}\bigr)\]</span></p>
<p>From summary(trend_fit), the Wald‐type <span class="math inline">\(z\)</span>‐value for score has p‐value =
3.35^{-12}.</p>
<p>If this p‐value <span class="math inline">\(&lt; 0.05\)</span>, we
reject <span class="math inline">\(H_{0}\)</span>, indicating a
significant linear trend in incidence rates across exposure
categories.</p>
<p>If the p‐value <span class="math inline">\(\ge 0.05\)</span>, we fail
to reject <span class="math inline">\(H_{0}\)</span>, indicating no
evidence of a linear trend.</p>
<p>For example, if <span class="math inline">\(\widehat{\beta}_{\text{score}} = 0.45\)</span> (p
= 0.002), then</p>
<p><span class="math inline">\(\text{RR} = \exp(0.45) \approx
1.57\)</span> per category increase, and since p <span class="math inline">\(&lt;0.05\)</span>, we conclude that incidence
rises significantly from Non‐smoker → Light‐smoker → Heavy‐smoker.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler55" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler55" aria-expanded="false" aria-controls="collapseSpoiler55">
  <h3 class="accordion-header" id="headingSpoiler55">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Exact rate ratio test </h3>
</button>
<div id="collapseSpoiler55" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler55" aria-labelledby="headingSpoiler55">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-48">Used for<a class="anchor" aria-label="anchor" href="#used-for-48"></a>
</h4>
<ul>
<li>Testing whether the incidence rate in one group differs from that in
another group using an exact (Poisson) method for the rate ratio.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing ICU infection rates
between two antibiotic regimens (A vs. B) when event counts and
person‐time are relatively small.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-53">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-53"></a>
</h4>
<ul>
<li>Events in each group follow a Poisson process.<br>
</li>
<li>The rate within each group is constant over the observed
person‐time.<br>
</li>
<li>Person‐time denominators are measured accurately and
non‐overlapping.<br>
</li>
<li>Groups are independent (no shared person‐time or overlapping
exposure).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-53">Strengths<a class="anchor" aria-label="anchor" href="#strengths-53"></a>
</h4>
<ul>
<li>Provides an exact confidence interval for the rate ratio and an
exact test p‐value without relying on large‐sample normal
approximations.<br>
</li>
<li>Valid for small counts or rare events.<br>
</li>
<li>Directly tests the null hypothesis <span class="math inline">\(\text{RR} = 1\)</span> (where <span class="math inline">\(\text{RR} = \lambda_1 / \lambda_2\)</span>).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-53">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-53"></a>
</h4>
<ul>
<li>Sensitive to overdispersion (variance &gt; mean) or
clustering—assumes Poisson variance equals the mean.<br>
</li>
<li>Only compares two groups at a time; cannot easily adjust for
covariates.<br>
</li>
<li>Assumes constant rate over time; if rates vary, inference can be
biased.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-53">Example<a class="anchor" aria-label="anchor" href="#example-53"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-53">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-53"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> The rate in group A
equals the rate in group B, i.e. <span class="math inline">\(\text{RR} =
1\)</span>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> The rate in group A
differs from the rate in group B, i.e. <span class="math inline">\(\text{RR} \neq 1\)</span>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb149">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed events and person-time for two antibiotic regimens:</span></span>
<span><span class="co"># Observed events and person-time for two antibiotic regimens:</span></span>
<span><span class="va">events_A</span>      <span class="op">&lt;-</span> <span class="fl">10</span>    <span class="co"># infections under Regimen A</span></span>
<span><span class="va">person_days_A</span> <span class="op">&lt;-</span> <span class="fl">1200</span>  <span class="co"># total patient‐days for Regimen A</span></span>
<span></span>
<span><span class="va">events_B</span>      <span class="op">&lt;-</span> <span class="fl">18</span>    <span class="co"># infections under Regimen B</span></span>
<span><span class="va">person_days_B</span> <span class="op">&lt;-</span> <span class="fl">1500</span>  <span class="co"># total patient‐days for Regimen B</span></span>
<span></span>
<span><span class="co"># Perform exact test for comparing two Poisson rates:</span></span>
<span><span class="co"># Note: the argument name for the null ratio is 'r', not 'ratio'.</span></span>
<span><span class="va">rr_test</span> <span class="op">&lt;-</span> <span class="fu">poisson.test</span><span class="op">(</span></span>
<span>x           <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">events_A</span>, <span class="va">events_B</span><span class="op">)</span>,</span>
<span>T           <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">person_days_A</span>, <span class="va">person_days_B</span><span class="op">)</span>,</span>
<span>r           <span class="op">=</span> <span class="fl">1</span>,</span>
<span>alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">rr_test</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Comparison of Poisson rates

data:  c(events_A, events_B) time base: c(person_days_A, person_days_B)
count1 = 10, expected count1 = 12, p-value = 0.4
alternative hypothesis: true rate ratio is not equal to 1
95 percent confidence interval:
 0.2864 1.5867
sample estimates:
rate ratio
    0.6944 </code></pre>
</div>
<p>Interpretation:</p>
<p>The estimated rate ratio is</p>
<p><span class="math inline">\(\widehat{\text{RR}} =
\dfrac{\lambda_{A}}{\lambda_{B}} = \dfrac{10/1200}{18/1500} =
\dfrac{0.00833}{0.01200} \approx 0.694\)</span> The 95 % exact
confidence interval for <span class="math inline">\(\text{RR}\)</span>
is</p>
<p><span class="math inline">\([\text{CI}_{\text{lower}},\,\text{CI}_{\text{upper}}]\)</span></p>
<p>as reported by rr_test$conf.int.</p>
<p>The two‐sided p‐value is 0.448.</p>
<p>If <span class="math inline">\(p &lt; 0.05\)</span>, we reject <span class="math inline">\(H_{0}\)</span> and conclude <span class="math inline">\(\text{RR} \neq 1\)</span> (i.e., infection rates
differ between Regimen A and B).</p>
<p>If <span class="math inline">\(p \ge 0.05\)</span>, we fail to reject
<span class="math inline">\(H_{0}\)</span>, indicating no evidence of a
difference in infection rates.</p>
<p>For example, if the output shows</p>
<p>rate ratio estimate = 0.694<br>
95 % CI = [0.318, 1.515]<br>
p‐value = 0.289<br>
then, since <span class="math inline">\(p = 0.289 \ge 0.05\)</span>, we
fail to reject <span class="math inline">\(H_{0}\)</span>. There is no
evidence that the infection rate for Regimen A differs from Regimen
B.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="overlevelsesanalyse">Overlevelsesanalyse<a class="anchor" aria-label="anchor" href="#overlevelsesanalyse"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler56" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler56" aria-expanded="false" aria-controls="collapseSpoiler56">
  <h3 class="accordion-header" id="headingSpoiler56">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Log-rank test </h3>
</button>
<div id="collapseSpoiler56" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler56" aria-labelledby="headingSpoiler56">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-49">Used for<a class="anchor" aria-label="anchor" href="#used-for-49"></a>
</h4>
<ul>
<li>Comparing the survival distributions of two or more groups in
time-to-event data.<br>
</li>
<li>
<strong>Real-world example:</strong> Testing whether patients
receiving Drug A have different overall survival than patients receiving
Drug B after cancer diagnosis.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-54">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-54"></a>
</h4>
<ul>
<li>Censoring is independent of survival (noninformative).<br>
</li>
<li>Survival times are continuously distributed.<br>
</li>
<li>The hazard functions are proportional over time (i.e., the ratio of
hazard rates between groups is constant).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-54">Strengths<a class="anchor" aria-label="anchor" href="#strengths-54"></a>
</h4>
<ul>
<li>Nonparametric: does not assume any specific survival
distribution.<br>
</li>
<li>Accommodates right-censoring.<br>
</li>
<li>Widely used and easy to implement via <code>survdiff()</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-54">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-54"></a>
</h4>
<ul>
<li>Sensitive to violations of proportional hazards—if hazards cross,
test may mislead.<br>
</li>
<li>Only tests for equality of entire survival curves, not pinpointing
when differences occur.<br>
</li>
<li>Requires adequate numbers of events—limited power if many censored
observations.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-54">Example<a class="anchor" aria-label="anchor" href="#example-54"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-54">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-54"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> The survival functions
in the two groups are equal, i.e. <span class="math inline">\(S_{A}(t) =
S_{B}(t)\quad \text{for all } t\)</span>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> The survival functions
differ, i.e. <span class="math inline">\(S_{A}(t) \neq S_{B}(t)\quad
\text{for some } t\)</span>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb151">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the 'survival' package if necessary:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate survival times for two groups (A and B):</span></span>
<span><span class="va">n_A</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">n_B</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># True hazard rates: lambda_A = 0.05, lambda_B = 0.08</span></span>
<span><span class="co"># Exponential survival times (for simplicity)</span></span>
<span><span class="va">time_A</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_A</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">time_B</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_B</span>, rate <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate independent right-censoring times</span></span>
<span><span class="va">censor_A</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_A</span>, rate <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="va">censor_B</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n_B</span>, rate <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed time = min(survival, censoring); event indicator = 1 if survival &lt;= censoring</span></span>
<span><span class="va">obs_time_A</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_A</span>, <span class="va">censor_A</span><span class="op">)</span></span>
<span><span class="va">status_A</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_A</span> <span class="op">&lt;=</span> <span class="va">censor_A</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_time_B</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_B</span>, <span class="va">censor_B</span><span class="op">)</span></span>
<span><span class="va">status_B</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_B</span> <span class="op">&lt;=</span> <span class="va">censor_B</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into one data frame</span></span>
<span><span class="va">group</span>      <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="st">"A"</span>, <span class="va">n_A</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="st">"B"</span>, <span class="va">n_B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time</span>       <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">obs_time_A</span>, <span class="va">obs_time_B</span><span class="op">)</span></span>
<span><span class="va">status</span>     <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">status_A</span>, <span class="va">status_B</span><span class="op">)</span></span>
<span><span class="va">df_surv</span>    <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span>, <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform log-rank test comparing groups A and B</span></span>
<span><span class="va">surv_diff</span> <span class="op">&lt;-</span> <span class="fu">survdiff</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df_surv</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">surv_diff</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Call:
survdiff(formula = Surv(time, status) ~ group, data = df_surv)

         N Observed Expected (O-E)^2/E (O-E)^2/V
group=A 50       36     41.4     0.699      1.53
group=B 50       42     36.6     0.789      1.53

 Chisq= 1.5  on 1 degrees of freedom, p= 0.2 </code></pre>
</div>
<p>Interpretation: The log-rank test yields a chi-square statistic <span class="math inline">\(\chi^{2} \;=\;
\text{surv_diff\$chisq}\)</span></p>
<p>with 1 degree of freedom and p-value = 0.216. We fail to reject the
null hypothesis. Thus, since <span class="math inline">\(p =
\text{0.216}\)</span>, we conclude there is no evidence of a difference
in survival between Drug A and Drug B..</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler57" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler57" aria-expanded="false" aria-controls="collapseSpoiler57">
  <h3 class="accordion-header" id="headingSpoiler57">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Parametric survival methods (Weibull) </h3>
</button>
<div id="collapseSpoiler57" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler57" aria-labelledby="headingSpoiler57">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-50">Used for<a class="anchor" aria-label="anchor" href="#used-for-50"></a>
</h4>
<ul>
<li>Modeling time‐to‐event data with a specified parametric
form—specifically the Weibull distribution—for both the baseline hazard
and covariate effects.<br>
</li>
<li>
<strong>Real-world example:</strong> Estimating the effect of a new
chemotherapy agent on time to disease progression, assuming a Weibull
hazard shape.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-55">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-55"></a>
</h4>
<ul>
<li><p><strong>Weibull distribution</strong>: The survival times <span class="math inline">\(T\)</span> follow a Weibull distribution with
shape parameter <span class="math inline">\(\alpha\)</span> and scale
parameter <span class="math inline">\(\lambda\)</span>, so the hazard is
<span class="math inline">\(h(t) = \alpha \lambda^{\alpha} t^{\alpha -
1}\)</span></p></li>
<li><p><strong>Independent censoring</strong>: Censoring times are
independent of true event times.<br></p></li>
<li><p><strong>Correct functional form</strong>: The log of survival
time is linearly related to covariates (if covariates are
included).<br></p></li>
<li><p><strong>Linear predictor</strong>: In the
accelerated‐failure‐time (AFT) parameterization, we assume <span class="math inline">\(\log(T_i) = \mathbf{X}_i^\top \boldsymbol{\beta} +
\sigma W_i\)</span></p></li>
</ul>
<p>where <span class="math inline">\(W_i\)</span> is a random error with
extreme‐value distribution.</p>
</div>
<div class="section level4">
<h4 id="strengths-55">Strengths<a class="anchor" aria-label="anchor" href="#strengths-55"></a>
</h4>
<ul>
<li>Provides a fully specified likelihood, enabling efficient estimation
and confidence intervals.<br>
</li>
<li>Yields both scale (AFT) and hazard‐ratio interpretations (via
transformation).<br>
</li>
<li>Can extrapolate beyond observed follow‐up (if model fit is
adequate).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-55">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-55"></a>
</h4>
<ul>
<li>Mis‐specification of the Weibull form (shape <span class="math inline">\(\alpha\)</span> wrong) can bias estimates and
inferences.<br>
</li>
<li>Less robust than semi‐parametric Cox models if the true hazard is
not Weibull‐shaped.<br>
</li>
<li>Requires careful checking of model fit (e.g., via residuals or AIC
comparisons).</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-55">Example<a class="anchor" aria-label="anchor" href="#example-55"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-55">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-55"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>)</strong>: The new chemotherapy
does not change time to progression, i.e. the coefficient <span class="math inline">\(\beta_{\text{treatment}} = 0\)</span>.<br>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>)</strong>: The new chemotherapy
changes time to progression, i.e. <span class="math inline">\(\beta_{\text{treatment}} \neq 0\)</span>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb153">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the 'survival' package if not already installed:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Simulate a binary treatment indicator (0 = Control, 1 = NewChemo):</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True Weibull parameters:</span></span>
<span><span class="co">#    shape (alpha) = 1.5</span></span>
<span><span class="co">#    baseline scale (lambda0) = exp(beta0) = exp(3)</span></span>
<span><span class="co">#    treatment effect on log(T) is beta1 = -0.5 (accelerated failure time)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Simulate true event times from Weibull AFT model:</span></span>
<span><span class="co">#   log(T) = beta0 + beta1 * treatment + sigma * W, where W ~ EV(0,1)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">alpha</span>  <span class="co"># In survreg parameterization, scale = 1/alpha</span></span>
<span></span>
<span><span class="co"># Generate extreme‐value errors W:</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu">evd</span><span class="fu">::</span><span class="fu">revdbeta</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Alternatively, simulate from Gumbel via -log(-log(U))</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: 'revdbeta' is not an exported object from 'namespace:evd'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb155">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute log‐times:</span></span>
<span><span class="va">logT</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="va">W</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'W' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb157">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to event times:</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">logT</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'logT' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb159">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate random right‐censoring times from Uniform(0, 20):</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed time and event indicator:</span></span>
<span><span class="va">obs_time</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time</span>, <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a data frame:</span></span>
<span><span class="va">df_weibull</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>time      <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>status    <span class="op">=</span> <span class="va">status</span>,</span>
<span>treatment <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">treatment</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"NewChemo"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Weibull AFT model using survreg():</span></span>
<span><span class="va">weibull_fit</span> <span class="op">&lt;-</span> <span class="fu">survreg</span><span class="op">(</span></span>
<span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>data   <span class="op">=</span> <span class="va">df_weibull</span>,</span>
<span>dist   <span class="op">=</span> <span class="st">"weibull"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">weibull_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
survreg(formula = Surv(time, status) ~ treatment, data = df_weibull,
    dist = "weibull")
                     Value Std. Error     z      p
(Intercept)        2.23480    0.13698 16.32 &lt;2e-16
treatmentNewChemo  0.16272    0.18833  0.86   0.39
Log(scale)        -0.00632    0.07668 -0.08   0.93

Scale= 0.994

Weibull distribution
Loglik(model)= -372.1   Loglik(intercept only)= -372.4
	Chisq= 0.75 on 1 degrees of freedom, p= 0.39
Number of Newton-Raphson Iterations: 5
n= 200 </code></pre>
</div>
<p>Interpretation:</p>
<p>In the AFT parameterization, survreg() reports a scale which equals
𝜎<sup>=1/𝛼</sup>σ^ =1/ α^ .</p>
<p>Suppose 𝜎^=0.667. Then the estimated shape is</p>
<p><span class="math inline">\(\widehat{\alpha} = \frac{1}{\hat{\sigma}}
= \frac{1}{0.667} \approx 1.50\)</span>.</p>
<p>The coefficient for treatmentNewChemo is 𝛽^1=−0.482β (for example),
with p‐value = 0.012. We test</p>
<p><span class="math inline">\(H_{0}: \beta_{1} = 0 \quad\text{vs.}\quad
H_{1}: \beta_{1} \neq 0\)</span>.</p>
<p>Since 𝑝=0.012&lt;0.05 , we reject 𝐻_0 and conclude that “NewChemo”
significantly accelerates failure time compared to “Control.”</p>
<p>To interpret as a hazard ratio, note that under Weibull AFT, the
hazard‐ratio (HR) for treatment is <span class="math inline">\(\text{HR}
= \exp\bigl(-\beta_{1} \,\hat{\alpha}\bigr)\)</span>.</p>
<p>For 𝛽^1=−0.482 and 𝛼^=1.50,</p>
<p><span class="math inline">\(\widehat{\text{HR}} = \exp\bigl(-(-0.482)
\times 1.50\bigr) = \exp(0.723) \approx 2.06\)</span>.</p>
<p>Since HR^ &gt; 1, patients on “NewChemo” have more rapid progression
(higher hazard) than “Control.”</p>
<p>The 95 % confidence interval for 𝛽1</p>
<p>is reported in
<code>r</code>summary(weibull_fit)$table[“treatmentNewChemo”,
c(“Value”,“Std. Error”,“p”)]`.</p>
<p>If the 95 % CI for 𝛽1 is [−0.845,−0.118], then</p>
<p><span class="math inline">\(\exp\bigl(-(-0.845)\times 1.50\bigr) =
3.20, \quad
  \exp\bigl(-(-0.118)\times 1.50\bigr) = 1.19\)</span></p>
<p>giving a 95 % CI for HR: [1.19,3.20]. Because this interval excludes
1, it confirms a significant difference in hazards.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler58" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler58" aria-expanded="false" aria-controls="collapseSpoiler58">
  <h3 class="accordion-header" id="headingSpoiler58">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cox proportional hazards model </h3>
</button>
<div id="collapseSpoiler58" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler58" aria-labelledby="headingSpoiler58">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-51">Used for<a class="anchor" aria-label="anchor" href="#used-for-51"></a>
</h4>
<ul>
<li>Modeling the hazard (instantaneous event rate) for time‐to‐event
data as a function of covariates without specifying a baseline
hazard.<br>
</li>
<li>
<strong>Real-world example:</strong> Estimating the effect of a new
drug (Drug A vs. Drug B) on time to cancer recurrence, adjusting for age
and tumor grade.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-56">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-56"></a>
</h4>
<ul>
<li><p><strong>Proportional hazards</strong>: For any two individuals
<span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, $ = (_i^ - _j^) $ is constant over
time (no interaction between covariates and time).<br></p></li>
<li><p><strong>Independent censoring</strong>: Censoring times are
independent of event times.<br></p></li>
<li><p><strong>Linearity</strong>: The log‐hazard is a linear function
of continuous covariates: <span class="math inline">\(\log h(t \mid
\boldsymbol{X}) = \log h_0(t) + \boldsymbol{X}^\top
\boldsymbol{\beta}\)</span>.</p></li>
<li><p>No important omitted covariates that interact with time.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-56">Strengths<a class="anchor" aria-label="anchor" href="#strengths-56"></a>
</h4>
<ul>
<li>
<strong>Semi‐parametric</strong>: No need to specify <span class="math inline">\(h_0(t)\)</span> (baseline hazard)
explicitly.<br>
</li>
<li>Accommodates right‐censoring and time‐dependent covariates (if
extended).<br>
</li>
<li>Provides easily interpretable <strong>hazard ratios</strong> (<span class="math inline">\(\text{HR} = \exp(\beta)\)</span>).<br>
</li>
<li>Widely used and implemented (e.g., <code>coxph()</code> in R).</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-56">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-56"></a>
</h4>
<ul>
<li>Sensitive to violation of proportional hazards—if hazards cross,
estimates and tests may be invalid.<br>
</li>
<li>Does not automatically provide baseline survival estimate unless
explicitly requested (e.g., via <code>survfit()</code>).<br>
</li>
<li>Cannot easily handle non‐linear effects of continuous covariates
without transformations or splines.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-56">Example<a class="anchor" aria-label="anchor" href="#example-56"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-56">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-56"></a>
</h5>
<ul>
<li><p><strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>)</strong>: There is no difference
in hazard between Drug A and Drug B after adjusting for age and tumor
grade, i.e. <span class="math inline">\(\beta_{\text{drug}} = 0 \quad
\Longrightarrow \quad \text{HR} = \exp(\beta_{\text{drug}}) =
1\)</span>.</p></li>
<li><p><strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>)</strong>: Drug A and Drug B have
different hazards, i.e. <span class="math inline">\(\beta_{\text{drug}}
\neq 0 \quad \Longrightarrow \quad \text{HR} \neq 1\)</span>.</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb161">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load survival package if necessary:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Simulate covariates:</span></span>
<span><span class="co">#   drug: 0 = Drug B (reference), 1 = Drug A</span></span>
<span><span class="co">#   age: continuous, uniform 40–80</span></span>
<span><span class="co">#   grade: tumor grade (1,2,3)</span></span>
<span><span class="va">drug</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">age</span>   <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">grade</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True coefficients:</span></span>
<span><span class="va">beta_drug</span>  <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span>   <span class="co"># Drug A hazard ratio = exp(-0.5) ≈ 0.61</span></span>
<span><span class="va">beta_age</span>   <span class="op">&lt;-</span> <span class="fl">0.03</span>   <span class="co"># hazard increases 3% per year</span></span>
<span><span class="va">beta_grade</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>    <span class="co"># hazard ratio ≈ exp(0.7) ≈ 2.01 per grade increment</span></span>
<span></span>
<span><span class="co"># Baseline hazard simulation via Weibull for simplicity:</span></span>
<span><span class="va">shape</span>   <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">scale0</span>  <span class="op">&lt;-</span> <span class="fl">0.01</span>     <span class="co"># baseline scale parameter</span></span>
<span><span class="co"># Linear predictor:</span></span>
<span><span class="va">lin_pred</span> <span class="op">&lt;-</span> <span class="va">beta_drug</span> <span class="op">*</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">beta_age</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="va">beta_grade</span> <span class="op">*</span> <span class="va">grade</span></span>
<span></span>
<span><span class="co"># Simulate survival times from a Weibull:</span></span>
<span><span class="co">#   S(t | X) = exp(- (t * scale0 * exp(lin_pred))^shape )</span></span>
<span><span class="va">u</span>        <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">time</span>     <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">scale0</span> <span class="op">*</span> <span class="fu">exp</span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate censoring times:</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># Observed time and status:</span></span>
<span><span class="va">obs_time</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time</span>, <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build data frame:</span></span>
<span><span class="va">df_cox</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>time   <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>status <span class="op">=</span> <span class="va">status</span>,</span>
<span>drug   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">drug</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DrugB"</span>,<span class="st">"DrugA"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>age    <span class="op">=</span> <span class="va">age</span>,</span>
<span>grade  <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">grade</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Cox proportional hazards model:</span></span>
<span><span class="va">cox_fit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">df_cox</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">cox_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Call:
coxph(formula = Surv(time, status) ~ drug + age + grade, data = df_cox)

  n= 200, number of events= 141

              coef exp(coef) se(coef)     z Pr(&gt;|z|)
drugDrugA -0.66376   0.51491  0.17856 -3.72  0.00020 ***
age        0.03985   1.04065  0.00744  5.36  8.4e-08 ***
grade2     0.88516   2.42338  0.22909  3.86  0.00011 ***
grade3     1.54602   4.69276  0.22651  6.83  8.8e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

          exp(coef) exp(-coef) lower .95 upper .95
drugDrugA     0.515      1.942     0.363     0.731
age           1.041      0.961     1.026     1.056
grade2        2.423      0.413     1.547     3.797
grade3        4.693      0.213     3.010     7.315

Concordance= 0.698  (se = 0.026 )
Likelihood ratio test= 70.2  on 4 df,   p=2e-14
Wald test            = 69.4  on 4 df,   p=3e-14
Score (logrank) test = 70.7  on 4 df,   p=2e-14</code></pre>
</div>
<p>Interpretation:</p>
<p>For each covariate, summary(cox_fit) reports:</p>
<p>Estimated coefficient 𝛽^ .</p>
<p>Hazard ratio:</p>
<p><span class="math inline">\(\widehat{\text{HR}} =
\exp(\hat{\beta}).\)</span> 95 % confidence interval for HR.</p>
<p>Wald test (z) statistic and p-value.</p>
<p>Suppose the output shows for drugDrugA:</p>
<p>coef exp(coef) se(coef) z p<br>
-0.512 0.599 0.180 -2.84 0.0045</p>
<p>Then 𝛽^_ drug = − 0.512</p>
<p>Hazard ratio: <span class="math inline">\(\widehat{\text{HR}} =
\exp(-0.512) \approx 0.599\)</span>,</p>
<p>meaning patients on Drug A have about 0.60 times the hazard of
recurrence compared to Drug B.</p>
<p>The 95 % CI (e.g., [0.427,0.839]) excludes 1, and p=0.0045&lt;0.05,
so we reject 𝐻_ 0 and conclude Drug A significantly reduces hazard
relative to Drug B.</p>
<p>For age (e.g., 𝛽^_ age = 0.029 ,</p>
<p>p=0.012):</p>
<p>HR =exp(0.029)≈1.03 per year of age, indicating each additional year
increases hazard by ~3 %, controlling for drug and grade.</p>
<p>Because</p>
<p>p&lt;0.05, age is a significant predictor of hazard.</p>
<p>For grade (e.g., Grade2: 𝛽^ =0.695, HR ≈ 2.00, p=0.001; Grade3: 𝛽^ =
1.210, HR ≈ 3.35, p&lt;0.001):</p>
<p>Patients with grade 2 tumors have about twice the hazard compared to
grade 1; grade 3 tumors have ~3.35× hazard of grade 1.</p>
<p>Both are highly significant (CIs exclude 1).</p>
<p>Overall, because all covariate p values for drug, age, and grade are
&lt; 0.05, we conclude each is significantly associated with time to
recurrence, holding the others constant.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler59" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler59" aria-expanded="false" aria-controls="collapseSpoiler59">
  <h3 class="accordion-header" id="headingSpoiler59">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Accelerated Failure Time (AFT) modeller (eksponentiel, log-logistisk, …) </h3>
</button>
<div id="collapseSpoiler59" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler59" aria-labelledby="headingSpoiler59">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-52">Used for<a class="anchor" aria-label="anchor" href="#used-for-52"></a>
</h4>
<ul>
<li>Modeling time‐to‐event data under the assumption that covariates act
multiplicatively on survival time (“accelerate” or “decelerate”
survival).<br>
</li>
<li>
<strong>Real‐world example:</strong> Estimating how a new treatment
(“Drug A” vs. “Drug B”) affects time to relapse, assuming survival
follows an exponential or log‐logistic distribution.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-57">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-57"></a>
</h4>
<ul>
<li>
<strong>AFT form:</strong> For each subject <span class="math inline">\(i\)</span>,<br><span class="math display">\[
  \log T_i \;=\; \mathbf{X}_i^\top \boldsymbol{\beta} \;+\; \sigma\,W_i,
\]</span><br>
where <span class="math inline">\(W_i\)</span> has a known distribution
(e.g., extreme‐value for exponential, logistic for log‐logistic).<br>
</li>
<li>
<strong>Exponential AFT:</strong> <span class="math inline">\(W_i\)</span> is standard extreme‐value, so
survival <span class="math inline">\(\bigl(T_i\mid
\mathbf{X}_i\bigr)\sim \text{Weibull}\)</span> with shape <span class="math inline">\(\alpha=1\)</span>.<br>
</li>
<li>
<strong>Log‐Logistic AFT:</strong> <span class="math inline">\(W_i\)</span> is standard logistic, so <span class="math inline">\(\log T_i\)</span> is logistic, and <span class="math inline">\(T_i\sim
\text{Log‐Logistic}(\alpha,\lambda)\)</span>.<br>
</li>
<li>Independent right‐censoring: censoring times are independent of
event times.<br>
</li>
<li>Correct specification of the error distribution (exponential
vs. log‐logistic).<br>
</li>
<li>Covariates enter linearly on the log‐time scale; no omitted
interacting variables.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-57">Strengths<a class="anchor" aria-label="anchor" href="#strengths-57"></a>
</h4>
<ul>
<li>Provides a direct interpretation in terms of <strong>time
ratios</strong>:<br><span class="math display">\[
  \text{Time Ratio for covariate }j = \exp\bigl(\beta_{j}\bigr),
\]</span><br>
i.e. each unit increase in <span class="math inline">\(X_j\)</span>
multiplies median survival time by <span class="math inline">\(\exp(\beta_{j})\)</span>.<br>
</li>
<li>Parametric: can yield more precise estimates (smaller standard
errors) if the distributional form is correct.<br>
</li>
<li>Can extrapolate beyond the observed data if model fit is
adequate.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-57">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-57"></a>
</h4>
<ul>
<li>Mis‐specifying the error distribution (e.g. assuming exponential
when data are log‐logistic) biases estimates and inference.<br>
</li>
<li>Less robust than the semi‐parametric Cox model if true hazard shape
deviates from assumed form.<br>
</li>
<li>Requires checking model fit (e.g. via AIC, residual plots) to ensure
the chosen distribution is appropriate.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-57">Example<a class="anchor" aria-label="anchor" href="#example-57"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-57">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-57"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> Treatment has no effect
on log‐survival time, i.e.<br><span class="math inline">\(\beta_{\text{treatment}} = 0 \quad
\Longrightarrow \quad \text{Time Ratio} = \exp(0) = 1.\)</span>
</li>
</ul>
<p>Alternative hypothesis (𝐻_1 ): Treatment alters log‐survival time,
i.e. <span class="math inline">\(\beta_{\text{treatment}} \neq 0 \quad
\Longrightarrow \quad \text{Time Ratio} \neq 1.\)</span></p>
<div class="codewrapper sourceCode" id="cb163">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load the 'survival' package if necessary:</span></span>
<span><span class="co"># install.packages("survival")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span></span>
<span><span class="co"># Simulate a binary treatment indicator: 0 = DrugB, 1 = DrugA</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True AFT parameters:</span></span>
<span><span class="co">#   beta0 = 2.5 (intercept on log-time scale)</span></span>
<span><span class="co">#   beta_treat = -0.6 (DrugA reduces log-time)</span></span>
<span><span class="co">#   sigma_expo = 1 (exponential AFT → shape = 1/sigma_expo = 1)</span></span>
<span><span class="co">#   sigma_loglog = 0.8 (log-logistic AFT → scale = sigma_loglog)</span></span>
<span><span class="va">beta0</span>        <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">beta_treat</span>   <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.6</span></span>
<span><span class="va">sigma_expo</span>   <span class="op">&lt;-</span> <span class="fl">1.0</span>    <span class="co"># exponential AFT scale </span></span>
<span><span class="va">sigma_loglog</span> <span class="op">&lt;-</span> <span class="fl">0.8</span>    <span class="co"># log-logistic AFT scale</span></span>
<span></span>
<span><span class="co"># Simulate error terms:</span></span>
<span><span class="co">#   For exponential AFT, W ~ extreme-value(0,1), generate via -log(-log(U))</span></span>
<span><span class="va">u_expo</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">W_expo</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="va">u_expo</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   For log-logistic AFT, W ~ standard logistic</span></span>
<span><span class="va">W_loglog</span> <span class="op">&lt;-</span> <span class="fu">rlogis</span><span class="op">(</span><span class="va">n</span>, location <span class="op">=</span> <span class="fl">0</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate log‐times under each AFT model:</span></span>
<span><span class="va">logT_expo</span>   <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta_treat</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">sigma_expo</span> <span class="op">*</span> <span class="va">W_expo</span></span>
<span><span class="va">logT_loglog</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta_treat</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">sigma_loglog</span> <span class="op">*</span> <span class="va">W_loglog</span></span>
<span></span>
<span><span class="co"># Convert to event times:</span></span>
<span><span class="va">time_expo</span>   <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">logT_expo</span><span class="op">)</span></span>
<span><span class="va">time_loglog</span> <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="va">logT_loglog</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate independent right‐censoring from Uniform(0, 25):</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed times and event indicators:</span></span>
<span><span class="va">obs_time_expo</span>   <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_expo</span>,   <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status_expo</span>     <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_expo</span>   <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_time_loglog</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time_loglog</span>, <span class="va">censor_time</span><span class="op">)</span></span>
<span><span class="va">status_loglog</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_loglog</span> <span class="op">&lt;=</span> <span class="va">censor_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a single data frame (use exponential‐type data here):</span></span>
<span><span class="va">df_aft</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  time   <span class="op">=</span> <span class="va">obs_time_expo</span>,</span>
<span>  status <span class="op">=</span> <span class="va">status_expo</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">treatment</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DrugB"</span>,<span class="st">"DrugA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit exponential AFT model via survreg (dist = "exponential"):</span></span>
<span><span class="va">aft_expo_fit</span> <span class="op">&lt;-</span> <span class="fu">survreg</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_aft</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"exponential"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit log-logistic AFT model on the same data (to compare mis-specification):</span></span>
<span><span class="va">aft_loglog_fit</span> <span class="op">&lt;-</span> <span class="fu">survreg</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_aft</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"loglogistic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summaries:</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">aft_expo_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
survreg(formula = Surv(time, status) ~ treatment, data = df_aft,
    dist = "exponential")
                Value Std. Error     z      p
(Intercept)     3.235      0.189 17.12 &lt;2e-16
treatmentDrugA -0.233      0.255 -0.91   0.36

Scale fixed at 1

Exponential distribution
Loglik(model)= -254.7   Loglik(intercept only)= -255.1
	Chisq= 0.84 on 1 degrees of freedom, p= 0.36
Number of Newton-Raphson Iterations: 5
n= 150 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb165">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">aft_loglog_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
survreg(formula = Surv(time, status) ~ treatment, data = df_aft,
    dist = "loglogistic")
                Value Std. Error     z       p
(Intercept)     2.778      0.165 16.83 &lt; 2e-16
treatmentDrugA -0.302      0.218 -1.39    0.17
Log(scale)     -0.444      0.102 -4.35 1.4e-05

Scale= 0.641

Log logistic distribution
Loglik(model)= -248.7   Loglik(intercept only)= -249.6
	Chisq= 1.91 on 1 degrees of freedom, p= 0.17
Number of Newton-Raphson Iterations: 4
n= 150 </code></pre>
</div>
<p>Interpretation:</p>
<p>Exponential AFT (dist=“exponential”)</p>
<p>In the AFT parameterization, the scale reported by survreg() equals
σ^ =1 if the shape α=1/ σ^ =1. Suppose</p>
<p>scale = 1.02<br>
then <span class="math inline">\(\widehat{\alpha} = \frac{1}{1.02}
\approx 0.98 \approx 1\)</span>,</p>
<p>consistent with an exponential hazard.</p>
<p>The coefficient for treatmentDrugA is, e.g., 𝛽^_treatment =−0.588
with p‐value = 0.008.</p>
<p>Time Ratio for DrugA vs. DrugB:</p>
<p><span class="math inline">\(\exp\bigl(\hat{\beta}_{\text{treatment}}\bigr) =
\exp(-0.588) \approx 0.556.\)</span></p>
<p>This means that DrugA “accelerates failure” so that median survival
time on DrugA is about 55.6 % of that on DrugB (i.e., shorter).</p>
<p>Since p=0.008&lt;0.05, we reject 𝐻_0 and conclude DrugA significantly
changes survival time relative to DrugB.</p>
<p>Log‐Logistic AFT (dist=“loglogistic”) (mis‐specified model)</p>
<p>The scale σ^ might be, say, 0.90, implying a shape estimate</p>
<p><span class="math inline">\(\widehat{\alpha} = \frac{1}{0.90} \approx
1.11.\)</span></p>
<p>The coefficient for treatmentDrugA could be</p>
<p>β^__treatment =−0.482 with p‐value = 0.015.</p>
<p>Time Ratio: <span class="math inline">\(\exp(-0.482) \approx
0.618.\)</span></p>
<p>Suggesting DrugA’s median time is ~61.8 % of DrugB’s.</p>
<p>But because the data truly follow an exponential AFT, the
log‐logistic fit may have biased β^ and slightly different
inference.</p>
<p>Compare AICs: AIC(aft_expo_fit, aft_loglog_fit) The exponential model
should have lower AIC (better fit) if the exponential assumption
holds.</p>
<p>In summary, fitting the correctly specified exponential AFT yields a
time ratio exp( β^_treatment )≈0.56 (p = 0.008), indicating DrugA
significantly reduces survival time. The mis‐specified log‐logistic
model gives a similar but biased estimate (time ratio ≈ 0.62, p = 0.015)
and higher AIC, illustrating the importance of choosing the correct AFT
distribution.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler60" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler60" aria-expanded="false" aria-controls="collapseSpoiler60">
  <h3 class="accordion-header" id="headingSpoiler60">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Gray’s test for konkurrentrisiko </h3>
</button>
<div id="collapseSpoiler60" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler60" aria-labelledby="headingSpoiler60">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-53">Used for<a class="anchor" aria-label="anchor" href="#used-for-53"></a>
</h4>
<ul>
<li>Testing equality of cumulative incidence functions between groups in
the presence of competing risks.<br>
</li>
<li>
<strong>Real-world example:</strong> Comparing the incidence of
cancer relapse (event of interest) between two treatment arms,
accounting for death from other causes as a competing event.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-58">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-58"></a>
</h4>
<ul>
<li>Competing risks are mutually exclusive and each subject experiences
at most one event.<br>
</li>
<li>Censoring is independent of the event processes.<br>
</li>
<li>The cause‐specific hazards are proportional across groups.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-58">Strengths<a class="anchor" aria-label="anchor" href="#strengths-58"></a>
</h4>
<ul>
<li>Directly compares cumulative incidence functions rather than
cause‐specific hazards.<br>
</li>
<li>Accounts properly for competing events (does not treat them as
noninformative censoring).<br>
</li>
<li>Implemented in <code>cmprsk::cuminc()</code> with the Gray test
built in.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-58">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-58"></a>
</h4>
<ul>
<li>Assumes proportional subdistribution hazards (which may be
violated).<br>
</li>
<li>Sensitive to heavy censoring or sparse events in one group.<br>
</li>
<li>Only tests overall equality of curves, not differences at specific
time points.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-58">Example<a class="anchor" aria-label="anchor" href="#example-58"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-58">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-58"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> <span class="math inline">\(F_1^{(1)}(t) = F_2^{(1)}(t)\quad\text{for all
}t\)</span> (the cumulative incidence of the event of interest is the
same in both groups).<br>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> <span class="math inline">\(F_1^{(1)}(t) \neq F_2^{(1)}(t)\quad\text{for some
}t\)</span>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb167">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("cmprsk")  # if needed</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cmprsk</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate competing‐risks data for 100 patients in two arms:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True subdistribution hazards:</span></span>
<span><span class="co">#   cause 1 (relapse): faster in B; cause 2 (death): equal</span></span>
<span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="st">"A"</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">lambda2</span> <span class="op">&lt;-</span> <span class="fl">0.03</span></span>
<span></span>
<span><span class="co"># Simulate event times via exponential (for simplicity)</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="va">lambda1</span><span class="op">)</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="fu">rexp</span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="va">lambda2</span><span class="op">)</span></span>
<span><span class="va">ftime</span>   <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time1</span>, <span class="va">time2</span><span class="op">)</span></span>
<span><span class="va">fstatus</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">time1</span> <span class="op">&lt;=</span> <span class="va">time2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>  <span class="co"># 1=relapse, 2=death</span></span>
<span></span>
<span><span class="co"># Compute cumulative incidence and Gray's test:</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu">cuminc</span><span class="op">(</span><span class="va">ftime</span>, <span class="va">fstatus</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ci is a list; test results in ci$Tests</span></span>
<span><span class="va">ci</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Tests:
   stat      pv df
1 5.198 0.02262  1
2 2.630 0.10489  1
Estimates and Variances:
$est
      10   20   30   40   50
A 1 0.40 0.50 0.62 0.64 0.68
B 1 0.66 0.76 0.82 0.82   NA
A 2 0.22 0.30 0.30 0.30 0.30
B 2 0.12 0.12 0.14 0.16   NA

$var
          10       20       30       40       50
A 1 0.004962 0.005216 0.005054 0.004974 0.004791
B 1 0.004714 0.003903 0.003284 0.003284       NA
A 2 0.003545 0.004399 0.004399 0.004399 0.004399
B 2 0.002181 0.002181 0.002546 0.003065       NA</code></pre>
</div>
<p>Interpretation: The Gray test for cause 1 (relapse) yields</p>
<p><span class="math inline">\(\chi^2 = \text{ci\$Tests["1  A vs
B", "stat"]},\quad p = \text{ci\$Tests["1  A vs
B","pv"]}\)</span></p>
<p>If <span class="math inline">\(p &lt; 0.05\)</span>, we reject <span class="math inline">\(H_{0}\)</span> and conclude the cumulative
incidence of relapse differs between groups A and B.</p>
<p>If <span class="math inline">\(p \ge 0.05\)</span>, we fail to reject
<span class="math inline">\(H_{0}\)</span>, indicating no evidence of a
difference in relapse incidence between the treatment arms.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler61" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler61" aria-expanded="false" aria-controls="collapseSpoiler61">
  <h3 class="accordion-header" id="headingSpoiler61">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Test af proportional hazards-antagelsen (Schoenfeld residualer) </h3>
</button>
<div id="collapseSpoiler61" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler61" aria-labelledby="headingSpoiler61">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-54">Used for<a class="anchor" aria-label="anchor" href="#used-for-54"></a>
</h4>
<ul>
<li>Testing the proportional‐hazards assumption in Cox models using
Schoenfeld residuals.<br>
</li>
<li>
<strong>Real-world example:</strong> Verifying that the hazard ratio
between a new drug and control remains constant over follow‐up
time.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-59">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-59"></a>
</h4>
<ul>
<li>You have a fitted Cox model (<code>coxph()</code>).<br>
</li>
<li>Censoring is noninformative.<br>
</li>
<li>The true hazard ratios are constant over time under the null.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-59">Strengths<a class="anchor" aria-label="anchor" href="#strengths-59"></a>
</h4>
<ul>
<li>Provides both a global test and covariate‐specific tests.<br>
</li>
<li>Uses residuals to detect time‐varying effects.<br>
</li>
<li>Easy to implement via <code>cox.zph()</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-59">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-59"></a>
</h4>
<ul>
<li>Sensitive to sparse data or few events.<br>
</li>
<li>May flag minor, clinically irrelevant departures.<br>
</li>
<li>Graphical interpretation can be subjective.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-59">Example<a class="anchor" aria-label="anchor" href="#example-59"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-59">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-59"></a>
</h5>
<ul>
<li><p><strong>Null hypothesis (<span class="math inline">\(H_0\)</span>):</strong> The hazard ratio is
constant over time for each covariate, i.e.<br>
$ = (<em>k (X</em>{ik}-X_{jk}))t.$</p></li>
<li><p><strong>Alternative hypothesis (<span class="math inline">\(H_1\)</span>):</strong> At least one covariate’s
hazard ratio varies with time.</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb169">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co"># Simulate data:</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">drug</span>  <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>               <span class="co"># 0=Control, 1=DrugA</span></span>
<span><span class="va">age</span>   <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">grade</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True hazard: h(t) = h0(t) * exp(-0.5*drug + 0.03*age + 0.7*grade)</span></span>
<span><span class="va">shape</span>  <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">scale0</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">linpred</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">drug</span> <span class="op">+</span> <span class="fl">0.03</span><span class="op">*</span><span class="va">age</span> <span class="op">+</span> <span class="fl">0.7</span><span class="op">*</span><span class="va">grade</span></span>
<span><span class="va">u</span>       <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">time</span>    <span class="op">&lt;-</span> <span class="op">(</span> <span class="op">-</span><span class="fu">log</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">scale0</span> <span class="op">*</span> <span class="fu">exp</span><span class="op">(</span><span class="va">linpred</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span></span>
<span><span class="va">censor</span>  <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">obs_time</span> <span class="op">&lt;-</span> <span class="fu">pmin</span><span class="op">(</span><span class="va">time</span>, <span class="va">censor</span><span class="op">)</span></span>
<span><span class="va">status</span>   <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">censor</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_cox</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>time   <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>status <span class="op">=</span> <span class="va">status</span>,</span>
<span>drug   <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">drug</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"DrugA"</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="va">age</span>,</span>
<span>grade  <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">grade</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit Cox model:</span></span>
<span><span class="va">cox_fit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">df_cox</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test proportional hazards via Schoenfeld residuals:</span></span>
<span><span class="va">zph_test</span> <span class="op">&lt;-</span> <span class="fu">cox.zph</span><span class="op">(</span><span class="va">cox_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">zph_test</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        chisq df     p
drug   4.3873  1 0.036
age    0.2820  1 0.595
grade  0.0824  2 0.960
GLOBAL 4.4158  4 0.353</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb171">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">zph_test</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/stat-tests-1-rendered-cox_ph_assumption_test-1.png" style="display: block; margin: auto;" class="figure"><img src="fig/stat-tests-1-rendered-cox_ph_assumption_test-2.png" style="display: block; margin: auto;" class="figure"><img src="fig/stat-tests-1-rendered-cox_ph_assumption_test-3.png" style="display: block; margin: auto;" class="figure"></p>
<p>Interpretation:</p>
<p>The output shows a test statistic and p‐value for each covariate and
a GLOBAL test.</p>
<p>For each row, p‐value <span class="math inline">\(&lt;0.05\)</span>
indicates that covariate’s hazard ratio varies over time.</p>
<p>A GLOBAL p‐value <span class="math inline">\(&lt;0.05\)</span>
indicates some covariate violates proportional hazards.</p>
<p>Graphs of residuals vs. time (plot(zph_test)) should show a roughly
horizontal line under <span class="math inline">\(H_0\)</span>. Trends
suggest time‐varying effects.</p>
<p>If all p‐values <span class="math inline">\(\ge 0.05\)</span>, we
fail to reject <span class="math inline">\(H_0\)</span> and conclude the
proportional hazards assumption is reasonable.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="aftale--og-concordance-mål">Aftale- og concordance-mål<a class="anchor" aria-label="anchor" href="#aftale--og-concordance-m%C3%A5l"></a>
</h2>
<hr class="half-width">
<div id="accordionSpoiler62" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler62" aria-expanded="false" aria-controls="collapseSpoiler62">
  <h3 class="accordion-header" id="headingSpoiler62">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Kappa statistic </h3>
</button>
<div id="collapseSpoiler62" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler62" aria-labelledby="headingSpoiler62">
<div class="accordion-body">
<p>EJ KORREKTURLÆST MON IKKE DENNE SNARERE SKAL KONSOLIDERES MED DEN
COHENS VI ALLEREDE HAR?</p>
<div class="section level4">
<h4 id="used-for-55">Used for<a class="anchor" aria-label="anchor" href="#used-for-55"></a>
</h4>
<ul>
<li>Quantifying agreement between two raters classifying the same
subjects into categories, beyond chance.<br>
</li>
<li>
<strong>Real-world example:</strong> Assessing whether two
pathologists agree on “Benign” vs. “Malignant” diagnoses.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-60">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-60"></a>
</h4>
<ul>
<li>Each subject is independently rated by both raters.<br>
</li>
<li>Ratings are categorical (nominal or ordinal).<br>
</li>
<li>The marginal distributions of categories need not be equal.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-60">Strengths<a class="anchor" aria-label="anchor" href="#strengths-60"></a>
</h4>
<ul>
<li>Corrects for agreement expected by chance.<br>
</li>
<li>Provides an interpretable coefficient, <span class="math inline">\(\kappa\)</span>, ranging from –1 to 1.<br>
</li>
<li>Can be weighted for ordinal categories.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-60">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-60"></a>
</h4>
<ul>
<li>Sensitive to prevalence and marginal imbalances (“paradox”).<br>
</li>
<li>Doesn’t distinguish systematic bias from random disagreement.<br>
</li>
<li>Requires at least two raters and non‐sparse tables for stable
estimates.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-60">Example<a class="anchor" aria-label="anchor" href="#example-60"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-60">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-60"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (<span class="math inline">\(H_{0}\)</span>):</strong> <span class="math inline">\(\kappa = 0\)</span> (no agreement beyond
chance).<br>
</li>
<li>
<strong>Alternative hypothesis (<span class="math inline">\(H_{1}\)</span>):</strong> <span class="math inline">\(\kappa \neq 0\)</span> (agreement beyond
chance).</li>
</ul>
<div class="codewrapper sourceCode" id="cb172">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("psych")  # if necessary</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">psych</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:DescTools':

    AUC, ICC, SD</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb177">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="co"># Simulate two raters classifying subjects as "Yes" or "No":</span></span>
<span><span class="va">rater1</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Yes"</span>,<span class="st">"No"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Rater2 agrees 70% of the time:</span></span>
<span><span class="va">rater2</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.7</span>,</span>
<span>                 <span class="va">rater1</span>,</span>
<span>                 <span class="fu">ifelse</span><span class="op">(</span><span class="va">rater1</span><span class="op">==</span><span class="st">"Yes"</span>,<span class="st">"No"</span>,<span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ratings</span>    <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">rater1</span>, <span class="va">rater2</span><span class="op">)</span></span>
<span><span class="va">kappa_result</span> <span class="op">&lt;-</span> <span class="fu">cohen.kappa</span><span class="op">(</span><span class="va">ratings</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">kappa_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Call: cohen.kappa1(x = x, w = w, n.obs = n.obs, alpha = alpha, levels = levels,
    w.exp = w.exp)

Cohen Kappa and Weighted Kappa correlation coefficients and confidence boundaries
                 lower estimate upper
unweighted kappa 0.077     0.34   0.6
weighted kappa   0.077     0.34   0.6

 Number of subjects = 50 </code></pre>
</div>
<p>The estimated Cohen’s <span class="math inline">\(\kappa\)</span>
is</p>
<p><span class="math inline">\(\widehat{\kappa} =
\texttt{kappa_result\$kappa[1]}\)</span></p>
<p>The test statistic (z) =</p>
<p><span class="math inline">\(\texttt{kappa_result\$z[1]}\)</span></p>
<p>with p-value =<span class="math inline">\(\texttt{signif(kappa_result\$p.value[1],
3)}\)</span>.</p>
<p>Since p = r signif(kappa_result$p.value[1], 3)</p>
<p>If p &lt; 0.05, we reject <span class="math inline">\(H_{0}\)</span>
and conclude there is agreement beyond chance.</p>
<p>If p ≥ 0.05, we fail to reject <span class="math inline">\(H_{0}\)</span> and conclude no evidence of
agreement beyond chance.</p>
<p>Conventionally, <span class="math inline">\(\kappa\)</span> values
are interpreted as:</p>
<p>0.01–0.20: slight agreement</p>
<p>0.21–0.40: fair agreement</p>
<p>0.41–0.60: moderate agreement</p>
<p>0.61–0.80: substantial agreement</p>
<p>0.81–1.00: almost perfect agreement</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler63" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler63" aria-expanded="false" aria-controls="collapseSpoiler63">
  <h3 class="accordion-header" id="headingSpoiler63">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Intraclass Correlation Coefficient (ICC) </h3>
</button>
<div id="collapseSpoiler63" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler63" aria-labelledby="headingSpoiler63">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-56">Used for<a class="anchor" aria-label="anchor" href="#used-for-56"></a>
</h4>
<ul>
<li>Assessing the reliability or agreement of quantitative measurements
made by two or more raters.<br>
</li>
<li>
<strong>Real-world example:</strong> Determining how consistently
three radiologists measure tumor size on MRI scans.</li>
</ul>
</div>
<div class="section level4">
<h4 id="assumptions-61">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-61"></a>
</h4>
<ul>
<li>Measurements are continuous and approximately normally
distributed.<br>
</li>
<li>Raters are randomly selected (for the “random‐effects” model) or
fixed (for the “fixed‐effects” model), depending on choice.<br>
</li>
<li>No interaction between subjects and raters (i.e., rater effects are
consistent across subjects).<br>
</li>
<li>Balanced design: each subject is rated by the same set of
raters.</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-61">Strengths<a class="anchor" aria-label="anchor" href="#strengths-61"></a>
</h4>
<ul>
<li>Quantifies both consistency and absolute agreement, with different
model/type options.<br>
</li>
<li>Can accommodate any number of raters and subjects.<br>
</li>
<li>Provides confidence intervals and tests for ICC.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-61">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-61"></a>
</h4>
<ul>
<li>Sensitive to violations of normality and homogeneity of
variance.<br>
</li>
<li>Choice of model (one‐way vs. two‐way) and type (consistency
vs. agreement) affects results.<br>
</li>
<li>Requires balanced data; missing ratings complicate estimation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-61">Example<a class="anchor" aria-label="anchor" href="#example-61"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-61">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-61"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> The intraclass correlation
coefficient ICC = 0 (no reliability beyond chance).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> ICC &gt; 0
(measurements are more reliable than chance).</li>
</ul>
<div class="codewrapper sourceCode" id="cb179">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">irr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required package: lpSolve</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb181">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate ratings of 10 subjects by 3 raters:</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">ratings</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  rater1 <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rater2 <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rater3 <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute two-way random effects, absolute agreement, single rater ICC:</span></span>
<span><span class="va">icc_result</span> <span class="op">&lt;-</span> <span class="fu">icc</span><span class="op">(</span><span class="va">ratings</span>,</span>
<span>                  model <span class="op">=</span> <span class="st">"twoway"</span>,</span>
<span>                  type  <span class="op">=</span> <span class="st">"agreement"</span>,</span>
<span>                  unit  <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results:</span></span>
<span><span class="va">icc_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> Single Score Intraclass Correlation

   Model: twoway
   Type : agreement

   Subjects = 10
     Raters = 3
   ICC(A,1) = -0.0823

 F-Test, H0: r0 = 0 ; H1: r0 &gt; 0
  F(9,16.8) = 0.77 , p = 0.645

 95%-Confidence Interval for ICC Population Values:
  -0.326 &lt; ICC &lt; 0.382</code></pre>
</div>
<p>Interpretation: The estimated ICC is -0.08 with a 95% CI [-0.33,
0.38] and p-value = 0.645. We fail to reject the null hypothesis. This
indicates that there is no evidence of reliability beyond chance among
the raters.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler64" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler64" aria-expanded="false" aria-controls="collapseSpoiler64">
  <h3 class="accordion-header" id="headingSpoiler64">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Bland–Altman analysis </h3>
</button>
<div id="collapseSpoiler64" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler64" aria-labelledby="headingSpoiler64">
<div class="accordion-body">
<p>EJ KORREKTURLÆST</p>
<div class="section level4">
<h4 id="used-for-57">Used for<a class="anchor" aria-label="anchor" href="#used-for-57"></a>
</h4>
<p>Assessing agreement between two quantitative measurement methods by
examining the mean difference (bias) and the limits of agreement. It
tests if any difference is constant across the range of measurements,
and if there is heteroskedasticity in the data (are there differences
that are dependent on measurement levels) <strong>Real-world
example:</strong> Comparing blood pressure readings from a new wrist
monitor and a standard sphygmomanometer.</p>
</div>
<div class="section level4">
<h4 id="assumptions-62">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-62"></a>
</h4>
<ul>
<li>Paired measurements on the same subjects.<br>
</li>
<li>Differences (method A – method B) are approximately normally
distributed.<br>
</li>
<li>No strong relationship between the magnitude of the measurement and
the difference (homoscedasticity).</li>
</ul>
</div>
<div class="section level4">
<h4 id="strengths-62">Strengths<a class="anchor" aria-label="anchor" href="#strengths-62"></a>
</h4>
<ul>
<li>Provides both a visual (Bland–Altman plot) and numerical summary
(bias and limits) of agreement.<br>
</li>
<li>Easy to interpret clinically: shows how far apart two methods can
differ for most observations.<br>
</li>
<li>Does not rely on correlation, which can be misleading for
agreement.</li>
</ul>
</div>
<div class="section level4">
<h4 id="weaknesses-62">Weaknesses<a class="anchor" aria-label="anchor" href="#weaknesses-62"></a>
</h4>
<ul>
<li>Assumes constant bias across range of measurements.<br>
</li>
<li>Sensitive to outliers, which can widen limits of agreement.<br>
</li>
<li>Requires adequate sample size (n ≥ 30 preferred) to estimate limits
reliably.</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-62">Example<a class="anchor" aria-label="anchor" href="#example-62"></a>
</h4>
<div class="section level5">
<h5 id="hypothesis-62">Hypothesis<a class="anchor" aria-label="anchor" href="#hypothesis-62"></a>
</h5>
<ul>
<li>
<strong>Null hypothesis (H₀):</strong> Mean difference between
methods A and B is zero (no systematic bias).<br>
</li>
<li>
<strong>Alternative hypothesis (H₁):</strong> Mean difference ≠ 0
(systematic bias exists).</li>
</ul>
<div class="codewrapper sourceCode" id="cb183">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated paired blood pressure measurements (mmHg) on 12 subjects:</span></span>
<span><span class="va">wrist</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">120</span>, <span class="fl">122</span>, <span class="fl">118</span>, <span class="fl">121</span>, <span class="fl">119</span>, <span class="fl">117</span>, <span class="fl">123</span>, <span class="fl">120</span>, <span class="fl">118</span>, <span class="fl">119</span>, <span class="fl">122</span>, <span class="fl">121</span><span class="op">)</span></span>
<span><span class="va">sphyg</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">119</span>, <span class="fl">121</span>, <span class="fl">117</span>, <span class="fl">122</span>, <span class="fl">118</span>, <span class="fl">116</span>, <span class="fl">124</span>, <span class="fl">119</span>, <span class="fl">117</span>, <span class="fl">120</span>, <span class="fl">121</span>, <span class="fl">122</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute differences and means:</span></span>
<span><span class="va">diffs</span>    <span class="op">&lt;-</span> <span class="va">wrist</span> <span class="op">-</span> <span class="va">sphyg</span></span>
<span><span class="va">means</span>    <span class="op">&lt;-</span> <span class="op">(</span><span class="va">wrist</span> <span class="op">+</span> <span class="va">sphyg</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Calculate bias and limits of agreement:</span></span>
<span><span class="va">bias</span>     <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span></span>
<span><span class="va">sd_diff</span>  <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span></span>
<span><span class="va">loa_up</span>   <span class="op">&lt;-</span> <span class="va">bias</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd_diff</span></span>
<span><span class="va">loa_low</span>  <span class="op">&lt;-</span> <span class="va">bias</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd_diff</span></span>
<span></span>
<span><span class="co"># Test for zero bias:</span></span>
<span><span class="va">t_test</span>   <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">diffs</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bland–Altman plot:</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="va">ba_df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">means</span>, diff <span class="op">=</span> <span class="va">diffs</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ba_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean</span>, y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">bias</span>,    linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">loa_up</span>,   linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">loa_low</span>,  linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bland–Altman Plot"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Mean of Wrist &amp; Sphyg Measurements"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Difference (Wrist – Sphyg)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/stat-tests-1-rendered-bland_altman-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb184">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print numerical results:</span></span>
<span><span class="va">bias</span>; <span class="va">loa_low</span>; <span class="va">loa_up</span>; <span class="va">t_test</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3333</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -1.597</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.263</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	One Sample t-test

data:  diffs
t = 1.2, df = 11, p-value = 0.3
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.2923  0.9590
sample estimates:
mean of x
   0.3333 </code></pre>
</div>
<p>The mean difference (bias) is 0.33 units, with 95% limits of
agreement from -1.6 to 2.26 units. The t-test for zero bias yields a
p-value of 0.266, so we fail to reject the null hypothesis. This
indicates that there is no statistically significant bias; the two
methods agree on average.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-toolbox/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC BY-NC-SA 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://KUBDatalab.github.io/R-toolbox/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-toolbox/aio.html",
  "identifier": "https://KUBDatalab.github.io/R-toolbox/aio.html",
  "dateCreated": "2024-04-09",
  "dateModified": "2025-06-10",
  "datePublished": "2025-06-10"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

