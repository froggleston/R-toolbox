<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>R-toolbox: R on Ucloud</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/lc/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/lc/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/lc/favicon-16x16.png"><link rel="manifest" href="favicons/lc/site.webmanifest"><link rel="mask-icon" href="favicons/lc/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="assets/images/library-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/ucloud.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="assets/images/library-logo-sm.svg"></div>
    <div class="lesson-title-md">
      R-toolbox
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            R-toolbox
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="CLT-dk.html">CLT - på dansk</a></li><li><a class="dropdown-item" href="CLT-en.html">CLT - in english</a></li><li><a class="dropdown-item" href="data.html">Data sets</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R-toolbox
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 55%" class="percentage">
    55%
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: 55%" aria-valuenow="55" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/ucloud.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="reproducible-analysis.html">1. Reproducible Data Analysis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reading-files.html">2. Reading data from file</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="descript-stat.html">3. Descriptive Statistics</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="histograms.html">4. Histograms</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="table1.html">5. Table One</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="tidy-data.html">6. Tidy Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="normal-distribution.html">7. The normal distribution</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="is-it-normal.html">8. Testing for normality</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="which-distribution.html">9. How is the data distributed?</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="linear-regression.html">10. Linear regression</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="multiple-linear-regression.html">11. Multiple Linear Regression</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="logistic-regression.html">12. Logistic regression</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="clt.html">13. Central Limit Theorem</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="barcharts.html">14. Nicer barcharts</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="powerberegninger.html">15. Power Calculations</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="kmeans.html">16. k-means</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="anova.html">17. ANOVA</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="cohens-kappa.html">18. Cohens Kappa</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        19. R on Ucloud
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#this-is-not-a-computer-as-such">This is not a computer as such</a></li>
<li><a href="#lets-get-started">Lets get started!</a></li>
<li><a href="#housekeeping">Housekeeping</a></li>
<li><a href="#setup-issues">Setup issues</a></li>
<li><a href="#the-good-solution">The Good Solution</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="pipes.html">20. A deeper dive into pipes</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="gis_setup.html">21. Setup for GIS</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="git-00-setup.html">22. Setup for Git</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="git-09-practice.html">23. Practice makes perfect</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="stat-tests-1.html">24. Statistical tests</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="fence-test.html">25. Fences på vores undervisningssider</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="making-a-new-course.html">26. Make a new course</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="CLT-dk.html">CLT - på dansk</a></li><li><a href="CLT-en.html">CLT - in english</a></li><li><a href="data.html">Data sets</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="cohens-kappa.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="pipes.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="cohens-kappa.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Cohens Kappa
        </a>
        <a class="chapter-link float-end" href="pipes.html" rel="next">
          Next: A deeper dive into...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>R on Ucloud</h1>
        <p>Last updated on 2025-06-16 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/ucloud.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is Ucloud?</li>
<li>How do we use R and RStudio on Ucloud?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain how to acces RStudio and R on Ucloud</li>
<li>Demonstrate how to setup drives and additional software working with
Ucloud</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>You need to run R on a computer that have more muscles than you
own.</p>
<p>If you are a student at UCPH, you are in luck, because you have
access to a High Performance Computing (HPC) facility; ucloud. It can be
acessed at cloud.sdu.dk using the normal UCPH login and password.</p>
<p>Depending on the user allowances, it will look something like
this.</p>
<figure><img src="fig/ucloud_front.png" class="figure mx-auto d-block"></figure><p>Ucloud provides access to a multitude of different applications
organized in the application store:</p>
<figure><img src="fig/ucloud_store.png" class="figure mx-auto d-block"></figure><p>Amongst the more popular picks from the store is RStudio:</p>
<figure><img src="fig/ucloud_picks.png" class="figure mx-auto d-block"></figure><p>This allow us to start a session of RStudio, accessible in the
browser.</p>
<figure><img src="fig/ucloud_rstudio.png" class="figure mx-auto d-block"></figure><p>Note that we can chose different machine types. Parallel processing
is not the solution to every problem, but sometimes it is, and here we
get access to a <em>lot</em> of cores.</p>
<p>You select a suitable type of machine, chose how long you want it to
run, click submit, and after a short wait, you can click “Interface”,
and you will have, in your browser, something that looks almost exactly
like RStudio.</p>
<section><h2 class="section-heading" id="this-is-not-a-computer-as-such">This is not a computer as such<a class="anchor" aria-label="anchor" href="#this-is-not-a-computer-as-such"></a></h2>
<hr class="half-width"><p>What we can start is not a computer. It is a virtual machine. A
virtual machine is not a real computer, it is a simulation of a
computer, that runs on a larger computer. Rather than installing an
operating system and software on a real computer, we ask the larger
computer to start a simulation of a computer. Since we interact with it
through the web, we might not discover the difference. But there are
some, which are important to know about.</p>
<div class="section level3">
<h3 id="compute">Compute<a class="anchor" aria-label="anchor" href="#compute"></a></h3>
<p>Running a virtual computer on a HPC-facility gives us access to a lot
of resources, primarily “CPU”s and “RAM”.</p>
<p>Your own computer have a CPU. It is the physical unit that actually
runs your code. When we ask R to calculate <code>1+1</code>, it is the
CPU that does the calculation.</p>
<p>Most modern CPU have multiple “cores”. So in reality it is not the
CPU that actually performs the calculation, it is one of the cores in
the CPU.</p>
<p>The computer used for writing this text have 20 cores.</p>
<p>This is nice, for the core can - in principle - only do one
calculation at a time. When we calculate <code>1+1</code>, that is the
only thing the core can do at that precise moment.</p>
<p>The thruth is a lot more complicated, but the analogy is useful in
order to understand why it can be nice to have more than one.</p>
<p>Having access to more than one core allow us to run some of our
calculations in parallel. If you are asked to do 10 simple
multiplications, you are finished when you have done 10 multiplications.
Ask a friend to help, and do 5 yourself, and let your friend do 5 - you
will be done in half the time.</p>
<p>Some calculations we want to do in R can be parallelized, where we
ask one core to distribute the tasks to 10 different cores. The
calculation will then be done much faster, than if only one core worked
on the problem.</p>
<p>Chosing a machine on Ucloud with a lot of cores will not necesarily
speed up your work. The code you run will have to be written to make use
of all the cores. And sometimes it takes longer to do that, than just
leaving all the work to a single core.</p>
<p>How do we find out how many cores we have? It should be simple. The
library <code>parallel</code> have a function <code>detectCores()</code>
that returns the number of cores we have access to:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Reading the documentation reveals that it is not that simple:</p>
<p>“Where virtual machines are in use, one would hope that the result
for logical = TRUE represents the number of CPUs available (or
potentially available) to that particular VM.”</p>
<p>Or use this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu">availableCores</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="memory">Memory<a class="anchor" aria-label="anchor" href="#memory"></a></h3>
<p>Looking at the interface, we see that we also get access to more
memory, or RAM.</p>
<p>RAM is the short term memory of the computer. If we want to
manipulate 10 Gb data, we need to be able to have 10 Gb of data in the
memory of the computer. And we probably need to have access to much more
than 10 Gb, because R likes to use a lot of memory, and tends to make a
copy of the data it manipulates.</p>
<p>We might therefore have to chose a certain size of virtual machine,
not because we actually need 64 cores, but because we need the
memory.</p>
</div>
<div class="section level3">
<h3 id="it-will-go-away">It will go away!<a class="anchor" aria-label="anchor" href="#it-will-go-away"></a></h3>
<p>Because we are running a virtual computer, rather than a real
computer, most of what we do will disappear when we restart the
computer. In R we typically installs a number of libraries or packages.
Those will vanish into thin air when the virtual machine is closed down.
In a section below we will cover access to drives on Ucloud which to a
certain degree can help us. But if we do not take precautions, we will
have to install R-packages every time we start up a new virtual machine
on Ucloud</p>
</div>
<div class="section level3">
<h3 id="cost">Cost<a class="anchor" aria-label="anchor" href="#cost"></a></h3>
<p>We might be tempted to let the virtual machine run forever, instead
of only for 1 hour. But Ucloud is a limited resource, and we only have a
specific allowance in total. Running a machine with one virutal CPU for
one hour consumes 1 “core-hour” of our allowance. Running a machine with
64 virtual CPUs for one hour consumes 64 core-hours. And when we run out
of allowance - the machine will close down.</p>
<p>It will also close down when the time we chose ran out.</p>
<p>Therefore, do not request more cores than you actually need.</p>
<p>On the other hand, do not request less than you need. If you chose 1
CPU, with 6 Gb RAM, and discover that you actually needed 12 Gb RAM -
you will have to shut down the virtual machine, and start a larger.</p>
<p>And because we are not running on a real computer, everything will be
lost.</p>
</div>
<div class="section level3">
<h3 id="your-drive">Your drive<a class="anchor" aria-label="anchor" href="#your-drive"></a></h3>
<p>Not all is lost when you restart a virtual machine. Ucloud provides
you with a drive:</p>
<figure><img src="fig/ucloud_drive.png" class="figure mx-auto d-block"></figure><p>In it we find a listing of what is in our drive: <img src="fig/ucloud_drive_2.png" class="figure"></p>
<p>The folder “Jobs” contains data from the individual runs of virtual
machines you have done. And Trash contains deleted files.</p>
<p>Note that the content of both these folders counts towards the total
storage you have available - so consider deleting them regularly.</p>
<p>It is recommended to create a folder for your work. Choose “Create
folder” and give it a name. For this example we will call it
“ml-course”.</p>
<div id="caution1" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Caution</h3>
<div class="callout-content">
<p>Do not use white spaces in your folder or file names. Most
programming languages are able to handle them, but will almost always
require special steps to be taken. Having white spaces in file names
introduces a potential for problems that can be difficult to identify
and fix.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="lets-get-started">Lets get started!<a class="anchor" aria-label="anchor" href="#lets-get-started"></a></h2>
<hr class="half-width"><p>Go to the app-store as shown above, and chose RStudio.</p>
<p>Chose the “u1-standard-2” machinetype with 2 virtual CPUs and 12 GB
memory.</p>
<p>In order to be able to access our files, go to “Select folders to
use” and click add folder:</p>
<figure><img src="fig/ucloud_start.png" class="figure mx-auto d-block"></figure><p>Click in “No directory selected” and then on “Use” to choose
“ml-course”:</p>
<figure><img src="fig/ucloud_start_1.png" class="figure mx-auto d-block"></figure><p>And than click “Submit”</p>
<p>Your request is being processed:</p>
<figure><img src="fig/ucloud_start_2.png" class="figure mx-auto d-block"></figure><p>And after a short while, you get this:</p>
<figure><img src="fig/ucloud_start_3.png" class="figure mx-auto d-block"></figure><p>We can see what type of machine we chose, and how much time is
remaining. We chose 1 hour, and we can extend the runtime by 1, 8 or 24
hours.</p>
<p>We can also see the “Open interface” button.</p>
<p>If we click that, RStudio opens and we can begin working with R.</p>
<p>The very first thing we should always do, is to create a project. At
the upper right hand corner we see where we can do that:</p>
<figure><img src="fig/ucloud_rstudio_2.png" class="figure mx-auto d-block"></figure><p>Click new project, create it in a “new Directory” and change the
subdirectory in which the project is created to the directory we made
earlier. THIS IS IMPORTANT!</p>
<figure><img src="fig/ucloud_rstudio_3.png" class="figure mx-auto d-block"></figure><p>We now have a project running in RStudio on a virtual machine on
UCloud, and we are ready to work!</p>
</section><section><h2 class="section-heading" id="housekeeping">Housekeeping<a class="anchor" aria-label="anchor" href="#housekeeping"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="what-to-do-if-rstudio-appears-to-freeze">What to do if RStudio appears to freeze?<a class="anchor" aria-label="anchor" href="#what-to-do-if-rstudio-appears-to-freeze"></a></h3>
<p>First of all - have patience. RStudio appears almost the same when it
is frozen and if it is working on something that takes time. But take
advantadge of the fact that this is just a web interface to what is
actually running on a virtual remote machine. Close the interface, and
open it again. R will still be there.</p>
</div>
<div class="section level3">
<h3 id="where-can-i-find-the-job-again">Where can I find the job again?<a class="anchor" aria-label="anchor" href="#where-can-i-find-the-job-again"></a></h3>
<p>Sometimes we close a window, or nagivate away from it. Where can we
find it again? In the navigationbar to the left in Ucloud we find this
icon. <img src="fig/ucloud_running_jobs.png" class="figure"> It provides us with a
list or running jobs (yes, we can have more than one). Click on the job,
and we get back to the job, where we can extend time or open the
interface again.</p>
</div>
<div class="section level3">
<h3 id="im-done-early---how-do-i-stop-the-job">I’m done early - how do I stop the job?<a class="anchor" aria-label="anchor" href="#im-done-early---how-do-i-stop-the-job"></a></h3>
<p>If you are done with your work, and there is no reason to continue
running the machine, you can stop it early. Find the job (see above),
and click and hold the “Stop application” button. Remember to save your
scripts in RStudio first!</p>
<ul><li>how to download an entire folder, so they can download their work at
the end of the semester (without having to learn how to sync folders,
which I imagine will be too much to ask from this workshop)
archiver…</li>
</ul></div>
<div class="section level3">
<h3 id="how-do-i-get-files-out-of-ucloud">How do I get files out of UCloud?<a class="anchor" aria-label="anchor" href="#how-do-i-get-files-out-of-ucloud"></a></h3>
<p>This can be done in several different ways. Ucloud provides guides on
how to syncronise files. And there are archiving tools that can zip and
download your files.</p>
<p>The easy way is to do it through RStudio. Select the folder and/or
files you want to save, click on the little cogwheel saying “More” and
chose “Export”. RStudio will now zip the files, and ask you where to
save them. <img src="fig/ucloud_save.png" class="figure"></p>
</div>
<div class="section level3">
<h3 id="how-do-i-get-files-into-ucloud">How do I get files into UCloud<a class="anchor" aria-label="anchor" href="#how-do-i-get-files-into-ucloud"></a></h3>
<p>Again - Ucloud have services that can assist. But the easiest way is
to note that there is an “Upload” button in the Files pane in RStudio.
Use that.</p>
</div>
<div class="section level3">
<h3 id="what-types-of-machines-did-i-have-access-to">What types of machines did I have access to?<a class="anchor" aria-label="anchor" href="#what-types-of-machines-did-i-have-access-to"></a></h3>
<p>UCloud offers the possibility of “projects” where you choices might
be different. If you’re not in a “project” these will be the default
options:</p>
<table class="table"><thead><tr class="header"><th>name</th>
<th>vcpu</th>
<th>memory (GB)</th>
</tr></thead><tbody><tr class="odd"><td>u1-standard-1</td>
<td>1</td>
<td>6</td>
</tr><tr class="even"><td>u1-standard-2</td>
<td>2</td>
<td>12</td>
</tr><tr class="odd"><td>u1-standard-4</td>
<td>4</td>
<td>24</td>
</tr><tr class="even"><td>u1-standard-8</td>
<td>8</td>
<td>48</td>
</tr><tr class="odd"><td>u1-standard-16</td>
<td>16</td>
<td>96</td>
</tr><tr class="even"><td>u1-standard-32</td>
<td>32</td>
<td>192</td>
</tr><tr class="odd"><td>u1-standard-64</td>
<td>64</td>
<td>384</td>
</tr></tbody></table></div>
</section><section><h2 class="section-heading" id="setup-issues">Setup issues<a class="anchor" aria-label="anchor" href="#setup-issues"></a></h2>
<hr class="half-width"><p>We can save our work, and as long as we do not delete it again, we
have access to it. And keeping stuff in a project in R makes everything
easy(ish) to locate.</p>
<p>That, in general works nicely on a “real” computer, where libraries
and other elements of what we work with is saved locally.</p>
<p>On a virtual computer, locally is in the memory of a larger computer,
and as hinted at, these locally stored files disappear when the virtual
machine is restarted.</p>
<p>If you usually start your code with <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>,
you will, on a virtual machine, have to start with
<code>install.packages("tidyverse")</code> instead. <em>Every
time!</em></p>
<p>Working with machine learning makes this even worse. Many of the
algorithms we work with requires us to have specific Python libraries
installed, and available to R. They also disappear.</p>
<p>And to complicate matters even more, some of them require specific
versions of Python, and are unable to run on the newest version. And by
default the version of Python on Ucloud is the newest.</p>
<p>Below we present two ways of handling this. First “The Good
Solution”. Which could be better. And “The Sledgehammer Solution”. Which
is the reason we call “The Good Solution” good.</p>
</section><section><h2 class="section-heading" id="the-good-solution">The Good Solution<a class="anchor" aria-label="anchor" href="#the-good-solution"></a></h2>
<hr class="half-width"><p>First of all, and <em>this is important!</em> you chose the folder we
demonstrated how to use earlier:</p>
<figure><img src="fig/ucloud_start_1.png" class="figure mx-auto d-block"></figure><p>The method requires the setup to know exactly where your files
are.</p>
<p>Secondly, and for the same reason, you <em>must</em> create a project
in the folder you attached to the run of the virtual machine.</p>
<p>Then make a script-file. It is not important what you call it, here
we call it “setup.R”</p>
<p>Copy the code below into that file, and run the code
<em>line-by-line</em>.</p>
<p>Some of the lines of code restart R. This is necessary for R to
read-in new options and settings. And when R is restarted, it does not
know where to continue.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set path to renv cache</span></span>
<span><span class="fu">writeLines</span><span class="op">(</span><span class="st">'RENV_PATHS_CACHE = "renv/cache"'</span>, <span class="st">".Renviron"</span><span class="op">)</span></span>
<span><span class="co"># restart R in order to set the environment variable</span></span>
<span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initializing renv. You will be asked if you want to do it. You do.</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">init</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Yes, it should be possible to do this in one go. </span></span>
<span><span class="co"># It fails. So, three lines of code...</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"reticulate"</span>, prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">'rstudio/tensorflow'</span>, prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"rstudio/keras"</span>, prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install miniconda - control where</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">install_miniconda</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"python_env"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Storing information about installed packages</span></span>
<span><span class="co"># You might be asked if you want to proceed. You do.</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># restart R to ensure that R knows where miniconda is installed</span></span>
<span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create python environment</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_create</span><span class="op">(</span></span>
<span>  envname <span class="op">=</span> <span class="st">"my_project_env"</span>,</span>
<span>  packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"python=3.10"</span>, <span class="st">"openssl=3.3.0"</span><span class="op">)</span>,</span>
<span>  channels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"conda-forge"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install Python packages in the environment</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_install</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"my_project_env"</span>, </span>
<span>                          packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"numpy&gt;=1.24"</span>, </span>
<span>                                       <span class="st">"pandas&gt;=2.1"</span>, </span>
<span>                                       <span class="st">"tensorflow&gt;=2.13"</span>, </span>
<span>                                       <span class="st">"keras&gt;=2.13"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_install</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"my_project_env"</span>, packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"transformers&gt;=4.30"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">conda_install</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"my_project_env"</span>, packages <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"pytorch"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Restart R - this might not be necessary - we do it anyway</span></span>
<span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify which environment is to be used</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">use_condaenv</span><span class="op">(</span><span class="st">"my_project_env"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Storing information about installed packages</span></span>
<span><span class="co"># You might be asked if you want to proceed. You do.</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>

<p>One way to check that everything worked, is to run the following
script:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">use_condaenv</span><span class="op">(</span><span class="st">"my_project_env"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">keras3</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">keras_model_sequential</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_dense</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">32</span>, input_shape <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">784</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_activation</span><span class="op">(</span><span class="st">"relu"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_dense</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">layer_activation</span><span class="op">(</span><span class="st">"softmax"</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#importing the transformers python module</span></span>
<span><span class="va">transformers</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="st">"transformers"</span><span class="op">)</span> </span>
<span><span class="va">autotoken</span> <span class="op">&lt;-</span> <span class="va">transformers</span><span class="op">$</span><span class="va">AutoTokenizer</span></span>
<span><span class="va">autoModelClass</span> <span class="op">&lt;-</span> <span class="va">transformers</span><span class="op">$</span><span class="va">AutoModelForSequenceClassification</span></span>
<span></span>
<span><span class="va">modelname</span> <span class="op">&lt;-</span> <span class="st">"distilbert-base-uncased-finetuned-sst-2-english"</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">autoModelClass</span><span class="op">$</span><span class="fu">from_pretrained</span><span class="op">(</span><span class="va">modelname</span><span class="op">)</span></span></code></pre>
</div>
<p>If you get a nice summary, everything worked. You might get messages
about “ssl not installed”. Those can be ignored. And you will also get
warnings about tensorflow not being compiled for working with “GPU”s.
Since we do not have access to GPU on the kind of virtual machines we
can run RStudio on, on UCloud, these can safely be ignored.</p>
<div class="section level4">
<h4 id="do-i-have-to-do-this-every-time">Do I have to do this every time?<a class="anchor" aria-label="anchor" href="#do-i-have-to-do-this-every-time"></a></h4>
<p>Good news everybody! No.</p>
<p><em>If</em> you start a new virtual machine, and add the
<em>same</em> folder in you drive on Ucloud to the run, you can open
your project again: Navigate to the project folder (you did remember the
name, right?), and click on the .Rproj file with the same name as your
project.</p>
<p>Due to the way Renv works, it might take some time to open the
project:¨</p>
<figure><img src="fig/ucloud_taking_longer.png" class="figure mx-auto d-block"></figure><p>And for reasons we do not entirely understand at KUB Datalab (yet),
we also have to run the</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu">use_condaenv</span><span class="op">(</span><span class="st">"my_project_env"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>Before actually doing anything.</p>
</div>
<div class="section level4">
<h4 id="what-about-other-packages">What about other packages?<a class="anchor" aria-label="anchor" href="#what-about-other-packages"></a></h4>
<p>When you have run the setup above, and opened the project,
<code>renv</code> is running and keeping track of stuff.</p>
<p>That also means that if you need another package -
<code>tidyverse</code> comes to mind as a frequently used set of
packages, you simply install tidyverse running
<code>install.packages("tidyverse")</code> just as you would normally
do. These new packages are now installed in your project and will be
available without having to install them repeatedly.</p>
<p>But remember to run <code>renv::snapshot()</code> afterwards to
update the registration <code>renv</code> keeps of installed
packages.</p>
</div>
<div class="section level4">
<h4 id="other-issues">Other issues<a class="anchor" aria-label="anchor" href="#other-issues"></a></h4>
<p>Renv is a bit finicky. You might get messages about packages being in
“an inconsistent state”. Try running this first:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">restore</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>And if that does not solve the problem, try:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">rehash</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">restore</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Sometimes renv forgets that a library is installed…</p>
<p>Fortunately the libraries are easily available, so an</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"rstudio/keras3"</span><span class="op">)</span></span></code></pre>
</div>
<p>is fast. The example shows keras3 - exchange the package name for
what is actually missing.</p>
</div>
<div class="section level3">
<h3 id="the-sledgehammer-solution">The sledgehammer solution<a class="anchor" aria-label="anchor" href="#the-sledgehammer-solution"></a></h3>
<p>This has worked consistently. But take a long time and needs to be
repeated every time you start a new machine. It will work, but only by
being pretty violent with the virtual machine.</p>
<p>When you have started the virtual machine, and opened a project, make
a new R-script in the project, copy the following code (or download it
from here), and run it line by line.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run shell commands from R</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"sudo"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"add-apt-repository"</span>, <span class="st">"-y"</span>, <span class="st">"ppa:deadsnakes/ppa"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"sudo"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"apt-get"</span>, <span class="st">"update"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"sudo"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"apt-get"</span>, <span class="st">"install"</span>, <span class="st">"-y"</span>, <span class="st">"python3.9"</span>, <span class="st">"python3.9-venv"</span>, <span class="st">"python3.9-dev"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Python setup</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"ensurepip"</span>, <span class="st">"--upgrade"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, <span class="st">"--upgrade"</span>, <span class="st">"pip"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, <span class="st">"numpy"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create and activate environment</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"python3.9"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-m"</span>, <span class="st">"venv"</span>, <span class="st">"~/r-tensorflow"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Activate virtual environment and install packages</span></span>
<span><span class="fu">system2</span><span class="op">(</span><span class="st">"bash"</span>, args <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-c"</span>, <span class="st">"source ~/r-tensorflow/bin/activate &amp;&amp; pip install numpy tensorflow keras spacy &amp;&amp; python -m spacy download en_core_web_sm &amp;&amp; deactivate"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># R packages and setup</span></span>
<span><span class="fu">Sys.unsetenv</span><span class="op">(</span><span class="st">'RETICULATE_PYTHON'</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">reticulate</span><span class="op">)</span></span>
<span><span class="fu">use_virtualenv</span><span class="op">(</span><span class="st">'~/r-tensorflow'</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">'remotes'</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'rstudio/tensorflow'</span>, upgrade <span class="op">=</span> <span class="st">'always'</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tensorflow</span><span class="op">)</span></span>
<span><span class="fu">install_tensorflow</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">'~/r-tensorflow'</span>, restart_session <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'rstudio/keras'</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">keras3</span><span class="op">)</span></span>
<span><span class="fu">install_keras</span><span class="op">(</span>envname <span class="op">=</span> <span class="st">'~/r-tensorflow'</span><span class="op">)</span></span></code></pre>
</div>
<p>You can check that it is working similarly to the better solution
above.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Notes on the good solution </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Data analysis is not worth much, if we are not able to reproduce our
results. A significant amount of work have therefore gone into providing
infrastructure for exactly that. One issue is the question of which
libraries are used for the analysis.</p>
<p>Enter <code>renv</code>. <code>renv</code> is a library that
establishes scaffolding for installing libraries in a specific location
in an R-project, making it self contained and easy to distribute.
Normally we would distribute a “lock file” that describes exactly which
versions of which packages are used in a project.</p>
<p>You will see a lot of stuff in the “files” tab. A folder called
“renv”, a file “renv.lock”, and probably a file “.Rprofile”.</p>
<p>Looking into that, we will find a line of code
“source(”renv/activate.R”)”</p>
<p>When ever we start the project, what ever we have written to
.Rprofile will be run. What will be run in this case is the script
“activate.R” which does a lot of interesting stuff. The important thing
is, that the renv-library is started. And whenever we now install a
package, it will be installed in the renv folder. Do not delve too deep
into that, leave it to the machine.</p>
<p>One issue with this is, that there are still installed packages weird
places on the machine. Caches of the packages are stored outside our
project. The idea is that other projects might use these cached
packages, and cut down on install time.</p>
<p>In our case, that is not helpful. This cache will disappear when the
virtual machine is stopped.</p>
<p>In order to handle this, we can specify where the cache should be
stored. We can do that manually. Or, and this is the preffered solution,
make a file .Renviron where we specify where renv should place the
cache. Having done that we need to restart R, and now we can install
packages to our hearts delight, and renv will place both the libraries
and the cache in our local project.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Ucloud provide access to a multitude of advanced software that we
are not able to run locally</li>
<li>Running RStudio on Ucloud give us access to more compute and memory
than we have on our own computer</li>
<li>More advanced work might require a quite complicated setup</li>
<li>Restarting a virtual machine means all our work and setup might be
lost, unless we take certain precautions.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="cohens-kappa.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="pipes.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="cohens-kappa.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Cohens Kappa
        </a>
        <a class="chapter-link float-end" href="pipes.html" rel="next">
          Next: A deeper dive into...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/ucloud.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-toolbox/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC BY-NC-SA 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://KUBDatalab.github.io/R-toolbox/ucloud.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson",
  "name": "R on Ucloud",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-toolbox/ucloud.html",
  "identifier": "https://KUBDatalab.github.io/R-toolbox/ucloud.html",
  "dateCreated": "2024-04-09",
  "dateModified": "2025-06-16",
  "datePublished": "2025-06-16"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

